<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 16.0.0"/>
    <title>data_validate.validators API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:27px;vertical-align:bottom;width:50px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../data_validate.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;data_validate</a>

            <img src="https://avatars.githubusercontent.com/u/141270342?s=400&amp;v=4" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#ValidatorModelABC">ValidatorModelABC</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ValidatorModelABC.__init__">ValidatorModelABC</a>
                        </li>
                        <li>
                                <a class="variable" href="#ValidatorModelABC.TITLES_INFO">TITLES_INFO</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorModelABC.initialize">initialize</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorModelABC.check_columns_in_models_dataframes">check_columns_in_models_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorModelABC.column_exists">column_exists</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorModelABC.set_not_executed">set_not_executed</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorModelABC.build_reports">build_reports</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorModelABC.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpDescriptionValidator">SpDescriptionValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpDescriptionValidator.__init__">SpDescriptionValidator</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_html_in_descriptions">validate_html_in_descriptions</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_sequential_codes">validate_sequential_codes</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_unique_codes">validate_unique_codes</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_text_capitalization">validate_text_capitalization</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_indicator_levels">validate_indicator_levels</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_punctuation">validate_punctuation</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_empty_strings">validate_empty_strings</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_cr_lf_characters">validate_cr_lf_characters</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_title_length">validate_title_length</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.validate_simple_description_length">validate_simple_description_length</a>
                        </li>
                        <li>
                                <a class="function" href="#SpDescriptionValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpValueValidator">SpValueValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpValueValidator.__init__">SpValueValidator</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.model_sp_value">model_sp_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.model_sp_description">model_sp_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.model_sp_temporal_reference">model_sp_temporal_reference</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.model_sp_scenario">model_sp_scenario</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.exists_scenario">exists_scenario</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.list_scenarios">list_scenarios</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.sp_name_description">sp_name_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.sp_name_temporal_reference">sp_name_temporal_reference</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.sp_name_scenario">sp_name_scenario</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.sp_name_value">sp_name_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.global_required_columns">global_required_columns</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpValueValidator.model_dataframes">model_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#SpValueValidator.validate_relation_indicators_in_values">validate_relation_indicators_in_values</a>
                        </li>
                        <li>
                                <a class="function" href="#SpValueValidator.validate_value_combination_relation">validate_value_combination_relation</a>
                        </li>
                        <li>
                                <a class="function" href="#SpValueValidator.validate_unavailable_codes_values">validate_unavailable_codes_values</a>
                        </li>
                        <li>
                                <a class="function" href="#SpValueValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpCompositionTreeValidator">SpCompositionTreeValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpCompositionTreeValidator.__init__">SpCompositionTreeValidator</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.model_sp_composition">model_sp_composition</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.model_sp_description">model_sp_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.sp_name_description">sp_name_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.sp_name_composition">sp_name_composition</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.column_name_code">column_name_code</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.column_name_level">column_name_level</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.column_name_parent">column_name_parent</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.column_name_child">column_name_child</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.global_required_columns">global_required_columns</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionTreeValidator.model_dataframes">model_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionTreeValidator.validate_hierarchy_with_tree">validate_hierarchy_with_tree</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionTreeValidator.validate_tree_levels_children">validate_tree_levels_children</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionTreeValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpCompositionGraphValidator">SpCompositionGraphValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpCompositionGraphValidator.__init__">SpCompositionGraphValidator</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.model_sp_composition">model_sp_composition</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.model_sp_description">model_sp_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.model_sp_value">model_sp_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.model_sp_proportionality">model_sp_proportionality</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.sp_name_composition">sp_name_composition</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.sp_name_description">sp_name_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.sp_name_value">sp_name_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.sp_name_proportionality">sp_name_proportionality</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.column_name_parent">column_name_parent</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.column_name_child">column_name_child</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.column_name_code">column_name_code</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.column_name_simple_name">column_name_simple_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.column_name_complete_name">column_name_complete_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.column_name_id">column_name_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.global_required_columns">global_required_columns</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.model_dataframes">model_dataframes</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpCompositionGraphValidator.graph_processing">graph_processing</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition">validate_relation_indicators_in_composition</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph">validate_relations_hierarchy_with_graph</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionGraphValidator.validate_unique_titles_with_graph">validate_unique_titles_with_graph</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionGraphValidator.validate_associated_indicators_leafs">validate_associated_indicators_leafs</a>
                        </li>
                        <li>
                                <a class="function" href="#SpCompositionGraphValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpTemporalReferenceValidator">SpTemporalReferenceValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpTemporalReferenceValidator.__init__">SpTemporalReferenceValidator</a>
                        </li>
                        <li>
                                <a class="function" href="#SpTemporalReferenceValidator.validate_punctuation">validate_punctuation</a>
                        </li>
                        <li>
                                <a class="function" href="#SpTemporalReferenceValidator.validate_reference_years">validate_reference_years</a>
                        </li>
                        <li>
                                <a class="function" href="#SpTemporalReferenceValidator.validate_unique_values">validate_unique_values</a>
                        </li>
                        <li>
                                <a class="function" href="#SpTemporalReferenceValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpProportionalityValidator">SpProportionalityValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpProportionalityValidator.__init__">SpProportionalityValidator</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.model_sp_proportionality">model_sp_proportionality</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.model_sp_description">model_sp_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.model_sp_value">model_sp_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.model_sp_composition">model_sp_composition</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.exists_scenario">exists_scenario</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.list_scenarios">list_scenarios</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.sp_name_proportionality">sp_name_proportionality</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.sp_name_description">sp_name_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.sp_name_value">sp_name_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.sp_name_composition">sp_name_composition</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.column_name_id">column_name_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.column_name_code">column_name_code</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.column_name_level">column_name_level</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.column_name_scenario">column_name_scenario</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.column_name_parent">column_name_parent</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.column_name_child">column_name_child</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.global_required_columns">global_required_columns</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpProportionalityValidator.model_dataframes">model_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality">validate_relation_indicators_in_proportionality</a>
                        </li>
                        <li>
                                <a class="function" href="#SpProportionalityValidator.validate_columns_repeated_indicators">validate_columns_repeated_indicators</a>
                        </li>
                        <li>
                                <a class="function" href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality">validate_relation_indicators_in_value_and_proportionality</a>
                        </li>
                        <li>
                                <a class="function" href="#SpProportionalityValidator.validate_parent_child_relationships">validate_parent_child_relationships</a>
                        </li>
                        <li>
                                <a class="function" href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors">validate_sum_properties_in_influencing_factors</a>
                        </li>
                        <li>
                                <a class="function" href="#SpProportionalityValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpScenarioValidator">SpScenarioValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpScenarioValidator.__init__">SpScenarioValidator</a>
                        </li>
                        <li>
                                <a class="function" href="#SpScenarioValidator.validate_punctuation">validate_punctuation</a>
                        </li>
                        <li>
                                <a class="function" href="#SpScenarioValidator.validate_unique_values">validate_unique_values</a>
                        </li>
                        <li>
                                <a class="function" href="#SpScenarioValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpLegendValidator">SpLegendValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpLegendValidator.__init__">SpLegendValidator</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.model_sp_legend">model_sp_legend</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.model_sp_description">model_sp_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.model_sp_value">model_sp_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.scenario_exists_file">scenario_exists_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.scenarios_list">scenarios_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.sp_name_legend">sp_name_legend</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.sp_name_description">sp_name_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.sp_name_value">sp_name_value</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.global_required_columns">global_required_columns</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpLegendValidator.model_dataframes">model_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#SpLegendValidator.validate_relation_indicators_in_legend">validate_relation_indicators_in_legend</a>
                        </li>
                        <li>
                                <a class="function" href="#SpLegendValidator.validate_range_multiple_legend">validate_range_multiple_legend</a>
                        </li>
                        <li>
                                <a class="function" href="#SpLegendValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpellCheckerValidator">SpellCheckerValidator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpellCheckerValidator.__init__">SpellCheckerValidator</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpellCheckerValidator.dictionary">dictionary</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpellCheckerValidator.lang_dict_spell">lang_dict_spell</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpellCheckerValidator.list_words_user">list_words_user</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpellCheckerValidator.spellchecker">spellchecker</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpellCheckerValidator.model_columns_map">model_columns_map</a>
                        </li>
                        <li>
                                <a class="function" href="#SpellCheckerValidator.validate_spellchecker">validate_spellchecker</a>
                        </li>
                        <li>
                                <a class="function" href="#SpellCheckerValidator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ValidatorStructureFiles">ValidatorStructureFiles</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ValidatorStructureFiles.__init__">ValidatorStructureFiles</a>
                        </li>
                        <li>
                                <a class="variable" href="#ValidatorStructureFiles.context">context</a>
                        </li>
                        <li>
                                <a class="variable" href="#ValidatorStructureFiles.errors">errors</a>
                        </li>
                        <li>
                                <a class="variable" href="#ValidatorStructureFiles.warnings">warnings</a>
                        </li>
                        <li>
                                <a class="variable" href="#ValidatorStructureFiles.dir_files">dir_files</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorStructureFiles.check_empty_directory">check_empty_directory</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root">check_not_expected_files_in_folder_root</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorStructureFiles.check_expected_files_in_folder_root">check_expected_files_in_folder_root</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorStructureFiles.check_ignored_files_in_folder_root">check_ignored_files_in_folder_root</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorStructureFiles.validate_all_general_structure">validate_all_general_structure</a>
                        </li>
                        <li>
                                <a class="function" href="#ValidatorStructureFiles.run">run</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22160%22%20viewBox%3D%220%200%20150%2080%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M132.316%2048.886c.276-4.679%202.342-6.698%204.409-7.982s4.27-1.165%206.751-1.055c1.586.07%203.044.156%204.222-.482%201.142-.619%202.026-1.932%202.162-3.739.268-3.576-1.929-5.368-5.006-5.551s-7.599.524-10.517%201.606c-4.455%201.652-8.588%206.606-9.552%208.992s-2.342%206.193-1.745%2010.873%202.664%209.221%205.878%2011.79%205.878%203.808%2010.103%204.312%203.444.229%206.062.229%205.006-2.202%204.914-4.909-2.296-5.001-4.501-4.863-3.077.505-5.281.229-7.715-2.064-7.899-9.451z%22%20fill%3D%22%23198754%22/%3E%3Ccircle%20cx%3D%22101.504%22%20cy%3D%2248.943%22%20r%3D%2214.208%22%20fill%3D%22none%22%20stroke%3D%22%23198754%22%20stroke-width%3D%229.354%22/%3E%3Cpath%20d%3D%22M87.81.002c-3.637.065-5.001.454-7.014%201.232s-3.443%201.363-6.3%204.282c-1.723%201.76-3.148%205.019-3.776%207.329-.413%201.521-.316%202.63-.316%202.63l-.195%2034.612c.065%205.774-6.755%208.305-9.612%208.37s-9.678-1.038-9.743-9.408%207.128-9.521%208.362-9.521c1.413-.13%202.526-.021%203.718-.016%202.071.009%204.157-.778%204.092-4.671s-4.157-4.736-4.157-4.736c-6.3-.843-11.43%202.206-11.43%202.206S40.917%2038.15%2041.372%2049.634%2051.568%2068.19%2061.311%2068.125s18.316-7.007%2018.445-17.193l.13-22.772c.046-2.291%202.683-3.644%204.476-4.203.745-.232%201.694-.274%201.694-.274l10.457-.13s4.871-.324%207.729-3.114%204.352-6.294%204.352-6.294.974-3.049.13-4.606-.195-1.233-2.792-3.309-8.573-4.477-8.573-4.477S91.447-.063%2087.81.002zM0%2047.169l.065%2028.417S0%2080.127%204.481%2079.997s5.072-3.866%205.049-4.152l-.113-28.482s1.624-7.656%209.937-7.721%2010.002%206.942%2010.002%208.499-.909%2010.51-9.093%2010.51c-.948%200-2.99-.567-4.145-.272-3.919%201-3.194%204.554-3.194%204.554s.065%205.061%207.404%204.996%2018.575-6.034%2018.575-19.074S26.953%2030.04%2019.549%2029.91%201.234%2035.296%200%2047.169z%22%20fill%3D%22%23198754%22/%3E%3Cg%20transform%3D%22matrix%28.325601%200%200%20.325256%20-10.32669%20-45.802786%29%22%3E%3Ccircle%20cx%3D%22297.554%22%20cy%3D%22172.286%22%20r%3D%2216.5%22%20fill%3D%22%23fff%22/%3E%3Cellipse%20cx%3D%22297.709%22%20cy%3D%22172.642%22%20rx%3D%2211.071%22%20ry%3D%2210.871%22%20fill%3D%22%23105a48%22/%3E%3Ccircle%20cx%3D%22304.104%22%20cy%3D%22167.667%22%20r%3D%224.5%22%20fill%3D%22%23fff%22/%3E%3C/g%3E%3Cpath%20d%3D%22M94.661%2017.032l.893-1.476s.99.714%201.916.925%201.575.114%202.955.114l14.565-.162c1.283-.032%203.085-.762%203.02-3.293s-.373-3.503-.373-3.503l1.283-.487s.52.503.877%201.573.309%201.995.292%202.66-.227%201.541-.227%201.541%201.564-.308%202.359-1.038.823-.779%201.489-1.508.812-.86.812-.86.552-.13.877.26.341.957.065%201.46-1.672%202.206-3.247%203.066-2.76%201.427-3.929%201.768-3.848.73-7.063.714l-10.944-.114s-2.143-.081-3.02-.373-2.241-.973-2.598-1.265z%22%20fill%3D%22%23d36d49%22/%3E%3Cg%20fill%3D%22%23105a48%22%3E%3Cellipse%20cx%3D%2293.052%22%20cy%3D%2243.567%22%20rx%3D%22.869%22%20ry%3D%221.014%22%20transform%3D%22rotate%28341.022%29%22/%3E%3Cellipse%20cx%3D%22104.3%22%20cy%3D%22-16.184%22%20rx%3D%22.865%22%20ry%3D%221.009%22%20transform%3D%22rotate%2814.786%29%22/%3E%3C/g%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../data_validate.html">data_validate</a><wbr>.validators    </h1>

                
                        <input id="mod-validators-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-validators-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="c1">#  Copyright (c) 2025-2026 National Institute for Space Research (INPE) (https://www.gov.br/inpe/pt-br). Documentation, source code, and more details about the AdaptaBrasil project are available at: https://github.com/AdaptaBrasil/.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="c1"># Package spell</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spell.spellchecker_validator</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpellCheckerValidator</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="c1"># Package spreadsheets</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.base.validator_model_abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ValidatorModelABC</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.composition</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>    <span class="n">SpCompositionTreeValidator</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="n">SpCompositionGraphValidator</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="p">)</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.description.description_validator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="n">SpDescriptionValidator</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="p">)</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.legend.legend_validator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="n">SpLegendValidator</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="p">)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.proportionality.proportionality_validator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>    <span class="n">SpProportionalityValidator</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="p">)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.scenario.scenario_validator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="n">SpScenarioValidator</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="p">)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.temporal_reference.temporal_reference_validator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="n">SpTemporalReferenceValidator</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="p">)</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.spreadsheets.value.value_validator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="n">SpValueValidator</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="p">)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a><span class="c1"># Package structure</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">data_validate.validators.structure.validator_structure</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="n">ValidatorStructureFiles</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="p">)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="c1"># Package spreadsheets</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="s2">&quot;ValidatorModelABC&quot;</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="s2">&quot;SpDescriptionValidator&quot;</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="s2">&quot;SpValueValidator&quot;</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="s2">&quot;SpCompositionTreeValidator&quot;</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="s2">&quot;SpCompositionGraphValidator&quot;</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="s2">&quot;SpTemporalReferenceValidator&quot;</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="s2">&quot;SpProportionalityValidator&quot;</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="s2">&quot;SpScenarioValidator&quot;</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="s2">&quot;SpLegendValidator&quot;</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="c1"># Package spell</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="s2">&quot;SpellCheckerValidator&quot;</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="c1"># Package structure</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>    <span class="s2">&quot;ValidatorStructureFiles&quot;</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="ValidatorModelABC">
                            <input id="ValidatorModelABC-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ValidatorModelABC</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="ValidatorModelABC-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC-22"><a href="#ValidatorModelABC-22"><span class="linenos"> 22</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ValidatorModelABC</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="ValidatorModelABC-23"><a href="#ValidatorModelABC-23"><span class="linenos"> 23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-24"><a href="#ValidatorModelABC-24"><span class="linenos"> 24</span></a><span class="sd">    Abstract base class for all spreadsheet model validators.</span>
</span><span id="ValidatorModelABC-25"><a href="#ValidatorModelABC-25"><span class="linenos"> 25</span></a>
</span><span id="ValidatorModelABC-26"><a href="#ValidatorModelABC-26"><span class="linenos"> 26</span></a><span class="sd">    This class provides the foundation for all specific validators (e.g., Description,</span>
</span><span id="ValidatorModelABC-27"><a href="#ValidatorModelABC-27"><span class="linenos"> 27</span></a><span class="sd">    Value, Legend validators). It handles common validation tasks such as column existence</span>
</span><span id="ValidatorModelABC-28"><a href="#ValidatorModelABC-28"><span class="linenos"> 28</span></a><span class="sd">    checks, text length validation, and report generation.</span>
</span><span id="ValidatorModelABC-29"><a href="#ValidatorModelABC-29"><span class="linenos"> 29</span></a>
</span><span id="ValidatorModelABC-30"><a href="#ValidatorModelABC-30"><span class="linenos"> 30</span></a><span class="sd">    Attributes</span>
</span><span id="ValidatorModelABC-31"><a href="#ValidatorModelABC-31"><span class="linenos"> 31</span></a><span class="sd">    ----------</span>
</span><span id="ValidatorModelABC-32"><a href="#ValidatorModelABC-32"><span class="linenos"> 32</span></a><span class="sd">    _data_models_context : DataModelsContext</span>
</span><span id="ValidatorModelABC-33"><a href="#ValidatorModelABC-33"><span class="linenos"> 33</span></a><span class="sd">        Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="ValidatorModelABC-34"><a href="#ValidatorModelABC-34"><span class="linenos"> 34</span></a><span class="sd">    _report_list : ModelListReport</span>
</span><span id="ValidatorModelABC-35"><a href="#ValidatorModelABC-35"><span class="linenos"> 35</span></a><span class="sd">        Aggregator for collecting and organizing validation results.</span>
</span><span id="ValidatorModelABC-36"><a href="#ValidatorModelABC-36"><span class="linenos"> 36</span></a><span class="sd">    _type_class : Type[SpModelABC]</span>
</span><span id="ValidatorModelABC-37"><a href="#ValidatorModelABC-37"><span class="linenos"> 37</span></a><span class="sd">        The model class type this validator is responsible for validating.</span>
</span><span id="ValidatorModelABC-38"><a href="#ValidatorModelABC-38"><span class="linenos"> 38</span></a><span class="sd">    _data_model : SpModelABC</span>
</span><span id="ValidatorModelABC-39"><a href="#ValidatorModelABC-39"><span class="linenos"> 39</span></a><span class="sd">        The specific model instance being validated.</span>
</span><span id="ValidatorModelABC-40"><a href="#ValidatorModelABC-40"><span class="linenos"> 40</span></a><span class="sd">    _filename : str</span>
</span><span id="ValidatorModelABC-41"><a href="#ValidatorModelABC-41"><span class="linenos"> 41</span></a><span class="sd">        Name of the file being validated.</span>
</span><span id="ValidatorModelABC-42"><a href="#ValidatorModelABC-42"><span class="linenos"> 42</span></a><span class="sd">    _dataframe : pd.DataFrame</span>
</span><span id="ValidatorModelABC-43"><a href="#ValidatorModelABC-43"><span class="linenos"> 43</span></a><span class="sd">        DataFrame containing the data to validate.</span>
</span><span id="ValidatorModelABC-44"><a href="#ValidatorModelABC-44"><span class="linenos"> 44</span></a><span class="sd">    TITLES_INFO : Dict[str, str]</span>
</span><span id="ValidatorModelABC-45"><a href="#ValidatorModelABC-45"><span class="linenos"> 45</span></a><span class="sd">        Mapping of validation types to human-readable titles.</span>
</span><span id="ValidatorModelABC-46"><a href="#ValidatorModelABC-46"><span class="linenos"> 46</span></a><span class="sd">    _errors : List[str]</span>
</span><span id="ValidatorModelABC-47"><a href="#ValidatorModelABC-47"><span class="linenos"> 47</span></a><span class="sd">        Accumulated list of validation errors.</span>
</span><span id="ValidatorModelABC-48"><a href="#ValidatorModelABC-48"><span class="linenos"> 48</span></a><span class="sd">    _warnings : List[str]</span>
</span><span id="ValidatorModelABC-49"><a href="#ValidatorModelABC-49"><span class="linenos"> 49</span></a><span class="sd">        Accumulated list of validation warnings.</span>
</span><span id="ValidatorModelABC-50"><a href="#ValidatorModelABC-50"><span class="linenos"> 50</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-51"><a href="#ValidatorModelABC-51"><span class="linenos"> 51</span></a>
</span><span id="ValidatorModelABC-52"><a href="#ValidatorModelABC-52"><span class="linenos"> 52</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ValidatorModelABC-53"><a href="#ValidatorModelABC-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ValidatorModelABC-54"><a href="#ValidatorModelABC-54"><span class="linenos"> 54</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="ValidatorModelABC-55"><a href="#ValidatorModelABC-55"><span class="linenos"> 55</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="ValidatorModelABC-56"><a href="#ValidatorModelABC-56"><span class="linenos"> 56</span></a>        <span class="n">type_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">SpModelABC</span><span class="p">],</span>
</span><span id="ValidatorModelABC-57"><a href="#ValidatorModelABC-57"><span class="linenos"> 57</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="ValidatorModelABC-58"><a href="#ValidatorModelABC-58"><span class="linenos"> 58</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC-59"><a href="#ValidatorModelABC-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-60"><a href="#ValidatorModelABC-60"><span class="linenos"> 60</span></a><span class="sd">        Initialize the validator with context, report aggregator, and model class.</span>
</span><span id="ValidatorModelABC-61"><a href="#ValidatorModelABC-61"><span class="linenos"> 61</span></a>
</span><span id="ValidatorModelABC-62"><a href="#ValidatorModelABC-62"><span class="linenos"> 62</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-63"><a href="#ValidatorModelABC-63"><span class="linenos"> 63</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-64"><a href="#ValidatorModelABC-64"><span class="linenos"> 64</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="ValidatorModelABC-65"><a href="#ValidatorModelABC-65"><span class="linenos"> 65</span></a><span class="sd">            Context containing all loaded spreadsheet models, configuration, and utilities.</span>
</span><span id="ValidatorModelABC-66"><a href="#ValidatorModelABC-66"><span class="linenos"> 66</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="ValidatorModelABC-67"><a href="#ValidatorModelABC-67"><span class="linenos"> 67</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="ValidatorModelABC-68"><a href="#ValidatorModelABC-68"><span class="linenos"> 68</span></a><span class="sd">        type_class : Type[SpModelABC]</span>
</span><span id="ValidatorModelABC-69"><a href="#ValidatorModelABC-69"><span class="linenos"> 69</span></a><span class="sd">            The specific model class type this validator will validate.</span>
</span><span id="ValidatorModelABC-70"><a href="#ValidatorModelABC-70"><span class="linenos"> 70</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="ValidatorModelABC-71"><a href="#ValidatorModelABC-71"><span class="linenos"> 71</span></a><span class="sd">            Additional keyword arguments for future extensibility.</span>
</span><span id="ValidatorModelABC-72"><a href="#ValidatorModelABC-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-73"><a href="#ValidatorModelABC-73"><span class="linenos"> 73</span></a>        <span class="c1"># SETUP</span>
</span><span id="ValidatorModelABC-74"><a href="#ValidatorModelABC-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span> <span class="o">=</span> <span class="n">data_models_context</span>
</span><span id="ValidatorModelABC-75"><a href="#ValidatorModelABC-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_report_list</span> <span class="o">=</span> <span class="n">report_list</span>
</span><span id="ValidatorModelABC-76"><a href="#ValidatorModelABC-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type_class</span> <span class="o">=</span> <span class="n">type_class</span>
</span><span id="ValidatorModelABC-77"><a href="#ValidatorModelABC-77"><span class="linenos"> 77</span></a>
</span><span id="ValidatorModelABC-78"><a href="#ValidatorModelABC-78"><span class="linenos"> 78</span></a>        <span class="c1"># UNPACK DATA</span>
</span><span id="ValidatorModelABC-79"><a href="#ValidatorModelABC-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_class</span><span class="p">)</span>
</span><span id="ValidatorModelABC-80"><a href="#ValidatorModelABC-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">filename</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="k">else</span> <span class="s2">&quot;Unknown&quot;</span>
</span><span id="ValidatorModelABC-81"><a href="#ValidatorModelABC-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({})</span>
</span><span id="ValidatorModelABC-82"><a href="#ValidatorModelABC-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TITLES_INFO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_verify_names</span><span class="p">()</span>
</span><span id="ValidatorModelABC-83"><a href="#ValidatorModelABC-83"><span class="linenos"> 83</span></a>
</span><span id="ValidatorModelABC-84"><a href="#ValidatorModelABC-84"><span class="linenos"> 84</span></a>        <span class="c1"># LIST OF ERRORS AND WARNINGS</span>
</span><span id="ValidatorModelABC-85"><a href="#ValidatorModelABC-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorModelABC-86"><a href="#ValidatorModelABC-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorModelABC-87"><a href="#ValidatorModelABC-87"><span class="linenos"> 87</span></a>
</span><span id="ValidatorModelABC-88"><a href="#ValidatorModelABC-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</span><span id="ValidatorModelABC-89"><a href="#ValidatorModelABC-89"><span class="linenos"> 89</span></a>
</span><span id="ValidatorModelABC-90"><a href="#ValidatorModelABC-90"><span class="linenos"> 90</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC-91"><a href="#ValidatorModelABC-91"><span class="linenos"> 91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-92"><a href="#ValidatorModelABC-92"><span class="linenos"> 92</span></a><span class="sd">        Initialize additional validator-specific setup.</span>
</span><span id="ValidatorModelABC-93"><a href="#ValidatorModelABC-93"><span class="linenos"> 93</span></a>
</span><span id="ValidatorModelABC-94"><a href="#ValidatorModelABC-94"><span class="linenos"> 94</span></a><span class="sd">        This method is called after __init__ and can be overridden by subclasses</span>
</span><span id="ValidatorModelABC-95"><a href="#ValidatorModelABC-95"><span class="linenos"> 95</span></a><span class="sd">        to perform custom initialization logic. The default implementation does nothing.</span>
</span><span id="ValidatorModelABC-96"><a href="#ValidatorModelABC-96"><span class="linenos"> 96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-97"><a href="#ValidatorModelABC-97"><span class="linenos"> 97</span></a>        <span class="k">pass</span>
</span><span id="ValidatorModelABC-98"><a href="#ValidatorModelABC-98"><span class="linenos"> 98</span></a>
</span><span id="ValidatorModelABC-99"><a href="#ValidatorModelABC-99"><span class="linenos"> 99</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="ValidatorModelABC-100"><a href="#ValidatorModelABC-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ValidatorModelABC-101"><a href="#ValidatorModelABC-101"><span class="linenos">101</span></a>        <span class="n">required_columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="ValidatorModelABC-102"><a href="#ValidatorModelABC-102"><span class="linenos">102</span></a>        <span class="n">model_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
</span><span id="ValidatorModelABC-103"><a href="#ValidatorModelABC-103"><span class="linenos">103</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ValidatorModelABC-104"><a href="#ValidatorModelABC-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-105"><a href="#ValidatorModelABC-105"><span class="linenos">105</span></a><span class="sd">        Check if required columns exist in the provided dataframes for different models.</span>
</span><span id="ValidatorModelABC-106"><a href="#ValidatorModelABC-106"><span class="linenos">106</span></a>
</span><span id="ValidatorModelABC-107"><a href="#ValidatorModelABC-107"><span class="linenos">107</span></a><span class="sd">        Validates that all specified columns exist in their corresponding model dataframes.</span>
</span><span id="ValidatorModelABC-108"><a href="#ValidatorModelABC-108"><span class="linenos">108</span></a><span class="sd">        This is useful for cross-model validations where multiple spreadsheet models need</span>
</span><span id="ValidatorModelABC-109"><a href="#ValidatorModelABC-109"><span class="linenos">109</span></a><span class="sd">        to be checked for column presence.</span>
</span><span id="ValidatorModelABC-110"><a href="#ValidatorModelABC-110"><span class="linenos">110</span></a>
</span><span id="ValidatorModelABC-111"><a href="#ValidatorModelABC-111"><span class="linenos">111</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-112"><a href="#ValidatorModelABC-112"><span class="linenos">112</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-113"><a href="#ValidatorModelABC-113"><span class="linenos">113</span></a><span class="sd">        required_columns : Dict[str, List[str]]</span>
</span><span id="ValidatorModelABC-114"><a href="#ValidatorModelABC-114"><span class="linenos">114</span></a><span class="sd">            Dictionary where keys are model names and values are lists of required column names.</span>
</span><span id="ValidatorModelABC-115"><a href="#ValidatorModelABC-115"><span class="linenos">115</span></a><span class="sd">        model_dataframes : Dict[str, pd.DataFrame]</span>
</span><span id="ValidatorModelABC-116"><a href="#ValidatorModelABC-116"><span class="linenos">116</span></a><span class="sd">            Dictionary where keys are model names and values are their corresponding DataFrames.</span>
</span><span id="ValidatorModelABC-117"><a href="#ValidatorModelABC-117"><span class="linenos">117</span></a>
</span><span id="ValidatorModelABC-118"><a href="#ValidatorModelABC-118"><span class="linenos">118</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC-119"><a href="#ValidatorModelABC-119"><span class="linenos">119</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC-120"><a href="#ValidatorModelABC-120"><span class="linenos">120</span></a><span class="sd">        List[str]</span>
</span><span id="ValidatorModelABC-121"><a href="#ValidatorModelABC-121"><span class="linenos">121</span></a><span class="sd">            List of error messages for missing columns. Empty list if all columns exist.</span>
</span><span id="ValidatorModelABC-122"><a href="#ValidatorModelABC-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-123"><a href="#ValidatorModelABC-123"><span class="linenos">123</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorModelABC-124"><a href="#ValidatorModelABC-124"><span class="linenos">124</span></a>
</span><span id="ValidatorModelABC-125"><a href="#ValidatorModelABC-125"><span class="linenos">125</span></a>        <span class="c1"># Check if columns exist</span>
</span><span id="ValidatorModelABC-126"><a href="#ValidatorModelABC-126"><span class="linenos">126</span></a>        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">required_columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ValidatorModelABC-127"><a href="#ValidatorModelABC-127"><span class="linenos">127</span></a>            <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">model_dataframes</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
</span><span id="ValidatorModelABC-128"><a href="#ValidatorModelABC-128"><span class="linenos">128</span></a>            <span class="k">if</span> <span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC-129"><a href="#ValidatorModelABC-129"><span class="linenos">129</span></a>                <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="ValidatorModelABC-130"><a href="#ValidatorModelABC-130"><span class="linenos">130</span></a>                    <span class="n">exists_column</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span><span id="ValidatorModelABC-131"><a href="#ValidatorModelABC-131"><span class="linenos">131</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="ValidatorModelABC-132"><a href="#ValidatorModelABC-132"><span class="linenos">132</span></a>                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
</span><span id="ValidatorModelABC-133"><a href="#ValidatorModelABC-133"><span class="linenos">133</span></a>
</span><span id="ValidatorModelABC-134"><a href="#ValidatorModelABC-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="n">errors</span>
</span><span id="ValidatorModelABC-135"><a href="#ValidatorModelABC-135"><span class="linenos">135</span></a>
</span><span id="ValidatorModelABC-136"><a href="#ValidatorModelABC-136"><span class="linenos">136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">column_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="ValidatorModelABC-137"><a href="#ValidatorModelABC-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-138"><a href="#ValidatorModelABC-138"><span class="linenos">138</span></a><span class="sd">        Check if a column exists in a given DataFrame.</span>
</span><span id="ValidatorModelABC-139"><a href="#ValidatorModelABC-139"><span class="linenos">139</span></a>
</span><span id="ValidatorModelABC-140"><a href="#ValidatorModelABC-140"><span class="linenos">140</span></a><span class="sd">        This is a convenience wrapper around DataFrameProcessing.column_exists that can be</span>
</span><span id="ValidatorModelABC-141"><a href="#ValidatorModelABC-141"><span class="linenos">141</span></a><span class="sd">        used to validate column presence in any DataFrame-filename pair.</span>
</span><span id="ValidatorModelABC-142"><a href="#ValidatorModelABC-142"><span class="linenos">142</span></a>
</span><span id="ValidatorModelABC-143"><a href="#ValidatorModelABC-143"><span class="linenos">143</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-144"><a href="#ValidatorModelABC-144"><span class="linenos">144</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-145"><a href="#ValidatorModelABC-145"><span class="linenos">145</span></a><span class="sd">        dataframe : pd.DataFrame</span>
</span><span id="ValidatorModelABC-146"><a href="#ValidatorModelABC-146"><span class="linenos">146</span></a><span class="sd">            The DataFrame to check for column existence.</span>
</span><span id="ValidatorModelABC-147"><a href="#ValidatorModelABC-147"><span class="linenos">147</span></a><span class="sd">        filename : str</span>
</span><span id="ValidatorModelABC-148"><a href="#ValidatorModelABC-148"><span class="linenos">148</span></a><span class="sd">            Name of the file for error message generation.</span>
</span><span id="ValidatorModelABC-149"><a href="#ValidatorModelABC-149"><span class="linenos">149</span></a><span class="sd">        column : str</span>
</span><span id="ValidatorModelABC-150"><a href="#ValidatorModelABC-150"><span class="linenos">150</span></a><span class="sd">            Name of the column to check for.</span>
</span><span id="ValidatorModelABC-151"><a href="#ValidatorModelABC-151"><span class="linenos">151</span></a>
</span><span id="ValidatorModelABC-152"><a href="#ValidatorModelABC-152"><span class="linenos">152</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC-153"><a href="#ValidatorModelABC-153"><span class="linenos">153</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC-154"><a href="#ValidatorModelABC-154"><span class="linenos">154</span></a><span class="sd">        Tuple[bool, str]</span>
</span><span id="ValidatorModelABC-155"><a href="#ValidatorModelABC-155"><span class="linenos">155</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorModelABC-156"><a href="#ValidatorModelABC-156"><span class="linenos">156</span></a><span class="sd">                - bool: True if column exists, False otherwise</span>
</span><span id="ValidatorModelABC-157"><a href="#ValidatorModelABC-157"><span class="linenos">157</span></a><span class="sd">                - str: Error message if column doesn&#39;t exist, empty string otherwise</span>
</span><span id="ValidatorModelABC-158"><a href="#ValidatorModelABC-158"><span class="linenos">158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-159"><a href="#ValidatorModelABC-159"><span class="linenos">159</span></a>        <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span><span id="ValidatorModelABC-160"><a href="#ValidatorModelABC-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span>
</span><span id="ValidatorModelABC-161"><a href="#ValidatorModelABC-161"><span class="linenos">161</span></a>
</span><span id="ValidatorModelABC-162"><a href="#ValidatorModelABC-162"><span class="linenos">162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_column_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="ValidatorModelABC-163"><a href="#ValidatorModelABC-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-164"><a href="#ValidatorModelABC-164"><span class="linenos">164</span></a><span class="sd">        Check if a column exists in the validator&#39;s internal DataFrame.</span>
</span><span id="ValidatorModelABC-165"><a href="#ValidatorModelABC-165"><span class="linenos">165</span></a>
</span><span id="ValidatorModelABC-166"><a href="#ValidatorModelABC-166"><span class="linenos">166</span></a><span class="sd">        This method validates column presence in the DataFrame currently being validated</span>
</span><span id="ValidatorModelABC-167"><a href="#ValidatorModelABC-167"><span class="linenos">167</span></a><span class="sd">        by this validator instance (self._dataframe).</span>
</span><span id="ValidatorModelABC-168"><a href="#ValidatorModelABC-168"><span class="linenos">168</span></a>
</span><span id="ValidatorModelABC-169"><a href="#ValidatorModelABC-169"><span class="linenos">169</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-170"><a href="#ValidatorModelABC-170"><span class="linenos">170</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-171"><a href="#ValidatorModelABC-171"><span class="linenos">171</span></a><span class="sd">        column : str</span>
</span><span id="ValidatorModelABC-172"><a href="#ValidatorModelABC-172"><span class="linenos">172</span></a><span class="sd">            Name of the column to check for.</span>
</span><span id="ValidatorModelABC-173"><a href="#ValidatorModelABC-173"><span class="linenos">173</span></a>
</span><span id="ValidatorModelABC-174"><a href="#ValidatorModelABC-174"><span class="linenos">174</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC-175"><a href="#ValidatorModelABC-175"><span class="linenos">175</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC-176"><a href="#ValidatorModelABC-176"><span class="linenos">176</span></a><span class="sd">        Tuple[bool, str]</span>
</span><span id="ValidatorModelABC-177"><a href="#ValidatorModelABC-177"><span class="linenos">177</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorModelABC-178"><a href="#ValidatorModelABC-178"><span class="linenos">178</span></a><span class="sd">                - bool: True if column exists, False otherwise</span>
</span><span id="ValidatorModelABC-179"><a href="#ValidatorModelABC-179"><span class="linenos">179</span></a><span class="sd">                - str: Error message if column doesn&#39;t exist, empty string otherwise</span>
</span><span id="ValidatorModelABC-180"><a href="#ValidatorModelABC-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-181"><a href="#ValidatorModelABC-181"><span class="linenos">181</span></a>        <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span><span id="ValidatorModelABC-182"><a href="#ValidatorModelABC-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span>
</span><span id="ValidatorModelABC-183"><a href="#ValidatorModelABC-183"><span class="linenos">183</span></a>
</span><span id="ValidatorModelABC-184"><a href="#ValidatorModelABC-184"><span class="linenos">184</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_column_exists_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="ValidatorModelABC-185"><a href="#ValidatorModelABC-185"><span class="linenos">185</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-186"><a href="#ValidatorModelABC-186"><span class="linenos">186</span></a><span class="sd">        Check if a column exists in a specified DataFrame.</span>
</span><span id="ValidatorModelABC-187"><a href="#ValidatorModelABC-187"><span class="linenos">187</span></a>
</span><span id="ValidatorModelABC-188"><a href="#ValidatorModelABC-188"><span class="linenos">188</span></a><span class="sd">        This method validates column presence in a given DataFrame using the</span>
</span><span id="ValidatorModelABC-189"><a href="#ValidatorModelABC-189"><span class="linenos">189</span></a><span class="sd">        validator&#39;s filename for error message generation.</span>
</span><span id="ValidatorModelABC-190"><a href="#ValidatorModelABC-190"><span class="linenos">190</span></a>
</span><span id="ValidatorModelABC-191"><a href="#ValidatorModelABC-191"><span class="linenos">191</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-192"><a href="#ValidatorModelABC-192"><span class="linenos">192</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-193"><a href="#ValidatorModelABC-193"><span class="linenos">193</span></a><span class="sd">        dataframe : pd.DataFrame</span>
</span><span id="ValidatorModelABC-194"><a href="#ValidatorModelABC-194"><span class="linenos">194</span></a><span class="sd">            The DataFrame to check for column existence.</span>
</span><span id="ValidatorModelABC-195"><a href="#ValidatorModelABC-195"><span class="linenos">195</span></a><span class="sd">        column : str</span>
</span><span id="ValidatorModelABC-196"><a href="#ValidatorModelABC-196"><span class="linenos">196</span></a><span class="sd">            Name of the column to check for.</span>
</span><span id="ValidatorModelABC-197"><a href="#ValidatorModelABC-197"><span class="linenos">197</span></a>
</span><span id="ValidatorModelABC-198"><a href="#ValidatorModelABC-198"><span class="linenos">198</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC-199"><a href="#ValidatorModelABC-199"><span class="linenos">199</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC-200"><a href="#ValidatorModelABC-200"><span class="linenos">200</span></a><span class="sd">        Tuple[bool, str]</span>
</span><span id="ValidatorModelABC-201"><a href="#ValidatorModelABC-201"><span class="linenos">201</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorModelABC-202"><a href="#ValidatorModelABC-202"><span class="linenos">202</span></a><span class="sd">                - bool: True if column exists, False otherwise</span>
</span><span id="ValidatorModelABC-203"><a href="#ValidatorModelABC-203"><span class="linenos">203</span></a><span class="sd">                - str: Error message if column doesn&#39;t exist, empty string otherwise</span>
</span><span id="ValidatorModelABC-204"><a href="#ValidatorModelABC-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-205"><a href="#ValidatorModelABC-205"><span class="linenos">205</span></a>        <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span><span id="ValidatorModelABC-206"><a href="#ValidatorModelABC-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span>
</span><span id="ValidatorModelABC-207"><a href="#ValidatorModelABC-207"><span class="linenos">207</span></a>
</span><span id="ValidatorModelABC-208"><a href="#ValidatorModelABC-208"><span class="linenos">208</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_check_text_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorModelABC-209"><a href="#ValidatorModelABC-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-210"><a href="#ValidatorModelABC-210"><span class="linenos">210</span></a><span class="sd">        Validate text length in a column of the validator&#39;s DataFrame.</span>
</span><span id="ValidatorModelABC-211"><a href="#ValidatorModelABC-211"><span class="linenos">211</span></a>
</span><span id="ValidatorModelABC-212"><a href="#ValidatorModelABC-212"><span class="linenos">212</span></a><span class="sd">        Checks that all text values in the specified column do not exceed the maximum</span>
</span><span id="ValidatorModelABC-213"><a href="#ValidatorModelABC-213"><span class="linenos">213</span></a><span class="sd">        allowed length. Violations are reported as warnings.</span>
</span><span id="ValidatorModelABC-214"><a href="#ValidatorModelABC-214"><span class="linenos">214</span></a>
</span><span id="ValidatorModelABC-215"><a href="#ValidatorModelABC-215"><span class="linenos">215</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-216"><a href="#ValidatorModelABC-216"><span class="linenos">216</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-217"><a href="#ValidatorModelABC-217"><span class="linenos">217</span></a><span class="sd">        column : str</span>
</span><span id="ValidatorModelABC-218"><a href="#ValidatorModelABC-218"><span class="linenos">218</span></a><span class="sd">            Name of the column to validate for text length.</span>
</span><span id="ValidatorModelABC-219"><a href="#ValidatorModelABC-219"><span class="linenos">219</span></a><span class="sd">        max_len : int</span>
</span><span id="ValidatorModelABC-220"><a href="#ValidatorModelABC-220"><span class="linenos">220</span></a><span class="sd">            Maximum allowed length for text values in the column.</span>
</span><span id="ValidatorModelABC-221"><a href="#ValidatorModelABC-221"><span class="linenos">221</span></a>
</span><span id="ValidatorModelABC-222"><a href="#ValidatorModelABC-222"><span class="linenos">222</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC-223"><a href="#ValidatorModelABC-223"><span class="linenos">223</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC-224"><a href="#ValidatorModelABC-224"><span class="linenos">224</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="ValidatorModelABC-225"><a href="#ValidatorModelABC-225"><span class="linenos">225</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorModelABC-226"><a href="#ValidatorModelABC-226"><span class="linenos">226</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="ValidatorModelABC-227"><a href="#ValidatorModelABC-227"><span class="linenos">227</span></a><span class="sd">                - List[str]: List of warning messages for text exceeding max_len</span>
</span><span id="ValidatorModelABC-228"><a href="#ValidatorModelABC-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-229"><a href="#ValidatorModelABC-229"><span class="linenos">229</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorModelABC-230"><a href="#ValidatorModelABC-230"><span class="linenos">230</span></a>        <span class="n">__</span><span class="p">,</span> <span class="n">warnings_text_length</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">check_dataframe_text_length</span><span class="p">(</span>
</span><span id="ValidatorModelABC-231"><a href="#ValidatorModelABC-231"><span class="linenos">231</span></a>            <span class="n">dataframe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="ValidatorModelABC-232"><a href="#ValidatorModelABC-232"><span class="linenos">232</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="ValidatorModelABC-233"><a href="#ValidatorModelABC-233"><span class="linenos">233</span></a>            <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
</span><span id="ValidatorModelABC-234"><a href="#ValidatorModelABC-234"><span class="linenos">234</span></a>            <span class="n">max_length</span><span class="o">=</span><span class="n">max_len</span><span class="p">,</span>
</span><span id="ValidatorModelABC-235"><a href="#ValidatorModelABC-235"><span class="linenos">235</span></a>        <span class="p">)</span>
</span><span id="ValidatorModelABC-236"><a href="#ValidatorModelABC-236"><span class="linenos">236</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">warnings_text_length</span><span class="p">)</span>
</span><span id="ValidatorModelABC-237"><a href="#ValidatorModelABC-237"><span class="linenos">237</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span><span id="ValidatorModelABC-238"><a href="#ValidatorModelABC-238"><span class="linenos">238</span></a>
</span><span id="ValidatorModelABC-239"><a href="#ValidatorModelABC-239"><span class="linenos">239</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_not_executed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC-240"><a href="#ValidatorModelABC-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-241"><a href="#ValidatorModelABC-241"><span class="linenos">241</span></a><span class="sd">        Mark validations as not executed in the report list.</span>
</span><span id="ValidatorModelABC-242"><a href="#ValidatorModelABC-242"><span class="linenos">242</span></a>
</span><span id="ValidatorModelABC-243"><a href="#ValidatorModelABC-243"><span class="linenos">243</span></a><span class="sd">        This is a placeholder method for a future feature that will allow marking</span>
</span><span id="ValidatorModelABC-244"><a href="#ValidatorModelABC-244"><span class="linenos">244</span></a><span class="sd">        certain validations as intentionally skipped or not executed.</span>
</span><span id="ValidatorModelABC-245"><a href="#ValidatorModelABC-245"><span class="linenos">245</span></a>
</span><span id="ValidatorModelABC-246"><a href="#ValidatorModelABC-246"><span class="linenos">246</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-247"><a href="#ValidatorModelABC-247"><span class="linenos">247</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-248"><a href="#ValidatorModelABC-248"><span class="linenos">248</span></a><span class="sd">        validations : List[Tuple[Callable, str]]</span>
</span><span id="ValidatorModelABC-249"><a href="#ValidatorModelABC-249"><span class="linenos">249</span></a><span class="sd">            List of validation tuples containing (validation_function, report_key).</span>
</span><span id="ValidatorModelABC-250"><a href="#ValidatorModelABC-250"><span class="linenos">250</span></a>
</span><span id="ValidatorModelABC-251"><a href="#ValidatorModelABC-251"><span class="linenos">251</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorModelABC-252"><a href="#ValidatorModelABC-252"><span class="linenos">252</span></a><span class="sd">        -----</span>
</span><span id="ValidatorModelABC-253"><a href="#ValidatorModelABC-253"><span class="linenos">253</span></a><span class="sd">        This method is currently not implemented and serves as a placeholder for</span>
</span><span id="ValidatorModelABC-254"><a href="#ValidatorModelABC-254"><span class="linenos">254</span></a><span class="sd">        future functionality.</span>
</span><span id="ValidatorModelABC-255"><a href="#ValidatorModelABC-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-256"><a href="#ValidatorModelABC-256"><span class="linenos">256</span></a>        <span class="k">pass</span>
</span><span id="ValidatorModelABC-257"><a href="#ValidatorModelABC-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-258"><a href="#ValidatorModelABC-258"><span class="linenos">258</span></a><span class="sd">        # FUTURE FEATURE: Implement a method to mark validations as not executed in the report list.</span>
</span><span id="ValidatorModelABC-259"><a href="#ValidatorModelABC-259"><span class="linenos">259</span></a><span class="sd">        for _, report_key in validations:</span>
</span><span id="ValidatorModelABC-260"><a href="#ValidatorModelABC-260"><span class="linenos">260</span></a><span class="sd">            self._report_list.set_not_executed(self.TITLES_INFO[report_key])</span>
</span><span id="ValidatorModelABC-261"><a href="#ValidatorModelABC-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-262"><a href="#ValidatorModelABC-262"><span class="linenos">262</span></a>
</span><span id="ValidatorModelABC-263"><a href="#ValidatorModelABC-263"><span class="linenos">263</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_reports</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC-264"><a href="#ValidatorModelABC-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-265"><a href="#ValidatorModelABC-265"><span class="linenos">265</span></a><span class="sd">        Execute validations and build reports from results.</span>
</span><span id="ValidatorModelABC-266"><a href="#ValidatorModelABC-266"><span class="linenos">266</span></a>
</span><span id="ValidatorModelABC-267"><a href="#ValidatorModelABC-267"><span class="linenos">267</span></a><span class="sd">        Orchestrates the execution of multiple validation functions, collecting their</span>
</span><span id="ValidatorModelABC-268"><a href="#ValidatorModelABC-268"><span class="linenos">268</span></a><span class="sd">        errors and warnings, and aggregating them into structured reports. If any</span>
</span><span id="ValidatorModelABC-269"><a href="#ValidatorModelABC-269"><span class="linenos">269</span></a><span class="sd">        validation raises an exception, it is caught and reported as an error.</span>
</span><span id="ValidatorModelABC-270"><a href="#ValidatorModelABC-270"><span class="linenos">270</span></a>
</span><span id="ValidatorModelABC-271"><a href="#ValidatorModelABC-271"><span class="linenos">271</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC-272"><a href="#ValidatorModelABC-272"><span class="linenos">272</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC-273"><a href="#ValidatorModelABC-273"><span class="linenos">273</span></a><span class="sd">        validations : List[Tuple[Callable, str]]</span>
</span><span id="ValidatorModelABC-274"><a href="#ValidatorModelABC-274"><span class="linenos">274</span></a><span class="sd">            List of tuples containing (validation_function, report_key). Each validation</span>
</span><span id="ValidatorModelABC-275"><a href="#ValidatorModelABC-275"><span class="linenos">275</span></a><span class="sd">            function should return Tuple[List[str], List[str]] representing (errors, warnings).</span>
</span><span id="ValidatorModelABC-276"><a href="#ValidatorModelABC-276"><span class="linenos">276</span></a>
</span><span id="ValidatorModelABC-277"><a href="#ValidatorModelABC-277"><span class="linenos">277</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorModelABC-278"><a href="#ValidatorModelABC-278"><span class="linenos">278</span></a><span class="sd">        -----</span>
</span><span id="ValidatorModelABC-279"><a href="#ValidatorModelABC-279"><span class="linenos">279</span></a><span class="sd">        - Each validation function is executed sequentially</span>
</span><span id="ValidatorModelABC-280"><a href="#ValidatorModelABC-280"><span class="linenos">280</span></a><span class="sd">        - Exceptions during validation are caught and reported as errors</span>
</span><span id="ValidatorModelABC-281"><a href="#ValidatorModelABC-281"><span class="linenos">281</span></a><span class="sd">        - Results are extended to both the report list and internal error/warning lists</span>
</span><span id="ValidatorModelABC-282"><a href="#ValidatorModelABC-282"><span class="linenos">282</span></a><span class="sd">        - Report keys are used to categorize validation results by type</span>
</span><span id="ValidatorModelABC-283"><a href="#ValidatorModelABC-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-284"><a href="#ValidatorModelABC-284"><span class="linenos">284</span></a>        <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">report_key</span> <span class="ow">in</span> <span class="n">validations</span><span class="p">:</span>
</span><span id="ValidatorModelABC-285"><a href="#ValidatorModelABC-285"><span class="linenos">285</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="ValidatorModelABC-286"><a href="#ValidatorModelABC-286"><span class="linenos">286</span></a>                <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span>
</span><span id="ValidatorModelABC-287"><a href="#ValidatorModelABC-287"><span class="linenos">287</span></a>                <span class="k">if</span> <span class="n">errors</span> <span class="ow">or</span> <span class="n">warnings</span><span class="p">:</span>
</span><span id="ValidatorModelABC-288"><a href="#ValidatorModelABC-288"><span class="linenos">288</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_report_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TITLES_INFO</span><span class="p">[</span><span class="n">report_key</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span><span class="o">=</span><span class="n">warnings</span><span class="p">)</span>
</span><span id="ValidatorModelABC-289"><a href="#ValidatorModelABC-289"><span class="linenos">289</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
</span><span id="ValidatorModelABC-290"><a href="#ValidatorModelABC-290"><span class="linenos">290</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">warnings</span><span class="p">)</span>
</span><span id="ValidatorModelABC-291"><a href="#ValidatorModelABC-291"><span class="linenos">291</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="ValidatorModelABC-292"><a href="#ValidatorModelABC-292"><span class="linenos">292</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_report_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="ValidatorModelABC-293"><a href="#ValidatorModelABC-293"><span class="linenos">293</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">TITLES_INFO</span><span class="p">[</span><span class="n">report_key</span><span class="p">],</span>
</span><span id="ValidatorModelABC-294"><a href="#ValidatorModelABC-294"><span class="linenos">294</span></a>                    <span class="n">errors</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Exception validation in file during </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
</span><span id="ValidatorModelABC-295"><a href="#ValidatorModelABC-295"><span class="linenos">295</span></a>                    <span class="n">warnings</span><span class="o">=</span><span class="p">[],</span>
</span><span id="ValidatorModelABC-296"><a href="#ValidatorModelABC-296"><span class="linenos">296</span></a>                <span class="p">)</span>
</span><span id="ValidatorModelABC-297"><a href="#ValidatorModelABC-297"><span class="linenos">297</span></a>
</span><span id="ValidatorModelABC-298"><a href="#ValidatorModelABC-298"><span class="linenos">298</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="ValidatorModelABC-299"><a href="#ValidatorModelABC-299"><span class="linenos">299</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorModelABC-300"><a href="#ValidatorModelABC-300"><span class="linenos">300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-301"><a href="#ValidatorModelABC-301"><span class="linenos">301</span></a><span class="sd">        Execute all validations for the specific model type.</span>
</span><span id="ValidatorModelABC-302"><a href="#ValidatorModelABC-302"><span class="linenos">302</span></a>
</span><span id="ValidatorModelABC-303"><a href="#ValidatorModelABC-303"><span class="linenos">303</span></a><span class="sd">        This abstract method must be implemented by all concrete validator subclasses</span>
</span><span id="ValidatorModelABC-304"><a href="#ValidatorModelABC-304"><span class="linenos">304</span></a><span class="sd">        to define their specific validation pipeline. It should orchestrate the execution</span>
</span><span id="ValidatorModelABC-305"><a href="#ValidatorModelABC-305"><span class="linenos">305</span></a><span class="sd">        of all validation checks appropriate for the model being validated.</span>
</span><span id="ValidatorModelABC-306"><a href="#ValidatorModelABC-306"><span class="linenos">306</span></a>
</span><span id="ValidatorModelABC-307"><a href="#ValidatorModelABC-307"><span class="linenos">307</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC-308"><a href="#ValidatorModelABC-308"><span class="linenos">308</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC-309"><a href="#ValidatorModelABC-309"><span class="linenos">309</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="ValidatorModelABC-310"><a href="#ValidatorModelABC-310"><span class="linenos">310</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorModelABC-311"><a href="#ValidatorModelABC-311"><span class="linenos">311</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="ValidatorModelABC-312"><a href="#ValidatorModelABC-312"><span class="linenos">312</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="ValidatorModelABC-313"><a href="#ValidatorModelABC-313"><span class="linenos">313</span></a>
</span><span id="ValidatorModelABC-314"><a href="#ValidatorModelABC-314"><span class="linenos">314</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorModelABC-315"><a href="#ValidatorModelABC-315"><span class="linenos">315</span></a><span class="sd">        -----</span>
</span><span id="ValidatorModelABC-316"><a href="#ValidatorModelABC-316"><span class="linenos">316</span></a><span class="sd">        Implementations should call `build_reports()` with their validation functions</span>
</span><span id="ValidatorModelABC-317"><a href="#ValidatorModelABC-317"><span class="linenos">317</span></a><span class="sd">        and return the accumulated errors and warnings.</span>
</span><span id="ValidatorModelABC-318"><a href="#ValidatorModelABC-318"><span class="linenos">318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-319"><a href="#ValidatorModelABC-319"><span class="linenos">319</span></a>        <span class="k">pass</span>
</span><span id="ValidatorModelABC-320"><a href="#ValidatorModelABC-320"><span class="linenos">320</span></a>
</span><span id="ValidatorModelABC-321"><a href="#ValidatorModelABC-321"><span class="linenos">321</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="ValidatorModelABC-322"><a href="#ValidatorModelABC-322"><span class="linenos">322</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC-323"><a href="#ValidatorModelABC-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-324"><a href="#ValidatorModelABC-324"><span class="linenos">324</span></a><span class="sd">        Prepare initial validation statements and setup.</span>
</span><span id="ValidatorModelABC-325"><a href="#ValidatorModelABC-325"><span class="linenos">325</span></a>
</span><span id="ValidatorModelABC-326"><a href="#ValidatorModelABC-326"><span class="linenos">326</span></a><span class="sd">        This abstract method must be implemented by concrete validator subclasses to</span>
</span><span id="ValidatorModelABC-327"><a href="#ValidatorModelABC-327"><span class="linenos">327</span></a><span class="sd">        perform any necessary initialization or preparation before running validations.</span>
</span><span id="ValidatorModelABC-328"><a href="#ValidatorModelABC-328"><span class="linenos">328</span></a><span class="sd">        This may include loading additional data, preparing validation contexts, or</span>
</span><span id="ValidatorModelABC-329"><a href="#ValidatorModelABC-329"><span class="linenos">329</span></a><span class="sd">        setting up internal state.</span>
</span><span id="ValidatorModelABC-330"><a href="#ValidatorModelABC-330"><span class="linenos">330</span></a>
</span><span id="ValidatorModelABC-331"><a href="#ValidatorModelABC-331"><span class="linenos">331</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorModelABC-332"><a href="#ValidatorModelABC-332"><span class="linenos">332</span></a><span class="sd">        -----</span>
</span><span id="ValidatorModelABC-333"><a href="#ValidatorModelABC-333"><span class="linenos">333</span></a><span class="sd">        This method is typically called during validator initialization or before</span>
</span><span id="ValidatorModelABC-334"><a href="#ValidatorModelABC-334"><span class="linenos">334</span></a><span class="sd">        the validation pipeline begins execution.</span>
</span><span id="ValidatorModelABC-335"><a href="#ValidatorModelABC-335"><span class="linenos">335</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC-336"><a href="#ValidatorModelABC-336"><span class="linenos">336</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Abstract base class for all spreadsheet model validators.</p>

<p>This class provides the foundation for all specific validators (e.g., Description,
Value, Legend validators). It handles common validation tasks such as column existence
checks, text length validation, and report generation.</p>

<h2 id="attributes">Attributes</h2>

<p>_data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
_report_list : ModelListReport
    Aggregator for collecting and organizing validation results.
_type_class : Type[SpModelABC]
    The model class type this validator is responsible for validating.
_data_model : SpModelABC
    The specific model instance being validated.
_filename : str
    Name of the file being validated.
_dataframe : pd.DataFrame
    DataFrame containing the data to validate.
TITLES_INFO : Dict[str, str]
    Mapping of validation types to human-readable titles.
_errors : List[str]
    Accumulated list of validation errors.
_warnings : List[str]
    Accumulated list of validation warnings.</p>
</div>


                            <div id="ValidatorModelABC.__init__" class="classattr">
                                        <input id="ValidatorModelABC.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ValidatorModelABC</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="n">type_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n"><a href="models.html#SpModelABC">data_validate.models.SpModelABC</a></span><span class="p">]</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="ValidatorModelABC.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC.__init__-52"><a href="#ValidatorModelABC.__init__-52"><span class="linenos">52</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ValidatorModelABC.__init__-53"><a href="#ValidatorModelABC.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ValidatorModelABC.__init__-54"><a href="#ValidatorModelABC.__init__-54"><span class="linenos">54</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="ValidatorModelABC.__init__-55"><a href="#ValidatorModelABC.__init__-55"><span class="linenos">55</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="ValidatorModelABC.__init__-56"><a href="#ValidatorModelABC.__init__-56"><span class="linenos">56</span></a>        <span class="n">type_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">SpModelABC</span><span class="p">],</span>
</span><span id="ValidatorModelABC.__init__-57"><a href="#ValidatorModelABC.__init__-57"><span class="linenos">57</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="ValidatorModelABC.__init__-58"><a href="#ValidatorModelABC.__init__-58"><span class="linenos">58</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC.__init__-59"><a href="#ValidatorModelABC.__init__-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.__init__-60"><a href="#ValidatorModelABC.__init__-60"><span class="linenos">60</span></a><span class="sd">        Initialize the validator with context, report aggregator, and model class.</span>
</span><span id="ValidatorModelABC.__init__-61"><a href="#ValidatorModelABC.__init__-61"><span class="linenos">61</span></a>
</span><span id="ValidatorModelABC.__init__-62"><a href="#ValidatorModelABC.__init__-62"><span class="linenos">62</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC.__init__-63"><a href="#ValidatorModelABC.__init__-63"><span class="linenos">63</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC.__init__-64"><a href="#ValidatorModelABC.__init__-64"><span class="linenos">64</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="ValidatorModelABC.__init__-65"><a href="#ValidatorModelABC.__init__-65"><span class="linenos">65</span></a><span class="sd">            Context containing all loaded spreadsheet models, configuration, and utilities.</span>
</span><span id="ValidatorModelABC.__init__-66"><a href="#ValidatorModelABC.__init__-66"><span class="linenos">66</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="ValidatorModelABC.__init__-67"><a href="#ValidatorModelABC.__init__-67"><span class="linenos">67</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="ValidatorModelABC.__init__-68"><a href="#ValidatorModelABC.__init__-68"><span class="linenos">68</span></a><span class="sd">        type_class : Type[SpModelABC]</span>
</span><span id="ValidatorModelABC.__init__-69"><a href="#ValidatorModelABC.__init__-69"><span class="linenos">69</span></a><span class="sd">            The specific model class type this validator will validate.</span>
</span><span id="ValidatorModelABC.__init__-70"><a href="#ValidatorModelABC.__init__-70"><span class="linenos">70</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="ValidatorModelABC.__init__-71"><a href="#ValidatorModelABC.__init__-71"><span class="linenos">71</span></a><span class="sd">            Additional keyword arguments for future extensibility.</span>
</span><span id="ValidatorModelABC.__init__-72"><a href="#ValidatorModelABC.__init__-72"><span class="linenos">72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.__init__-73"><a href="#ValidatorModelABC.__init__-73"><span class="linenos">73</span></a>        <span class="c1"># SETUP</span>
</span><span id="ValidatorModelABC.__init__-74"><a href="#ValidatorModelABC.__init__-74"><span class="linenos">74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span> <span class="o">=</span> <span class="n">data_models_context</span>
</span><span id="ValidatorModelABC.__init__-75"><a href="#ValidatorModelABC.__init__-75"><span class="linenos">75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_report_list</span> <span class="o">=</span> <span class="n">report_list</span>
</span><span id="ValidatorModelABC.__init__-76"><a href="#ValidatorModelABC.__init__-76"><span class="linenos">76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type_class</span> <span class="o">=</span> <span class="n">type_class</span>
</span><span id="ValidatorModelABC.__init__-77"><a href="#ValidatorModelABC.__init__-77"><span class="linenos">77</span></a>
</span><span id="ValidatorModelABC.__init__-78"><a href="#ValidatorModelABC.__init__-78"><span class="linenos">78</span></a>        <span class="c1"># UNPACK DATA</span>
</span><span id="ValidatorModelABC.__init__-79"><a href="#ValidatorModelABC.__init__-79"><span class="linenos">79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_class</span><span class="p">)</span>
</span><span id="ValidatorModelABC.__init__-80"><a href="#ValidatorModelABC.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">filename</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="k">else</span> <span class="s2">&quot;Unknown&quot;</span>
</span><span id="ValidatorModelABC.__init__-81"><a href="#ValidatorModelABC.__init__-81"><span class="linenos">81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({})</span>
</span><span id="ValidatorModelABC.__init__-82"><a href="#ValidatorModelABC.__init__-82"><span class="linenos">82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TITLES_INFO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_verify_names</span><span class="p">()</span>
</span><span id="ValidatorModelABC.__init__-83"><a href="#ValidatorModelABC.__init__-83"><span class="linenos">83</span></a>
</span><span id="ValidatorModelABC.__init__-84"><a href="#ValidatorModelABC.__init__-84"><span class="linenos">84</span></a>        <span class="c1"># LIST OF ERRORS AND WARNINGS</span>
</span><span id="ValidatorModelABC.__init__-85"><a href="#ValidatorModelABC.__init__-85"><span class="linenos">85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorModelABC.__init__-86"><a href="#ValidatorModelABC.__init__-86"><span class="linenos">86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorModelABC.__init__-87"><a href="#ValidatorModelABC.__init__-87"><span class="linenos">87</span></a>
</span><span id="ValidatorModelABC.__init__-88"><a href="#ValidatorModelABC.__init__-88"><span class="linenos">88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the validator with context, report aggregator, and model class.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models, configuration, and utilities.
report_list : ModelListReport
    Report aggregator for collecting validation results.
type_class : Type[SpModelABC]
    The specific model class type this validator will validate.
**kwargs : Dict[str, Any]
    Additional keyword arguments for future extensibility.</p>
</div>


                            </div>
                            <div id="ValidatorModelABC.TITLES_INFO" class="classattr">
                                <div class="attr variable">
            <span class="name">TITLES_INFO</span>

        
    </div>
    <a class="headerlink" href="#ValidatorModelABC.TITLES_INFO"></a>
    
    

                            </div>
                            <div id="ValidatorModelABC.initialize" class="classattr">
                                        <input id="ValidatorModelABC.initialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">initialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ValidatorModelABC.initialize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC.initialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC.initialize-90"><a href="#ValidatorModelABC.initialize-90"><span class="linenos">90</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC.initialize-91"><a href="#ValidatorModelABC.initialize-91"><span class="linenos">91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.initialize-92"><a href="#ValidatorModelABC.initialize-92"><span class="linenos">92</span></a><span class="sd">        Initialize additional validator-specific setup.</span>
</span><span id="ValidatorModelABC.initialize-93"><a href="#ValidatorModelABC.initialize-93"><span class="linenos">93</span></a>
</span><span id="ValidatorModelABC.initialize-94"><a href="#ValidatorModelABC.initialize-94"><span class="linenos">94</span></a><span class="sd">        This method is called after __init__ and can be overridden by subclasses</span>
</span><span id="ValidatorModelABC.initialize-95"><a href="#ValidatorModelABC.initialize-95"><span class="linenos">95</span></a><span class="sd">        to perform custom initialization logic. The default implementation does nothing.</span>
</span><span id="ValidatorModelABC.initialize-96"><a href="#ValidatorModelABC.initialize-96"><span class="linenos">96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.initialize-97"><a href="#ValidatorModelABC.initialize-97"><span class="linenos">97</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Initialize additional validator-specific setup.</p>

<p>This method is called after __init__ and can be overridden by subclasses
to perform custom initialization logic. The default implementation does nothing.</p>
</div>


                            </div>
                            <div id="ValidatorModelABC.check_columns_in_models_dataframes" class="classattr">
                                        <input id="ValidatorModelABC.check_columns_in_models_dataframes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_columns_in_models_dataframes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">required_columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">model_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ValidatorModelABC.check_columns_in_models_dataframes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC.check_columns_in_models_dataframes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC.check_columns_in_models_dataframes-99"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-99"><span class="linenos"> 99</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-100"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-101"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-101"><span class="linenos">101</span></a>        <span class="n">required_columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-102"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-102"><span class="linenos">102</span></a>        <span class="n">model_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-103"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-103"><span class="linenos">103</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-104"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-105"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-105"><span class="linenos">105</span></a><span class="sd">        Check if required columns exist in the provided dataframes for different models.</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-106"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-106"><span class="linenos">106</span></a>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-107"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-107"><span class="linenos">107</span></a><span class="sd">        Validates that all specified columns exist in their corresponding model dataframes.</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-108"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-108"><span class="linenos">108</span></a><span class="sd">        This is useful for cross-model validations where multiple spreadsheet models need</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-109"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-109"><span class="linenos">109</span></a><span class="sd">        to be checked for column presence.</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-110"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-110"><span class="linenos">110</span></a>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-111"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-111"><span class="linenos">111</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-112"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-112"><span class="linenos">112</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-113"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-113"><span class="linenos">113</span></a><span class="sd">        required_columns : Dict[str, List[str]]</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-114"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-114"><span class="linenos">114</span></a><span class="sd">            Dictionary where keys are model names and values are lists of required column names.</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-115"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-115"><span class="linenos">115</span></a><span class="sd">        model_dataframes : Dict[str, pd.DataFrame]</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-116"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-116"><span class="linenos">116</span></a><span class="sd">            Dictionary where keys are model names and values are their corresponding DataFrames.</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-117"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-117"><span class="linenos">117</span></a>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-118"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-118"><span class="linenos">118</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-119"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-119"><span class="linenos">119</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-120"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-120"><span class="linenos">120</span></a><span class="sd">        List[str]</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-121"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-121"><span class="linenos">121</span></a><span class="sd">            List of error messages for missing columns. Empty list if all columns exist.</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-122"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-123"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-123"><span class="linenos">123</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-124"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-124"><span class="linenos">124</span></a>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-125"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-125"><span class="linenos">125</span></a>        <span class="c1"># Check if columns exist</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-126"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-126"><span class="linenos">126</span></a>        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">required_columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-127"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-127"><span class="linenos">127</span></a>            <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">model_dataframes</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-128"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-128"><span class="linenos">128</span></a>            <span class="k">if</span> <span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-129"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-129"><span class="linenos">129</span></a>                <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-130"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-130"><span class="linenos">130</span></a>                    <span class="n">exists_column</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-131"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-131"><span class="linenos">131</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-132"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-132"><span class="linenos">132</span></a>                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-133"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-133"><span class="linenos">133</span></a>
</span><span id="ValidatorModelABC.check_columns_in_models_dataframes-134"><a href="#ValidatorModelABC.check_columns_in_models_dataframes-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="n">errors</span>
</span></pre></div>


            <div class="docstring"><p>Check if required columns exist in the provided dataframes for different models.</p>

<p>Validates that all specified columns exist in their corresponding model dataframes.
This is useful for cross-model validations where multiple spreadsheet models need
to be checked for column presence.</p>

<h2 id="args">Args</h2>

<p>required_columns : Dict[str, List[str]]
    Dictionary where keys are model names and values are lists of required column names.
model_dataframes : Dict[str, pd.DataFrame]
    Dictionary where keys are model names and values are their corresponding DataFrames.</p>

<h2 id="returns">Returns</h2>

<p>List[str]
    List of error messages for missing columns. Empty list if all columns exist.</p>
</div>


                            </div>
                            <div id="ValidatorModelABC.column_exists" class="classattr">
                                        <input id="ValidatorModelABC.column_exists-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">column_exists</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dataframe</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">column</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ValidatorModelABC.column_exists-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC.column_exists"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC.column_exists-136"><a href="#ValidatorModelABC.column_exists-136"><span class="linenos">136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">column_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="ValidatorModelABC.column_exists-137"><a href="#ValidatorModelABC.column_exists-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.column_exists-138"><a href="#ValidatorModelABC.column_exists-138"><span class="linenos">138</span></a><span class="sd">        Check if a column exists in a given DataFrame.</span>
</span><span id="ValidatorModelABC.column_exists-139"><a href="#ValidatorModelABC.column_exists-139"><span class="linenos">139</span></a>
</span><span id="ValidatorModelABC.column_exists-140"><a href="#ValidatorModelABC.column_exists-140"><span class="linenos">140</span></a><span class="sd">        This is a convenience wrapper around DataFrameProcessing.column_exists that can be</span>
</span><span id="ValidatorModelABC.column_exists-141"><a href="#ValidatorModelABC.column_exists-141"><span class="linenos">141</span></a><span class="sd">        used to validate column presence in any DataFrame-filename pair.</span>
</span><span id="ValidatorModelABC.column_exists-142"><a href="#ValidatorModelABC.column_exists-142"><span class="linenos">142</span></a>
</span><span id="ValidatorModelABC.column_exists-143"><a href="#ValidatorModelABC.column_exists-143"><span class="linenos">143</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC.column_exists-144"><a href="#ValidatorModelABC.column_exists-144"><span class="linenos">144</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC.column_exists-145"><a href="#ValidatorModelABC.column_exists-145"><span class="linenos">145</span></a><span class="sd">        dataframe : pd.DataFrame</span>
</span><span id="ValidatorModelABC.column_exists-146"><a href="#ValidatorModelABC.column_exists-146"><span class="linenos">146</span></a><span class="sd">            The DataFrame to check for column existence.</span>
</span><span id="ValidatorModelABC.column_exists-147"><a href="#ValidatorModelABC.column_exists-147"><span class="linenos">147</span></a><span class="sd">        filename : str</span>
</span><span id="ValidatorModelABC.column_exists-148"><a href="#ValidatorModelABC.column_exists-148"><span class="linenos">148</span></a><span class="sd">            Name of the file for error message generation.</span>
</span><span id="ValidatorModelABC.column_exists-149"><a href="#ValidatorModelABC.column_exists-149"><span class="linenos">149</span></a><span class="sd">        column : str</span>
</span><span id="ValidatorModelABC.column_exists-150"><a href="#ValidatorModelABC.column_exists-150"><span class="linenos">150</span></a><span class="sd">            Name of the column to check for.</span>
</span><span id="ValidatorModelABC.column_exists-151"><a href="#ValidatorModelABC.column_exists-151"><span class="linenos">151</span></a>
</span><span id="ValidatorModelABC.column_exists-152"><a href="#ValidatorModelABC.column_exists-152"><span class="linenos">152</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC.column_exists-153"><a href="#ValidatorModelABC.column_exists-153"><span class="linenos">153</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC.column_exists-154"><a href="#ValidatorModelABC.column_exists-154"><span class="linenos">154</span></a><span class="sd">        Tuple[bool, str]</span>
</span><span id="ValidatorModelABC.column_exists-155"><a href="#ValidatorModelABC.column_exists-155"><span class="linenos">155</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorModelABC.column_exists-156"><a href="#ValidatorModelABC.column_exists-156"><span class="linenos">156</span></a><span class="sd">                - bool: True if column exists, False otherwise</span>
</span><span id="ValidatorModelABC.column_exists-157"><a href="#ValidatorModelABC.column_exists-157"><span class="linenos">157</span></a><span class="sd">                - str: Error message if column doesn&#39;t exist, empty string otherwise</span>
</span><span id="ValidatorModelABC.column_exists-158"><a href="#ValidatorModelABC.column_exists-158"><span class="linenos">158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.column_exists-159"><a href="#ValidatorModelABC.column_exists-159"><span class="linenos">159</span></a>        <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span><span id="ValidatorModelABC.column_exists-160"><a href="#ValidatorModelABC.column_exists-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">exists</span><span class="p">,</span> <span class="n">msg_error_column</span>
</span></pre></div>


            <div class="docstring"><p>Check if a column exists in a given DataFrame.</p>

<p>This is a convenience wrapper around DataFrameProcessing.column_exists that can be
used to validate column presence in any DataFrame-filename pair.</p>

<h2 id="args">Args</h2>

<p>dataframe : pd.DataFrame
    The DataFrame to check for column existence.
filename : str
    Name of the file for error message generation.
column : str
    Name of the column to check for.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[bool, str]
    A tuple containing:
        - bool: True if column exists, False otherwise
        - str: Error message if column doesn't exist, empty string otherwise</p>
</div>


                            </div>
                            <div id="ValidatorModelABC.set_not_executed" class="classattr">
                                        <input id="ValidatorModelABC.set_not_executed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_not_executed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">validations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ValidatorModelABC.set_not_executed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC.set_not_executed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC.set_not_executed-239"><a href="#ValidatorModelABC.set_not_executed-239"><span class="linenos">239</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_not_executed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC.set_not_executed-240"><a href="#ValidatorModelABC.set_not_executed-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.set_not_executed-241"><a href="#ValidatorModelABC.set_not_executed-241"><span class="linenos">241</span></a><span class="sd">        Mark validations as not executed in the report list.</span>
</span><span id="ValidatorModelABC.set_not_executed-242"><a href="#ValidatorModelABC.set_not_executed-242"><span class="linenos">242</span></a>
</span><span id="ValidatorModelABC.set_not_executed-243"><a href="#ValidatorModelABC.set_not_executed-243"><span class="linenos">243</span></a><span class="sd">        This is a placeholder method for a future feature that will allow marking</span>
</span><span id="ValidatorModelABC.set_not_executed-244"><a href="#ValidatorModelABC.set_not_executed-244"><span class="linenos">244</span></a><span class="sd">        certain validations as intentionally skipped or not executed.</span>
</span><span id="ValidatorModelABC.set_not_executed-245"><a href="#ValidatorModelABC.set_not_executed-245"><span class="linenos">245</span></a>
</span><span id="ValidatorModelABC.set_not_executed-246"><a href="#ValidatorModelABC.set_not_executed-246"><span class="linenos">246</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC.set_not_executed-247"><a href="#ValidatorModelABC.set_not_executed-247"><span class="linenos">247</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC.set_not_executed-248"><a href="#ValidatorModelABC.set_not_executed-248"><span class="linenos">248</span></a><span class="sd">        validations : List[Tuple[Callable, str]]</span>
</span><span id="ValidatorModelABC.set_not_executed-249"><a href="#ValidatorModelABC.set_not_executed-249"><span class="linenos">249</span></a><span class="sd">            List of validation tuples containing (validation_function, report_key).</span>
</span><span id="ValidatorModelABC.set_not_executed-250"><a href="#ValidatorModelABC.set_not_executed-250"><span class="linenos">250</span></a>
</span><span id="ValidatorModelABC.set_not_executed-251"><a href="#ValidatorModelABC.set_not_executed-251"><span class="linenos">251</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorModelABC.set_not_executed-252"><a href="#ValidatorModelABC.set_not_executed-252"><span class="linenos">252</span></a><span class="sd">        -----</span>
</span><span id="ValidatorModelABC.set_not_executed-253"><a href="#ValidatorModelABC.set_not_executed-253"><span class="linenos">253</span></a><span class="sd">        This method is currently not implemented and serves as a placeholder for</span>
</span><span id="ValidatorModelABC.set_not_executed-254"><a href="#ValidatorModelABC.set_not_executed-254"><span class="linenos">254</span></a><span class="sd">        future functionality.</span>
</span><span id="ValidatorModelABC.set_not_executed-255"><a href="#ValidatorModelABC.set_not_executed-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.set_not_executed-256"><a href="#ValidatorModelABC.set_not_executed-256"><span class="linenos">256</span></a>        <span class="k">pass</span>
</span><span id="ValidatorModelABC.set_not_executed-257"><a href="#ValidatorModelABC.set_not_executed-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.set_not_executed-258"><a href="#ValidatorModelABC.set_not_executed-258"><span class="linenos">258</span></a><span class="sd">        # FUTURE FEATURE: Implement a method to mark validations as not executed in the report list.</span>
</span><span id="ValidatorModelABC.set_not_executed-259"><a href="#ValidatorModelABC.set_not_executed-259"><span class="linenos">259</span></a><span class="sd">        for _, report_key in validations:</span>
</span><span id="ValidatorModelABC.set_not_executed-260"><a href="#ValidatorModelABC.set_not_executed-260"><span class="linenos">260</span></a><span class="sd">            self._report_list.set_not_executed(self.TITLES_INFO[report_key])</span>
</span><span id="ValidatorModelABC.set_not_executed-261"><a href="#ValidatorModelABC.set_not_executed-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Mark validations as not executed in the report list.</p>

<p>This is a placeholder method for a future feature that will allow marking
certain validations as intentionally skipped or not executed.</p>

<h2 id="args">Args</h2>

<p>validations : List[Tuple[Callable, str]]
    List of validation tuples containing (validation_function, report_key).</p>

<h2 id="notes">Notes</h2>

<p>This method is currently not implemented and serves as a placeholder for
future functionality.</p>
</div>


                            </div>
                            <div id="ValidatorModelABC.build_reports" class="classattr">
                                        <input id="ValidatorModelABC.build_reports-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_reports</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">validations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ValidatorModelABC.build_reports-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC.build_reports"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC.build_reports-263"><a href="#ValidatorModelABC.build_reports-263"><span class="linenos">263</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_reports</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorModelABC.build_reports-264"><a href="#ValidatorModelABC.build_reports-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.build_reports-265"><a href="#ValidatorModelABC.build_reports-265"><span class="linenos">265</span></a><span class="sd">        Execute validations and build reports from results.</span>
</span><span id="ValidatorModelABC.build_reports-266"><a href="#ValidatorModelABC.build_reports-266"><span class="linenos">266</span></a>
</span><span id="ValidatorModelABC.build_reports-267"><a href="#ValidatorModelABC.build_reports-267"><span class="linenos">267</span></a><span class="sd">        Orchestrates the execution of multiple validation functions, collecting their</span>
</span><span id="ValidatorModelABC.build_reports-268"><a href="#ValidatorModelABC.build_reports-268"><span class="linenos">268</span></a><span class="sd">        errors and warnings, and aggregating them into structured reports. If any</span>
</span><span id="ValidatorModelABC.build_reports-269"><a href="#ValidatorModelABC.build_reports-269"><span class="linenos">269</span></a><span class="sd">        validation raises an exception, it is caught and reported as an error.</span>
</span><span id="ValidatorModelABC.build_reports-270"><a href="#ValidatorModelABC.build_reports-270"><span class="linenos">270</span></a>
</span><span id="ValidatorModelABC.build_reports-271"><a href="#ValidatorModelABC.build_reports-271"><span class="linenos">271</span></a><span class="sd">        Args</span>
</span><span id="ValidatorModelABC.build_reports-272"><a href="#ValidatorModelABC.build_reports-272"><span class="linenos">272</span></a><span class="sd">        ----</span>
</span><span id="ValidatorModelABC.build_reports-273"><a href="#ValidatorModelABC.build_reports-273"><span class="linenos">273</span></a><span class="sd">        validations : List[Tuple[Callable, str]]</span>
</span><span id="ValidatorModelABC.build_reports-274"><a href="#ValidatorModelABC.build_reports-274"><span class="linenos">274</span></a><span class="sd">            List of tuples containing (validation_function, report_key). Each validation</span>
</span><span id="ValidatorModelABC.build_reports-275"><a href="#ValidatorModelABC.build_reports-275"><span class="linenos">275</span></a><span class="sd">            function should return Tuple[List[str], List[str]] representing (errors, warnings).</span>
</span><span id="ValidatorModelABC.build_reports-276"><a href="#ValidatorModelABC.build_reports-276"><span class="linenos">276</span></a>
</span><span id="ValidatorModelABC.build_reports-277"><a href="#ValidatorModelABC.build_reports-277"><span class="linenos">277</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorModelABC.build_reports-278"><a href="#ValidatorModelABC.build_reports-278"><span class="linenos">278</span></a><span class="sd">        -----</span>
</span><span id="ValidatorModelABC.build_reports-279"><a href="#ValidatorModelABC.build_reports-279"><span class="linenos">279</span></a><span class="sd">        - Each validation function is executed sequentially</span>
</span><span id="ValidatorModelABC.build_reports-280"><a href="#ValidatorModelABC.build_reports-280"><span class="linenos">280</span></a><span class="sd">        - Exceptions during validation are caught and reported as errors</span>
</span><span id="ValidatorModelABC.build_reports-281"><a href="#ValidatorModelABC.build_reports-281"><span class="linenos">281</span></a><span class="sd">        - Results are extended to both the report list and internal error/warning lists</span>
</span><span id="ValidatorModelABC.build_reports-282"><a href="#ValidatorModelABC.build_reports-282"><span class="linenos">282</span></a><span class="sd">        - Report keys are used to categorize validation results by type</span>
</span><span id="ValidatorModelABC.build_reports-283"><a href="#ValidatorModelABC.build_reports-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.build_reports-284"><a href="#ValidatorModelABC.build_reports-284"><span class="linenos">284</span></a>        <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">report_key</span> <span class="ow">in</span> <span class="n">validations</span><span class="p">:</span>
</span><span id="ValidatorModelABC.build_reports-285"><a href="#ValidatorModelABC.build_reports-285"><span class="linenos">285</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="ValidatorModelABC.build_reports-286"><a href="#ValidatorModelABC.build_reports-286"><span class="linenos">286</span></a>                <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span>
</span><span id="ValidatorModelABC.build_reports-287"><a href="#ValidatorModelABC.build_reports-287"><span class="linenos">287</span></a>                <span class="k">if</span> <span class="n">errors</span> <span class="ow">or</span> <span class="n">warnings</span><span class="p">:</span>
</span><span id="ValidatorModelABC.build_reports-288"><a href="#ValidatorModelABC.build_reports-288"><span class="linenos">288</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_report_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TITLES_INFO</span><span class="p">[</span><span class="n">report_key</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span><span class="o">=</span><span class="n">warnings</span><span class="p">)</span>
</span><span id="ValidatorModelABC.build_reports-289"><a href="#ValidatorModelABC.build_reports-289"><span class="linenos">289</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
</span><span id="ValidatorModelABC.build_reports-290"><a href="#ValidatorModelABC.build_reports-290"><span class="linenos">290</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">warnings</span><span class="p">)</span>
</span><span id="ValidatorModelABC.build_reports-291"><a href="#ValidatorModelABC.build_reports-291"><span class="linenos">291</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="ValidatorModelABC.build_reports-292"><a href="#ValidatorModelABC.build_reports-292"><span class="linenos">292</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_report_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="ValidatorModelABC.build_reports-293"><a href="#ValidatorModelABC.build_reports-293"><span class="linenos">293</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">TITLES_INFO</span><span class="p">[</span><span class="n">report_key</span><span class="p">],</span>
</span><span id="ValidatorModelABC.build_reports-294"><a href="#ValidatorModelABC.build_reports-294"><span class="linenos">294</span></a>                    <span class="n">errors</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Exception validation in file during </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
</span><span id="ValidatorModelABC.build_reports-295"><a href="#ValidatorModelABC.build_reports-295"><span class="linenos">295</span></a>                    <span class="n">warnings</span><span class="o">=</span><span class="p">[],</span>
</span><span id="ValidatorModelABC.build_reports-296"><a href="#ValidatorModelABC.build_reports-296"><span class="linenos">296</span></a>                <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Execute validations and build reports from results.</p>

<p>Orchestrates the execution of multiple validation functions, collecting their
errors and warnings, and aggregating them into structured reports. If any
validation raises an exception, it is caught and reported as an error.</p>

<h2 id="args">Args</h2>

<p>validations : List[Tuple[Callable, str]]
    List of tuples containing (validation_function, report_key). Each validation
    function should return Tuple[List[str], List[str]] representing (errors, warnings).</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Each validation function is executed sequentially</li>
<li>Exceptions during validation are caught and reported as errors</li>
<li>Results are extended to both the report list and internal error/warning lists</li>
<li>Report keys are used to categorize validation results by type</li>
</ul>
</div>


                            </div>
                            <div id="ValidatorModelABC.run" class="classattr">
                                        <input id="ValidatorModelABC.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ValidatorModelABC.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorModelABC.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorModelABC.run-298"><a href="#ValidatorModelABC.run-298"><span class="linenos">298</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="ValidatorModelABC.run-299"><a href="#ValidatorModelABC.run-299"><span class="linenos">299</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorModelABC.run-300"><a href="#ValidatorModelABC.run-300"><span class="linenos">300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.run-301"><a href="#ValidatorModelABC.run-301"><span class="linenos">301</span></a><span class="sd">        Execute all validations for the specific model type.</span>
</span><span id="ValidatorModelABC.run-302"><a href="#ValidatorModelABC.run-302"><span class="linenos">302</span></a>
</span><span id="ValidatorModelABC.run-303"><a href="#ValidatorModelABC.run-303"><span class="linenos">303</span></a><span class="sd">        This abstract method must be implemented by all concrete validator subclasses</span>
</span><span id="ValidatorModelABC.run-304"><a href="#ValidatorModelABC.run-304"><span class="linenos">304</span></a><span class="sd">        to define their specific validation pipeline. It should orchestrate the execution</span>
</span><span id="ValidatorModelABC.run-305"><a href="#ValidatorModelABC.run-305"><span class="linenos">305</span></a><span class="sd">        of all validation checks appropriate for the model being validated.</span>
</span><span id="ValidatorModelABC.run-306"><a href="#ValidatorModelABC.run-306"><span class="linenos">306</span></a>
</span><span id="ValidatorModelABC.run-307"><a href="#ValidatorModelABC.run-307"><span class="linenos">307</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorModelABC.run-308"><a href="#ValidatorModelABC.run-308"><span class="linenos">308</span></a><span class="sd">        -------</span>
</span><span id="ValidatorModelABC.run-309"><a href="#ValidatorModelABC.run-309"><span class="linenos">309</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="ValidatorModelABC.run-310"><a href="#ValidatorModelABC.run-310"><span class="linenos">310</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorModelABC.run-311"><a href="#ValidatorModelABC.run-311"><span class="linenos">311</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="ValidatorModelABC.run-312"><a href="#ValidatorModelABC.run-312"><span class="linenos">312</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="ValidatorModelABC.run-313"><a href="#ValidatorModelABC.run-313"><span class="linenos">313</span></a>
</span><span id="ValidatorModelABC.run-314"><a href="#ValidatorModelABC.run-314"><span class="linenos">314</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorModelABC.run-315"><a href="#ValidatorModelABC.run-315"><span class="linenos">315</span></a><span class="sd">        -----</span>
</span><span id="ValidatorModelABC.run-316"><a href="#ValidatorModelABC.run-316"><span class="linenos">316</span></a><span class="sd">        Implementations should call `build_reports()` with their validation functions</span>
</span><span id="ValidatorModelABC.run-317"><a href="#ValidatorModelABC.run-317"><span class="linenos">317</span></a><span class="sd">        and return the accumulated errors and warnings.</span>
</span><span id="ValidatorModelABC.run-318"><a href="#ValidatorModelABC.run-318"><span class="linenos">318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorModelABC.run-319"><a href="#ValidatorModelABC.run-319"><span class="linenos">319</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Execute all validations for the specific model type.</p>

<p>This abstract method must be implemented by all concrete validator subclasses
to define their specific validation pipeline. It should orchestrate the execution
of all validation checks appropriate for the model being validated.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<p>Implementations should call <code><a href="#ValidatorModelABC.build_reports">build_reports()</a></code> with their validation functions
and return the accumulated errors and warnings.</p>
</div>


                            </div>
                </section>
                <section id="SpDescriptionValidator">
                            <input id="SpDescriptionValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpDescriptionValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpDescriptionValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator-28"><a href="#SpDescriptionValidator-28"><span class="linenos"> 28</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpDescriptionValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpDescriptionValidator-29"><a href="#SpDescriptionValidator-29"><span class="linenos"> 29</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-30"><a href="#SpDescriptionValidator-30"><span class="linenos"> 30</span></a><span class="sd">    Validates Description spreadsheet content and metadata.</span>
</span><span id="SpDescriptionValidator-31"><a href="#SpDescriptionValidator-31"><span class="linenos"> 31</span></a>
</span><span id="SpDescriptionValidator-32"><a href="#SpDescriptionValidator-32"><span class="linenos"> 32</span></a><span class="sd">    This validator performs comprehensive checks on indicator descriptions including:</span>
</span><span id="SpDescriptionValidator-33"><a href="#SpDescriptionValidator-33"><span class="linenos"> 33</span></a><span class="sd">    - HTML tag detection in descriptions</span>
</span><span id="SpDescriptionValidator-34"><a href="#SpDescriptionValidator-34"><span class="linenos"> 34</span></a><span class="sd">    - Sequential code validation</span>
</span><span id="SpDescriptionValidator-35"><a href="#SpDescriptionValidator-35"><span class="linenos"> 35</span></a><span class="sd">    - Unique code enforcement</span>
</span><span id="SpDescriptionValidator-36"><a href="#SpDescriptionValidator-36"><span class="linenos"> 36</span></a><span class="sd">    - Text capitalization standards</span>
</span><span id="SpDescriptionValidator-37"><a href="#SpDescriptionValidator-37"><span class="linenos"> 37</span></a><span class="sd">    - Indicator level validation</span>
</span><span id="SpDescriptionValidator-38"><a href="#SpDescriptionValidator-38"><span class="linenos"> 38</span></a><span class="sd">    - Punctuation rules</span>
</span><span id="SpDescriptionValidator-39"><a href="#SpDescriptionValidator-39"><span class="linenos"> 39</span></a><span class="sd">    - Empty string detection</span>
</span><span id="SpDescriptionValidator-40"><a href="#SpDescriptionValidator-40"><span class="linenos"> 40</span></a><span class="sd">    - Special character handling (CR/LF)</span>
</span><span id="SpDescriptionValidator-41"><a href="#SpDescriptionValidator-41"><span class="linenos"> 41</span></a><span class="sd">    - Text length limits</span>
</span><span id="SpDescriptionValidator-42"><a href="#SpDescriptionValidator-42"><span class="linenos"> 42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-43"><a href="#SpDescriptionValidator-43"><span class="linenos"> 43</span></a>
</span><span id="SpDescriptionValidator-44"><a href="#SpDescriptionValidator-44"><span class="linenos"> 44</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpDescriptionValidator-45"><a href="#SpDescriptionValidator-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-46"><a href="#SpDescriptionValidator-46"><span class="linenos"> 46</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-47"><a href="#SpDescriptionValidator-47"><span class="linenos"> 47</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-48"><a href="#SpDescriptionValidator-48"><span class="linenos"> 48</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpDescriptionValidator-49"><a href="#SpDescriptionValidator-49"><span class="linenos"> 49</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-50"><a href="#SpDescriptionValidator-50"><span class="linenos"> 50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-51"><a href="#SpDescriptionValidator-51"><span class="linenos"> 51</span></a><span class="sd">        Initialize the Description validator.</span>
</span><span id="SpDescriptionValidator-52"><a href="#SpDescriptionValidator-52"><span class="linenos"> 52</span></a>
</span><span id="SpDescriptionValidator-53"><a href="#SpDescriptionValidator-53"><span class="linenos"> 53</span></a><span class="sd">        Args</span>
</span><span id="SpDescriptionValidator-54"><a href="#SpDescriptionValidator-54"><span class="linenos"> 54</span></a><span class="sd">        ----</span>
</span><span id="SpDescriptionValidator-55"><a href="#SpDescriptionValidator-55"><span class="linenos"> 55</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpDescriptionValidator-56"><a href="#SpDescriptionValidator-56"><span class="linenos"> 56</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpDescriptionValidator-57"><a href="#SpDescriptionValidator-57"><span class="linenos"> 57</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpDescriptionValidator-58"><a href="#SpDescriptionValidator-58"><span class="linenos"> 58</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpDescriptionValidator-59"><a href="#SpDescriptionValidator-59"><span class="linenos"> 59</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpDescriptionValidator-60"><a href="#SpDescriptionValidator-60"><span class="linenos"> 60</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpDescriptionValidator-61"><a href="#SpDescriptionValidator-61"><span class="linenos"> 61</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-62"><a href="#SpDescriptionValidator-62"><span class="linenos"> 62</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpDescriptionValidator-63"><a href="#SpDescriptionValidator-63"><span class="linenos"> 63</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-64"><a href="#SpDescriptionValidator-64"><span class="linenos"> 64</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-65"><a href="#SpDescriptionValidator-65"><span class="linenos"> 65</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpDescription</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-66"><a href="#SpDescriptionValidator-66"><span class="linenos"> 66</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-67"><a href="#SpDescriptionValidator-67"><span class="linenos"> 67</span></a>        <span class="p">)</span>
</span><span id="SpDescriptionValidator-68"><a href="#SpDescriptionValidator-68"><span class="linenos"> 68</span></a>
</span><span id="SpDescriptionValidator-69"><a href="#SpDescriptionValidator-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpDescriptionValidator-70"><a href="#SpDescriptionValidator-70"><span class="linenos"> 70</span></a>
</span><span id="SpDescriptionValidator-71"><a href="#SpDescriptionValidator-71"><span class="linenos"> 71</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_html_in_descriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-72"><a href="#SpDescriptionValidator-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-73"><a href="#SpDescriptionValidator-73"><span class="linenos"> 73</span></a><span class="sd">        Validate that simple descriptions do not contain HTML tags.</span>
</span><span id="SpDescriptionValidator-74"><a href="#SpDescriptionValidator-74"><span class="linenos"> 74</span></a>
</span><span id="SpDescriptionValidator-75"><a href="#SpDescriptionValidator-75"><span class="linenos"> 75</span></a><span class="sd">        Checks the simple description column for HTML tag patterns (e.g., &lt;tag&gt;).</span>
</span><span id="SpDescriptionValidator-76"><a href="#SpDescriptionValidator-76"><span class="linenos"> 76</span></a><span class="sd">        HTML content is not allowed in descriptions as it may cause rendering issues.</span>
</span><span id="SpDescriptionValidator-77"><a href="#SpDescriptionValidator-77"><span class="linenos"> 77</span></a>
</span><span id="SpDescriptionValidator-78"><a href="#SpDescriptionValidator-78"><span class="linenos"> 78</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-79"><a href="#SpDescriptionValidator-79"><span class="linenos"> 79</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-80"><a href="#SpDescriptionValidator-80"><span class="linenos"> 80</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-81"><a href="#SpDescriptionValidator-81"><span class="linenos"> 81</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-82"><a href="#SpDescriptionValidator-82"><span class="linenos"> 82</span></a><span class="sd">                - List[str]: List of error messages (column missing error only)</span>
</span><span id="SpDescriptionValidator-83"><a href="#SpDescriptionValidator-83"><span class="linenos"> 83</span></a><span class="sd">                - List[str]: List of warning messages for rows containing HTML tags</span>
</span><span id="SpDescriptionValidator-84"><a href="#SpDescriptionValidator-84"><span class="linenos"> 84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-85"><a href="#SpDescriptionValidator-85"><span class="linenos"> 85</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-86"><a href="#SpDescriptionValidator-86"><span class="linenos"> 86</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator-87"><a href="#SpDescriptionValidator-87"><span class="linenos"> 87</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-88"><a href="#SpDescriptionValidator-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-89"><a href="#SpDescriptionValidator-89"><span class="linenos"> 89</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-90"><a href="#SpDescriptionValidator-90"><span class="linenos"> 90</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpDescriptionValidator-91"><a href="#SpDescriptionValidator-91"><span class="linenos"> 91</span></a>            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;&lt;.*?&gt;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">column</span><span class="p">])):</span>
</span><span id="SpDescriptionValidator-92"><a href="#SpDescriptionValidator-92"><span class="linenos"> 92</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</span><span id="SpDescriptionValidator-93"><a href="#SpDescriptionValidator-93"><span class="linenos"> 93</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: Coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; no pode conter cdigo HTML.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-94"><a href="#SpDescriptionValidator-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span><span id="SpDescriptionValidator-95"><a href="#SpDescriptionValidator-95"><span class="linenos"> 95</span></a>
</span><span id="SpDescriptionValidator-96"><a href="#SpDescriptionValidator-96"><span class="linenos"> 96</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_sequential_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-97"><a href="#SpDescriptionValidator-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-98"><a href="#SpDescriptionValidator-98"><span class="linenos"> 98</span></a><span class="sd">        Validate that indicator codes are sequential starting from 1.</span>
</span><span id="SpDescriptionValidator-99"><a href="#SpDescriptionValidator-99"><span class="linenos"> 99</span></a>
</span><span id="SpDescriptionValidator-100"><a href="#SpDescriptionValidator-100"><span class="linenos">100</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpDescriptionValidator-101"><a href="#SpDescriptionValidator-101"><span class="linenos">101</span></a><span class="sd">        - All codes are numeric integers</span>
</span><span id="SpDescriptionValidator-102"><a href="#SpDescriptionValidator-102"><span class="linenos">102</span></a><span class="sd">        - The first code is 1</span>
</span><span id="SpDescriptionValidator-103"><a href="#SpDescriptionValidator-103"><span class="linenos">103</span></a><span class="sd">        - Codes follow a sequential pattern (1, 2, 3, ...)</span>
</span><span id="SpDescriptionValidator-104"><a href="#SpDescriptionValidator-104"><span class="linenos">104</span></a>
</span><span id="SpDescriptionValidator-105"><a href="#SpDescriptionValidator-105"><span class="linenos">105</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-106"><a href="#SpDescriptionValidator-106"><span class="linenos">106</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-107"><a href="#SpDescriptionValidator-107"><span class="linenos">107</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-108"><a href="#SpDescriptionValidator-108"><span class="linenos">108</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-109"><a href="#SpDescriptionValidator-109"><span class="linenos">109</span></a><span class="sd">                - List[str]: List of error messages for validation failures</span>
</span><span id="SpDescriptionValidator-110"><a href="#SpDescriptionValidator-110"><span class="linenos">110</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator-111"><a href="#SpDescriptionValidator-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-112"><a href="#SpDescriptionValidator-112"><span class="linenos">112</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-113"><a href="#SpDescriptionValidator-113"><span class="linenos">113</span></a>
</span><span id="SpDescriptionValidator-114"><a href="#SpDescriptionValidator-114"><span class="linenos">114</span></a>        <span class="c1"># 0. Check if the column exists</span>
</span><span id="SpDescriptionValidator-115"><a href="#SpDescriptionValidator-115"><span class="linenos">115</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator-116"><a href="#SpDescriptionValidator-116"><span class="linenos">116</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-117"><a href="#SpDescriptionValidator-117"><span class="linenos">117</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-118"><a href="#SpDescriptionValidator-118"><span class="linenos">118</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-119"><a href="#SpDescriptionValidator-119"><span class="linenos">119</span></a>
</span><span id="SpDescriptionValidator-120"><a href="#SpDescriptionValidator-120"><span class="linenos">120</span></a>        <span class="c1"># Load the original codes and cleaned codes</span>
</span><span id="SpDescriptionValidator-121"><a href="#SpDescriptionValidator-121"><span class="linenos">121</span></a>        <span class="n">original_codes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-122"><a href="#SpDescriptionValidator-122"><span class="linenos">122</span></a>        <span class="n">codes_cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span>
</span><span id="SpDescriptionValidator-123"><a href="#SpDescriptionValidator-123"><span class="linenos">123</span></a>
</span><span id="SpDescriptionValidator-124"><a href="#SpDescriptionValidator-124"><span class="linenos">124</span></a>        <span class="c1"># 1. Check if the column has only integers</span>
</span><span id="SpDescriptionValidator-125"><a href="#SpDescriptionValidator-125"><span class="linenos">125</span></a>        <span class="k">if</span> <span class="n">original_codes</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">codes_cleaned</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-126"><a href="#SpDescriptionValidator-126"><span class="linenos">126</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A verificao foi abortada porque a coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; contm valores no numricos.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-127"><a href="#SpDescriptionValidator-127"><span class="linenos">127</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-128"><a href="#SpDescriptionValidator-128"><span class="linenos">128</span></a>
</span><span id="SpDescriptionValidator-129"><a href="#SpDescriptionValidator-129"><span class="linenos">129</span></a>        <span class="c1"># 2. Check if the first code is 1</span>
</span><span id="SpDescriptionValidator-130"><a href="#SpDescriptionValidator-130"><span class="linenos">130</span></a>        <span class="k">if</span> <span class="n">codes_cleaned</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-131"><a href="#SpDescriptionValidator-131"><span class="linenos">131</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; deve comear em 1.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-132"><a href="#SpDescriptionValidator-132"><span class="linenos">132</span></a>
</span><span id="SpDescriptionValidator-133"><a href="#SpDescriptionValidator-133"><span class="linenos">133</span></a>        <span class="c1"># 3. Check if the codes are sequential and starting from 1</span>
</span><span id="SpDescriptionValidator-134"><a href="#SpDescriptionValidator-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">codes_cleaned</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes_cleaned</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
</span><span id="SpDescriptionValidator-135"><a href="#SpDescriptionValidator-135"><span class="linenos">135</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; deve conter valores inteiros e sequenciais (1, 2, 3, ...).&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-136"><a href="#SpDescriptionValidator-136"><span class="linenos">136</span></a>
</span><span id="SpDescriptionValidator-137"><a href="#SpDescriptionValidator-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-138"><a href="#SpDescriptionValidator-138"><span class="linenos">138</span></a>
</span><span id="SpDescriptionValidator-139"><a href="#SpDescriptionValidator-139"><span class="linenos">139</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-140"><a href="#SpDescriptionValidator-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-141"><a href="#SpDescriptionValidator-141"><span class="linenos">141</span></a><span class="sd">        Validate that all indicator codes are unique.</span>
</span><span id="SpDescriptionValidator-142"><a href="#SpDescriptionValidator-142"><span class="linenos">142</span></a>
</span><span id="SpDescriptionValidator-143"><a href="#SpDescriptionValidator-143"><span class="linenos">143</span></a><span class="sd">        Checks for duplicate code values in the code column and reports any</span>
</span><span id="SpDescriptionValidator-144"><a href="#SpDescriptionValidator-144"><span class="linenos">144</span></a><span class="sd">        duplicates found.</span>
</span><span id="SpDescriptionValidator-145"><a href="#SpDescriptionValidator-145"><span class="linenos">145</span></a>
</span><span id="SpDescriptionValidator-146"><a href="#SpDescriptionValidator-146"><span class="linenos">146</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-147"><a href="#SpDescriptionValidator-147"><span class="linenos">147</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-148"><a href="#SpDescriptionValidator-148"><span class="linenos">148</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-149"><a href="#SpDescriptionValidator-149"><span class="linenos">149</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-150"><a href="#SpDescriptionValidator-150"><span class="linenos">150</span></a><span class="sd">                - List[str]: List of error messages listing duplicate codes</span>
</span><span id="SpDescriptionValidator-151"><a href="#SpDescriptionValidator-151"><span class="linenos">151</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator-152"><a href="#SpDescriptionValidator-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-153"><a href="#SpDescriptionValidator-153"><span class="linenos">153</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-154"><a href="#SpDescriptionValidator-154"><span class="linenos">154</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator-155"><a href="#SpDescriptionValidator-155"><span class="linenos">155</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-156"><a href="#SpDescriptionValidator-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-157"><a href="#SpDescriptionValidator-157"><span class="linenos">157</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-158"><a href="#SpDescriptionValidator-158"><span class="linenos">158</span></a>
</span><span id="SpDescriptionValidator-159"><a href="#SpDescriptionValidator-159"><span class="linenos">159</span></a>        <span class="n">codes_cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span>
</span><span id="SpDescriptionValidator-160"><a href="#SpDescriptionValidator-160"><span class="linenos">160</span></a>        <span class="n">duplicated_codes</span> <span class="o">=</span> <span class="n">codes_cleaned</span><span class="p">[</span><span class="n">codes_cleaned</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpDescriptionValidator-161"><a href="#SpDescriptionValidator-161"><span class="linenos">161</span></a>
</span><span id="SpDescriptionValidator-162"><a href="#SpDescriptionValidator-162"><span class="linenos">162</span></a>        <span class="k">if</span> <span class="n">duplicated_codes</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-163"><a href="#SpDescriptionValidator-163"><span class="linenos">163</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; contm cdigos duplicados: </span><span class="si">{</span><span class="n">duplicated_codes</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-164"><a href="#SpDescriptionValidator-164"><span class="linenos">164</span></a>
</span><span id="SpDescriptionValidator-165"><a href="#SpDescriptionValidator-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-166"><a href="#SpDescriptionValidator-166"><span class="linenos">166</span></a>
</span><span id="SpDescriptionValidator-167"><a href="#SpDescriptionValidator-167"><span class="linenos">167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_text_capitalization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-168"><a href="#SpDescriptionValidator-168"><span class="linenos">168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-169"><a href="#SpDescriptionValidator-169"><span class="linenos">169</span></a><span class="sd">        Validate text capitalization in name columns.</span>
</span><span id="SpDescriptionValidator-170"><a href="#SpDescriptionValidator-170"><span class="linenos">170</span></a>
</span><span id="SpDescriptionValidator-171"><a href="#SpDescriptionValidator-171"><span class="linenos">171</span></a><span class="sd">        Checks that simple and complete name columns follow proper capitalization</span>
</span><span id="SpDescriptionValidator-172"><a href="#SpDescriptionValidator-172"><span class="linenos">172</span></a><span class="sd">        standards while preserving acronyms. Also detects special characters like</span>
</span><span id="SpDescriptionValidator-173"><a href="#SpDescriptionValidator-173"><span class="linenos">173</span></a><span class="sd">        CR, LF, and extra spaces that should not be present.</span>
</span><span id="SpDescriptionValidator-174"><a href="#SpDescriptionValidator-174"><span class="linenos">174</span></a>
</span><span id="SpDescriptionValidator-175"><a href="#SpDescriptionValidator-175"><span class="linenos">175</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-176"><a href="#SpDescriptionValidator-176"><span class="linenos">176</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-177"><a href="#SpDescriptionValidator-177"><span class="linenos">177</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-178"><a href="#SpDescriptionValidator-178"><span class="linenos">178</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-179"><a href="#SpDescriptionValidator-179"><span class="linenos">179</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator-180"><a href="#SpDescriptionValidator-180"><span class="linenos">180</span></a><span class="sd">                - List[str]: List of warning messages for capitalization issues</span>
</span><span id="SpDescriptionValidator-181"><a href="#SpDescriptionValidator-181"><span class="linenos">181</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-182"><a href="#SpDescriptionValidator-182"><span class="linenos">182</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-183"><a href="#SpDescriptionValidator-183"><span class="linenos">183</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator-184"><a href="#SpDescriptionValidator-184"><span class="linenos">184</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-185"><a href="#SpDescriptionValidator-185"><span class="linenos">185</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-186"><a href="#SpDescriptionValidator-186"><span class="linenos">186</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator-187"><a href="#SpDescriptionValidator-187"><span class="linenos">187</span></a>
</span><span id="SpDescriptionValidator-188"><a href="#SpDescriptionValidator-188"><span class="linenos">188</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-189"><a href="#SpDescriptionValidator-189"><span class="linenos">189</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-190"><a href="#SpDescriptionValidator-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-191"><a href="#SpDescriptionValidator-191"><span class="linenos">191</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-192"><a href="#SpDescriptionValidator-192"><span class="linenos">192</span></a>                <span class="k">continue</span>
</span><span id="SpDescriptionValidator-193"><a href="#SpDescriptionValidator-193"><span class="linenos">193</span></a>
</span><span id="SpDescriptionValidator-194"><a href="#SpDescriptionValidator-194"><span class="linenos">194</span></a>            <span class="c1"># Filter non-empty values</span>
</span><span id="SpDescriptionValidator-195"><a href="#SpDescriptionValidator-195"><span class="linenos">195</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-196"><a href="#SpDescriptionValidator-196"><span class="linenos">196</span></a>            <span class="n">filtered_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="SpDescriptionValidator-197"><a href="#SpDescriptionValidator-197"><span class="linenos">197</span></a>
</span><span id="SpDescriptionValidator-198"><a href="#SpDescriptionValidator-198"><span class="linenos">198</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-199"><a href="#SpDescriptionValidator-199"><span class="linenos">199</span></a>                <span class="c1"># Process original text with all replacements</span>
</span><span id="SpDescriptionValidator-200"><a href="#SpDescriptionValidator-200"><span class="linenos">200</span></a>                <span class="n">original_series</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpDescriptionValidator-201"><a href="#SpDescriptionValidator-201"><span class="linenos">201</span></a>                    <span class="n">filtered_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
</span><span id="SpDescriptionValidator-202"><a href="#SpDescriptionValidator-202"><span class="linenos">202</span></a>                    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-203"><a href="#SpDescriptionValidator-203"><span class="linenos">203</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; (EXTRA_SPACE)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-204"><a href="#SpDescriptionValidator-204"><span class="linenos">204</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(CR)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-205"><a href="#SpDescriptionValidator-205"><span class="linenos">205</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(LF)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-206"><a href="#SpDescriptionValidator-206"><span class="linenos">206</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(CR)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-207"><a href="#SpDescriptionValidator-207"><span class="linenos">207</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0a</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(LF)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-208"><a href="#SpDescriptionValidator-208"><span class="linenos">208</span></a>                <span class="p">)</span>
</span><span id="SpDescriptionValidator-209"><a href="#SpDescriptionValidator-209"><span class="linenos">209</span></a>
</span><span id="SpDescriptionValidator-210"><a href="#SpDescriptionValidator-210"><span class="linenos">210</span></a>                <span class="c1"># Process expected correct text with all replacements and capitalization</span>
</span><span id="SpDescriptionValidator-211"><a href="#SpDescriptionValidator-211"><span class="linenos">211</span></a>                <span class="n">expected_series</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpDescriptionValidator-212"><a href="#SpDescriptionValidator-212"><span class="linenos">212</span></a>                    <span class="n">filtered_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
</span><span id="SpDescriptionValidator-213"><a href="#SpDescriptionValidator-213"><span class="linenos">213</span></a>                    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-214"><a href="#SpDescriptionValidator-214"><span class="linenos">214</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-215"><a href="#SpDescriptionValidator-215"><span class="linenos">215</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-216"><a href="#SpDescriptionValidator-216"><span class="linenos">216</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-217"><a href="#SpDescriptionValidator-217"><span class="linenos">217</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0a</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-218"><a href="#SpDescriptionValidator-218"><span class="linenos">218</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="SpDescriptionValidator-219"><a href="#SpDescriptionValidator-219"><span class="linenos">219</span></a>                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TextFormattingProcessing</span><span class="o">.</span><span class="n">capitalize_text_keep_acronyms</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
</span><span id="SpDescriptionValidator-220"><a href="#SpDescriptionValidator-220"><span class="linenos">220</span></a>                <span class="p">)</span>
</span><span id="SpDescriptionValidator-221"><a href="#SpDescriptionValidator-221"><span class="linenos">221</span></a>
</span><span id="SpDescriptionValidator-222"><a href="#SpDescriptionValidator-222"><span class="linenos">222</span></a>                <span class="c1"># Find mismatches</span>
</span><span id="SpDescriptionValidator-223"><a href="#SpDescriptionValidator-223"><span class="linenos">223</span></a>                <span class="n">mismatches_mask</span> <span class="o">=</span> <span class="n">original_series</span> <span class="o">!=</span> <span class="n">expected_series</span>
</span><span id="SpDescriptionValidator-224"><a href="#SpDescriptionValidator-224"><span class="linenos">224</span></a>                <span class="n">mismatches_indices</span> <span class="o">=</span> <span class="n">original_series</span><span class="p">[</span><span class="n">mismatches_mask</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="SpDescriptionValidator-225"><a href="#SpDescriptionValidator-225"><span class="linenos">225</span></a>
</span><span id="SpDescriptionValidator-226"><a href="#SpDescriptionValidator-226"><span class="linenos">226</span></a>                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">mismatches_indices</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-227"><a href="#SpDescriptionValidator-227"><span class="linenos">227</span></a>                    <span class="n">original_text</span> <span class="o">=</span> <span class="n">original_series</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="SpDescriptionValidator-228"><a href="#SpDescriptionValidator-228"><span class="linenos">228</span></a>                    <span class="n">expected_text</span> <span class="o">=</span> <span class="n">expected_series</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="SpDescriptionValidator-229"><a href="#SpDescriptionValidator-229"><span class="linenos">229</span></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpDescriptionValidator-230"><a href="#SpDescriptionValidator-230"><span class="linenos">230</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: Valor da coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; fora do padro. Esperado: &#39;</span><span class="si">{</span><span class="n">expected_text</span><span class="si">}</span><span class="s2">&#39;. Encontrado: &#39;</span><span class="si">{</span><span class="n">original_text</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="SpDescriptionValidator-231"><a href="#SpDescriptionValidator-231"><span class="linenos">231</span></a>                    <span class="p">)</span>
</span><span id="SpDescriptionValidator-232"><a href="#SpDescriptionValidator-232"><span class="linenos">232</span></a>
</span><span id="SpDescriptionValidator-233"><a href="#SpDescriptionValidator-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span><span id="SpDescriptionValidator-234"><a href="#SpDescriptionValidator-234"><span class="linenos">234</span></a>
</span><span id="SpDescriptionValidator-235"><a href="#SpDescriptionValidator-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_indicator_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-236"><a href="#SpDescriptionValidator-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-237"><a href="#SpDescriptionValidator-237"><span class="linenos">237</span></a><span class="sd">        Validate indicator level values.</span>
</span><span id="SpDescriptionValidator-238"><a href="#SpDescriptionValidator-238"><span class="linenos">238</span></a>
</span><span id="SpDescriptionValidator-239"><a href="#SpDescriptionValidator-239"><span class="linenos">239</span></a><span class="sd">        Ensures that all indicator levels in the level column are positive integers</span>
</span><span id="SpDescriptionValidator-240"><a href="#SpDescriptionValidator-240"><span class="linenos">240</span></a><span class="sd">        greater than zero.</span>
</span><span id="SpDescriptionValidator-241"><a href="#SpDescriptionValidator-241"><span class="linenos">241</span></a>
</span><span id="SpDescriptionValidator-242"><a href="#SpDescriptionValidator-242"><span class="linenos">242</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-243"><a href="#SpDescriptionValidator-243"><span class="linenos">243</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-244"><a href="#SpDescriptionValidator-244"><span class="linenos">244</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-245"><a href="#SpDescriptionValidator-245"><span class="linenos">245</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-246"><a href="#SpDescriptionValidator-246"><span class="linenos">246</span></a><span class="sd">                - List[str]: List of error messages for invalid levels</span>
</span><span id="SpDescriptionValidator-247"><a href="#SpDescriptionValidator-247"><span class="linenos">247</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator-248"><a href="#SpDescriptionValidator-248"><span class="linenos">248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-249"><a href="#SpDescriptionValidator-249"><span class="linenos">249</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-250"><a href="#SpDescriptionValidator-250"><span class="linenos">250</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator-251"><a href="#SpDescriptionValidator-251"><span class="linenos">251</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-252"><a href="#SpDescriptionValidator-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-253"><a href="#SpDescriptionValidator-253"><span class="linenos">253</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-254"><a href="#SpDescriptionValidator-254"><span class="linenos">254</span></a>
</span><span id="SpDescriptionValidator-255"><a href="#SpDescriptionValidator-255"><span class="linenos">255</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpDescriptionValidator-256"><a href="#SpDescriptionValidator-256"><span class="linenos">256</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
</span><span id="SpDescriptionValidator-257"><a href="#SpDescriptionValidator-257"><span class="linenos">257</span></a>            <span class="n">is_valid</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">NumberFormattingProcessing</span><span class="o">.</span><span class="n">check_cell_integer</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-258"><a href="#SpDescriptionValidator-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-259"><a href="#SpDescriptionValidator-259"><span class="linenos">259</span></a>                <span class="n">line_updated</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="SpDescriptionValidator-260"><a href="#SpDescriptionValidator-260"><span class="linenos">260</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpDescriptionValidator-261"><a href="#SpDescriptionValidator-261"><span class="linenos">261</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">line_updated</span><span class="si">}</span><span class="s2">: O nvel do indicador na coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; deve ser um nmero inteiro maior que 0.&quot;</span>
</span><span id="SpDescriptionValidator-262"><a href="#SpDescriptionValidator-262"><span class="linenos">262</span></a>                <span class="p">)</span>
</span><span id="SpDescriptionValidator-263"><a href="#SpDescriptionValidator-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-264"><a href="#SpDescriptionValidator-264"><span class="linenos">264</span></a>
</span><span id="SpDescriptionValidator-265"><a href="#SpDescriptionValidator-265"><span class="linenos">265</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_punctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-266"><a href="#SpDescriptionValidator-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-267"><a href="#SpDescriptionValidator-267"><span class="linenos">267</span></a><span class="sd">        Validate punctuation rules in name and description columns.</span>
</span><span id="SpDescriptionValidator-268"><a href="#SpDescriptionValidator-268"><span class="linenos">268</span></a>
</span><span id="SpDescriptionValidator-269"><a href="#SpDescriptionValidator-269"><span class="linenos">269</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpDescriptionValidator-270"><a href="#SpDescriptionValidator-270"><span class="linenos">270</span></a><span class="sd">        - Name columns do not end with punctuation</span>
</span><span id="SpDescriptionValidator-271"><a href="#SpDescriptionValidator-271"><span class="linenos">271</span></a><span class="sd">        - Description columns end with a period</span>
</span><span id="SpDescriptionValidator-272"><a href="#SpDescriptionValidator-272"><span class="linenos">272</span></a>
</span><span id="SpDescriptionValidator-273"><a href="#SpDescriptionValidator-273"><span class="linenos">273</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-274"><a href="#SpDescriptionValidator-274"><span class="linenos">274</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-275"><a href="#SpDescriptionValidator-275"><span class="linenos">275</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-276"><a href="#SpDescriptionValidator-276"><span class="linenos">276</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-277"><a href="#SpDescriptionValidator-277"><span class="linenos">277</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator-278"><a href="#SpDescriptionValidator-278"><span class="linenos">278</span></a><span class="sd">                - List[str]: List of warning messages for punctuation violations</span>
</span><span id="SpDescriptionValidator-279"><a href="#SpDescriptionValidator-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-280"><a href="#SpDescriptionValidator-280"><span class="linenos">280</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-281"><a href="#SpDescriptionValidator-281"><span class="linenos">281</span></a>        <span class="n">columns_dont_punctuation</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator-282"><a href="#SpDescriptionValidator-282"><span class="linenos">282</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-283"><a href="#SpDescriptionValidator-283"><span class="linenos">283</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-284"><a href="#SpDescriptionValidator-284"><span class="linenos">284</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator-285"><a href="#SpDescriptionValidator-285"><span class="linenos">285</span></a>        <span class="n">columns_must_end_with_dot</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator-286"><a href="#SpDescriptionValidator-286"><span class="linenos">286</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-287"><a href="#SpDescriptionValidator-287"><span class="linenos">287</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-288"><a href="#SpDescriptionValidator-288"><span class="linenos">288</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator-289"><a href="#SpDescriptionValidator-289"><span class="linenos">289</span></a>
</span><span id="SpDescriptionValidator-290"><a href="#SpDescriptionValidator-290"><span class="linenos">290</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns_dont_punctuation</span> <span class="o">+</span> <span class="n">columns_must_end_with_dot</span><span class="p">):</span>
</span><span id="SpDescriptionValidator-291"><a href="#SpDescriptionValidator-291"><span class="linenos">291</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-292"><a href="#SpDescriptionValidator-292"><span class="linenos">292</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-293"><a href="#SpDescriptionValidator-293"><span class="linenos">293</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-294"><a href="#SpDescriptionValidator-294"><span class="linenos">294</span></a>
</span><span id="SpDescriptionValidator-295"><a href="#SpDescriptionValidator-295"><span class="linenos">295</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">punctuation_warnings</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_characters_punctuation_rules</span><span class="p">(</span>
</span><span id="SpDescriptionValidator-296"><a href="#SpDescriptionValidator-296"><span class="linenos">296</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-297"><a href="#SpDescriptionValidator-297"><span class="linenos">297</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-298"><a href="#SpDescriptionValidator-298"><span class="linenos">298</span></a>            <span class="n">columns_dont_punctuation</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-299"><a href="#SpDescriptionValidator-299"><span class="linenos">299</span></a>            <span class="n">columns_must_end_with_dot</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-300"><a href="#SpDescriptionValidator-300"><span class="linenos">300</span></a>        <span class="p">)</span>
</span><span id="SpDescriptionValidator-301"><a href="#SpDescriptionValidator-301"><span class="linenos">301</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">punctuation_warnings</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-302"><a href="#SpDescriptionValidator-302"><span class="linenos">302</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span><span id="SpDescriptionValidator-303"><a href="#SpDescriptionValidator-303"><span class="linenos">303</span></a>
</span><span id="SpDescriptionValidator-304"><a href="#SpDescriptionValidator-304"><span class="linenos">304</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_empty_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-305"><a href="#SpDescriptionValidator-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-306"><a href="#SpDescriptionValidator-306"><span class="linenos">306</span></a><span class="sd">        Validate that required text columns do not contain empty values.</span>
</span><span id="SpDescriptionValidator-307"><a href="#SpDescriptionValidator-307"><span class="linenos">307</span></a>
</span><span id="SpDescriptionValidator-308"><a href="#SpDescriptionValidator-308"><span class="linenos">308</span></a><span class="sd">        Checks that name and description columns contain non-empty, non-null values</span>
</span><span id="SpDescriptionValidator-309"><a href="#SpDescriptionValidator-309"><span class="linenos">309</span></a><span class="sd">        in all rows.</span>
</span><span id="SpDescriptionValidator-310"><a href="#SpDescriptionValidator-310"><span class="linenos">310</span></a>
</span><span id="SpDescriptionValidator-311"><a href="#SpDescriptionValidator-311"><span class="linenos">311</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-312"><a href="#SpDescriptionValidator-312"><span class="linenos">312</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-313"><a href="#SpDescriptionValidator-313"><span class="linenos">313</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-314"><a href="#SpDescriptionValidator-314"><span class="linenos">314</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-315"><a href="#SpDescriptionValidator-315"><span class="linenos">315</span></a><span class="sd">                - List[str]: List of error messages for empty values</span>
</span><span id="SpDescriptionValidator-316"><a href="#SpDescriptionValidator-316"><span class="linenos">316</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator-317"><a href="#SpDescriptionValidator-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-318"><a href="#SpDescriptionValidator-318"><span class="linenos">318</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-319"><a href="#SpDescriptionValidator-319"><span class="linenos">319</span></a>
</span><span id="SpDescriptionValidator-320"><a href="#SpDescriptionValidator-320"><span class="linenos">320</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator-321"><a href="#SpDescriptionValidator-321"><span class="linenos">321</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-322"><a href="#SpDescriptionValidator-322"><span class="linenos">322</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-323"><a href="#SpDescriptionValidator-323"><span class="linenos">323</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-324"><a href="#SpDescriptionValidator-324"><span class="linenos">324</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-325"><a href="#SpDescriptionValidator-325"><span class="linenos">325</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator-326"><a href="#SpDescriptionValidator-326"><span class="linenos">326</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-327"><a href="#SpDescriptionValidator-327"><span class="linenos">327</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-328"><a href="#SpDescriptionValidator-328"><span class="linenos">328</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-329"><a href="#SpDescriptionValidator-329"><span class="linenos">329</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-330"><a href="#SpDescriptionValidator-330"><span class="linenos">330</span></a>                <span class="k">continue</span>
</span><span id="SpDescriptionValidator-331"><a href="#SpDescriptionValidator-331"><span class="linenos">331</span></a>            <span class="n">empty_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
</span><span id="SpDescriptionValidator-332"><a href="#SpDescriptionValidator-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_rows</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-333"><a href="#SpDescriptionValidator-333"><span class="linenos">333</span></a>                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">empty_rows</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-334"><a href="#SpDescriptionValidator-334"><span class="linenos">334</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: Nenhum item da coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; pode ser vazio.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-335"><a href="#SpDescriptionValidator-335"><span class="linenos">335</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-336"><a href="#SpDescriptionValidator-336"><span class="linenos">336</span></a>
</span><span id="SpDescriptionValidator-337"><a href="#SpDescriptionValidator-337"><span class="linenos">337</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_cr_lf_characters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-338"><a href="#SpDescriptionValidator-338"><span class="linenos">338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-339"><a href="#SpDescriptionValidator-339"><span class="linenos">339</span></a><span class="sd">        Validate special CR/LF characters in text columns.</span>
</span><span id="SpDescriptionValidator-340"><a href="#SpDescriptionValidator-340"><span class="linenos">340</span></a>
</span><span id="SpDescriptionValidator-341"><a href="#SpDescriptionValidator-341"><span class="linenos">341</span></a><span class="sd">        Checks for carriage return (CR) and line feed (LF) characters that should not</span>
</span><span id="SpDescriptionValidator-342"><a href="#SpDescriptionValidator-342"><span class="linenos">342</span></a><span class="sd">        appear at the start/end of columns or anywhere in name columns.</span>
</span><span id="SpDescriptionValidator-343"><a href="#SpDescriptionValidator-343"><span class="linenos">343</span></a>
</span><span id="SpDescriptionValidator-344"><a href="#SpDescriptionValidator-344"><span class="linenos">344</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-345"><a href="#SpDescriptionValidator-345"><span class="linenos">345</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-346"><a href="#SpDescriptionValidator-346"><span class="linenos">346</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-347"><a href="#SpDescriptionValidator-347"><span class="linenos">347</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-348"><a href="#SpDescriptionValidator-348"><span class="linenos">348</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator-349"><a href="#SpDescriptionValidator-349"><span class="linenos">349</span></a><span class="sd">                - List[str]: List of warning messages for CR/LF violations</span>
</span><span id="SpDescriptionValidator-350"><a href="#SpDescriptionValidator-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-351"><a href="#SpDescriptionValidator-351"><span class="linenos">351</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator-352"><a href="#SpDescriptionValidator-352"><span class="linenos">352</span></a>
</span><span id="SpDescriptionValidator-353"><a href="#SpDescriptionValidator-353"><span class="linenos">353</span></a>        <span class="n">columns_start_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">EXPECTED_COLUMNS</span>
</span><span id="SpDescriptionValidator-354"><a href="#SpDescriptionValidator-354"><span class="linenos">354</span></a>        <span class="n">columns_anywhere</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator-355"><a href="#SpDescriptionValidator-355"><span class="linenos">355</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-356"><a href="#SpDescriptionValidator-356"><span class="linenos">356</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator-357"><a href="#SpDescriptionValidator-357"><span class="linenos">357</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator-358"><a href="#SpDescriptionValidator-358"><span class="linenos">358</span></a>
</span><span id="SpDescriptionValidator-359"><a href="#SpDescriptionValidator-359"><span class="linenos">359</span></a>        <span class="c1"># Create an ordered dictionary with the columns</span>
</span><span id="SpDescriptionValidator-360"><a href="#SpDescriptionValidator-360"><span class="linenos">360</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">OrderedDict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">columns_anywhere</span> <span class="o">+</span> <span class="n">columns_start_end</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="SpDescriptionValidator-361"><a href="#SpDescriptionValidator-361"><span class="linenos">361</span></a>
</span><span id="SpDescriptionValidator-362"><a href="#SpDescriptionValidator-362"><span class="linenos">362</span></a>        <span class="c1"># Check if the columns exist</span>
</span><span id="SpDescriptionValidator-363"><a href="#SpDescriptionValidator-363"><span class="linenos">363</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-364"><a href="#SpDescriptionValidator-364"><span class="linenos">364</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-365"><a href="#SpDescriptionValidator-365"><span class="linenos">365</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-366"><a href="#SpDescriptionValidator-366"><span class="linenos">366</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-367"><a href="#SpDescriptionValidator-367"><span class="linenos">367</span></a>                <span class="k">continue</span>
</span><span id="SpDescriptionValidator-368"><a href="#SpDescriptionValidator-368"><span class="linenos">368</span></a>
</span><span id="SpDescriptionValidator-369"><a href="#SpDescriptionValidator-369"><span class="linenos">369</span></a>        <span class="c1"># Run the checks for CR/LF characters</span>
</span><span id="SpDescriptionValidator-370"><a href="#SpDescriptionValidator-370"><span class="linenos">370</span></a>        <span class="n">__</span><span class="p">,</span> <span class="n">all_warnings_cr_lf</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_special_characters_cr_lf</span><span class="p">(</span>
</span><span id="SpDescriptionValidator-371"><a href="#SpDescriptionValidator-371"><span class="linenos">371</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span> <span class="n">columns_start_end</span><span class="p">,</span> <span class="n">columns_anywhere</span>
</span><span id="SpDescriptionValidator-372"><a href="#SpDescriptionValidator-372"><span class="linenos">372</span></a>        <span class="p">)</span>
</span><span id="SpDescriptionValidator-373"><a href="#SpDescriptionValidator-373"><span class="linenos">373</span></a>
</span><span id="SpDescriptionValidator-374"><a href="#SpDescriptionValidator-374"><span class="linenos">374</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">all_warnings_cr_lf</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-375"><a href="#SpDescriptionValidator-375"><span class="linenos">375</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span><span id="SpDescriptionValidator-376"><a href="#SpDescriptionValidator-376"><span class="linenos">376</span></a>
</span><span id="SpDescriptionValidator-377"><a href="#SpDescriptionValidator-377"><span class="linenos">377</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_title_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-378"><a href="#SpDescriptionValidator-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-379"><a href="#SpDescriptionValidator-379"><span class="linenos">379</span></a><span class="sd">        Validate the length of indicator titles.</span>
</span><span id="SpDescriptionValidator-380"><a href="#SpDescriptionValidator-380"><span class="linenos">380</span></a>
</span><span id="SpDescriptionValidator-381"><a href="#SpDescriptionValidator-381"><span class="linenos">381</span></a><span class="sd">        Checks that simple name values do not exceed the configured maximum</span>
</span><span id="SpDescriptionValidator-382"><a href="#SpDescriptionValidator-382"><span class="linenos">382</span></a><span class="sd">        title length.</span>
</span><span id="SpDescriptionValidator-383"><a href="#SpDescriptionValidator-383"><span class="linenos">383</span></a>
</span><span id="SpDescriptionValidator-384"><a href="#SpDescriptionValidator-384"><span class="linenos">384</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-385"><a href="#SpDescriptionValidator-385"><span class="linenos">385</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-386"><a href="#SpDescriptionValidator-386"><span class="linenos">386</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-387"><a href="#SpDescriptionValidator-387"><span class="linenos">387</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-388"><a href="#SpDescriptionValidator-388"><span class="linenos">388</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator-389"><a href="#SpDescriptionValidator-389"><span class="linenos">389</span></a><span class="sd">                - List[str]: List of warning messages for titles exceeding max length</span>
</span><span id="SpDescriptionValidator-390"><a href="#SpDescriptionValidator-390"><span class="linenos">390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-391"><a href="#SpDescriptionValidator-391"><span class="linenos">391</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator-392"><a href="#SpDescriptionValidator-392"><span class="linenos">392</span></a>        <span class="n">max_len</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MAX_TITLE_LENGTH</span>
</span><span id="SpDescriptionValidator-393"><a href="#SpDescriptionValidator-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_text_length</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">max_len</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-394"><a href="#SpDescriptionValidator-394"><span class="linenos">394</span></a>
</span><span id="SpDescriptionValidator-395"><a href="#SpDescriptionValidator-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_simple_description_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-396"><a href="#SpDescriptionValidator-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-397"><a href="#SpDescriptionValidator-397"><span class="linenos">397</span></a><span class="sd">        Validate the length of simple descriptions.</span>
</span><span id="SpDescriptionValidator-398"><a href="#SpDescriptionValidator-398"><span class="linenos">398</span></a>
</span><span id="SpDescriptionValidator-399"><a href="#SpDescriptionValidator-399"><span class="linenos">399</span></a><span class="sd">        Checks that simple description values do not exceed the configured maximum</span>
</span><span id="SpDescriptionValidator-400"><a href="#SpDescriptionValidator-400"><span class="linenos">400</span></a><span class="sd">        description length.</span>
</span><span id="SpDescriptionValidator-401"><a href="#SpDescriptionValidator-401"><span class="linenos">401</span></a>
</span><span id="SpDescriptionValidator-402"><a href="#SpDescriptionValidator-402"><span class="linenos">402</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-403"><a href="#SpDescriptionValidator-403"><span class="linenos">403</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-404"><a href="#SpDescriptionValidator-404"><span class="linenos">404</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-405"><a href="#SpDescriptionValidator-405"><span class="linenos">405</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-406"><a href="#SpDescriptionValidator-406"><span class="linenos">406</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator-407"><a href="#SpDescriptionValidator-407"><span class="linenos">407</span></a><span class="sd">                - List[str]: List of warning messages for descriptions exceeding max length</span>
</span><span id="SpDescriptionValidator-408"><a href="#SpDescriptionValidator-408"><span class="linenos">408</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-409"><a href="#SpDescriptionValidator-409"><span class="linenos">409</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator-410"><a href="#SpDescriptionValidator-410"><span class="linenos">410</span></a>        <span class="n">max_len</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MAX_SIMPLE_DESC_LENGTH</span>
</span><span id="SpDescriptionValidator-411"><a href="#SpDescriptionValidator-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_text_length</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">max_len</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-412"><a href="#SpDescriptionValidator-412"><span class="linenos">412</span></a>
</span><span id="SpDescriptionValidator-413"><a href="#SpDescriptionValidator-413"><span class="linenos">413</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-414"><a href="#SpDescriptionValidator-414"><span class="linenos">414</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-415"><a href="#SpDescriptionValidator-415"><span class="linenos">415</span></a><span class="sd">        Prepare validation statements.</span>
</span><span id="SpDescriptionValidator-416"><a href="#SpDescriptionValidator-416"><span class="linenos">416</span></a>
</span><span id="SpDescriptionValidator-417"><a href="#SpDescriptionValidator-417"><span class="linenos">417</span></a><span class="sd">        This method is currently a placeholder for future initialization logic</span>
</span><span id="SpDescriptionValidator-418"><a href="#SpDescriptionValidator-418"><span class="linenos">418</span></a><span class="sd">        that may be needed before running validations.</span>
</span><span id="SpDescriptionValidator-419"><a href="#SpDescriptionValidator-419"><span class="linenos">419</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-420"><a href="#SpDescriptionValidator-420"><span class="linenos">420</span></a>        <span class="k">pass</span>
</span><span id="SpDescriptionValidator-421"><a href="#SpDescriptionValidator-421"><span class="linenos">421</span></a>
</span><span id="SpDescriptionValidator-422"><a href="#SpDescriptionValidator-422"><span class="linenos">422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator-423"><a href="#SpDescriptionValidator-423"><span class="linenos">423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-424"><a href="#SpDescriptionValidator-424"><span class="linenos">424</span></a><span class="sd">        Execute all Description spreadsheet validations.</span>
</span><span id="SpDescriptionValidator-425"><a href="#SpDescriptionValidator-425"><span class="linenos">425</span></a>
</span><span id="SpDescriptionValidator-426"><a href="#SpDescriptionValidator-426"><span class="linenos">426</span></a><span class="sd">        Orchestrates the validation process by executing all description checks</span>
</span><span id="SpDescriptionValidator-427"><a href="#SpDescriptionValidator-427"><span class="linenos">427</span></a><span class="sd">        and building reports based on the validation results. Title length validation</span>
</span><span id="SpDescriptionValidator-428"><a href="#SpDescriptionValidator-428"><span class="linenos">428</span></a><span class="sd">        is conditionally included based on configuration flags.</span>
</span><span id="SpDescriptionValidator-429"><a href="#SpDescriptionValidator-429"><span class="linenos">429</span></a>
</span><span id="SpDescriptionValidator-430"><a href="#SpDescriptionValidator-430"><span class="linenos">430</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator-431"><a href="#SpDescriptionValidator-431"><span class="linenos">431</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator-432"><a href="#SpDescriptionValidator-432"><span class="linenos">432</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator-433"><a href="#SpDescriptionValidator-433"><span class="linenos">433</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator-434"><a href="#SpDescriptionValidator-434"><span class="linenos">434</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpDescriptionValidator-435"><a href="#SpDescriptionValidator-435"><span class="linenos">435</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpDescriptionValidator-436"><a href="#SpDescriptionValidator-436"><span class="linenos">436</span></a>
</span><span id="SpDescriptionValidator-437"><a href="#SpDescriptionValidator-437"><span class="linenos">437</span></a><span class="sd">        Notes</span>
</span><span id="SpDescriptionValidator-438"><a href="#SpDescriptionValidator-438"><span class="linenos">438</span></a><span class="sd">        -----</span>
</span><span id="SpDescriptionValidator-439"><a href="#SpDescriptionValidator-439"><span class="linenos">439</span></a><span class="sd">        - If the dataframe is empty, all validations are marked as not executed</span>
</span><span id="SpDescriptionValidator-440"><a href="#SpDescriptionValidator-440"><span class="linenos">440</span></a><span class="sd">        - Title length validation can be disabled via command line flag</span>
</span><span id="SpDescriptionValidator-441"><a href="#SpDescriptionValidator-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator-442"><a href="#SpDescriptionValidator-442"><span class="linenos">442</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator-443"><a href="#SpDescriptionValidator-443"><span class="linenos">443</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_html_in_descriptions</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">HTML_DESC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-444"><a href="#SpDescriptionValidator-444"><span class="linenos">444</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_sequential_codes</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-445"><a href="#SpDescriptionValidator-445"><span class="linenos">445</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_codes</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">CO_UN</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-446"><a href="#SpDescriptionValidator-446"><span class="linenos">446</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_text_capitalization</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">INP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-447"><a href="#SpDescriptionValidator-447"><span class="linenos">447</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_indicator_levels</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IL</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-448"><a href="#SpDescriptionValidator-448"><span class="linenos">448</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_punctuation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">MAND_PUNC_DESC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-449"><a href="#SpDescriptionValidator-449"><span class="linenos">449</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_empty_strings</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">EF</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-450"><a href="#SpDescriptionValidator-450"><span class="linenos">450</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_cr_lf_characters</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LB_DESC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-451"><a href="#SpDescriptionValidator-451"><span class="linenos">451</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_simple_description_length</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SIMP_DESC_N</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator-452"><a href="#SpDescriptionValidator-452"><span class="linenos">452</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator-453"><a href="#SpDescriptionValidator-453"><span class="linenos">453</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-454"><a href="#SpDescriptionValidator-454"><span class="linenos">454</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-455"><a href="#SpDescriptionValidator-455"><span class="linenos">455</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpDescriptionValidator-456"><a href="#SpDescriptionValidator-456"><span class="linenos">456</span></a>
</span><span id="SpDescriptionValidator-457"><a href="#SpDescriptionValidator-457"><span class="linenos">457</span></a>        <span class="c1"># Add title length validation if the flag is not set to skip it</span>
</span><span id="SpDescriptionValidator-458"><a href="#SpDescriptionValidator-458"><span class="linenos">458</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_action</span><span class="o">.</span><span class="n">no_warning_titles_length</span><span class="p">:</span>
</span><span id="SpDescriptionValidator-459"><a href="#SpDescriptionValidator-459"><span class="linenos">459</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_title_length</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">TITLES_N</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="SpDescriptionValidator-460"><a href="#SpDescriptionValidator-460"><span class="linenos">460</span></a>
</span><span id="SpDescriptionValidator-461"><a href="#SpDescriptionValidator-461"><span class="linenos">461</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpDescriptionValidator-462"><a href="#SpDescriptionValidator-462"><span class="linenos">462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpDescriptionValidator-463"><a href="#SpDescriptionValidator-463"><span class="linenos">463</span></a>
</span><span id="SpDescriptionValidator-464"><a href="#SpDescriptionValidator-464"><span class="linenos">464</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates Description spreadsheet content and metadata.</p>

<p>This validator performs comprehensive checks on indicator descriptions including:</p>

<ul>
<li>HTML tag detection in descriptions</li>
<li>Sequential code validation</li>
<li>Unique code enforcement</li>
<li>Text capitalization standards</li>
<li>Indicator level validation</li>
<li>Punctuation rules</li>
<li>Empty string detection</li>
<li>Special character handling (CR/LF)</li>
<li>Text length limits</li>
</ul>
</div>


                            <div id="SpDescriptionValidator.__init__" class="classattr">
                                        <input id="SpDescriptionValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpDescriptionValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpDescriptionValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.__init__-44"><a href="#SpDescriptionValidator.__init__-44"><span class="linenos">44</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpDescriptionValidator.__init__-45"><a href="#SpDescriptionValidator.__init__-45"><span class="linenos">45</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.__init__-46"><a href="#SpDescriptionValidator.__init__-46"><span class="linenos">46</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.__init__-47"><a href="#SpDescriptionValidator.__init__-47"><span class="linenos">47</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.__init__-48"><a href="#SpDescriptionValidator.__init__-48"><span class="linenos">48</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpDescriptionValidator.__init__-49"><a href="#SpDescriptionValidator.__init__-49"><span class="linenos">49</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.__init__-50"><a href="#SpDescriptionValidator.__init__-50"><span class="linenos">50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.__init__-51"><a href="#SpDescriptionValidator.__init__-51"><span class="linenos">51</span></a><span class="sd">        Initialize the Description validator.</span>
</span><span id="SpDescriptionValidator.__init__-52"><a href="#SpDescriptionValidator.__init__-52"><span class="linenos">52</span></a>
</span><span id="SpDescriptionValidator.__init__-53"><a href="#SpDescriptionValidator.__init__-53"><span class="linenos">53</span></a><span class="sd">        Args</span>
</span><span id="SpDescriptionValidator.__init__-54"><a href="#SpDescriptionValidator.__init__-54"><span class="linenos">54</span></a><span class="sd">        ----</span>
</span><span id="SpDescriptionValidator.__init__-55"><a href="#SpDescriptionValidator.__init__-55"><span class="linenos">55</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpDescriptionValidator.__init__-56"><a href="#SpDescriptionValidator.__init__-56"><span class="linenos">56</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpDescriptionValidator.__init__-57"><a href="#SpDescriptionValidator.__init__-57"><span class="linenos">57</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpDescriptionValidator.__init__-58"><a href="#SpDescriptionValidator.__init__-58"><span class="linenos">58</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpDescriptionValidator.__init__-59"><a href="#SpDescriptionValidator.__init__-59"><span class="linenos">59</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpDescriptionValidator.__init__-60"><a href="#SpDescriptionValidator.__init__-60"><span class="linenos">60</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpDescriptionValidator.__init__-61"><a href="#SpDescriptionValidator.__init__-61"><span class="linenos">61</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.__init__-62"><a href="#SpDescriptionValidator.__init__-62"><span class="linenos">62</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpDescriptionValidator.__init__-63"><a href="#SpDescriptionValidator.__init__-63"><span class="linenos">63</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.__init__-64"><a href="#SpDescriptionValidator.__init__-64"><span class="linenos">64</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.__init__-65"><a href="#SpDescriptionValidator.__init__-65"><span class="linenos">65</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpDescription</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.__init__-66"><a href="#SpDescriptionValidator.__init__-66"><span class="linenos">66</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.__init__-67"><a href="#SpDescriptionValidator.__init__-67"><span class="linenos">67</span></a>        <span class="p">)</span>
</span><span id="SpDescriptionValidator.__init__-68"><a href="#SpDescriptionValidator.__init__-68"><span class="linenos">68</span></a>
</span><span id="SpDescriptionValidator.__init__-69"><a href="#SpDescriptionValidator.__init__-69"><span class="linenos">69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Description validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_html_in_descriptions" class="classattr">
                                        <input id="SpDescriptionValidator.validate_html_in_descriptions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_html_in_descriptions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_html_in_descriptions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_html_in_descriptions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_html_in_descriptions-71"><a href="#SpDescriptionValidator.validate_html_in_descriptions-71"><span class="linenos">71</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_html_in_descriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-72"><a href="#SpDescriptionValidator.validate_html_in_descriptions-72"><span class="linenos">72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-73"><a href="#SpDescriptionValidator.validate_html_in_descriptions-73"><span class="linenos">73</span></a><span class="sd">        Validate that simple descriptions do not contain HTML tags.</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-74"><a href="#SpDescriptionValidator.validate_html_in_descriptions-74"><span class="linenos">74</span></a>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-75"><a href="#SpDescriptionValidator.validate_html_in_descriptions-75"><span class="linenos">75</span></a><span class="sd">        Checks the simple description column for HTML tag patterns (e.g., &lt;tag&gt;).</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-76"><a href="#SpDescriptionValidator.validate_html_in_descriptions-76"><span class="linenos">76</span></a><span class="sd">        HTML content is not allowed in descriptions as it may cause rendering issues.</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-77"><a href="#SpDescriptionValidator.validate_html_in_descriptions-77"><span class="linenos">77</span></a>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-78"><a href="#SpDescriptionValidator.validate_html_in_descriptions-78"><span class="linenos">78</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-79"><a href="#SpDescriptionValidator.validate_html_in_descriptions-79"><span class="linenos">79</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-80"><a href="#SpDescriptionValidator.validate_html_in_descriptions-80"><span class="linenos">80</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-81"><a href="#SpDescriptionValidator.validate_html_in_descriptions-81"><span class="linenos">81</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-82"><a href="#SpDescriptionValidator.validate_html_in_descriptions-82"><span class="linenos">82</span></a><span class="sd">                - List[str]: List of error messages (column missing error only)</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-83"><a href="#SpDescriptionValidator.validate_html_in_descriptions-83"><span class="linenos">83</span></a><span class="sd">                - List[str]: List of warning messages for rows containing HTML tags</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-84"><a href="#SpDescriptionValidator.validate_html_in_descriptions-84"><span class="linenos">84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-85"><a href="#SpDescriptionValidator.validate_html_in_descriptions-85"><span class="linenos">85</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-86"><a href="#SpDescriptionValidator.validate_html_in_descriptions-86"><span class="linenos">86</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-87"><a href="#SpDescriptionValidator.validate_html_in_descriptions-87"><span class="linenos">87</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-88"><a href="#SpDescriptionValidator.validate_html_in_descriptions-88"><span class="linenos">88</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-89"><a href="#SpDescriptionValidator.validate_html_in_descriptions-89"><span class="linenos">89</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-90"><a href="#SpDescriptionValidator.validate_html_in_descriptions-90"><span class="linenos">90</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-91"><a href="#SpDescriptionValidator.validate_html_in_descriptions-91"><span class="linenos">91</span></a>            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;&lt;.*?&gt;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">column</span><span class="p">])):</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-92"><a href="#SpDescriptionValidator.validate_html_in_descriptions-92"><span class="linenos">92</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-93"><a href="#SpDescriptionValidator.validate_html_in_descriptions-93"><span class="linenos">93</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: Coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; no pode conter cdigo HTML.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_html_in_descriptions-94"><a href="#SpDescriptionValidator.validate_html_in_descriptions-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate that simple descriptions do not contain HTML tags.</p>

<p>Checks the simple description column for HTML tag patterns (e.g., <tag>).
HTML content is not allowed in descriptions as it may cause rendering issues.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: List of error messages (column missing error only)
        - List[str]: List of warning messages for rows containing HTML tags</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_sequential_codes" class="classattr">
                                        <input id="SpDescriptionValidator.validate_sequential_codes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_sequential_codes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_sequential_codes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_sequential_codes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_sequential_codes-96"><a href="#SpDescriptionValidator.validate_sequential_codes-96"><span class="linenos"> 96</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_sequential_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-97"><a href="#SpDescriptionValidator.validate_sequential_codes-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-98"><a href="#SpDescriptionValidator.validate_sequential_codes-98"><span class="linenos"> 98</span></a><span class="sd">        Validate that indicator codes are sequential starting from 1.</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-99"><a href="#SpDescriptionValidator.validate_sequential_codes-99"><span class="linenos"> 99</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-100"><a href="#SpDescriptionValidator.validate_sequential_codes-100"><span class="linenos">100</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-101"><a href="#SpDescriptionValidator.validate_sequential_codes-101"><span class="linenos">101</span></a><span class="sd">        - All codes are numeric integers</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-102"><a href="#SpDescriptionValidator.validate_sequential_codes-102"><span class="linenos">102</span></a><span class="sd">        - The first code is 1</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-103"><a href="#SpDescriptionValidator.validate_sequential_codes-103"><span class="linenos">103</span></a><span class="sd">        - Codes follow a sequential pattern (1, 2, 3, ...)</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-104"><a href="#SpDescriptionValidator.validate_sequential_codes-104"><span class="linenos">104</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-105"><a href="#SpDescriptionValidator.validate_sequential_codes-105"><span class="linenos">105</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-106"><a href="#SpDescriptionValidator.validate_sequential_codes-106"><span class="linenos">106</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-107"><a href="#SpDescriptionValidator.validate_sequential_codes-107"><span class="linenos">107</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-108"><a href="#SpDescriptionValidator.validate_sequential_codes-108"><span class="linenos">108</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-109"><a href="#SpDescriptionValidator.validate_sequential_codes-109"><span class="linenos">109</span></a><span class="sd">                - List[str]: List of error messages for validation failures</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-110"><a href="#SpDescriptionValidator.validate_sequential_codes-110"><span class="linenos">110</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-111"><a href="#SpDescriptionValidator.validate_sequential_codes-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-112"><a href="#SpDescriptionValidator.validate_sequential_codes-112"><span class="linenos">112</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-113"><a href="#SpDescriptionValidator.validate_sequential_codes-113"><span class="linenos">113</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-114"><a href="#SpDescriptionValidator.validate_sequential_codes-114"><span class="linenos">114</span></a>        <span class="c1"># 0. Check if the column exists</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-115"><a href="#SpDescriptionValidator.validate_sequential_codes-115"><span class="linenos">115</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-116"><a href="#SpDescriptionValidator.validate_sequential_codes-116"><span class="linenos">116</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-117"><a href="#SpDescriptionValidator.validate_sequential_codes-117"><span class="linenos">117</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-118"><a href="#SpDescriptionValidator.validate_sequential_codes-118"><span class="linenos">118</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-119"><a href="#SpDescriptionValidator.validate_sequential_codes-119"><span class="linenos">119</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-120"><a href="#SpDescriptionValidator.validate_sequential_codes-120"><span class="linenos">120</span></a>        <span class="c1"># Load the original codes and cleaned codes</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-121"><a href="#SpDescriptionValidator.validate_sequential_codes-121"><span class="linenos">121</span></a>        <span class="n">original_codes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-122"><a href="#SpDescriptionValidator.validate_sequential_codes-122"><span class="linenos">122</span></a>        <span class="n">codes_cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-123"><a href="#SpDescriptionValidator.validate_sequential_codes-123"><span class="linenos">123</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-124"><a href="#SpDescriptionValidator.validate_sequential_codes-124"><span class="linenos">124</span></a>        <span class="c1"># 1. Check if the column has only integers</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-125"><a href="#SpDescriptionValidator.validate_sequential_codes-125"><span class="linenos">125</span></a>        <span class="k">if</span> <span class="n">original_codes</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">codes_cleaned</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-126"><a href="#SpDescriptionValidator.validate_sequential_codes-126"><span class="linenos">126</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A verificao foi abortada porque a coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; contm valores no numricos.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-127"><a href="#SpDescriptionValidator.validate_sequential_codes-127"><span class="linenos">127</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-128"><a href="#SpDescriptionValidator.validate_sequential_codes-128"><span class="linenos">128</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-129"><a href="#SpDescriptionValidator.validate_sequential_codes-129"><span class="linenos">129</span></a>        <span class="c1"># 2. Check if the first code is 1</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-130"><a href="#SpDescriptionValidator.validate_sequential_codes-130"><span class="linenos">130</span></a>        <span class="k">if</span> <span class="n">codes_cleaned</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-131"><a href="#SpDescriptionValidator.validate_sequential_codes-131"><span class="linenos">131</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; deve comear em 1.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-132"><a href="#SpDescriptionValidator.validate_sequential_codes-132"><span class="linenos">132</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-133"><a href="#SpDescriptionValidator.validate_sequential_codes-133"><span class="linenos">133</span></a>        <span class="c1"># 3. Check if the codes are sequential and starting from 1</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-134"><a href="#SpDescriptionValidator.validate_sequential_codes-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">codes_cleaned</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes_cleaned</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-135"><a href="#SpDescriptionValidator.validate_sequential_codes-135"><span class="linenos">135</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; deve conter valores inteiros e sequenciais (1, 2, 3, ...).&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_sequential_codes-136"><a href="#SpDescriptionValidator.validate_sequential_codes-136"><span class="linenos">136</span></a>
</span><span id="SpDescriptionValidator.validate_sequential_codes-137"><a href="#SpDescriptionValidator.validate_sequential_codes-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Validate that indicator codes are sequential starting from 1.</p>

<p>Ensures that:</p>

<ul>
<li>All codes are numeric integers</li>
<li>The first code is 1</li>
<li>Codes follow a sequential pattern (1, 2, 3, ...)</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: List of error messages for validation failures
        - List[str]: Empty list (no warnings generated)</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_unique_codes" class="classattr">
                                        <input id="SpDescriptionValidator.validate_unique_codes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_unique_codes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_unique_codes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_unique_codes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_unique_codes-139"><a href="#SpDescriptionValidator.validate_unique_codes-139"><span class="linenos">139</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-140"><a href="#SpDescriptionValidator.validate_unique_codes-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-141"><a href="#SpDescriptionValidator.validate_unique_codes-141"><span class="linenos">141</span></a><span class="sd">        Validate that all indicator codes are unique.</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-142"><a href="#SpDescriptionValidator.validate_unique_codes-142"><span class="linenos">142</span></a>
</span><span id="SpDescriptionValidator.validate_unique_codes-143"><a href="#SpDescriptionValidator.validate_unique_codes-143"><span class="linenos">143</span></a><span class="sd">        Checks for duplicate code values in the code column and reports any</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-144"><a href="#SpDescriptionValidator.validate_unique_codes-144"><span class="linenos">144</span></a><span class="sd">        duplicates found.</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-145"><a href="#SpDescriptionValidator.validate_unique_codes-145"><span class="linenos">145</span></a>
</span><span id="SpDescriptionValidator.validate_unique_codes-146"><a href="#SpDescriptionValidator.validate_unique_codes-146"><span class="linenos">146</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-147"><a href="#SpDescriptionValidator.validate_unique_codes-147"><span class="linenos">147</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-148"><a href="#SpDescriptionValidator.validate_unique_codes-148"><span class="linenos">148</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-149"><a href="#SpDescriptionValidator.validate_unique_codes-149"><span class="linenos">149</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-150"><a href="#SpDescriptionValidator.validate_unique_codes-150"><span class="linenos">150</span></a><span class="sd">                - List[str]: List of error messages listing duplicate codes</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-151"><a href="#SpDescriptionValidator.validate_unique_codes-151"><span class="linenos">151</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-152"><a href="#SpDescriptionValidator.validate_unique_codes-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-153"><a href="#SpDescriptionValidator.validate_unique_codes-153"><span class="linenos">153</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-154"><a href="#SpDescriptionValidator.validate_unique_codes-154"><span class="linenos">154</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-155"><a href="#SpDescriptionValidator.validate_unique_codes-155"><span class="linenos">155</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-156"><a href="#SpDescriptionValidator.validate_unique_codes-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-157"><a href="#SpDescriptionValidator.validate_unique_codes-157"><span class="linenos">157</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-158"><a href="#SpDescriptionValidator.validate_unique_codes-158"><span class="linenos">158</span></a>
</span><span id="SpDescriptionValidator.validate_unique_codes-159"><a href="#SpDescriptionValidator.validate_unique_codes-159"><span class="linenos">159</span></a>        <span class="n">codes_cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-160"><a href="#SpDescriptionValidator.validate_unique_codes-160"><span class="linenos">160</span></a>        <span class="n">duplicated_codes</span> <span class="o">=</span> <span class="n">codes_cleaned</span><span class="p">[</span><span class="n">codes_cleaned</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-161"><a href="#SpDescriptionValidator.validate_unique_codes-161"><span class="linenos">161</span></a>
</span><span id="SpDescriptionValidator.validate_unique_codes-162"><a href="#SpDescriptionValidator.validate_unique_codes-162"><span class="linenos">162</span></a>        <span class="k">if</span> <span class="n">duplicated_codes</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-163"><a href="#SpDescriptionValidator.validate_unique_codes-163"><span class="linenos">163</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; contm cdigos duplicados: </span><span class="si">{</span><span class="n">duplicated_codes</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_unique_codes-164"><a href="#SpDescriptionValidator.validate_unique_codes-164"><span class="linenos">164</span></a>
</span><span id="SpDescriptionValidator.validate_unique_codes-165"><a href="#SpDescriptionValidator.validate_unique_codes-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Validate that all indicator codes are unique.</p>

<p>Checks for duplicate code values in the code column and reports any
duplicates found.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: List of error messages listing duplicate codes
        - List[str]: Empty list (no warnings generated)</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_text_capitalization" class="classattr">
                                        <input id="SpDescriptionValidator.validate_text_capitalization-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_text_capitalization</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_text_capitalization-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_text_capitalization"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_text_capitalization-167"><a href="#SpDescriptionValidator.validate_text_capitalization-167"><span class="linenos">167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_text_capitalization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-168"><a href="#SpDescriptionValidator.validate_text_capitalization-168"><span class="linenos">168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-169"><a href="#SpDescriptionValidator.validate_text_capitalization-169"><span class="linenos">169</span></a><span class="sd">        Validate text capitalization in name columns.</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-170"><a href="#SpDescriptionValidator.validate_text_capitalization-170"><span class="linenos">170</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-171"><a href="#SpDescriptionValidator.validate_text_capitalization-171"><span class="linenos">171</span></a><span class="sd">        Checks that simple and complete name columns follow proper capitalization</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-172"><a href="#SpDescriptionValidator.validate_text_capitalization-172"><span class="linenos">172</span></a><span class="sd">        standards while preserving acronyms. Also detects special characters like</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-173"><a href="#SpDescriptionValidator.validate_text_capitalization-173"><span class="linenos">173</span></a><span class="sd">        CR, LF, and extra spaces that should not be present.</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-174"><a href="#SpDescriptionValidator.validate_text_capitalization-174"><span class="linenos">174</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-175"><a href="#SpDescriptionValidator.validate_text_capitalization-175"><span class="linenos">175</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-176"><a href="#SpDescriptionValidator.validate_text_capitalization-176"><span class="linenos">176</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-177"><a href="#SpDescriptionValidator.validate_text_capitalization-177"><span class="linenos">177</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-178"><a href="#SpDescriptionValidator.validate_text_capitalization-178"><span class="linenos">178</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-179"><a href="#SpDescriptionValidator.validate_text_capitalization-179"><span class="linenos">179</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-180"><a href="#SpDescriptionValidator.validate_text_capitalization-180"><span class="linenos">180</span></a><span class="sd">                - List[str]: List of warning messages for capitalization issues</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-181"><a href="#SpDescriptionValidator.validate_text_capitalization-181"><span class="linenos">181</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-182"><a href="#SpDescriptionValidator.validate_text_capitalization-182"><span class="linenos">182</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-183"><a href="#SpDescriptionValidator.validate_text_capitalization-183"><span class="linenos">183</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-184"><a href="#SpDescriptionValidator.validate_text_capitalization-184"><span class="linenos">184</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-185"><a href="#SpDescriptionValidator.validate_text_capitalization-185"><span class="linenos">185</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-186"><a href="#SpDescriptionValidator.validate_text_capitalization-186"><span class="linenos">186</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-187"><a href="#SpDescriptionValidator.validate_text_capitalization-187"><span class="linenos">187</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-188"><a href="#SpDescriptionValidator.validate_text_capitalization-188"><span class="linenos">188</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-189"><a href="#SpDescriptionValidator.validate_text_capitalization-189"><span class="linenos">189</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-190"><a href="#SpDescriptionValidator.validate_text_capitalization-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-191"><a href="#SpDescriptionValidator.validate_text_capitalization-191"><span class="linenos">191</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-192"><a href="#SpDescriptionValidator.validate_text_capitalization-192"><span class="linenos">192</span></a>                <span class="k">continue</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-193"><a href="#SpDescriptionValidator.validate_text_capitalization-193"><span class="linenos">193</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-194"><a href="#SpDescriptionValidator.validate_text_capitalization-194"><span class="linenos">194</span></a>            <span class="c1"># Filter non-empty values</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-195"><a href="#SpDescriptionValidator.validate_text_capitalization-195"><span class="linenos">195</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-196"><a href="#SpDescriptionValidator.validate_text_capitalization-196"><span class="linenos">196</span></a>            <span class="n">filtered_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-197"><a href="#SpDescriptionValidator.validate_text_capitalization-197"><span class="linenos">197</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-198"><a href="#SpDescriptionValidator.validate_text_capitalization-198"><span class="linenos">198</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-199"><a href="#SpDescriptionValidator.validate_text_capitalization-199"><span class="linenos">199</span></a>                <span class="c1"># Process original text with all replacements</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-200"><a href="#SpDescriptionValidator.validate_text_capitalization-200"><span class="linenos">200</span></a>                <span class="n">original_series</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-201"><a href="#SpDescriptionValidator.validate_text_capitalization-201"><span class="linenos">201</span></a>                    <span class="n">filtered_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-202"><a href="#SpDescriptionValidator.validate_text_capitalization-202"><span class="linenos">202</span></a>                    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-203"><a href="#SpDescriptionValidator.validate_text_capitalization-203"><span class="linenos">203</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; (EXTRA_SPACE)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-204"><a href="#SpDescriptionValidator.validate_text_capitalization-204"><span class="linenos">204</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(CR)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-205"><a href="#SpDescriptionValidator.validate_text_capitalization-205"><span class="linenos">205</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(LF)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-206"><a href="#SpDescriptionValidator.validate_text_capitalization-206"><span class="linenos">206</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(CR)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-207"><a href="#SpDescriptionValidator.validate_text_capitalization-207"><span class="linenos">207</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0a</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(LF)&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-208"><a href="#SpDescriptionValidator.validate_text_capitalization-208"><span class="linenos">208</span></a>                <span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-209"><a href="#SpDescriptionValidator.validate_text_capitalization-209"><span class="linenos">209</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-210"><a href="#SpDescriptionValidator.validate_text_capitalization-210"><span class="linenos">210</span></a>                <span class="c1"># Process expected correct text with all replacements and capitalization</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-211"><a href="#SpDescriptionValidator.validate_text_capitalization-211"><span class="linenos">211</span></a>                <span class="n">expected_series</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-212"><a href="#SpDescriptionValidator.validate_text_capitalization-212"><span class="linenos">212</span></a>                    <span class="n">filtered_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-213"><a href="#SpDescriptionValidator.validate_text_capitalization-213"><span class="linenos">213</span></a>                    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-214"><a href="#SpDescriptionValidator.validate_text_capitalization-214"><span class="linenos">214</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-215"><a href="#SpDescriptionValidator.validate_text_capitalization-215"><span class="linenos">215</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-216"><a href="#SpDescriptionValidator.validate_text_capitalization-216"><span class="linenos">216</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-217"><a href="#SpDescriptionValidator.validate_text_capitalization-217"><span class="linenos">217</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0a</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-218"><a href="#SpDescriptionValidator.validate_text_capitalization-218"><span class="linenos">218</span></a>                    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-219"><a href="#SpDescriptionValidator.validate_text_capitalization-219"><span class="linenos">219</span></a>                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TextFormattingProcessing</span><span class="o">.</span><span class="n">capitalize_text_keep_acronyms</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-220"><a href="#SpDescriptionValidator.validate_text_capitalization-220"><span class="linenos">220</span></a>                <span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-221"><a href="#SpDescriptionValidator.validate_text_capitalization-221"><span class="linenos">221</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-222"><a href="#SpDescriptionValidator.validate_text_capitalization-222"><span class="linenos">222</span></a>                <span class="c1"># Find mismatches</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-223"><a href="#SpDescriptionValidator.validate_text_capitalization-223"><span class="linenos">223</span></a>                <span class="n">mismatches_mask</span> <span class="o">=</span> <span class="n">original_series</span> <span class="o">!=</span> <span class="n">expected_series</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-224"><a href="#SpDescriptionValidator.validate_text_capitalization-224"><span class="linenos">224</span></a>                <span class="n">mismatches_indices</span> <span class="o">=</span> <span class="n">original_series</span><span class="p">[</span><span class="n">mismatches_mask</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-225"><a href="#SpDescriptionValidator.validate_text_capitalization-225"><span class="linenos">225</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-226"><a href="#SpDescriptionValidator.validate_text_capitalization-226"><span class="linenos">226</span></a>                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">mismatches_indices</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-227"><a href="#SpDescriptionValidator.validate_text_capitalization-227"><span class="linenos">227</span></a>                    <span class="n">original_text</span> <span class="o">=</span> <span class="n">original_series</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-228"><a href="#SpDescriptionValidator.validate_text_capitalization-228"><span class="linenos">228</span></a>                    <span class="n">expected_text</span> <span class="o">=</span> <span class="n">expected_series</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-229"><a href="#SpDescriptionValidator.validate_text_capitalization-229"><span class="linenos">229</span></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-230"><a href="#SpDescriptionValidator.validate_text_capitalization-230"><span class="linenos">230</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: Valor da coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; fora do padro. Esperado: &#39;</span><span class="si">{</span><span class="n">expected_text</span><span class="si">}</span><span class="s2">&#39;. Encontrado: &#39;</span><span class="si">{</span><span class="n">original_text</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-231"><a href="#SpDescriptionValidator.validate_text_capitalization-231"><span class="linenos">231</span></a>                    <span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_text_capitalization-232"><a href="#SpDescriptionValidator.validate_text_capitalization-232"><span class="linenos">232</span></a>
</span><span id="SpDescriptionValidator.validate_text_capitalization-233"><a href="#SpDescriptionValidator.validate_text_capitalization-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate text capitalization in name columns.</p>

<p>Checks that simple and complete name columns follow proper capitalization
standards while preserving acronyms. Also detects special characters like
CR, LF, and extra spaces that should not be present.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors generated)
        - List[str]: List of warning messages for capitalization issues</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_indicator_levels" class="classattr">
                                        <input id="SpDescriptionValidator.validate_indicator_levels-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_indicator_levels</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_indicator_levels-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_indicator_levels"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_indicator_levels-235"><a href="#SpDescriptionValidator.validate_indicator_levels-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_indicator_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-236"><a href="#SpDescriptionValidator.validate_indicator_levels-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-237"><a href="#SpDescriptionValidator.validate_indicator_levels-237"><span class="linenos">237</span></a><span class="sd">        Validate indicator level values.</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-238"><a href="#SpDescriptionValidator.validate_indicator_levels-238"><span class="linenos">238</span></a>
</span><span id="SpDescriptionValidator.validate_indicator_levels-239"><a href="#SpDescriptionValidator.validate_indicator_levels-239"><span class="linenos">239</span></a><span class="sd">        Ensures that all indicator levels in the level column are positive integers</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-240"><a href="#SpDescriptionValidator.validate_indicator_levels-240"><span class="linenos">240</span></a><span class="sd">        greater than zero.</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-241"><a href="#SpDescriptionValidator.validate_indicator_levels-241"><span class="linenos">241</span></a>
</span><span id="SpDescriptionValidator.validate_indicator_levels-242"><a href="#SpDescriptionValidator.validate_indicator_levels-242"><span class="linenos">242</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-243"><a href="#SpDescriptionValidator.validate_indicator_levels-243"><span class="linenos">243</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-244"><a href="#SpDescriptionValidator.validate_indicator_levels-244"><span class="linenos">244</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-245"><a href="#SpDescriptionValidator.validate_indicator_levels-245"><span class="linenos">245</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-246"><a href="#SpDescriptionValidator.validate_indicator_levels-246"><span class="linenos">246</span></a><span class="sd">                - List[str]: List of error messages for invalid levels</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-247"><a href="#SpDescriptionValidator.validate_indicator_levels-247"><span class="linenos">247</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-248"><a href="#SpDescriptionValidator.validate_indicator_levels-248"><span class="linenos">248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-249"><a href="#SpDescriptionValidator.validate_indicator_levels-249"><span class="linenos">249</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-250"><a href="#SpDescriptionValidator.validate_indicator_levels-250"><span class="linenos">250</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-251"><a href="#SpDescriptionValidator.validate_indicator_levels-251"><span class="linenos">251</span></a>        <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-252"><a href="#SpDescriptionValidator.validate_indicator_levels-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-253"><a href="#SpDescriptionValidator.validate_indicator_levels-253"><span class="linenos">253</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">msg_error_column</span><span class="p">],</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-254"><a href="#SpDescriptionValidator.validate_indicator_levels-254"><span class="linenos">254</span></a>
</span><span id="SpDescriptionValidator.validate_indicator_levels-255"><a href="#SpDescriptionValidator.validate_indicator_levels-255"><span class="linenos">255</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-256"><a href="#SpDescriptionValidator.validate_indicator_levels-256"><span class="linenos">256</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-257"><a href="#SpDescriptionValidator.validate_indicator_levels-257"><span class="linenos">257</span></a>            <span class="n">is_valid</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">NumberFormattingProcessing</span><span class="o">.</span><span class="n">check_cell_integer</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-258"><a href="#SpDescriptionValidator.validate_indicator_levels-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-259"><a href="#SpDescriptionValidator.validate_indicator_levels-259"><span class="linenos">259</span></a>                <span class="n">line_updated</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-260"><a href="#SpDescriptionValidator.validate_indicator_levels-260"><span class="linenos">260</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-261"><a href="#SpDescriptionValidator.validate_indicator_levels-261"><span class="linenos">261</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">line_updated</span><span class="si">}</span><span class="s2">: O nvel do indicador na coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; deve ser um nmero inteiro maior que 0.&quot;</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-262"><a href="#SpDescriptionValidator.validate_indicator_levels-262"><span class="linenos">262</span></a>                <span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_indicator_levels-263"><a href="#SpDescriptionValidator.validate_indicator_levels-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Validate indicator level values.</p>

<p>Ensures that all indicator levels in the level column are positive integers
greater than zero.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: List of error messages for invalid levels
        - List[str]: Empty list (no warnings generated)</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_punctuation" class="classattr">
                                        <input id="SpDescriptionValidator.validate_punctuation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_punctuation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_punctuation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_punctuation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_punctuation-265"><a href="#SpDescriptionValidator.validate_punctuation-265"><span class="linenos">265</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_punctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_punctuation-266"><a href="#SpDescriptionValidator.validate_punctuation-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_punctuation-267"><a href="#SpDescriptionValidator.validate_punctuation-267"><span class="linenos">267</span></a><span class="sd">        Validate punctuation rules in name and description columns.</span>
</span><span id="SpDescriptionValidator.validate_punctuation-268"><a href="#SpDescriptionValidator.validate_punctuation-268"><span class="linenos">268</span></a>
</span><span id="SpDescriptionValidator.validate_punctuation-269"><a href="#SpDescriptionValidator.validate_punctuation-269"><span class="linenos">269</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpDescriptionValidator.validate_punctuation-270"><a href="#SpDescriptionValidator.validate_punctuation-270"><span class="linenos">270</span></a><span class="sd">        - Name columns do not end with punctuation</span>
</span><span id="SpDescriptionValidator.validate_punctuation-271"><a href="#SpDescriptionValidator.validate_punctuation-271"><span class="linenos">271</span></a><span class="sd">        - Description columns end with a period</span>
</span><span id="SpDescriptionValidator.validate_punctuation-272"><a href="#SpDescriptionValidator.validate_punctuation-272"><span class="linenos">272</span></a>
</span><span id="SpDescriptionValidator.validate_punctuation-273"><a href="#SpDescriptionValidator.validate_punctuation-273"><span class="linenos">273</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_punctuation-274"><a href="#SpDescriptionValidator.validate_punctuation-274"><span class="linenos">274</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_punctuation-275"><a href="#SpDescriptionValidator.validate_punctuation-275"><span class="linenos">275</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_punctuation-276"><a href="#SpDescriptionValidator.validate_punctuation-276"><span class="linenos">276</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_punctuation-277"><a href="#SpDescriptionValidator.validate_punctuation-277"><span class="linenos">277</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator.validate_punctuation-278"><a href="#SpDescriptionValidator.validate_punctuation-278"><span class="linenos">278</span></a><span class="sd">                - List[str]: List of warning messages for punctuation violations</span>
</span><span id="SpDescriptionValidator.validate_punctuation-279"><a href="#SpDescriptionValidator.validate_punctuation-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_punctuation-280"><a href="#SpDescriptionValidator.validate_punctuation-280"><span class="linenos">280</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_punctuation-281"><a href="#SpDescriptionValidator.validate_punctuation-281"><span class="linenos">281</span></a>        <span class="n">columns_dont_punctuation</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator.validate_punctuation-282"><a href="#SpDescriptionValidator.validate_punctuation-282"><span class="linenos">282</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-283"><a href="#SpDescriptionValidator.validate_punctuation-283"><span class="linenos">283</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-284"><a href="#SpDescriptionValidator.validate_punctuation-284"><span class="linenos">284</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_punctuation-285"><a href="#SpDescriptionValidator.validate_punctuation-285"><span class="linenos">285</span></a>        <span class="n">columns_must_end_with_dot</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator.validate_punctuation-286"><a href="#SpDescriptionValidator.validate_punctuation-286"><span class="linenos">286</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-287"><a href="#SpDescriptionValidator.validate_punctuation-287"><span class="linenos">287</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-288"><a href="#SpDescriptionValidator.validate_punctuation-288"><span class="linenos">288</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_punctuation-289"><a href="#SpDescriptionValidator.validate_punctuation-289"><span class="linenos">289</span></a>
</span><span id="SpDescriptionValidator.validate_punctuation-290"><a href="#SpDescriptionValidator.validate_punctuation-290"><span class="linenos">290</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns_dont_punctuation</span> <span class="o">+</span> <span class="n">columns_must_end_with_dot</span><span class="p">):</span>
</span><span id="SpDescriptionValidator.validate_punctuation-291"><a href="#SpDescriptionValidator.validate_punctuation-291"><span class="linenos">291</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_punctuation-292"><a href="#SpDescriptionValidator.validate_punctuation-292"><span class="linenos">292</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_punctuation-293"><a href="#SpDescriptionValidator.validate_punctuation-293"><span class="linenos">293</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_punctuation-294"><a href="#SpDescriptionValidator.validate_punctuation-294"><span class="linenos">294</span></a>
</span><span id="SpDescriptionValidator.validate_punctuation-295"><a href="#SpDescriptionValidator.validate_punctuation-295"><span class="linenos">295</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">punctuation_warnings</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_characters_punctuation_rules</span><span class="p">(</span>
</span><span id="SpDescriptionValidator.validate_punctuation-296"><a href="#SpDescriptionValidator.validate_punctuation-296"><span class="linenos">296</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-297"><a href="#SpDescriptionValidator.validate_punctuation-297"><span class="linenos">297</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-298"><a href="#SpDescriptionValidator.validate_punctuation-298"><span class="linenos">298</span></a>            <span class="n">columns_dont_punctuation</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-299"><a href="#SpDescriptionValidator.validate_punctuation-299"><span class="linenos">299</span></a>            <span class="n">columns_must_end_with_dot</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_punctuation-300"><a href="#SpDescriptionValidator.validate_punctuation-300"><span class="linenos">300</span></a>        <span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_punctuation-301"><a href="#SpDescriptionValidator.validate_punctuation-301"><span class="linenos">301</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">punctuation_warnings</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_punctuation-302"><a href="#SpDescriptionValidator.validate_punctuation-302"><span class="linenos">302</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate punctuation rules in name and description columns.</p>

<p>Ensures that:</p>

<ul>
<li>Name columns do not end with punctuation</li>
<li>Description columns end with a period</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors generated)
        - List[str]: List of warning messages for punctuation violations</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_empty_strings" class="classattr">
                                        <input id="SpDescriptionValidator.validate_empty_strings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_empty_strings</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_empty_strings-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_empty_strings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_empty_strings-304"><a href="#SpDescriptionValidator.validate_empty_strings-304"><span class="linenos">304</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_empty_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-305"><a href="#SpDescriptionValidator.validate_empty_strings-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-306"><a href="#SpDescriptionValidator.validate_empty_strings-306"><span class="linenos">306</span></a><span class="sd">        Validate that required text columns do not contain empty values.</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-307"><a href="#SpDescriptionValidator.validate_empty_strings-307"><span class="linenos">307</span></a>
</span><span id="SpDescriptionValidator.validate_empty_strings-308"><a href="#SpDescriptionValidator.validate_empty_strings-308"><span class="linenos">308</span></a><span class="sd">        Checks that name and description columns contain non-empty, non-null values</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-309"><a href="#SpDescriptionValidator.validate_empty_strings-309"><span class="linenos">309</span></a><span class="sd">        in all rows.</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-310"><a href="#SpDescriptionValidator.validate_empty_strings-310"><span class="linenos">310</span></a>
</span><span id="SpDescriptionValidator.validate_empty_strings-311"><a href="#SpDescriptionValidator.validate_empty_strings-311"><span class="linenos">311</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-312"><a href="#SpDescriptionValidator.validate_empty_strings-312"><span class="linenos">312</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-313"><a href="#SpDescriptionValidator.validate_empty_strings-313"><span class="linenos">313</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-314"><a href="#SpDescriptionValidator.validate_empty_strings-314"><span class="linenos">314</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-315"><a href="#SpDescriptionValidator.validate_empty_strings-315"><span class="linenos">315</span></a><span class="sd">                - List[str]: List of error messages for empty values</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-316"><a href="#SpDescriptionValidator.validate_empty_strings-316"><span class="linenos">316</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-317"><a href="#SpDescriptionValidator.validate_empty_strings-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-318"><a href="#SpDescriptionValidator.validate_empty_strings-318"><span class="linenos">318</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-319"><a href="#SpDescriptionValidator.validate_empty_strings-319"><span class="linenos">319</span></a>
</span><span id="SpDescriptionValidator.validate_empty_strings-320"><a href="#SpDescriptionValidator.validate_empty_strings-320"><span class="linenos">320</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-321"><a href="#SpDescriptionValidator.validate_empty_strings-321"><span class="linenos">321</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-322"><a href="#SpDescriptionValidator.validate_empty_strings-322"><span class="linenos">322</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-323"><a href="#SpDescriptionValidator.validate_empty_strings-323"><span class="linenos">323</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-324"><a href="#SpDescriptionValidator.validate_empty_strings-324"><span class="linenos">324</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-325"><a href="#SpDescriptionValidator.validate_empty_strings-325"><span class="linenos">325</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-326"><a href="#SpDescriptionValidator.validate_empty_strings-326"><span class="linenos">326</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-327"><a href="#SpDescriptionValidator.validate_empty_strings-327"><span class="linenos">327</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-328"><a href="#SpDescriptionValidator.validate_empty_strings-328"><span class="linenos">328</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-329"><a href="#SpDescriptionValidator.validate_empty_strings-329"><span class="linenos">329</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-330"><a href="#SpDescriptionValidator.validate_empty_strings-330"><span class="linenos">330</span></a>                <span class="k">continue</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-331"><a href="#SpDescriptionValidator.validate_empty_strings-331"><span class="linenos">331</span></a>            <span class="n">empty_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-332"><a href="#SpDescriptionValidator.validate_empty_strings-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_rows</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-333"><a href="#SpDescriptionValidator.validate_empty_strings-333"><span class="linenos">333</span></a>                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">empty_rows</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-334"><a href="#SpDescriptionValidator.validate_empty_strings-334"><span class="linenos">334</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: Nenhum item da coluna &#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&#39; pode ser vazio.&quot;</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_empty_strings-335"><a href="#SpDescriptionValidator.validate_empty_strings-335"><span class="linenos">335</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Validate that required text columns do not contain empty values.</p>

<p>Checks that name and description columns contain non-empty, non-null values
in all rows.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: List of error messages for empty values
        - List[str]: Empty list (no warnings generated)</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_cr_lf_characters" class="classattr">
                                        <input id="SpDescriptionValidator.validate_cr_lf_characters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_cr_lf_characters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_cr_lf_characters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_cr_lf_characters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_cr_lf_characters-337"><a href="#SpDescriptionValidator.validate_cr_lf_characters-337"><span class="linenos">337</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_cr_lf_characters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-338"><a href="#SpDescriptionValidator.validate_cr_lf_characters-338"><span class="linenos">338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-339"><a href="#SpDescriptionValidator.validate_cr_lf_characters-339"><span class="linenos">339</span></a><span class="sd">        Validate special CR/LF characters in text columns.</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-340"><a href="#SpDescriptionValidator.validate_cr_lf_characters-340"><span class="linenos">340</span></a>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-341"><a href="#SpDescriptionValidator.validate_cr_lf_characters-341"><span class="linenos">341</span></a><span class="sd">        Checks for carriage return (CR) and line feed (LF) characters that should not</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-342"><a href="#SpDescriptionValidator.validate_cr_lf_characters-342"><span class="linenos">342</span></a><span class="sd">        appear at the start/end of columns or anywhere in name columns.</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-343"><a href="#SpDescriptionValidator.validate_cr_lf_characters-343"><span class="linenos">343</span></a>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-344"><a href="#SpDescriptionValidator.validate_cr_lf_characters-344"><span class="linenos">344</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-345"><a href="#SpDescriptionValidator.validate_cr_lf_characters-345"><span class="linenos">345</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-346"><a href="#SpDescriptionValidator.validate_cr_lf_characters-346"><span class="linenos">346</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-347"><a href="#SpDescriptionValidator.validate_cr_lf_characters-347"><span class="linenos">347</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-348"><a href="#SpDescriptionValidator.validate_cr_lf_characters-348"><span class="linenos">348</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-349"><a href="#SpDescriptionValidator.validate_cr_lf_characters-349"><span class="linenos">349</span></a><span class="sd">                - List[str]: List of warning messages for CR/LF violations</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-350"><a href="#SpDescriptionValidator.validate_cr_lf_characters-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-351"><a href="#SpDescriptionValidator.validate_cr_lf_characters-351"><span class="linenos">351</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-352"><a href="#SpDescriptionValidator.validate_cr_lf_characters-352"><span class="linenos">352</span></a>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-353"><a href="#SpDescriptionValidator.validate_cr_lf_characters-353"><span class="linenos">353</span></a>        <span class="n">columns_start_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">EXPECTED_COLUMNS</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-354"><a href="#SpDescriptionValidator.validate_cr_lf_characters-354"><span class="linenos">354</span></a>        <span class="n">columns_anywhere</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-355"><a href="#SpDescriptionValidator.validate_cr_lf_characters-355"><span class="linenos">355</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-356"><a href="#SpDescriptionValidator.validate_cr_lf_characters-356"><span class="linenos">356</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-357"><a href="#SpDescriptionValidator.validate_cr_lf_characters-357"><span class="linenos">357</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-358"><a href="#SpDescriptionValidator.validate_cr_lf_characters-358"><span class="linenos">358</span></a>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-359"><a href="#SpDescriptionValidator.validate_cr_lf_characters-359"><span class="linenos">359</span></a>        <span class="c1"># Create an ordered dictionary with the columns</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-360"><a href="#SpDescriptionValidator.validate_cr_lf_characters-360"><span class="linenos">360</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">OrderedDict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">columns_anywhere</span> <span class="o">+</span> <span class="n">columns_start_end</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-361"><a href="#SpDescriptionValidator.validate_cr_lf_characters-361"><span class="linenos">361</span></a>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-362"><a href="#SpDescriptionValidator.validate_cr_lf_characters-362"><span class="linenos">362</span></a>        <span class="c1"># Check if the columns exist</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-363"><a href="#SpDescriptionValidator.validate_cr_lf_characters-363"><span class="linenos">363</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-364"><a href="#SpDescriptionValidator.validate_cr_lf_characters-364"><span class="linenos">364</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-365"><a href="#SpDescriptionValidator.validate_cr_lf_characters-365"><span class="linenos">365</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-366"><a href="#SpDescriptionValidator.validate_cr_lf_characters-366"><span class="linenos">366</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-367"><a href="#SpDescriptionValidator.validate_cr_lf_characters-367"><span class="linenos">367</span></a>                <span class="k">continue</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-368"><a href="#SpDescriptionValidator.validate_cr_lf_characters-368"><span class="linenos">368</span></a>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-369"><a href="#SpDescriptionValidator.validate_cr_lf_characters-369"><span class="linenos">369</span></a>        <span class="c1"># Run the checks for CR/LF characters</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-370"><a href="#SpDescriptionValidator.validate_cr_lf_characters-370"><span class="linenos">370</span></a>        <span class="n">__</span><span class="p">,</span> <span class="n">all_warnings_cr_lf</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_special_characters_cr_lf</span><span class="p">(</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-371"><a href="#SpDescriptionValidator.validate_cr_lf_characters-371"><span class="linenos">371</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span> <span class="n">columns_start_end</span><span class="p">,</span> <span class="n">columns_anywhere</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-372"><a href="#SpDescriptionValidator.validate_cr_lf_characters-372"><span class="linenos">372</span></a>        <span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-373"><a href="#SpDescriptionValidator.validate_cr_lf_characters-373"><span class="linenos">373</span></a>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-374"><a href="#SpDescriptionValidator.validate_cr_lf_characters-374"><span class="linenos">374</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">all_warnings_cr_lf</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.validate_cr_lf_characters-375"><a href="#SpDescriptionValidator.validate_cr_lf_characters-375"><span class="linenos">375</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate special CR/LF characters in text columns.</p>

<p>Checks for carriage return (CR) and line feed (LF) characters that should not
appear at the start/end of columns or anywhere in name columns.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors generated)
        - List[str]: List of warning messages for CR/LF violations</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_title_length" class="classattr">
                                        <input id="SpDescriptionValidator.validate_title_length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_title_length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_title_length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_title_length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_title_length-377"><a href="#SpDescriptionValidator.validate_title_length-377"><span class="linenos">377</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_title_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_title_length-378"><a href="#SpDescriptionValidator.validate_title_length-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_title_length-379"><a href="#SpDescriptionValidator.validate_title_length-379"><span class="linenos">379</span></a><span class="sd">        Validate the length of indicator titles.</span>
</span><span id="SpDescriptionValidator.validate_title_length-380"><a href="#SpDescriptionValidator.validate_title_length-380"><span class="linenos">380</span></a>
</span><span id="SpDescriptionValidator.validate_title_length-381"><a href="#SpDescriptionValidator.validate_title_length-381"><span class="linenos">381</span></a><span class="sd">        Checks that simple name values do not exceed the configured maximum</span>
</span><span id="SpDescriptionValidator.validate_title_length-382"><a href="#SpDescriptionValidator.validate_title_length-382"><span class="linenos">382</span></a><span class="sd">        title length.</span>
</span><span id="SpDescriptionValidator.validate_title_length-383"><a href="#SpDescriptionValidator.validate_title_length-383"><span class="linenos">383</span></a>
</span><span id="SpDescriptionValidator.validate_title_length-384"><a href="#SpDescriptionValidator.validate_title_length-384"><span class="linenos">384</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_title_length-385"><a href="#SpDescriptionValidator.validate_title_length-385"><span class="linenos">385</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_title_length-386"><a href="#SpDescriptionValidator.validate_title_length-386"><span class="linenos">386</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_title_length-387"><a href="#SpDescriptionValidator.validate_title_length-387"><span class="linenos">387</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_title_length-388"><a href="#SpDescriptionValidator.validate_title_length-388"><span class="linenos">388</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator.validate_title_length-389"><a href="#SpDescriptionValidator.validate_title_length-389"><span class="linenos">389</span></a><span class="sd">                - List[str]: List of warning messages for titles exceeding max length</span>
</span><span id="SpDescriptionValidator.validate_title_length-390"><a href="#SpDescriptionValidator.validate_title_length-390"><span class="linenos">390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_title_length-391"><a href="#SpDescriptionValidator.validate_title_length-391"><span class="linenos">391</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator.validate_title_length-392"><a href="#SpDescriptionValidator.validate_title_length-392"><span class="linenos">392</span></a>        <span class="n">max_len</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MAX_TITLE_LENGTH</span>
</span><span id="SpDescriptionValidator.validate_title_length-393"><a href="#SpDescriptionValidator.validate_title_length-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_text_length</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">max_len</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Validate the length of indicator titles.</p>

<p>Checks that simple name values do not exceed the configured maximum
title length.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors generated)
        - List[str]: List of warning messages for titles exceeding max length</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.validate_simple_description_length" class="classattr">
                                        <input id="SpDescriptionValidator.validate_simple_description_length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_simple_description_length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.validate_simple_description_length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.validate_simple_description_length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.validate_simple_description_length-395"><a href="#SpDescriptionValidator.validate_simple_description_length-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_simple_description_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-396"><a href="#SpDescriptionValidator.validate_simple_description_length-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-397"><a href="#SpDescriptionValidator.validate_simple_description_length-397"><span class="linenos">397</span></a><span class="sd">        Validate the length of simple descriptions.</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-398"><a href="#SpDescriptionValidator.validate_simple_description_length-398"><span class="linenos">398</span></a>
</span><span id="SpDescriptionValidator.validate_simple_description_length-399"><a href="#SpDescriptionValidator.validate_simple_description_length-399"><span class="linenos">399</span></a><span class="sd">        Checks that simple description values do not exceed the configured maximum</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-400"><a href="#SpDescriptionValidator.validate_simple_description_length-400"><span class="linenos">400</span></a><span class="sd">        description length.</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-401"><a href="#SpDescriptionValidator.validate_simple_description_length-401"><span class="linenos">401</span></a>
</span><span id="SpDescriptionValidator.validate_simple_description_length-402"><a href="#SpDescriptionValidator.validate_simple_description_length-402"><span class="linenos">402</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-403"><a href="#SpDescriptionValidator.validate_simple_description_length-403"><span class="linenos">403</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-404"><a href="#SpDescriptionValidator.validate_simple_description_length-404"><span class="linenos">404</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-405"><a href="#SpDescriptionValidator.validate_simple_description_length-405"><span class="linenos">405</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-406"><a href="#SpDescriptionValidator.validate_simple_description_length-406"><span class="linenos">406</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-407"><a href="#SpDescriptionValidator.validate_simple_description_length-407"><span class="linenos">407</span></a><span class="sd">                - List[str]: List of warning messages for descriptions exceeding max length</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-408"><a href="#SpDescriptionValidator.validate_simple_description_length-408"><span class="linenos">408</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-409"><a href="#SpDescriptionValidator.validate_simple_description_length-409"><span class="linenos">409</span></a>        <span class="n">column</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-410"><a href="#SpDescriptionValidator.validate_simple_description_length-410"><span class="linenos">410</span></a>        <span class="n">max_len</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MAX_SIMPLE_DESC_LENGTH</span>
</span><span id="SpDescriptionValidator.validate_simple_description_length-411"><a href="#SpDescriptionValidator.validate_simple_description_length-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_text_length</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">max_len</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Validate the length of simple descriptions.</p>

<p>Checks that simple description values do not exceed the configured maximum
description length.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors generated)
        - List[str]: List of warning messages for descriptions exceeding max length</p>
</div>


                            </div>
                            <div id="SpDescriptionValidator.run" class="classattr">
                                        <input id="SpDescriptionValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpDescriptionValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpDescriptionValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpDescriptionValidator.run-422"><a href="#SpDescriptionValidator.run-422"><span class="linenos">422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpDescriptionValidator.run-423"><a href="#SpDescriptionValidator.run-423"><span class="linenos">423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.run-424"><a href="#SpDescriptionValidator.run-424"><span class="linenos">424</span></a><span class="sd">        Execute all Description spreadsheet validations.</span>
</span><span id="SpDescriptionValidator.run-425"><a href="#SpDescriptionValidator.run-425"><span class="linenos">425</span></a>
</span><span id="SpDescriptionValidator.run-426"><a href="#SpDescriptionValidator.run-426"><span class="linenos">426</span></a><span class="sd">        Orchestrates the validation process by executing all description checks</span>
</span><span id="SpDescriptionValidator.run-427"><a href="#SpDescriptionValidator.run-427"><span class="linenos">427</span></a><span class="sd">        and building reports based on the validation results. Title length validation</span>
</span><span id="SpDescriptionValidator.run-428"><a href="#SpDescriptionValidator.run-428"><span class="linenos">428</span></a><span class="sd">        is conditionally included based on configuration flags.</span>
</span><span id="SpDescriptionValidator.run-429"><a href="#SpDescriptionValidator.run-429"><span class="linenos">429</span></a>
</span><span id="SpDescriptionValidator.run-430"><a href="#SpDescriptionValidator.run-430"><span class="linenos">430</span></a><span class="sd">        Returns</span>
</span><span id="SpDescriptionValidator.run-431"><a href="#SpDescriptionValidator.run-431"><span class="linenos">431</span></a><span class="sd">        -------</span>
</span><span id="SpDescriptionValidator.run-432"><a href="#SpDescriptionValidator.run-432"><span class="linenos">432</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpDescriptionValidator.run-433"><a href="#SpDescriptionValidator.run-433"><span class="linenos">433</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpDescriptionValidator.run-434"><a href="#SpDescriptionValidator.run-434"><span class="linenos">434</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpDescriptionValidator.run-435"><a href="#SpDescriptionValidator.run-435"><span class="linenos">435</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpDescriptionValidator.run-436"><a href="#SpDescriptionValidator.run-436"><span class="linenos">436</span></a>
</span><span id="SpDescriptionValidator.run-437"><a href="#SpDescriptionValidator.run-437"><span class="linenos">437</span></a><span class="sd">        Notes</span>
</span><span id="SpDescriptionValidator.run-438"><a href="#SpDescriptionValidator.run-438"><span class="linenos">438</span></a><span class="sd">        -----</span>
</span><span id="SpDescriptionValidator.run-439"><a href="#SpDescriptionValidator.run-439"><span class="linenos">439</span></a><span class="sd">        - If the dataframe is empty, all validations are marked as not executed</span>
</span><span id="SpDescriptionValidator.run-440"><a href="#SpDescriptionValidator.run-440"><span class="linenos">440</span></a><span class="sd">        - Title length validation can be disabled via command line flag</span>
</span><span id="SpDescriptionValidator.run-441"><a href="#SpDescriptionValidator.run-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpDescriptionValidator.run-442"><a href="#SpDescriptionValidator.run-442"><span class="linenos">442</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpDescriptionValidator.run-443"><a href="#SpDescriptionValidator.run-443"><span class="linenos">443</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_html_in_descriptions</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">HTML_DESC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-444"><a href="#SpDescriptionValidator.run-444"><span class="linenos">444</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_sequential_codes</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-445"><a href="#SpDescriptionValidator.run-445"><span class="linenos">445</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_codes</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">CO_UN</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-446"><a href="#SpDescriptionValidator.run-446"><span class="linenos">446</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_text_capitalization</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">INP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-447"><a href="#SpDescriptionValidator.run-447"><span class="linenos">447</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_indicator_levels</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IL</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-448"><a href="#SpDescriptionValidator.run-448"><span class="linenos">448</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_punctuation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">MAND_PUNC_DESC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-449"><a href="#SpDescriptionValidator.run-449"><span class="linenos">449</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_empty_strings</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">EF</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-450"><a href="#SpDescriptionValidator.run-450"><span class="linenos">450</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_cr_lf_characters</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LB_DESC</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-451"><a href="#SpDescriptionValidator.run-451"><span class="linenos">451</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_simple_description_length</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SIMP_DESC_N</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpDescriptionValidator.run-452"><a href="#SpDescriptionValidator.run-452"><span class="linenos">452</span></a>        <span class="p">]</span>
</span><span id="SpDescriptionValidator.run-453"><a href="#SpDescriptionValidator.run-453"><span class="linenos">453</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.run-454"><a href="#SpDescriptionValidator.run-454"><span class="linenos">454</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.run-455"><a href="#SpDescriptionValidator.run-455"><span class="linenos">455</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpDescriptionValidator.run-456"><a href="#SpDescriptionValidator.run-456"><span class="linenos">456</span></a>
</span><span id="SpDescriptionValidator.run-457"><a href="#SpDescriptionValidator.run-457"><span class="linenos">457</span></a>        <span class="c1"># Add title length validation if the flag is not set to skip it</span>
</span><span id="SpDescriptionValidator.run-458"><a href="#SpDescriptionValidator.run-458"><span class="linenos">458</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_action</span><span class="o">.</span><span class="n">no_warning_titles_length</span><span class="p">:</span>
</span><span id="SpDescriptionValidator.run-459"><a href="#SpDescriptionValidator.run-459"><span class="linenos">459</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_title_length</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">TITLES_N</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="SpDescriptionValidator.run-460"><a href="#SpDescriptionValidator.run-460"><span class="linenos">460</span></a>
</span><span id="SpDescriptionValidator.run-461"><a href="#SpDescriptionValidator.run-461"><span class="linenos">461</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpDescriptionValidator.run-462"><a href="#SpDescriptionValidator.run-462"><span class="linenos">462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpDescriptionValidator.run-463"><a href="#SpDescriptionValidator.run-463"><span class="linenos">463</span></a>
</span><span id="SpDescriptionValidator.run-464"><a href="#SpDescriptionValidator.run-464"><span class="linenos">464</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all Description spreadsheet validations.</p>

<p>Orchestrates the validation process by executing all description checks
and building reports based on the validation results. Title length validation
is conditionally included based on configuration flags.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<ul>
<li>If the dataframe is empty, all validations are marked as not executed</li>
<li>Title length validation can be disabled via command line flag</li>
</ul>
</div>


                            </div>
                </section>
                <section id="SpValueValidator">
                            <input id="SpValueValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpValueValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpValueValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpValueValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpValueValidator-25"><a href="#SpValueValidator-25"><span class="linenos"> 25</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpValueValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpValueValidator-26"><a href="#SpValueValidator-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator-27"><a href="#SpValueValidator-27"><span class="linenos"> 27</span></a><span class="sd">    Validates Value spreadsheet content and relationships.</span>
</span><span id="SpValueValidator-28"><a href="#SpValueValidator-28"><span class="linenos"> 28</span></a>
</span><span id="SpValueValidator-29"><a href="#SpValueValidator-29"><span class="linenos"> 29</span></a><span class="sd">    This validator performs comprehensive checks on value data including:</span>
</span><span id="SpValueValidator-30"><a href="#SpValueValidator-30"><span class="linenos"> 30</span></a><span class="sd">    - Indicator relationship validation with description</span>
</span><span id="SpValueValidator-31"><a href="#SpValueValidator-31"><span class="linenos"> 31</span></a><span class="sd">    - Column combination validation based on level and scenario</span>
</span><span id="SpValueValidator-32"><a href="#SpValueValidator-32"><span class="linenos"> 32</span></a><span class="sd">    - Data format validation (numeric values, decimal places)</span>
</span><span id="SpValueValidator-33"><a href="#SpValueValidator-33"><span class="linenos"> 33</span></a><span class="sd">    - Invalid and unavailable value detection</span>
</span><span id="SpValueValidator-34"><a href="#SpValueValidator-34"><span class="linenos"> 34</span></a><span class="sd">    - Temporal reference and scenario consistency</span>
</span><span id="SpValueValidator-35"><a href="#SpValueValidator-35"><span class="linenos"> 35</span></a>
</span><span id="SpValueValidator-36"><a href="#SpValueValidator-36"><span class="linenos"> 36</span></a><span class="sd">    Attributes</span>
</span><span id="SpValueValidator-37"><a href="#SpValueValidator-37"><span class="linenos"> 37</span></a><span class="sd">    ----------</span>
</span><span id="SpValueValidator-38"><a href="#SpValueValidator-38"><span class="linenos"> 38</span></a><span class="sd">    model_sp_value : SpValue</span>
</span><span id="SpValueValidator-39"><a href="#SpValueValidator-39"><span class="linenos"> 39</span></a><span class="sd">        Value model instance containing indicator data.</span>
</span><span id="SpValueValidator-40"><a href="#SpValueValidator-40"><span class="linenos"> 40</span></a><span class="sd">    model_sp_description : SpDescription</span>
</span><span id="SpValueValidator-41"><a href="#SpValueValidator-41"><span class="linenos"> 41</span></a><span class="sd">        Description model instance containing indicator metadata.</span>
</span><span id="SpValueValidator-42"><a href="#SpValueValidator-42"><span class="linenos"> 42</span></a><span class="sd">    model_sp_temporal_reference : SpTemporalReference</span>
</span><span id="SpValueValidator-43"><a href="#SpValueValidator-43"><span class="linenos"> 43</span></a><span class="sd">        Temporal reference model instance for time periods.</span>
</span><span id="SpValueValidator-44"><a href="#SpValueValidator-44"><span class="linenos"> 44</span></a><span class="sd">    model_sp_scenario : SpScenario</span>
</span><span id="SpValueValidator-45"><a href="#SpValueValidator-45"><span class="linenos"> 45</span></a><span class="sd">        Scenario model instance for scenario definitions.</span>
</span><span id="SpValueValidator-46"><a href="#SpValueValidator-46"><span class="linenos"> 46</span></a><span class="sd">    exists_scenario : bool</span>
</span><span id="SpValueValidator-47"><a href="#SpValueValidator-47"><span class="linenos"> 47</span></a><span class="sd">        Flag indicating if scenario file exists.</span>
</span><span id="SpValueValidator-48"><a href="#SpValueValidator-48"><span class="linenos"> 48</span></a><span class="sd">    list_scenarios : List[str]</span>
</span><span id="SpValueValidator-49"><a href="#SpValueValidator-49"><span class="linenos"> 49</span></a><span class="sd">        List of available scenario identifiers.</span>
</span><span id="SpValueValidator-50"><a href="#SpValueValidator-50"><span class="linenos"> 50</span></a><span class="sd">    sp_name_description : str</span>
</span><span id="SpValueValidator-51"><a href="#SpValueValidator-51"><span class="linenos"> 51</span></a><span class="sd">        Description spreadsheet filename.</span>
</span><span id="SpValueValidator-52"><a href="#SpValueValidator-52"><span class="linenos"> 52</span></a><span class="sd">    sp_name_temporal_reference : str</span>
</span><span id="SpValueValidator-53"><a href="#SpValueValidator-53"><span class="linenos"> 53</span></a><span class="sd">        Temporal reference spreadsheet filename.</span>
</span><span id="SpValueValidator-54"><a href="#SpValueValidator-54"><span class="linenos"> 54</span></a><span class="sd">    sp_name_scenario : str</span>
</span><span id="SpValueValidator-55"><a href="#SpValueValidator-55"><span class="linenos"> 55</span></a><span class="sd">        Scenario spreadsheet filename.</span>
</span><span id="SpValueValidator-56"><a href="#SpValueValidator-56"><span class="linenos"> 56</span></a><span class="sd">    sp_name_value : str</span>
</span><span id="SpValueValidator-57"><a href="#SpValueValidator-57"><span class="linenos"> 57</span></a><span class="sd">        Value spreadsheet filename.</span>
</span><span id="SpValueValidator-58"><a href="#SpValueValidator-58"><span class="linenos"> 58</span></a><span class="sd">    global_required_columns : Dict[str, List[str]]</span>
</span><span id="SpValueValidator-59"><a href="#SpValueValidator-59"><span class="linenos"> 59</span></a><span class="sd">        Required columns mapping for validation.</span>
</span><span id="SpValueValidator-60"><a href="#SpValueValidator-60"><span class="linenos"> 60</span></a><span class="sd">    model_dataframes : Dict[str, pd.DataFrame]</span>
</span><span id="SpValueValidator-61"><a href="#SpValueValidator-61"><span class="linenos"> 61</span></a><span class="sd">        DataFrames mapping for each model.</span>
</span><span id="SpValueValidator-62"><a href="#SpValueValidator-62"><span class="linenos"> 62</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpValueValidator-63"><a href="#SpValueValidator-63"><span class="linenos"> 63</span></a>
</span><span id="SpValueValidator-64"><a href="#SpValueValidator-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpValueValidator-65"><a href="#SpValueValidator-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpValueValidator-66"><a href="#SpValueValidator-66"><span class="linenos"> 66</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpValueValidator-67"><a href="#SpValueValidator-67"><span class="linenos"> 67</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpValueValidator-68"><a href="#SpValueValidator-68"><span class="linenos"> 68</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpValueValidator-69"><a href="#SpValueValidator-69"><span class="linenos"> 69</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpValueValidator-70"><a href="#SpValueValidator-70"><span class="linenos"> 70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator-71"><a href="#SpValueValidator-71"><span class="linenos"> 71</span></a><span class="sd">        Initialize the Value validator.</span>
</span><span id="SpValueValidator-72"><a href="#SpValueValidator-72"><span class="linenos"> 72</span></a>
</span><span id="SpValueValidator-73"><a href="#SpValueValidator-73"><span class="linenos"> 73</span></a><span class="sd">        Args</span>
</span><span id="SpValueValidator-74"><a href="#SpValueValidator-74"><span class="linenos"> 74</span></a><span class="sd">        ----</span>
</span><span id="SpValueValidator-75"><a href="#SpValueValidator-75"><span class="linenos"> 75</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpValueValidator-76"><a href="#SpValueValidator-76"><span class="linenos"> 76</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpValueValidator-77"><a href="#SpValueValidator-77"><span class="linenos"> 77</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpValueValidator-78"><a href="#SpValueValidator-78"><span class="linenos"> 78</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpValueValidator-79"><a href="#SpValueValidator-79"><span class="linenos"> 79</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpValueValidator-80"><a href="#SpValueValidator-80"><span class="linenos"> 80</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpValueValidator-81"><a href="#SpValueValidator-81"><span class="linenos"> 81</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator-82"><a href="#SpValueValidator-82"><span class="linenos"> 82</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpValueValidator-83"><a href="#SpValueValidator-83"><span class="linenos"> 83</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpValueValidator-84"><a href="#SpValueValidator-84"><span class="linenos"> 84</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpValueValidator-85"><a href="#SpValueValidator-85"><span class="linenos"> 85</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpValue</span><span class="p">,</span>
</span><span id="SpValueValidator-86"><a href="#SpValueValidator-86"><span class="linenos"> 86</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpValueValidator-87"><a href="#SpValueValidator-87"><span class="linenos"> 87</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-88"><a href="#SpValueValidator-88"><span class="linenos"> 88</span></a>
</span><span id="SpValueValidator-89"><a href="#SpValueValidator-89"><span class="linenos"> 89</span></a>        <span class="c1"># Configure</span>
</span><span id="SpValueValidator-90"><a href="#SpValueValidator-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpValueValidator-91"><a href="#SpValueValidator-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpValueValidator-92"><a href="#SpValueValidator-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_temporal_reference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpTemporalReference</span><span class="p">)</span>
</span><span id="SpValueValidator-93"><a href="#SpValueValidator-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_scenario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpScenario</span><span class="p">)</span>
</span><span id="SpValueValidator-94"><a href="#SpValueValidator-94"><span class="linenos"> 94</span></a>
</span><span id="SpValueValidator-95"><a href="#SpValueValidator-95"><span class="linenos"> 95</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpValueValidator-96"><a href="#SpValueValidator-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenario_exists_file</span>
</span><span id="SpValueValidator-97"><a href="#SpValueValidator-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenarios_list</span>
</span><span id="SpValueValidator-98"><a href="#SpValueValidator-98"><span class="linenos"> 98</span></a>
</span><span id="SpValueValidator-99"><a href="#SpValueValidator-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator-100"><a href="#SpValueValidator-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator-101"><a href="#SpValueValidator-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator-102"><a href="#SpValueValidator-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator-103"><a href="#SpValueValidator-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpValueValidator-104"><a href="#SpValueValidator-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpValueValidator-105"><a href="#SpValueValidator-105"><span class="linenos">105</span></a>
</span><span id="SpValueValidator-106"><a href="#SpValueValidator-106"><span class="linenos">106</span></a>        <span class="c1"># Prepare statements</span>
</span><span id="SpValueValidator-107"><a href="#SpValueValidator-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpValueValidator-108"><a href="#SpValueValidator-108"><span class="linenos">108</span></a>
</span><span id="SpValueValidator-109"><a href="#SpValueValidator-109"><span class="linenos">109</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpValueValidator-110"><a href="#SpValueValidator-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpValueValidator-111"><a href="#SpValueValidator-111"><span class="linenos">111</span></a>
</span><span id="SpValueValidator-112"><a href="#SpValueValidator-112"><span class="linenos">112</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpValueValidator-113"><a href="#SpValueValidator-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator-114"><a href="#SpValueValidator-114"><span class="linenos">114</span></a><span class="sd">        Prepare validation context, column mappings, and dataframe references.</span>
</span><span id="SpValueValidator-115"><a href="#SpValueValidator-115"><span class="linenos">115</span></a>
</span><span id="SpValueValidator-116"><a href="#SpValueValidator-116"><span class="linenos">116</span></a><span class="sd">        Sets up:</span>
</span><span id="SpValueValidator-117"><a href="#SpValueValidator-117"><span class="linenos">117</span></a><span class="sd">        - Spreadsheet names for all models</span>
</span><span id="SpValueValidator-118"><a href="#SpValueValidator-118"><span class="linenos">118</span></a><span class="sd">        - Column name mappings for validation</span>
</span><span id="SpValueValidator-119"><a href="#SpValueValidator-119"><span class="linenos">119</span></a><span class="sd">        - Required columns dictionary (conditional on scenario existence)</span>
</span><span id="SpValueValidator-120"><a href="#SpValueValidator-120"><span class="linenos">120</span></a><span class="sd">        - DataFrame references for all models</span>
</span><span id="SpValueValidator-121"><a href="#SpValueValidator-121"><span class="linenos">121</span></a>
</span><span id="SpValueValidator-122"><a href="#SpValueValidator-122"><span class="linenos">122</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator-123"><a href="#SpValueValidator-123"><span class="linenos">123</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator-124"><a href="#SpValueValidator-124"><span class="linenos">124</span></a><span class="sd">        Scenario-related configurations are conditional based on scenario file existence.</span>
</span><span id="SpValueValidator-125"><a href="#SpValueValidator-125"><span class="linenos">125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator-126"><a href="#SpValueValidator-126"><span class="linenos">126</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpValueValidator-127"><a href="#SpValueValidator-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpValueValidator-128"><a href="#SpValueValidator-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_temporal_reference</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpValueValidator-129"><a href="#SpValueValidator-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_scenario</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpValueValidator-130"><a href="#SpValueValidator-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpValueValidator-131"><a href="#SpValueValidator-131"><span class="linenos">131</span></a>
</span><span id="SpValueValidator-132"><a href="#SpValueValidator-132"><span class="linenos">132</span></a>        <span class="c1"># Define required columns efficiently</span>
</span><span id="SpValueValidator-133"><a href="#SpValueValidator-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpValueValidator-134"><a href="#SpValueValidator-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="p">[</span><span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpValueValidator-135"><a href="#SpValueValidator-135"><span class="linenos">135</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpValueValidator-136"><a href="#SpValueValidator-136"><span class="linenos">136</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpValueValidator-137"><a href="#SpValueValidator-137"><span class="linenos">137</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpValueValidator-138"><a href="#SpValueValidator-138"><span class="linenos">138</span></a>            <span class="p">],</span>
</span><span id="SpValueValidator-139"><a href="#SpValueValidator-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">:</span> <span class="p">[</span><span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpValueValidator-140"><a href="#SpValueValidator-140"><span class="linenos">140</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">:</span> <span class="p">([</span><span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="k">else</span> <span class="p">[]),</span>
</span><span id="SpValueValidator-141"><a href="#SpValueValidator-141"><span class="linenos">141</span></a>        <span class="p">}</span>
</span><span id="SpValueValidator-142"><a href="#SpValueValidator-142"><span class="linenos">142</span></a>
</span><span id="SpValueValidator-143"><a href="#SpValueValidator-143"><span class="linenos">143</span></a>        <span class="c1"># Validate all required columns exist</span>
</span><span id="SpValueValidator-144"><a href="#SpValueValidator-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpValueValidator-145"><a href="#SpValueValidator-145"><span class="linenos">145</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpValueValidator-146"><a href="#SpValueValidator-146"><span class="linenos">146</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpValueValidator-147"><a href="#SpValueValidator-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_temporal_reference</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpValueValidator-148"><a href="#SpValueValidator-148"><span class="linenos">148</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_scenario</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()),</span>
</span><span id="SpValueValidator-149"><a href="#SpValueValidator-149"><span class="linenos">149</span></a>        <span class="p">}</span>
</span><span id="SpValueValidator-150"><a href="#SpValueValidator-150"><span class="linenos">150</span></a>
</span><span id="SpValueValidator-151"><a href="#SpValueValidator-151"><span class="linenos">151</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator-152"><a href="#SpValueValidator-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator-153"><a href="#SpValueValidator-153"><span class="linenos">153</span></a><span class="sd">        Validate indicator relationships between values and descriptions.</span>
</span><span id="SpValueValidator-154"><a href="#SpValueValidator-154"><span class="linenos">154</span></a>
</span><span id="SpValueValidator-155"><a href="#SpValueValidator-155"><span class="linenos">155</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpValueValidator-156"><a href="#SpValueValidator-156"><span class="linenos">156</span></a><span class="sd">        - All value columns match valid indicator codes from description</span>
</span><span id="SpValueValidator-157"><a href="#SpValueValidator-157"><span class="linenos">157</span></a><span class="sd">        - Level 1 indicators are excluded from validation</span>
</span><span id="SpValueValidator-158"><a href="#SpValueValidator-158"><span class="linenos">158</span></a><span class="sd">        - Level 2 indicators with scenario 0 are handled appropriately</span>
</span><span id="SpValueValidator-159"><a href="#SpValueValidator-159"><span class="linenos">159</span></a><span class="sd">        - All description indicators (except excluded levels) exist in values</span>
</span><span id="SpValueValidator-160"><a href="#SpValueValidator-160"><span class="linenos">160</span></a><span class="sd">        - Column names follow valid patterns (code-year or code-year-scenario)</span>
</span><span id="SpValueValidator-161"><a href="#SpValueValidator-161"><span class="linenos">161</span></a>
</span><span id="SpValueValidator-162"><a href="#SpValueValidator-162"><span class="linenos">162</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator-163"><a href="#SpValueValidator-163"><span class="linenos">163</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator-164"><a href="#SpValueValidator-164"><span class="linenos">164</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator-165"><a href="#SpValueValidator-165"><span class="linenos">165</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator-166"><a href="#SpValueValidator-166"><span class="linenos">166</span></a><span class="sd">                - List[str]: Error messages for missing indicators and invalid columns</span>
</span><span id="SpValueValidator-167"><a href="#SpValueValidator-167"><span class="linenos">167</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpValueValidator-168"><a href="#SpValueValidator-168"><span class="linenos">168</span></a>
</span><span id="SpValueValidator-169"><a href="#SpValueValidator-169"><span class="linenos">169</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator-170"><a href="#SpValueValidator-170"><span class="linenos">170</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator-171"><a href="#SpValueValidator-171"><span class="linenos">171</span></a><span class="sd">        - Validation is skipped if description dataframe is empty</span>
</span><span id="SpValueValidator-172"><a href="#SpValueValidator-172"><span class="linenos">172</span></a><span class="sd">        - Level 1 indicators are automatically excluded</span>
</span><span id="SpValueValidator-173"><a href="#SpValueValidator-173"><span class="linenos">173</span></a><span class="sd">        - Columns containing &#39;:&#39; are ignored in invalid column detection</span>
</span><span id="SpValueValidator-174"><a href="#SpValueValidator-174"><span class="linenos">174</span></a><span class="sd">        - Level 2 with scenario 0 are conditionally excluded</span>
</span><span id="SpValueValidator-175"><a href="#SpValueValidator-175"><span class="linenos">175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator-176"><a href="#SpValueValidator-176"><span class="linenos">176</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpValueValidator-177"><a href="#SpValueValidator-177"><span class="linenos">177</span></a>
</span><span id="SpValueValidator-178"><a href="#SpValueValidator-178"><span class="linenos">178</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpValueValidator-179"><a href="#SpValueValidator-179"><span class="linenos">179</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-180"><a href="#SpValueValidator-180"><span class="linenos">180</span></a>
</span><span id="SpValueValidator-181"><a href="#SpValueValidator-181"><span class="linenos">181</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="SpValueValidator-182"><a href="#SpValueValidator-182"><span class="linenos">182</span></a>            <span class="n">required_columns</span><span class="o">=</span><span class="p">{</span>
</span><span id="SpValueValidator-183"><a href="#SpValueValidator-183"><span class="linenos">183</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator-184"><a href="#SpValueValidator-184"><span class="linenos">184</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">],</span>
</span><span id="SpValueValidator-185"><a href="#SpValueValidator-185"><span class="linenos">185</span></a>            <span class="p">},</span>
</span><span id="SpValueValidator-186"><a href="#SpValueValidator-186"><span class="linenos">186</span></a>            <span class="n">model_dataframes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">,</span>
</span><span id="SpValueValidator-187"><a href="#SpValueValidator-187"><span class="linenos">187</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-188"><a href="#SpValueValidator-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpValueValidator-189"><a href="#SpValueValidator-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-190"><a href="#SpValueValidator-190"><span class="linenos">190</span></a>
</span><span id="SpValueValidator-191"><a href="#SpValueValidator-191"><span class="linenos">191</span></a>        <span class="n">code_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-192"><a href="#SpValueValidator-192"><span class="linenos">192</span></a>        <span class="n">level_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-193"><a href="#SpValueValidator-193"><span class="linenos">193</span></a>        <span class="n">scenario_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_SCENARIO</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-194"><a href="#SpValueValidator-194"><span class="linenos">194</span></a>
</span><span id="SpValueValidator-195"><a href="#SpValueValidator-195"><span class="linenos">195</span></a>        <span class="c1"># Prepare cleaned dataframes</span>
</span><span id="SpValueValidator-196"><a href="#SpValueValidator-196"><span class="linenos">196</span></a>        <span class="c1"># No-need to clean the values dataframe</span>
</span><span id="SpValueValidator-197"><a href="#SpValueValidator-197"><span class="linenos">197</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator-198"><a href="#SpValueValidator-198"><span class="linenos">198</span></a>        <span class="c1"># Need to clean the description and temporal reference dataframes</span>
</span><span id="SpValueValidator-199"><a href="#SpValueValidator-199"><span class="linenos">199</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpValueValidator-200"><a href="#SpValueValidator-200"><span class="linenos">200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator-201"><a href="#SpValueValidator-201"><span class="linenos">201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpValueValidator-202"><a href="#SpValueValidator-202"><span class="linenos">202</span></a>            <span class="p">[</span><span class="n">code_column_name</span><span class="p">],</span>
</span><span id="SpValueValidator-203"><a href="#SpValueValidator-203"><span class="linenos">203</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-204"><a href="#SpValueValidator-204"><span class="linenos">204</span></a>
</span><span id="SpValueValidator-205"><a href="#SpValueValidator-205"><span class="linenos">205</span></a>        <span class="n">level_one_codes</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span><span class="n">code_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpValueValidator-206"><a href="#SpValueValidator-206"><span class="linenos">206</span></a>
</span><span id="SpValueValidator-207"><a href="#SpValueValidator-207"><span class="linenos">207</span></a>        <span class="c1"># Process value columns</span>
</span><span id="SpValueValidator-208"><a href="#SpValueValidator-208"><span class="linenos">208</span></a>        <span class="n">value_columns</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpValueValidator-209"><a href="#SpValueValidator-209"><span class="linenos">209</span></a>        <span class="n">columns_to_ignore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span> <span class="o">+</span> <span class="n">level_one_codes</span>
</span><span id="SpValueValidator-210"><a href="#SpValueValidator-210"><span class="linenos">210</span></a>
</span><span id="SpValueValidator-211"><a href="#SpValueValidator-211"><span class="linenos">211</span></a>        <span class="n">valid_value_codes</span><span class="p">,</span> <span class="n">invalid_columns</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_ids_and_unmatched_strings_from_list</span><span class="p">(</span>
</span><span id="SpValueValidator-212"><a href="#SpValueValidator-212"><span class="linenos">212</span></a>            <span class="n">value_columns</span><span class="p">,</span> <span class="n">columns_to_ignore</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span>
</span><span id="SpValueValidator-213"><a href="#SpValueValidator-213"><span class="linenos">213</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-214"><a href="#SpValueValidator-214"><span class="linenos">214</span></a>
</span><span id="SpValueValidator-215"><a href="#SpValueValidator-215"><span class="linenos">215</span></a>        <span class="c1"># Filter out columns containing &#39;:&#39;</span>
</span><span id="SpValueValidator-216"><a href="#SpValueValidator-216"><span class="linenos">216</span></a>        <span class="n">processed_invalid_columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">({</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">invalid_columns</span> <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col</span><span class="p">})</span>
</span><span id="SpValueValidator-217"><a href="#SpValueValidator-217"><span class="linenos">217</span></a>
</span><span id="SpValueValidator-218"><a href="#SpValueValidator-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="n">processed_invalid_columns</span><span class="p">:</span>
</span><span id="SpValueValidator-219"><a href="#SpValueValidator-219"><span class="linenos">219</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: Colunas invlidas: </span><span class="si">{</span><span class="n">processed_invalid_columns</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator-220"><a href="#SpValueValidator-220"><span class="linenos">220</span></a>
</span><span id="SpValueValidator-221"><a href="#SpValueValidator-221"><span class="linenos">221</span></a>        <span class="c1"># Get filtered description codes using generic function</span>
</span><span id="SpValueValidator-222"><a href="#SpValueValidator-222"><span class="linenos">222</span></a>        <span class="c1"># Remove level 1 indicators</span>
</span><span id="SpValueValidator-223"><a href="#SpValueValidator-223"><span class="linenos">223</span></a>        <span class="n">filtered_description_df</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator-224"><a href="#SpValueValidator-224"><span class="linenos">224</span></a>
</span><span id="SpValueValidator-225"><a href="#SpValueValidator-225"><span class="linenos">225</span></a>        <span class="c1"># Remove level 2 indicators with scenario 0 if scenario column exists</span>
</span><span id="SpValueValidator-226"><a href="#SpValueValidator-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="ow">and</span> <span class="n">scenario_column_name</span> <span class="ow">in</span> <span class="n">filtered_description_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpValueValidator-227"><a href="#SpValueValidator-227"><span class="linenos">227</span></a>            <span class="n">filtered_description_df</span> <span class="o">=</span> <span class="n">filtered_description_df</span><span class="p">[</span>
</span><span id="SpValueValidator-228"><a href="#SpValueValidator-228"><span class="linenos">228</span></a>                <span class="o">~</span><span class="p">((</span><span class="n">filtered_description_df</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">filtered_description_df</span><span class="p">[</span><span class="n">scenario_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span>
</span><span id="SpValueValidator-229"><a href="#SpValueValidator-229"><span class="linenos">229</span></a>            <span class="p">]</span>
</span><span id="SpValueValidator-230"><a href="#SpValueValidator-230"><span class="linenos">230</span></a>
</span><span id="SpValueValidator-231"><a href="#SpValueValidator-231"><span class="linenos">231</span></a>        <span class="c1"># Extract valid description codes</span>
</span><span id="SpValueValidator-232"><a href="#SpValueValidator-232"><span class="linenos">232</span></a>        <span class="n">valid_description_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span>
</span><span id="SpValueValidator-233"><a href="#SpValueValidator-233"><span class="linenos">233</span></a>            <span class="n">id_values_list</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">filtered_description_df</span><span class="p">[</span><span class="n">code_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span><span id="SpValueValidator-234"><a href="#SpValueValidator-234"><span class="linenos">234</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-235"><a href="#SpValueValidator-235"><span class="linenos">235</span></a>
</span><span id="SpValueValidator-236"><a href="#SpValueValidator-236"><span class="linenos">236</span></a>        <span class="c1"># Compare codes between description and values</span>
</span><span id="SpValueValidator-237"><a href="#SpValueValidator-237"><span class="linenos">237</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpValueValidator-238"><a href="#SpValueValidator-238"><span class="linenos">238</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">valid_description_codes</span><span class="p">,</span>
</span><span id="SpValueValidator-239"><a href="#SpValueValidator-239"><span class="linenos">239</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
</span><span id="SpValueValidator-240"><a href="#SpValueValidator-240"><span class="linenos">240</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">valid_value_codes</span><span class="p">,</span>
</span><span id="SpValueValidator-241"><a href="#SpValueValidator-241"><span class="linenos">241</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
</span><span id="SpValueValidator-242"><a href="#SpValueValidator-242"><span class="linenos">242</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-243"><a href="#SpValueValidator-243"><span class="linenos">243</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpValueValidator-244"><a href="#SpValueValidator-244"><span class="linenos">244</span></a>
</span><span id="SpValueValidator-245"><a href="#SpValueValidator-245"><span class="linenos">245</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-246"><a href="#SpValueValidator-246"><span class="linenos">246</span></a>
</span><span id="SpValueValidator-247"><a href="#SpValueValidator-247"><span class="linenos">247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_value_combination_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator-248"><a href="#SpValueValidator-248"><span class="linenos">248</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator-249"><a href="#SpValueValidator-249"><span class="linenos">249</span></a><span class="sd">        Validate value combination relations between indicators and their expected columns.</span>
</span><span id="SpValueValidator-250"><a href="#SpValueValidator-250"><span class="linenos">250</span></a>
</span><span id="SpValueValidator-251"><a href="#SpValueValidator-251"><span class="linenos">251</span></a><span class="sd">        Ensures that each indicator has the correct combination of columns in the values</span>
</span><span id="SpValueValidator-252"><a href="#SpValueValidator-252"><span class="linenos">252</span></a><span class="sd">        dataframe based on its level and scenario configuration. Validates:</span>
</span><span id="SpValueValidator-253"><a href="#SpValueValidator-253"><span class="linenos">253</span></a><span class="sd">        - Level &gt;= 2 indicators have appropriate temporal-scenario combinations</span>
</span><span id="SpValueValidator-254"><a href="#SpValueValidator-254"><span class="linenos">254</span></a><span class="sd">        - Level 2 with scenario 0 have only base year column</span>
</span><span id="SpValueValidator-255"><a href="#SpValueValidator-255"><span class="linenos">255</span></a><span class="sd">        - Level 2 with scenario 1 have full temporal-scenario matrix</span>
</span><span id="SpValueValidator-256"><a href="#SpValueValidator-256"><span class="linenos">256</span></a><span class="sd">        - No extra unnecessary columns exist for any indicator</span>
</span><span id="SpValueValidator-257"><a href="#SpValueValidator-257"><span class="linenos">257</span></a><span class="sd">        - No missing required combinations</span>
</span><span id="SpValueValidator-258"><a href="#SpValueValidator-258"><span class="linenos">258</span></a>
</span><span id="SpValueValidator-259"><a href="#SpValueValidator-259"><span class="linenos">259</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator-260"><a href="#SpValueValidator-260"><span class="linenos">260</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator-261"><a href="#SpValueValidator-261"><span class="linenos">261</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator-262"><a href="#SpValueValidator-262"><span class="linenos">262</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator-263"><a href="#SpValueValidator-263"><span class="linenos">263</span></a><span class="sd">                - List[str]: Error messages for missing/extra columns</span>
</span><span id="SpValueValidator-264"><a href="#SpValueValidator-264"><span class="linenos">264</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpValueValidator-265"><a href="#SpValueValidator-265"><span class="linenos">265</span></a>
</span><span id="SpValueValidator-266"><a href="#SpValueValidator-266"><span class="linenos">266</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator-267"><a href="#SpValueValidator-267"><span class="linenos">267</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator-268"><a href="#SpValueValidator-268"><span class="linenos">268</span></a><span class="sd">        - Validation is skipped if description or temporal reference is empty</span>
</span><span id="SpValueValidator-269"><a href="#SpValueValidator-269"><span class="linenos">269</span></a><span class="sd">        - Level 1 indicators should not have any temporal columns</span>
</span><span id="SpValueValidator-270"><a href="#SpValueValidator-270"><span class="linenos">270</span></a><span class="sd">        - Level &gt;= 2 indicators require specific combinations based on scenario</span>
</span><span id="SpValueValidator-271"><a href="#SpValueValidator-271"><span class="linenos">271</span></a><span class="sd">        - Extra columns are flagged with specific messages per level</span>
</span><span id="SpValueValidator-272"><a href="#SpValueValidator-272"><span class="linenos">272</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator-273"><a href="#SpValueValidator-273"><span class="linenos">273</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpValueValidator-274"><a href="#SpValueValidator-274"><span class="linenos">274</span></a>
</span><span id="SpValueValidator-275"><a href="#SpValueValidator-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpValueValidator-276"><a href="#SpValueValidator-276"><span class="linenos">276</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-277"><a href="#SpValueValidator-277"><span class="linenos">277</span></a>
</span><span id="SpValueValidator-278"><a href="#SpValueValidator-278"><span class="linenos">278</span></a>        <span class="n">code_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-279"><a href="#SpValueValidator-279"><span class="linenos">279</span></a>        <span class="n">level_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-280"><a href="#SpValueValidator-280"><span class="linenos">280</span></a>        <span class="n">scenario_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_SCENARIO</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-281"><a href="#SpValueValidator-281"><span class="linenos">281</span></a>        <span class="n">symbol_column_name</span> <span class="o">=</span> <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-282"><a href="#SpValueValidator-282"><span class="linenos">282</span></a>
</span><span id="SpValueValidator-283"><a href="#SpValueValidator-283"><span class="linenos">283</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator-284"><a href="#SpValueValidator-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span><span class="p">:</span>
</span><span id="SpValueValidator-285"><a href="#SpValueValidator-285"><span class="linenos">285</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scenario_column_name</span><span class="p">)</span>
</span><span id="SpValueValidator-286"><a href="#SpValueValidator-286"><span class="linenos">286</span></a>
</span><span id="SpValueValidator-287"><a href="#SpValueValidator-287"><span class="linenos">287</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="SpValueValidator-288"><a href="#SpValueValidator-288"><span class="linenos">288</span></a>            <span class="n">required_columns</span><span class="o">=</span><span class="n">local_required_columns</span><span class="p">,</span>
</span><span id="SpValueValidator-289"><a href="#SpValueValidator-289"><span class="linenos">289</span></a>            <span class="n">model_dataframes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">,</span>
</span><span id="SpValueValidator-290"><a href="#SpValueValidator-290"><span class="linenos">290</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-291"><a href="#SpValueValidator-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpValueValidator-292"><a href="#SpValueValidator-292"><span class="linenos">292</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-293"><a href="#SpValueValidator-293"><span class="linenos">293</span></a>
</span><span id="SpValueValidator-294"><a href="#SpValueValidator-294"><span class="linenos">294</span></a>        <span class="c1"># Prepare cleaned dataframes</span>
</span><span id="SpValueValidator-295"><a href="#SpValueValidator-295"><span class="linenos">295</span></a>        <span class="c1"># No-need to clean the values dataframe</span>
</span><span id="SpValueValidator-296"><a href="#SpValueValidator-296"><span class="linenos">296</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator-297"><a href="#SpValueValidator-297"><span class="linenos">297</span></a>
</span><span id="SpValueValidator-298"><a href="#SpValueValidator-298"><span class="linenos">298</span></a>        <span class="c1"># Need to clean the description and temporal reference dataframes</span>
</span><span id="SpValueValidator-299"><a href="#SpValueValidator-299"><span class="linenos">299</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpValueValidator-300"><a href="#SpValueValidator-300"><span class="linenos">300</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator-301"><a href="#SpValueValidator-301"><span class="linenos">301</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpValueValidator-302"><a href="#SpValueValidator-302"><span class="linenos">302</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator-303"><a href="#SpValueValidator-303"><span class="linenos">303</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-304"><a href="#SpValueValidator-304"><span class="linenos">304</span></a>        <span class="n">df_temporal_reference</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpValueValidator-305"><a href="#SpValueValidator-305"><span class="linenos">305</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">],</span>
</span><span id="SpValueValidator-306"><a href="#SpValueValidator-306"><span class="linenos">306</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">,</span>
</span><span id="SpValueValidator-307"><a href="#SpValueValidator-307"><span class="linenos">307</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">],</span>
</span><span id="SpValueValidator-308"><a href="#SpValueValidator-308"><span class="linenos">308</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-309"><a href="#SpValueValidator-309"><span class="linenos">309</span></a>
</span><span id="SpValueValidator-310"><a href="#SpValueValidator-310"><span class="linenos">310</span></a>        <span class="c1"># Get temporal symbols once (sorted for consistency)</span>
</span><span id="SpValueValidator-311"><a href="#SpValueValidator-311"><span class="linenos">311</span></a>        <span class="n">temporal_symbols</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df_temporal_reference</span><span class="p">[</span><span class="n">symbol_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="SpValueValidator-312"><a href="#SpValueValidator-312"><span class="linenos">312</span></a>        <span class="n">first_year</span> <span class="o">=</span> <span class="n">temporal_symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpValueValidator-313"><a href="#SpValueValidator-313"><span class="linenos">313</span></a>        <span class="n">sp_value_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="SpValueValidator-314"><a href="#SpValueValidator-314"><span class="linenos">314</span></a>
</span><span id="SpValueValidator-315"><a href="#SpValueValidator-315"><span class="linenos">315</span></a>        <span class="c1"># Process each indicator efficiently</span>
</span><span id="SpValueValidator-316"><a href="#SpValueValidator-316"><span class="linenos">316</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_description</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpValueValidator-317"><a href="#SpValueValidator-317"><span class="linenos">317</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">code_column_name</span><span class="p">])</span>
</span><span id="SpValueValidator-318"><a href="#SpValueValidator-318"><span class="linenos">318</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">])</span>
</span><span id="SpValueValidator-319"><a href="#SpValueValidator-319"><span class="linenos">319</span></a>            <span class="n">scenario</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">scenario_column_name</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="SpValueValidator-320"><a href="#SpValueValidator-320"><span class="linenos">320</span></a>
</span><span id="SpValueValidator-321"><a href="#SpValueValidator-321"><span class="linenos">321</span></a>            <span class="c1"># Generate expected combinations based on level and scenario</span>
</span><span id="SpValueValidator-322"><a href="#SpValueValidator-322"><span class="linenos">322</span></a>            <span class="n">expected_combinations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpValueValidator-323"><a href="#SpValueValidator-323"><span class="linenos">323</span></a>            <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SpValueValidator-324"><a href="#SpValueValidator-324"><span class="linenos">324</span></a>                <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SpValueValidator-325"><a href="#SpValueValidator-325"><span class="linenos">325</span></a>                    <span class="n">expected_combinations</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">first_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="SpValueValidator-326"><a href="#SpValueValidator-326"><span class="linenos">326</span></a>                <span class="k">elif</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpValueValidator-327"><a href="#SpValueValidator-327"><span class="linenos">327</span></a>                    <span class="n">expected_combinations</span> <span class="o">=</span> <span class="n">CombinationsProcessing</span><span class="o">.</span><span class="n">generate_combinations</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">first_year</span><span class="p">,</span> <span class="n">temporal_symbols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span><span class="p">)</span>
</span><span id="SpValueValidator-328"><a href="#SpValueValidator-328"><span class="linenos">328</span></a>
</span><span id="SpValueValidator-329"><a href="#SpValueValidator-329"><span class="linenos">329</span></a>            <span class="c1"># Validate required combinations exist</span>
</span><span id="SpValueValidator-330"><a href="#SpValueValidator-330"><span class="linenos">330</span></a>            <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">expected_combinations</span><span class="p">:</span>
</span><span id="SpValueValidator-331"><a href="#SpValueValidator-331"><span class="linenos">331</span></a>                <span class="k">if</span> <span class="n">combination</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sp_value_columns</span><span class="p">:</span>
</span><span id="SpValueValidator-332"><a href="#SpValueValidator-332"><span class="linenos">332</span></a>                    <span class="c1"># Skip validation for level 2 with scenario 0 (special case)</span>
</span><span id="SpValueValidator-333"><a href="#SpValueValidator-333"><span class="linenos">333</span></a>                    <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SpValueValidator-334"><a href="#SpValueValidator-334"><span class="linenos">334</span></a>                        <span class="k">continue</span>
</span><span id="SpValueValidator-335"><a href="#SpValueValidator-335"><span class="linenos">335</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">combination</span><span class="si">}</span><span class="s2">&#39;  obrigatria.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator-336"><a href="#SpValueValidator-336"><span class="linenos">336</span></a>
</span><span id="SpValueValidator-337"><a href="#SpValueValidator-337"><span class="linenos">337</span></a>            <span class="c1"># Find actual combinations for this code</span>
</span><span id="SpValueValidator-338"><a href="#SpValueValidator-338"><span class="linenos">338</span></a>            <span class="n">actual_combinations</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sp_value_columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">-&quot;</span><span class="p">)]</span>
</span><span id="SpValueValidator-339"><a href="#SpValueValidator-339"><span class="linenos">339</span></a>
</span><span id="SpValueValidator-340"><a href="#SpValueValidator-340"><span class="linenos">340</span></a>            <span class="c1"># Check for extra combinations</span>
</span><span id="SpValueValidator-341"><a href="#SpValueValidator-341"><span class="linenos">341</span></a>            <span class="n">has_extra_error</span><span class="p">,</span> <span class="n">extra_columns</span> <span class="o">=</span> <span class="n">CombinationsProcessing</span><span class="o">.</span><span class="n">find_extra_combinations</span><span class="p">(</span><span class="n">expected_combinations</span><span class="p">,</span> <span class="n">actual_combinations</span><span class="p">)</span>
</span><span id="SpValueValidator-342"><a href="#SpValueValidator-342"><span class="linenos">342</span></a>            <span class="k">if</span> <span class="n">has_extra_error</span><span class="p">:</span>
</span><span id="SpValueValidator-343"><a href="#SpValueValidator-343"><span class="linenos">343</span></a>                <span class="k">for</span> <span class="n">extra_column</span> <span class="ow">in</span> <span class="n">extra_columns</span><span class="p">:</span>
</span><span id="SpValueValidator-344"><a href="#SpValueValidator-344"><span class="linenos">344</span></a>                    <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpValueValidator-345"><a href="#SpValueValidator-345"><span class="linenos">345</span></a>                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">extra_column</span><span class="si">}</span><span class="s2">&#39;  desnecessria para o indicador de nvel 1.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator-346"><a href="#SpValueValidator-346"><span class="linenos">346</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="SpValueValidator-347"><a href="#SpValueValidator-347"><span class="linenos">347</span></a>                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">extra_column</span><span class="si">}</span><span class="s2">&#39;  desnecessria.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator-348"><a href="#SpValueValidator-348"><span class="linenos">348</span></a>
</span><span id="SpValueValidator-349"><a href="#SpValueValidator-349"><span class="linenos">349</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-350"><a href="#SpValueValidator-350"><span class="linenos">350</span></a>
</span><span id="SpValueValidator-351"><a href="#SpValueValidator-351"><span class="linenos">351</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unavailable_codes_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator-352"><a href="#SpValueValidator-352"><span class="linenos">352</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator-353"><a href="#SpValueValidator-353"><span class="linenos">353</span></a><span class="sd">        Validate unavailable and invalid values in the data.</span>
</span><span id="SpValueValidator-354"><a href="#SpValueValidator-354"><span class="linenos">354</span></a>
</span><span id="SpValueValidator-355"><a href="#SpValueValidator-355"><span class="linenos">355</span></a><span class="sd">        Performs comprehensive data quality checks including:</span>
</span><span id="SpValueValidator-356"><a href="#SpValueValidator-356"><span class="linenos">356</span></a><span class="sd">        - Invalid numeric values (not numbers and not &quot;DI&quot; marker)</span>
</span><span id="SpValueValidator-357"><a href="#SpValueValidator-357"><span class="linenos">357</span></a><span class="sd">        - Values with more than 2 decimal places</span>
</span><span id="SpValueValidator-358"><a href="#SpValueValidator-358"><span class="linenos">358</span></a><span class="sd">        - Proper format validation for all value columns</span>
</span><span id="SpValueValidator-359"><a href="#SpValueValidator-359"><span class="linenos">359</span></a>
</span><span id="SpValueValidator-360"><a href="#SpValueValidator-360"><span class="linenos">360</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator-361"><a href="#SpValueValidator-361"><span class="linenos">361</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator-362"><a href="#SpValueValidator-362"><span class="linenos">362</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator-363"><a href="#SpValueValidator-363"><span class="linenos">363</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator-364"><a href="#SpValueValidator-364"><span class="linenos">364</span></a><span class="sd">                - List[str]: Error messages for invalid numeric values</span>
</span><span id="SpValueValidator-365"><a href="#SpValueValidator-365"><span class="linenos">365</span></a><span class="sd">                - List[str]: Warning messages for excessive decimal places</span>
</span><span id="SpValueValidator-366"><a href="#SpValueValidator-366"><span class="linenos">366</span></a>
</span><span id="SpValueValidator-367"><a href="#SpValueValidator-367"><span class="linenos">367</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator-368"><a href="#SpValueValidator-368"><span class="linenos">368</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator-369"><a href="#SpValueValidator-369"><span class="linenos">369</span></a><span class="sd">        - ID column is excluded from validation</span>
</span><span id="SpValueValidator-370"><a href="#SpValueValidator-370"><span class="linenos">370</span></a><span class="sd">        - Only columns matching valid ID patterns are validated</span>
</span><span id="SpValueValidator-371"><a href="#SpValueValidator-371"><span class="linenos">371</span></a><span class="sd">        - &quot;Dado indisponvel&quot; (DI) markers are allowed</span>
</span><span id="SpValueValidator-372"><a href="#SpValueValidator-372"><span class="linenos">372</span></a><span class="sd">        - Maximum 2 decimal places enforced for numeric values</span>
</span><span id="SpValueValidator-373"><a href="#SpValueValidator-373"><span class="linenos">373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator-374"><a href="#SpValueValidator-374"><span class="linenos">374</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpValueValidator-375"><a href="#SpValueValidator-375"><span class="linenos">375</span></a>
</span><span id="SpValueValidator-376"><a href="#SpValueValidator-376"><span class="linenos">376</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="SpValueValidator-377"><a href="#SpValueValidator-377"><span class="linenos">377</span></a>            <span class="n">required_columns</span><span class="o">=</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="k">else</span> <span class="p">[])},</span>
</span><span id="SpValueValidator-378"><a href="#SpValueValidator-378"><span class="linenos">378</span></a>            <span class="n">model_dataframes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">,</span>
</span><span id="SpValueValidator-379"><a href="#SpValueValidator-379"><span class="linenos">379</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-380"><a href="#SpValueValidator-380"><span class="linenos">380</span></a>
</span><span id="SpValueValidator-381"><a href="#SpValueValidator-381"><span class="linenos">381</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpValueValidator-382"><a href="#SpValueValidator-382"><span class="linenos">382</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-383"><a href="#SpValueValidator-383"><span class="linenos">383</span></a>
</span><span id="SpValueValidator-384"><a href="#SpValueValidator-384"><span class="linenos">384</span></a>        <span class="n">id_column_name</span> <span class="o">=</span> <span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator-385"><a href="#SpValueValidator-385"><span class="linenos">385</span></a>
</span><span id="SpValueValidator-386"><a href="#SpValueValidator-386"><span class="linenos">386</span></a>        <span class="c1"># Prepare dataframe for validation using generic function</span>
</span><span id="SpValueValidator-387"><a href="#SpValueValidator-387"><span class="linenos">387</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator-388"><a href="#SpValueValidator-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">in</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpValueValidator-389"><a href="#SpValueValidator-389"><span class="linenos">389</span></a>            <span class="n">df_values</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">])</span>
</span><span id="SpValueValidator-390"><a href="#SpValueValidator-390"><span class="linenos">390</span></a>
</span><span id="SpValueValidator-391"><a href="#SpValueValidator-391"><span class="linenos">391</span></a>        <span class="c1"># Get valid columns that match ID patterns</span>
</span><span id="SpValueValidator-392"><a href="#SpValueValidator-392"><span class="linenos">392</span></a>        <span class="n">valid_columns</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">categorize_strings_by_id_pattern_from_list</span><span class="p">(</span><span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span><span class="p">)</span>
</span><span id="SpValueValidator-393"><a href="#SpValueValidator-393"><span class="linenos">393</span></a>
</span><span id="SpValueValidator-394"><a href="#SpValueValidator-394"><span class="linenos">394</span></a>        <span class="c1"># Validate data values in columns using generic function</span>
</span><span id="SpValueValidator-395"><a href="#SpValueValidator-395"><span class="linenos">395</span></a>        <span class="n">validation_errors</span><span class="p">,</span> <span class="n">validation_warnings</span> <span class="o">=</span> <span class="n">ValueProcessing</span><span class="o">.</span><span class="n">validate_data_values_in_columns</span><span class="p">(</span>
</span><span id="SpValueValidator-396"><a href="#SpValueValidator-396"><span class="linenos">396</span></a>            <span class="n">df_values</span><span class="p">,</span> <span class="n">valid_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpValueValidator-397"><a href="#SpValueValidator-397"><span class="linenos">397</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator-398"><a href="#SpValueValidator-398"><span class="linenos">398</span></a>
</span><span id="SpValueValidator-399"><a href="#SpValueValidator-399"><span class="linenos">399</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">validation_errors</span><span class="p">)</span>
</span><span id="SpValueValidator-400"><a href="#SpValueValidator-400"><span class="linenos">400</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">validation_warnings</span><span class="p">)</span>
</span><span id="SpValueValidator-401"><a href="#SpValueValidator-401"><span class="linenos">401</span></a>
</span><span id="SpValueValidator-402"><a href="#SpValueValidator-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator-403"><a href="#SpValueValidator-403"><span class="linenos">403</span></a>
</span><span id="SpValueValidator-404"><a href="#SpValueValidator-404"><span class="linenos">404</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator-405"><a href="#SpValueValidator-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator-406"><a href="#SpValueValidator-406"><span class="linenos">406</span></a><span class="sd">        Execute all value validations.</span>
</span><span id="SpValueValidator-407"><a href="#SpValueValidator-407"><span class="linenos">407</span></a>
</span><span id="SpValueValidator-408"><a href="#SpValueValidator-408"><span class="linenos">408</span></a><span class="sd">        Orchestrates the execution of all value validators including:</span>
</span><span id="SpValueValidator-409"><a href="#SpValueValidator-409"><span class="linenos">409</span></a><span class="sd">        - Indicator relationship validation with description</span>
</span><span id="SpValueValidator-410"><a href="#SpValueValidator-410"><span class="linenos">410</span></a><span class="sd">        - Column combination validation based on level and scenario</span>
</span><span id="SpValueValidator-411"><a href="#SpValueValidator-411"><span class="linenos">411</span></a><span class="sd">        - Data format and quality validation (invalid/unavailable values)</span>
</span><span id="SpValueValidator-412"><a href="#SpValueValidator-412"><span class="linenos">412</span></a>
</span><span id="SpValueValidator-413"><a href="#SpValueValidator-413"><span class="linenos">413</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator-414"><a href="#SpValueValidator-414"><span class="linenos">414</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator-415"><a href="#SpValueValidator-415"><span class="linenos">415</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator-416"><a href="#SpValueValidator-416"><span class="linenos">416</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator-417"><a href="#SpValueValidator-417"><span class="linenos">417</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpValueValidator-418"><a href="#SpValueValidator-418"><span class="linenos">418</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpValueValidator-419"><a href="#SpValueValidator-419"><span class="linenos">419</span></a>
</span><span id="SpValueValidator-420"><a href="#SpValueValidator-420"><span class="linenos">420</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator-421"><a href="#SpValueValidator-421"><span class="linenos">421</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator-422"><a href="#SpValueValidator-422"><span class="linenos">422</span></a><span class="sd">        All validations are skipped if the value dataframe is empty.</span>
</span><span id="SpValueValidator-423"><a href="#SpValueValidator-423"><span class="linenos">423</span></a><span class="sd">        Results are aggregated into reports via `build_reports()`.</span>
</span><span id="SpValueValidator-424"><a href="#SpValueValidator-424"><span class="linenos">424</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator-425"><a href="#SpValueValidator-425"><span class="linenos">425</span></a>
</span><span id="SpValueValidator-426"><a href="#SpValueValidator-426"><span class="linenos">426</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpValueValidator-427"><a href="#SpValueValidator-427"><span class="linenos">427</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpValueValidator-428"><a href="#SpValueValidator-428"><span class="linenos">428</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_value_combination_relation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">VAL_COMB</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpValueValidator-429"><a href="#SpValueValidator-429"><span class="linenos">429</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unavailable_codes_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UNAV_INV</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpValueValidator-430"><a href="#SpValueValidator-430"><span class="linenos">430</span></a>        <span class="p">]</span>
</span><span id="SpValueValidator-431"><a href="#SpValueValidator-431"><span class="linenos">431</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpValueValidator-432"><a href="#SpValueValidator-432"><span class="linenos">432</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpValueValidator-433"><a href="#SpValueValidator-433"><span class="linenos">433</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpValueValidator-434"><a href="#SpValueValidator-434"><span class="linenos">434</span></a>
</span><span id="SpValueValidator-435"><a href="#SpValueValidator-435"><span class="linenos">435</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpValueValidator-436"><a href="#SpValueValidator-436"><span class="linenos">436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpValueValidator-437"><a href="#SpValueValidator-437"><span class="linenos">437</span></a>
</span><span id="SpValueValidator-438"><a href="#SpValueValidator-438"><span class="linenos">438</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates Value spreadsheet content and relationships.</p>

<p>This validator performs comprehensive checks on value data including:</p>

<ul>
<li>Indicator relationship validation with description</li>
<li>Column combination validation based on level and scenario</li>
<li>Data format validation (numeric values, decimal places)</li>
<li>Invalid and unavailable value detection</li>
<li>Temporal reference and scenario consistency</li>
</ul>

<h2 id="attributes">Attributes</h2>

<p>model_sp_value : SpValue
    Value model instance containing indicator data.
model_sp_description : SpDescription
    Description model instance containing indicator metadata.
model_sp_temporal_reference : SpTemporalReference
    Temporal reference model instance for time periods.
model_sp_scenario : SpScenario
    Scenario model instance for scenario definitions.
exists_scenario : bool
    Flag indicating if scenario file exists.
list_scenarios : List[str]
    List of available scenario identifiers.
sp_name_description : str
    Description spreadsheet filename.
sp_name_temporal_reference : str
    Temporal reference spreadsheet filename.
sp_name_scenario : str
    Scenario spreadsheet filename.
sp_name_value : str
    Value spreadsheet filename.
global_required_columns : Dict[str, List[str]]
    Required columns mapping for validation.
model_dataframes : Dict[str, pd.DataFrame]
    DataFrames mapping for each model.</p>
</div>


                            <div id="SpValueValidator.__init__" class="classattr">
                                        <input id="SpValueValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpValueValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpValueValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpValueValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpValueValidator.__init__-64"><a href="#SpValueValidator.__init__-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpValueValidator.__init__-65"><a href="#SpValueValidator.__init__-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpValueValidator.__init__-66"><a href="#SpValueValidator.__init__-66"><span class="linenos"> 66</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpValueValidator.__init__-67"><a href="#SpValueValidator.__init__-67"><span class="linenos"> 67</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpValueValidator.__init__-68"><a href="#SpValueValidator.__init__-68"><span class="linenos"> 68</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpValueValidator.__init__-69"><a href="#SpValueValidator.__init__-69"><span class="linenos"> 69</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpValueValidator.__init__-70"><a href="#SpValueValidator.__init__-70"><span class="linenos"> 70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator.__init__-71"><a href="#SpValueValidator.__init__-71"><span class="linenos"> 71</span></a><span class="sd">        Initialize the Value validator.</span>
</span><span id="SpValueValidator.__init__-72"><a href="#SpValueValidator.__init__-72"><span class="linenos"> 72</span></a>
</span><span id="SpValueValidator.__init__-73"><a href="#SpValueValidator.__init__-73"><span class="linenos"> 73</span></a><span class="sd">        Args</span>
</span><span id="SpValueValidator.__init__-74"><a href="#SpValueValidator.__init__-74"><span class="linenos"> 74</span></a><span class="sd">        ----</span>
</span><span id="SpValueValidator.__init__-75"><a href="#SpValueValidator.__init__-75"><span class="linenos"> 75</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpValueValidator.__init__-76"><a href="#SpValueValidator.__init__-76"><span class="linenos"> 76</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpValueValidator.__init__-77"><a href="#SpValueValidator.__init__-77"><span class="linenos"> 77</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpValueValidator.__init__-78"><a href="#SpValueValidator.__init__-78"><span class="linenos"> 78</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpValueValidator.__init__-79"><a href="#SpValueValidator.__init__-79"><span class="linenos"> 79</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpValueValidator.__init__-80"><a href="#SpValueValidator.__init__-80"><span class="linenos"> 80</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpValueValidator.__init__-81"><a href="#SpValueValidator.__init__-81"><span class="linenos"> 81</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator.__init__-82"><a href="#SpValueValidator.__init__-82"><span class="linenos"> 82</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpValueValidator.__init__-83"><a href="#SpValueValidator.__init__-83"><span class="linenos"> 83</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpValueValidator.__init__-84"><a href="#SpValueValidator.__init__-84"><span class="linenos"> 84</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpValueValidator.__init__-85"><a href="#SpValueValidator.__init__-85"><span class="linenos"> 85</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpValue</span><span class="p">,</span>
</span><span id="SpValueValidator.__init__-86"><a href="#SpValueValidator.__init__-86"><span class="linenos"> 86</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpValueValidator.__init__-87"><a href="#SpValueValidator.__init__-87"><span class="linenos"> 87</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.__init__-88"><a href="#SpValueValidator.__init__-88"><span class="linenos"> 88</span></a>
</span><span id="SpValueValidator.__init__-89"><a href="#SpValueValidator.__init__-89"><span class="linenos"> 89</span></a>        <span class="c1"># Configure</span>
</span><span id="SpValueValidator.__init__-90"><a href="#SpValueValidator.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpValueValidator.__init__-91"><a href="#SpValueValidator.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpValueValidator.__init__-92"><a href="#SpValueValidator.__init__-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_temporal_reference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpTemporalReference</span><span class="p">)</span>
</span><span id="SpValueValidator.__init__-93"><a href="#SpValueValidator.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_scenario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpScenario</span><span class="p">)</span>
</span><span id="SpValueValidator.__init__-94"><a href="#SpValueValidator.__init__-94"><span class="linenos"> 94</span></a>
</span><span id="SpValueValidator.__init__-95"><a href="#SpValueValidator.__init__-95"><span class="linenos"> 95</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpValueValidator.__init__-96"><a href="#SpValueValidator.__init__-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenario_exists_file</span>
</span><span id="SpValueValidator.__init__-97"><a href="#SpValueValidator.__init__-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenarios_list</span>
</span><span id="SpValueValidator.__init__-98"><a href="#SpValueValidator.__init__-98"><span class="linenos"> 98</span></a>
</span><span id="SpValueValidator.__init__-99"><a href="#SpValueValidator.__init__-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator.__init__-100"><a href="#SpValueValidator.__init__-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator.__init__-101"><a href="#SpValueValidator.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator.__init__-102"><a href="#SpValueValidator.__init__-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpValueValidator.__init__-103"><a href="#SpValueValidator.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpValueValidator.__init__-104"><a href="#SpValueValidator.__init__-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpValueValidator.__init__-105"><a href="#SpValueValidator.__init__-105"><span class="linenos">105</span></a>
</span><span id="SpValueValidator.__init__-106"><a href="#SpValueValidator.__init__-106"><span class="linenos">106</span></a>        <span class="c1"># Prepare statements</span>
</span><span id="SpValueValidator.__init__-107"><a href="#SpValueValidator.__init__-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpValueValidator.__init__-108"><a href="#SpValueValidator.__init__-108"><span class="linenos">108</span></a>
</span><span id="SpValueValidator.__init__-109"><a href="#SpValueValidator.__init__-109"><span class="linenos">109</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpValueValidator.__init__-110"><a href="#SpValueValidator.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Value validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpValueValidator.model_sp_value" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_value</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.model_sp_value"></a>
    
    

                            </div>
                            <div id="SpValueValidator.model_sp_description" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_description</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.model_sp_description"></a>
    
    

                            </div>
                            <div id="SpValueValidator.model_sp_temporal_reference" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_temporal_reference</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.model_sp_temporal_reference"></a>
    
    

                            </div>
                            <div id="SpValueValidator.model_sp_scenario" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_scenario</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.model_sp_scenario"></a>
    
    

                            </div>
                            <div id="SpValueValidator.exists_scenario" class="classattr">
                                <div class="attr variable">
            <span class="name">exists_scenario</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.exists_scenario"></a>
    
    

                            </div>
                            <div id="SpValueValidator.list_scenarios" class="classattr">
                                <div class="attr variable">
            <span class="name">list_scenarios</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.list_scenarios"></a>
    
    

                            </div>
                            <div id="SpValueValidator.sp_name_description" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_description</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.sp_name_description"></a>
    
    

                            </div>
                            <div id="SpValueValidator.sp_name_temporal_reference" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_temporal_reference</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.sp_name_temporal_reference"></a>
    
    

                            </div>
                            <div id="SpValueValidator.sp_name_scenario" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_scenario</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.sp_name_scenario"></a>
    
    

                            </div>
                            <div id="SpValueValidator.sp_name_value" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_value</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.sp_name_value"></a>
    
    

                            </div>
                            <div id="SpValueValidator.global_required_columns" class="classattr">
                                <div class="attr variable">
            <span class="name">global_required_columns</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.global_required_columns"></a>
    
    

                            </div>
                            <div id="SpValueValidator.model_dataframes" class="classattr">
                                <div class="attr variable">
            <span class="name">model_dataframes</span>

        
    </div>
    <a class="headerlink" href="#SpValueValidator.model_dataframes"></a>
    
    

                            </div>
                            <div id="SpValueValidator.validate_relation_indicators_in_values" class="classattr">
                                        <input id="SpValueValidator.validate_relation_indicators_in_values-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_relation_indicators_in_values</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpValueValidator.validate_relation_indicators_in_values-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpValueValidator.validate_relation_indicators_in_values"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpValueValidator.validate_relation_indicators_in_values-151"><a href="#SpValueValidator.validate_relation_indicators_in_values-151"><span class="linenos">151</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-152"><a href="#SpValueValidator.validate_relation_indicators_in_values-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-153"><a href="#SpValueValidator.validate_relation_indicators_in_values-153"><span class="linenos">153</span></a><span class="sd">        Validate indicator relationships between values and descriptions.</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-154"><a href="#SpValueValidator.validate_relation_indicators_in_values-154"><span class="linenos">154</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-155"><a href="#SpValueValidator.validate_relation_indicators_in_values-155"><span class="linenos">155</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-156"><a href="#SpValueValidator.validate_relation_indicators_in_values-156"><span class="linenos">156</span></a><span class="sd">        - All value columns match valid indicator codes from description</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-157"><a href="#SpValueValidator.validate_relation_indicators_in_values-157"><span class="linenos">157</span></a><span class="sd">        - Level 1 indicators are excluded from validation</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-158"><a href="#SpValueValidator.validate_relation_indicators_in_values-158"><span class="linenos">158</span></a><span class="sd">        - Level 2 indicators with scenario 0 are handled appropriately</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-159"><a href="#SpValueValidator.validate_relation_indicators_in_values-159"><span class="linenos">159</span></a><span class="sd">        - All description indicators (except excluded levels) exist in values</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-160"><a href="#SpValueValidator.validate_relation_indicators_in_values-160"><span class="linenos">160</span></a><span class="sd">        - Column names follow valid patterns (code-year or code-year-scenario)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-161"><a href="#SpValueValidator.validate_relation_indicators_in_values-161"><span class="linenos">161</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-162"><a href="#SpValueValidator.validate_relation_indicators_in_values-162"><span class="linenos">162</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-163"><a href="#SpValueValidator.validate_relation_indicators_in_values-163"><span class="linenos">163</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-164"><a href="#SpValueValidator.validate_relation_indicators_in_values-164"><span class="linenos">164</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-165"><a href="#SpValueValidator.validate_relation_indicators_in_values-165"><span class="linenos">165</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-166"><a href="#SpValueValidator.validate_relation_indicators_in_values-166"><span class="linenos">166</span></a><span class="sd">                - List[str]: Error messages for missing indicators and invalid columns</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-167"><a href="#SpValueValidator.validate_relation_indicators_in_values-167"><span class="linenos">167</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-168"><a href="#SpValueValidator.validate_relation_indicators_in_values-168"><span class="linenos">168</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-169"><a href="#SpValueValidator.validate_relation_indicators_in_values-169"><span class="linenos">169</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-170"><a href="#SpValueValidator.validate_relation_indicators_in_values-170"><span class="linenos">170</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-171"><a href="#SpValueValidator.validate_relation_indicators_in_values-171"><span class="linenos">171</span></a><span class="sd">        - Validation is skipped if description dataframe is empty</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-172"><a href="#SpValueValidator.validate_relation_indicators_in_values-172"><span class="linenos">172</span></a><span class="sd">        - Level 1 indicators are automatically excluded</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-173"><a href="#SpValueValidator.validate_relation_indicators_in_values-173"><span class="linenos">173</span></a><span class="sd">        - Columns containing &#39;:&#39; are ignored in invalid column detection</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-174"><a href="#SpValueValidator.validate_relation_indicators_in_values-174"><span class="linenos">174</span></a><span class="sd">        - Level 2 with scenario 0 are conditionally excluded</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-175"><a href="#SpValueValidator.validate_relation_indicators_in_values-175"><span class="linenos">175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-176"><a href="#SpValueValidator.validate_relation_indicators_in_values-176"><span class="linenos">176</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-177"><a href="#SpValueValidator.validate_relation_indicators_in_values-177"><span class="linenos">177</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-178"><a href="#SpValueValidator.validate_relation_indicators_in_values-178"><span class="linenos">178</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-179"><a href="#SpValueValidator.validate_relation_indicators_in_values-179"><span class="linenos">179</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-180"><a href="#SpValueValidator.validate_relation_indicators_in_values-180"><span class="linenos">180</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-181"><a href="#SpValueValidator.validate_relation_indicators_in_values-181"><span class="linenos">181</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-182"><a href="#SpValueValidator.validate_relation_indicators_in_values-182"><span class="linenos">182</span></a>            <span class="n">required_columns</span><span class="o">=</span><span class="p">{</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-183"><a href="#SpValueValidator.validate_relation_indicators_in_values-183"><span class="linenos">183</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-184"><a href="#SpValueValidator.validate_relation_indicators_in_values-184"><span class="linenos">184</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-185"><a href="#SpValueValidator.validate_relation_indicators_in_values-185"><span class="linenos">185</span></a>            <span class="p">},</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-186"><a href="#SpValueValidator.validate_relation_indicators_in_values-186"><span class="linenos">186</span></a>            <span class="n">model_dataframes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-187"><a href="#SpValueValidator.validate_relation_indicators_in_values-187"><span class="linenos">187</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-188"><a href="#SpValueValidator.validate_relation_indicators_in_values-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-189"><a href="#SpValueValidator.validate_relation_indicators_in_values-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-190"><a href="#SpValueValidator.validate_relation_indicators_in_values-190"><span class="linenos">190</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-191"><a href="#SpValueValidator.validate_relation_indicators_in_values-191"><span class="linenos">191</span></a>        <span class="n">code_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-192"><a href="#SpValueValidator.validate_relation_indicators_in_values-192"><span class="linenos">192</span></a>        <span class="n">level_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-193"><a href="#SpValueValidator.validate_relation_indicators_in_values-193"><span class="linenos">193</span></a>        <span class="n">scenario_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_SCENARIO</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-194"><a href="#SpValueValidator.validate_relation_indicators_in_values-194"><span class="linenos">194</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-195"><a href="#SpValueValidator.validate_relation_indicators_in_values-195"><span class="linenos">195</span></a>        <span class="c1"># Prepare cleaned dataframes</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-196"><a href="#SpValueValidator.validate_relation_indicators_in_values-196"><span class="linenos">196</span></a>        <span class="c1"># No-need to clean the values dataframe</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-197"><a href="#SpValueValidator.validate_relation_indicators_in_values-197"><span class="linenos">197</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-198"><a href="#SpValueValidator.validate_relation_indicators_in_values-198"><span class="linenos">198</span></a>        <span class="c1"># Need to clean the description and temporal reference dataframes</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-199"><a href="#SpValueValidator.validate_relation_indicators_in_values-199"><span class="linenos">199</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-200"><a href="#SpValueValidator.validate_relation_indicators_in_values-200"><span class="linenos">200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-201"><a href="#SpValueValidator.validate_relation_indicators_in_values-201"><span class="linenos">201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-202"><a href="#SpValueValidator.validate_relation_indicators_in_values-202"><span class="linenos">202</span></a>            <span class="p">[</span><span class="n">code_column_name</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-203"><a href="#SpValueValidator.validate_relation_indicators_in_values-203"><span class="linenos">203</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-204"><a href="#SpValueValidator.validate_relation_indicators_in_values-204"><span class="linenos">204</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-205"><a href="#SpValueValidator.validate_relation_indicators_in_values-205"><span class="linenos">205</span></a>        <span class="n">level_one_codes</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span><span class="n">code_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-206"><a href="#SpValueValidator.validate_relation_indicators_in_values-206"><span class="linenos">206</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-207"><a href="#SpValueValidator.validate_relation_indicators_in_values-207"><span class="linenos">207</span></a>        <span class="c1"># Process value columns</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-208"><a href="#SpValueValidator.validate_relation_indicators_in_values-208"><span class="linenos">208</span></a>        <span class="n">value_columns</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-209"><a href="#SpValueValidator.validate_relation_indicators_in_values-209"><span class="linenos">209</span></a>        <span class="n">columns_to_ignore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span> <span class="o">+</span> <span class="n">level_one_codes</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-210"><a href="#SpValueValidator.validate_relation_indicators_in_values-210"><span class="linenos">210</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-211"><a href="#SpValueValidator.validate_relation_indicators_in_values-211"><span class="linenos">211</span></a>        <span class="n">valid_value_codes</span><span class="p">,</span> <span class="n">invalid_columns</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_ids_and_unmatched_strings_from_list</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-212"><a href="#SpValueValidator.validate_relation_indicators_in_values-212"><span class="linenos">212</span></a>            <span class="n">value_columns</span><span class="p">,</span> <span class="n">columns_to_ignore</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-213"><a href="#SpValueValidator.validate_relation_indicators_in_values-213"><span class="linenos">213</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-214"><a href="#SpValueValidator.validate_relation_indicators_in_values-214"><span class="linenos">214</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-215"><a href="#SpValueValidator.validate_relation_indicators_in_values-215"><span class="linenos">215</span></a>        <span class="c1"># Filter out columns containing &#39;:&#39;</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-216"><a href="#SpValueValidator.validate_relation_indicators_in_values-216"><span class="linenos">216</span></a>        <span class="n">processed_invalid_columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">({</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">invalid_columns</span> <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col</span><span class="p">})</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-217"><a href="#SpValueValidator.validate_relation_indicators_in_values-217"><span class="linenos">217</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-218"><a href="#SpValueValidator.validate_relation_indicators_in_values-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="n">processed_invalid_columns</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-219"><a href="#SpValueValidator.validate_relation_indicators_in_values-219"><span class="linenos">219</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: Colunas invlidas: </span><span class="si">{</span><span class="n">processed_invalid_columns</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-220"><a href="#SpValueValidator.validate_relation_indicators_in_values-220"><span class="linenos">220</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-221"><a href="#SpValueValidator.validate_relation_indicators_in_values-221"><span class="linenos">221</span></a>        <span class="c1"># Get filtered description codes using generic function</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-222"><a href="#SpValueValidator.validate_relation_indicators_in_values-222"><span class="linenos">222</span></a>        <span class="c1"># Remove level 1 indicators</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-223"><a href="#SpValueValidator.validate_relation_indicators_in_values-223"><span class="linenos">223</span></a>        <span class="n">filtered_description_df</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-224"><a href="#SpValueValidator.validate_relation_indicators_in_values-224"><span class="linenos">224</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-225"><a href="#SpValueValidator.validate_relation_indicators_in_values-225"><span class="linenos">225</span></a>        <span class="c1"># Remove level 2 indicators with scenario 0 if scenario column exists</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-226"><a href="#SpValueValidator.validate_relation_indicators_in_values-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="ow">and</span> <span class="n">scenario_column_name</span> <span class="ow">in</span> <span class="n">filtered_description_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-227"><a href="#SpValueValidator.validate_relation_indicators_in_values-227"><span class="linenos">227</span></a>            <span class="n">filtered_description_df</span> <span class="o">=</span> <span class="n">filtered_description_df</span><span class="p">[</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-228"><a href="#SpValueValidator.validate_relation_indicators_in_values-228"><span class="linenos">228</span></a>                <span class="o">~</span><span class="p">((</span><span class="n">filtered_description_df</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">filtered_description_df</span><span class="p">[</span><span class="n">scenario_column_name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-229"><a href="#SpValueValidator.validate_relation_indicators_in_values-229"><span class="linenos">229</span></a>            <span class="p">]</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-230"><a href="#SpValueValidator.validate_relation_indicators_in_values-230"><span class="linenos">230</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-231"><a href="#SpValueValidator.validate_relation_indicators_in_values-231"><span class="linenos">231</span></a>        <span class="c1"># Extract valid description codes</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-232"><a href="#SpValueValidator.validate_relation_indicators_in_values-232"><span class="linenos">232</span></a>        <span class="n">valid_description_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-233"><a href="#SpValueValidator.validate_relation_indicators_in_values-233"><span class="linenos">233</span></a>            <span class="n">id_values_list</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">filtered_description_df</span><span class="p">[</span><span class="n">code_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-234"><a href="#SpValueValidator.validate_relation_indicators_in_values-234"><span class="linenos">234</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-235"><a href="#SpValueValidator.validate_relation_indicators_in_values-235"><span class="linenos">235</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-236"><a href="#SpValueValidator.validate_relation_indicators_in_values-236"><span class="linenos">236</span></a>        <span class="c1"># Compare codes between description and values</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-237"><a href="#SpValueValidator.validate_relation_indicators_in_values-237"><span class="linenos">237</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-238"><a href="#SpValueValidator.validate_relation_indicators_in_values-238"><span class="linenos">238</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">valid_description_codes</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-239"><a href="#SpValueValidator.validate_relation_indicators_in_values-239"><span class="linenos">239</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-240"><a href="#SpValueValidator.validate_relation_indicators_in_values-240"><span class="linenos">240</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">valid_value_codes</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-241"><a href="#SpValueValidator.validate_relation_indicators_in_values-241"><span class="linenos">241</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-242"><a href="#SpValueValidator.validate_relation_indicators_in_values-242"><span class="linenos">242</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-243"><a href="#SpValueValidator.validate_relation_indicators_in_values-243"><span class="linenos">243</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-244"><a href="#SpValueValidator.validate_relation_indicators_in_values-244"><span class="linenos">244</span></a>
</span><span id="SpValueValidator.validate_relation_indicators_in_values-245"><a href="#SpValueValidator.validate_relation_indicators_in_values-245"><span class="linenos">245</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate indicator relationships between values and descriptions.</p>

<p>Ensures that:</p>

<ul>
<li>All value columns match valid indicator codes from description</li>
<li>Level 1 indicators are excluded from validation</li>
<li>Level 2 indicators with scenario 0 are handled appropriately</li>
<li>All description indicators (except excluded levels) exist in values</li>
<li>Column names follow valid patterns (code-year or code-year-scenario)</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for missing indicators and invalid columns
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if description dataframe is empty</li>
<li>Level 1 indicators are automatically excluded</li>
<li>Columns containing ':' are ignored in invalid column detection</li>
<li>Level 2 with scenario 0 are conditionally excluded</li>
</ul>
</div>


                            </div>
                            <div id="SpValueValidator.validate_value_combination_relation" class="classattr">
                                        <input id="SpValueValidator.validate_value_combination_relation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_value_combination_relation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpValueValidator.validate_value_combination_relation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpValueValidator.validate_value_combination_relation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpValueValidator.validate_value_combination_relation-247"><a href="#SpValueValidator.validate_value_combination_relation-247"><span class="linenos">247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_value_combination_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-248"><a href="#SpValueValidator.validate_value_combination_relation-248"><span class="linenos">248</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator.validate_value_combination_relation-249"><a href="#SpValueValidator.validate_value_combination_relation-249"><span class="linenos">249</span></a><span class="sd">        Validate value combination relations between indicators and their expected columns.</span>
</span><span id="SpValueValidator.validate_value_combination_relation-250"><a href="#SpValueValidator.validate_value_combination_relation-250"><span class="linenos">250</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-251"><a href="#SpValueValidator.validate_value_combination_relation-251"><span class="linenos">251</span></a><span class="sd">        Ensures that each indicator has the correct combination of columns in the values</span>
</span><span id="SpValueValidator.validate_value_combination_relation-252"><a href="#SpValueValidator.validate_value_combination_relation-252"><span class="linenos">252</span></a><span class="sd">        dataframe based on its level and scenario configuration. Validates:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-253"><a href="#SpValueValidator.validate_value_combination_relation-253"><span class="linenos">253</span></a><span class="sd">        - Level &gt;= 2 indicators have appropriate temporal-scenario combinations</span>
</span><span id="SpValueValidator.validate_value_combination_relation-254"><a href="#SpValueValidator.validate_value_combination_relation-254"><span class="linenos">254</span></a><span class="sd">        - Level 2 with scenario 0 have only base year column</span>
</span><span id="SpValueValidator.validate_value_combination_relation-255"><a href="#SpValueValidator.validate_value_combination_relation-255"><span class="linenos">255</span></a><span class="sd">        - Level 2 with scenario 1 have full temporal-scenario matrix</span>
</span><span id="SpValueValidator.validate_value_combination_relation-256"><a href="#SpValueValidator.validate_value_combination_relation-256"><span class="linenos">256</span></a><span class="sd">        - No extra unnecessary columns exist for any indicator</span>
</span><span id="SpValueValidator.validate_value_combination_relation-257"><a href="#SpValueValidator.validate_value_combination_relation-257"><span class="linenos">257</span></a><span class="sd">        - No missing required combinations</span>
</span><span id="SpValueValidator.validate_value_combination_relation-258"><a href="#SpValueValidator.validate_value_combination_relation-258"><span class="linenos">258</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-259"><a href="#SpValueValidator.validate_value_combination_relation-259"><span class="linenos">259</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator.validate_value_combination_relation-260"><a href="#SpValueValidator.validate_value_combination_relation-260"><span class="linenos">260</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator.validate_value_combination_relation-261"><a href="#SpValueValidator.validate_value_combination_relation-261"><span class="linenos">261</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator.validate_value_combination_relation-262"><a href="#SpValueValidator.validate_value_combination_relation-262"><span class="linenos">262</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-263"><a href="#SpValueValidator.validate_value_combination_relation-263"><span class="linenos">263</span></a><span class="sd">                - List[str]: Error messages for missing/extra columns</span>
</span><span id="SpValueValidator.validate_value_combination_relation-264"><a href="#SpValueValidator.validate_value_combination_relation-264"><span class="linenos">264</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-265"><a href="#SpValueValidator.validate_value_combination_relation-265"><span class="linenos">265</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-266"><a href="#SpValueValidator.validate_value_combination_relation-266"><span class="linenos">266</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator.validate_value_combination_relation-267"><a href="#SpValueValidator.validate_value_combination_relation-267"><span class="linenos">267</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator.validate_value_combination_relation-268"><a href="#SpValueValidator.validate_value_combination_relation-268"><span class="linenos">268</span></a><span class="sd">        - Validation is skipped if description or temporal reference is empty</span>
</span><span id="SpValueValidator.validate_value_combination_relation-269"><a href="#SpValueValidator.validate_value_combination_relation-269"><span class="linenos">269</span></a><span class="sd">        - Level 1 indicators should not have any temporal columns</span>
</span><span id="SpValueValidator.validate_value_combination_relation-270"><a href="#SpValueValidator.validate_value_combination_relation-270"><span class="linenos">270</span></a><span class="sd">        - Level &gt;= 2 indicators require specific combinations based on scenario</span>
</span><span id="SpValueValidator.validate_value_combination_relation-271"><a href="#SpValueValidator.validate_value_combination_relation-271"><span class="linenos">271</span></a><span class="sd">        - Extra columns are flagged with specific messages per level</span>
</span><span id="SpValueValidator.validate_value_combination_relation-272"><a href="#SpValueValidator.validate_value_combination_relation-272"><span class="linenos">272</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator.validate_value_combination_relation-273"><a href="#SpValueValidator.validate_value_combination_relation-273"><span class="linenos">273</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpValueValidator.validate_value_combination_relation-274"><a href="#SpValueValidator.validate_value_combination_relation-274"><span class="linenos">274</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-275"><a href="#SpValueValidator.validate_value_combination_relation-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-276"><a href="#SpValueValidator.validate_value_combination_relation-276"><span class="linenos">276</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator.validate_value_combination_relation-277"><a href="#SpValueValidator.validate_value_combination_relation-277"><span class="linenos">277</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-278"><a href="#SpValueValidator.validate_value_combination_relation-278"><span class="linenos">278</span></a>        <span class="n">code_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_value_combination_relation-279"><a href="#SpValueValidator.validate_value_combination_relation-279"><span class="linenos">279</span></a>        <span class="n">level_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_value_combination_relation-280"><a href="#SpValueValidator.validate_value_combination_relation-280"><span class="linenos">280</span></a>        <span class="n">scenario_column_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_SCENARIO</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_value_combination_relation-281"><a href="#SpValueValidator.validate_value_combination_relation-281"><span class="linenos">281</span></a>        <span class="n">symbol_column_name</span> <span class="o">=</span> <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_value_combination_relation-282"><a href="#SpValueValidator.validate_value_combination_relation-282"><span class="linenos">282</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-283"><a href="#SpValueValidator.validate_value_combination_relation-283"><span class="linenos">283</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator.validate_value_combination_relation-284"><a href="#SpValueValidator.validate_value_combination_relation-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-285"><a href="#SpValueValidator.validate_value_combination_relation-285"><span class="linenos">285</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scenario_column_name</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-286"><a href="#SpValueValidator.validate_value_combination_relation-286"><span class="linenos">286</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-287"><a href="#SpValueValidator.validate_value_combination_relation-287"><span class="linenos">287</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_value_combination_relation-288"><a href="#SpValueValidator.validate_value_combination_relation-288"><span class="linenos">288</span></a>            <span class="n">required_columns</span><span class="o">=</span><span class="n">local_required_columns</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_value_combination_relation-289"><a href="#SpValueValidator.validate_value_combination_relation-289"><span class="linenos">289</span></a>            <span class="n">model_dataframes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_value_combination_relation-290"><a href="#SpValueValidator.validate_value_combination_relation-290"><span class="linenos">290</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-291"><a href="#SpValueValidator.validate_value_combination_relation-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-292"><a href="#SpValueValidator.validate_value_combination_relation-292"><span class="linenos">292</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator.validate_value_combination_relation-293"><a href="#SpValueValidator.validate_value_combination_relation-293"><span class="linenos">293</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-294"><a href="#SpValueValidator.validate_value_combination_relation-294"><span class="linenos">294</span></a>        <span class="c1"># Prepare cleaned dataframes</span>
</span><span id="SpValueValidator.validate_value_combination_relation-295"><a href="#SpValueValidator.validate_value_combination_relation-295"><span class="linenos">295</span></a>        <span class="c1"># No-need to clean the values dataframe</span>
</span><span id="SpValueValidator.validate_value_combination_relation-296"><a href="#SpValueValidator.validate_value_combination_relation-296"><span class="linenos">296</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator.validate_value_combination_relation-297"><a href="#SpValueValidator.validate_value_combination_relation-297"><span class="linenos">297</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-298"><a href="#SpValueValidator.validate_value_combination_relation-298"><span class="linenos">298</span></a>        <span class="c1"># Need to clean the description and temporal reference dataframes</span>
</span><span id="SpValueValidator.validate_value_combination_relation-299"><a href="#SpValueValidator.validate_value_combination_relation-299"><span class="linenos">299</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_value_combination_relation-300"><a href="#SpValueValidator.validate_value_combination_relation-300"><span class="linenos">300</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_value_combination_relation-301"><a href="#SpValueValidator.validate_value_combination_relation-301"><span class="linenos">301</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_value_combination_relation-302"><a href="#SpValueValidator.validate_value_combination_relation-302"><span class="linenos">302</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_value_combination_relation-303"><a href="#SpValueValidator.validate_value_combination_relation-303"><span class="linenos">303</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-304"><a href="#SpValueValidator.validate_value_combination_relation-304"><span class="linenos">304</span></a>        <span class="n">df_temporal_reference</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_value_combination_relation-305"><a href="#SpValueValidator.validate_value_combination_relation-305"><span class="linenos">305</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_value_combination_relation-306"><a href="#SpValueValidator.validate_value_combination_relation-306"><span class="linenos">306</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_value_combination_relation-307"><a href="#SpValueValidator.validate_value_combination_relation-307"><span class="linenos">307</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_temporal_reference</span><span class="p">],</span>
</span><span id="SpValueValidator.validate_value_combination_relation-308"><a href="#SpValueValidator.validate_value_combination_relation-308"><span class="linenos">308</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-309"><a href="#SpValueValidator.validate_value_combination_relation-309"><span class="linenos">309</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-310"><a href="#SpValueValidator.validate_value_combination_relation-310"><span class="linenos">310</span></a>        <span class="c1"># Get temporal symbols once (sorted for consistency)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-311"><a href="#SpValueValidator.validate_value_combination_relation-311"><span class="linenos">311</span></a>        <span class="n">temporal_symbols</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df_temporal_reference</span><span class="p">[</span><span class="n">symbol_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="SpValueValidator.validate_value_combination_relation-312"><a href="#SpValueValidator.validate_value_combination_relation-312"><span class="linenos">312</span></a>        <span class="n">first_year</span> <span class="o">=</span> <span class="n">temporal_symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpValueValidator.validate_value_combination_relation-313"><a href="#SpValueValidator.validate_value_combination_relation-313"><span class="linenos">313</span></a>        <span class="n">sp_value_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-314"><a href="#SpValueValidator.validate_value_combination_relation-314"><span class="linenos">314</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-315"><a href="#SpValueValidator.validate_value_combination_relation-315"><span class="linenos">315</span></a>        <span class="c1"># Process each indicator efficiently</span>
</span><span id="SpValueValidator.validate_value_combination_relation-316"><a href="#SpValueValidator.validate_value_combination_relation-316"><span class="linenos">316</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_description</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpValueValidator.validate_value_combination_relation-317"><a href="#SpValueValidator.validate_value_combination_relation-317"><span class="linenos">317</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">code_column_name</span><span class="p">])</span>
</span><span id="SpValueValidator.validate_value_combination_relation-318"><a href="#SpValueValidator.validate_value_combination_relation-318"><span class="linenos">318</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">level_column_name</span><span class="p">])</span>
</span><span id="SpValueValidator.validate_value_combination_relation-319"><a href="#SpValueValidator.validate_value_combination_relation-319"><span class="linenos">319</span></a>            <span class="n">scenario</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">scenario_column_name</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="SpValueValidator.validate_value_combination_relation-320"><a href="#SpValueValidator.validate_value_combination_relation-320"><span class="linenos">320</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-321"><a href="#SpValueValidator.validate_value_combination_relation-321"><span class="linenos">321</span></a>            <span class="c1"># Generate expected combinations based on level and scenario</span>
</span><span id="SpValueValidator.validate_value_combination_relation-322"><a href="#SpValueValidator.validate_value_combination_relation-322"><span class="linenos">322</span></a>            <span class="n">expected_combinations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpValueValidator.validate_value_combination_relation-323"><a href="#SpValueValidator.validate_value_combination_relation-323"><span class="linenos">323</span></a>            <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-324"><a href="#SpValueValidator.validate_value_combination_relation-324"><span class="linenos">324</span></a>                <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-325"><a href="#SpValueValidator.validate_value_combination_relation-325"><span class="linenos">325</span></a>                    <span class="n">expected_combinations</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">first_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="SpValueValidator.validate_value_combination_relation-326"><a href="#SpValueValidator.validate_value_combination_relation-326"><span class="linenos">326</span></a>                <span class="k">elif</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-327"><a href="#SpValueValidator.validate_value_combination_relation-327"><span class="linenos">327</span></a>                    <span class="n">expected_combinations</span> <span class="o">=</span> <span class="n">CombinationsProcessing</span><span class="o">.</span><span class="n">generate_combinations</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">first_year</span><span class="p">,</span> <span class="n">temporal_symbols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-328"><a href="#SpValueValidator.validate_value_combination_relation-328"><span class="linenos">328</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-329"><a href="#SpValueValidator.validate_value_combination_relation-329"><span class="linenos">329</span></a>            <span class="c1"># Validate required combinations exist</span>
</span><span id="SpValueValidator.validate_value_combination_relation-330"><a href="#SpValueValidator.validate_value_combination_relation-330"><span class="linenos">330</span></a>            <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">expected_combinations</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-331"><a href="#SpValueValidator.validate_value_combination_relation-331"><span class="linenos">331</span></a>                <span class="k">if</span> <span class="n">combination</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sp_value_columns</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-332"><a href="#SpValueValidator.validate_value_combination_relation-332"><span class="linenos">332</span></a>                    <span class="c1"># Skip validation for level 2 with scenario 0 (special case)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-333"><a href="#SpValueValidator.validate_value_combination_relation-333"><span class="linenos">333</span></a>                    <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-334"><a href="#SpValueValidator.validate_value_combination_relation-334"><span class="linenos">334</span></a>                        <span class="k">continue</span>
</span><span id="SpValueValidator.validate_value_combination_relation-335"><a href="#SpValueValidator.validate_value_combination_relation-335"><span class="linenos">335</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">combination</span><span class="si">}</span><span class="s2">&#39;  obrigatria.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-336"><a href="#SpValueValidator.validate_value_combination_relation-336"><span class="linenos">336</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-337"><a href="#SpValueValidator.validate_value_combination_relation-337"><span class="linenos">337</span></a>            <span class="c1"># Find actual combinations for this code</span>
</span><span id="SpValueValidator.validate_value_combination_relation-338"><a href="#SpValueValidator.validate_value_combination_relation-338"><span class="linenos">338</span></a>            <span class="n">actual_combinations</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sp_value_columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">-&quot;</span><span class="p">)]</span>
</span><span id="SpValueValidator.validate_value_combination_relation-339"><a href="#SpValueValidator.validate_value_combination_relation-339"><span class="linenos">339</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-340"><a href="#SpValueValidator.validate_value_combination_relation-340"><span class="linenos">340</span></a>            <span class="c1"># Check for extra combinations</span>
</span><span id="SpValueValidator.validate_value_combination_relation-341"><a href="#SpValueValidator.validate_value_combination_relation-341"><span class="linenos">341</span></a>            <span class="n">has_extra_error</span><span class="p">,</span> <span class="n">extra_columns</span> <span class="o">=</span> <span class="n">CombinationsProcessing</span><span class="o">.</span><span class="n">find_extra_combinations</span><span class="p">(</span><span class="n">expected_combinations</span><span class="p">,</span> <span class="n">actual_combinations</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-342"><a href="#SpValueValidator.validate_value_combination_relation-342"><span class="linenos">342</span></a>            <span class="k">if</span> <span class="n">has_extra_error</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-343"><a href="#SpValueValidator.validate_value_combination_relation-343"><span class="linenos">343</span></a>                <span class="k">for</span> <span class="n">extra_column</span> <span class="ow">in</span> <span class="n">extra_columns</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-344"><a href="#SpValueValidator.validate_value_combination_relation-344"><span class="linenos">344</span></a>                    <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-345"><a href="#SpValueValidator.validate_value_combination_relation-345"><span class="linenos">345</span></a>                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">extra_column</span><span class="si">}</span><span class="s2">&#39;  desnecessria para o indicador de nvel 1.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-346"><a href="#SpValueValidator.validate_value_combination_relation-346"><span class="linenos">346</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_value_combination_relation-347"><a href="#SpValueValidator.validate_value_combination_relation-347"><span class="linenos">347</span></a>                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">: A coluna &#39;</span><span class="si">{</span><span class="n">extra_column</span><span class="si">}</span><span class="s2">&#39;  desnecessria.&quot;</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_value_combination_relation-348"><a href="#SpValueValidator.validate_value_combination_relation-348"><span class="linenos">348</span></a>
</span><span id="SpValueValidator.validate_value_combination_relation-349"><a href="#SpValueValidator.validate_value_combination_relation-349"><span class="linenos">349</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate value combination relations between indicators and their expected columns.</p>

<p>Ensures that each indicator has the correct combination of columns in the values
dataframe based on its level and scenario configuration. Validates:</p>

<ul>
<li>Level &gt;= 2 indicators have appropriate temporal-scenario combinations</li>
<li>Level 2 with scenario 0 have only base year column</li>
<li>Level 2 with scenario 1 have full temporal-scenario matrix</li>
<li>No extra unnecessary columns exist for any indicator</li>
<li>No missing required combinations</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for missing/extra columns
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if description or temporal reference is empty</li>
<li>Level 1 indicators should not have any temporal columns</li>
<li>Level &gt;= 2 indicators require specific combinations based on scenario</li>
<li>Extra columns are flagged with specific messages per level</li>
</ul>
</div>


                            </div>
                            <div id="SpValueValidator.validate_unavailable_codes_values" class="classattr">
                                        <input id="SpValueValidator.validate_unavailable_codes_values-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_unavailable_codes_values</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpValueValidator.validate_unavailable_codes_values-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpValueValidator.validate_unavailable_codes_values"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpValueValidator.validate_unavailable_codes_values-351"><a href="#SpValueValidator.validate_unavailable_codes_values-351"><span class="linenos">351</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unavailable_codes_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-352"><a href="#SpValueValidator.validate_unavailable_codes_values-352"><span class="linenos">352</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-353"><a href="#SpValueValidator.validate_unavailable_codes_values-353"><span class="linenos">353</span></a><span class="sd">        Validate unavailable and invalid values in the data.</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-354"><a href="#SpValueValidator.validate_unavailable_codes_values-354"><span class="linenos">354</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-355"><a href="#SpValueValidator.validate_unavailable_codes_values-355"><span class="linenos">355</span></a><span class="sd">        Performs comprehensive data quality checks including:</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-356"><a href="#SpValueValidator.validate_unavailable_codes_values-356"><span class="linenos">356</span></a><span class="sd">        - Invalid numeric values (not numbers and not &quot;DI&quot; marker)</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-357"><a href="#SpValueValidator.validate_unavailable_codes_values-357"><span class="linenos">357</span></a><span class="sd">        - Values with more than 2 decimal places</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-358"><a href="#SpValueValidator.validate_unavailable_codes_values-358"><span class="linenos">358</span></a><span class="sd">        - Proper format validation for all value columns</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-359"><a href="#SpValueValidator.validate_unavailable_codes_values-359"><span class="linenos">359</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-360"><a href="#SpValueValidator.validate_unavailable_codes_values-360"><span class="linenos">360</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-361"><a href="#SpValueValidator.validate_unavailable_codes_values-361"><span class="linenos">361</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-362"><a href="#SpValueValidator.validate_unavailable_codes_values-362"><span class="linenos">362</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-363"><a href="#SpValueValidator.validate_unavailable_codes_values-363"><span class="linenos">363</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-364"><a href="#SpValueValidator.validate_unavailable_codes_values-364"><span class="linenos">364</span></a><span class="sd">                - List[str]: Error messages for invalid numeric values</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-365"><a href="#SpValueValidator.validate_unavailable_codes_values-365"><span class="linenos">365</span></a><span class="sd">                - List[str]: Warning messages for excessive decimal places</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-366"><a href="#SpValueValidator.validate_unavailable_codes_values-366"><span class="linenos">366</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-367"><a href="#SpValueValidator.validate_unavailable_codes_values-367"><span class="linenos">367</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-368"><a href="#SpValueValidator.validate_unavailable_codes_values-368"><span class="linenos">368</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-369"><a href="#SpValueValidator.validate_unavailable_codes_values-369"><span class="linenos">369</span></a><span class="sd">        - ID column is excluded from validation</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-370"><a href="#SpValueValidator.validate_unavailable_codes_values-370"><span class="linenos">370</span></a><span class="sd">        - Only columns matching valid ID patterns are validated</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-371"><a href="#SpValueValidator.validate_unavailable_codes_values-371"><span class="linenos">371</span></a><span class="sd">        - &quot;Dado indisponvel&quot; (DI) markers are allowed</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-372"><a href="#SpValueValidator.validate_unavailable_codes_values-372"><span class="linenos">372</span></a><span class="sd">        - Maximum 2 decimal places enforced for numeric values</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-373"><a href="#SpValueValidator.validate_unavailable_codes_values-373"><span class="linenos">373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-374"><a href="#SpValueValidator.validate_unavailable_codes_values-374"><span class="linenos">374</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-375"><a href="#SpValueValidator.validate_unavailable_codes_values-375"><span class="linenos">375</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-376"><a href="#SpValueValidator.validate_unavailable_codes_values-376"><span class="linenos">376</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-377"><a href="#SpValueValidator.validate_unavailable_codes_values-377"><span class="linenos">377</span></a>            <span class="n">required_columns</span><span class="o">=</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_scenario</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="k">else</span> <span class="p">[])},</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-378"><a href="#SpValueValidator.validate_unavailable_codes_values-378"><span class="linenos">378</span></a>            <span class="n">model_dataframes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">,</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-379"><a href="#SpValueValidator.validate_unavailable_codes_values-379"><span class="linenos">379</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-380"><a href="#SpValueValidator.validate_unavailable_codes_values-380"><span class="linenos">380</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-381"><a href="#SpValueValidator.validate_unavailable_codes_values-381"><span class="linenos">381</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-382"><a href="#SpValueValidator.validate_unavailable_codes_values-382"><span class="linenos">382</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-383"><a href="#SpValueValidator.validate_unavailable_codes_values-383"><span class="linenos">383</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-384"><a href="#SpValueValidator.validate_unavailable_codes_values-384"><span class="linenos">384</span></a>        <span class="n">id_column_name</span> <span class="o">=</span> <span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-385"><a href="#SpValueValidator.validate_unavailable_codes_values-385"><span class="linenos">385</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-386"><a href="#SpValueValidator.validate_unavailable_codes_values-386"><span class="linenos">386</span></a>        <span class="c1"># Prepare dataframe for validation using generic function</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-387"><a href="#SpValueValidator.validate_unavailable_codes_values-387"><span class="linenos">387</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-388"><a href="#SpValueValidator.validate_unavailable_codes_values-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">id_column_name</span> <span class="ow">in</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-389"><a href="#SpValueValidator.validate_unavailable_codes_values-389"><span class="linenos">389</span></a>            <span class="n">df_values</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">id_column_name</span><span class="p">])</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-390"><a href="#SpValueValidator.validate_unavailable_codes_values-390"><span class="linenos">390</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-391"><a href="#SpValueValidator.validate_unavailable_codes_values-391"><span class="linenos">391</span></a>        <span class="c1"># Get valid columns that match ID patterns</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-392"><a href="#SpValueValidator.validate_unavailable_codes_values-392"><span class="linenos">392</span></a>        <span class="n">valid_columns</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">categorize_strings_by_id_pattern_from_list</span><span class="p">(</span><span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-393"><a href="#SpValueValidator.validate_unavailable_codes_values-393"><span class="linenos">393</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-394"><a href="#SpValueValidator.validate_unavailable_codes_values-394"><span class="linenos">394</span></a>        <span class="c1"># Validate data values in columns using generic function</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-395"><a href="#SpValueValidator.validate_unavailable_codes_values-395"><span class="linenos">395</span></a>        <span class="n">validation_errors</span><span class="p">,</span> <span class="n">validation_warnings</span> <span class="o">=</span> <span class="n">ValueProcessing</span><span class="o">.</span><span class="n">validate_data_values_in_columns</span><span class="p">(</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-396"><a href="#SpValueValidator.validate_unavailable_codes_values-396"><span class="linenos">396</span></a>            <span class="n">df_values</span><span class="p">,</span> <span class="n">valid_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-397"><a href="#SpValueValidator.validate_unavailable_codes_values-397"><span class="linenos">397</span></a>        <span class="p">)</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-398"><a href="#SpValueValidator.validate_unavailable_codes_values-398"><span class="linenos">398</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-399"><a href="#SpValueValidator.validate_unavailable_codes_values-399"><span class="linenos">399</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">validation_errors</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-400"><a href="#SpValueValidator.validate_unavailable_codes_values-400"><span class="linenos">400</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">validation_warnings</span><span class="p">)</span>
</span><span id="SpValueValidator.validate_unavailable_codes_values-401"><a href="#SpValueValidator.validate_unavailable_codes_values-401"><span class="linenos">401</span></a>
</span><span id="SpValueValidator.validate_unavailable_codes_values-402"><a href="#SpValueValidator.validate_unavailable_codes_values-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate unavailable and invalid values in the data.</p>

<p>Performs comprehensive data quality checks including:</p>

<ul>
<li>Invalid numeric values (not numbers and not "DI" marker)</li>
<li>Values with more than 2 decimal places</li>
<li>Proper format validation for all value columns</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for invalid numeric values
        - List[str]: Warning messages for excessive decimal places</p>

<h2 id="notes">Notes</h2>

<ul>
<li>ID column is excluded from validation</li>
<li>Only columns matching valid ID patterns are validated</li>
<li>"Dado indisponvel" (DI) markers are allowed</li>
<li>Maximum 2 decimal places enforced for numeric values</li>
</ul>
</div>


                            </div>
                            <div id="SpValueValidator.run" class="classattr">
                                        <input id="SpValueValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpValueValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpValueValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpValueValidator.run-404"><a href="#SpValueValidator.run-404"><span class="linenos">404</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpValueValidator.run-405"><a href="#SpValueValidator.run-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpValueValidator.run-406"><a href="#SpValueValidator.run-406"><span class="linenos">406</span></a><span class="sd">        Execute all value validations.</span>
</span><span id="SpValueValidator.run-407"><a href="#SpValueValidator.run-407"><span class="linenos">407</span></a>
</span><span id="SpValueValidator.run-408"><a href="#SpValueValidator.run-408"><span class="linenos">408</span></a><span class="sd">        Orchestrates the execution of all value validators including:</span>
</span><span id="SpValueValidator.run-409"><a href="#SpValueValidator.run-409"><span class="linenos">409</span></a><span class="sd">        - Indicator relationship validation with description</span>
</span><span id="SpValueValidator.run-410"><a href="#SpValueValidator.run-410"><span class="linenos">410</span></a><span class="sd">        - Column combination validation based on level and scenario</span>
</span><span id="SpValueValidator.run-411"><a href="#SpValueValidator.run-411"><span class="linenos">411</span></a><span class="sd">        - Data format and quality validation (invalid/unavailable values)</span>
</span><span id="SpValueValidator.run-412"><a href="#SpValueValidator.run-412"><span class="linenos">412</span></a>
</span><span id="SpValueValidator.run-413"><a href="#SpValueValidator.run-413"><span class="linenos">413</span></a><span class="sd">        Returns</span>
</span><span id="SpValueValidator.run-414"><a href="#SpValueValidator.run-414"><span class="linenos">414</span></a><span class="sd">        -------</span>
</span><span id="SpValueValidator.run-415"><a href="#SpValueValidator.run-415"><span class="linenos">415</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpValueValidator.run-416"><a href="#SpValueValidator.run-416"><span class="linenos">416</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpValueValidator.run-417"><a href="#SpValueValidator.run-417"><span class="linenos">417</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpValueValidator.run-418"><a href="#SpValueValidator.run-418"><span class="linenos">418</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpValueValidator.run-419"><a href="#SpValueValidator.run-419"><span class="linenos">419</span></a>
</span><span id="SpValueValidator.run-420"><a href="#SpValueValidator.run-420"><span class="linenos">420</span></a><span class="sd">        Notes</span>
</span><span id="SpValueValidator.run-421"><a href="#SpValueValidator.run-421"><span class="linenos">421</span></a><span class="sd">        -----</span>
</span><span id="SpValueValidator.run-422"><a href="#SpValueValidator.run-422"><span class="linenos">422</span></a><span class="sd">        All validations are skipped if the value dataframe is empty.</span>
</span><span id="SpValueValidator.run-423"><a href="#SpValueValidator.run-423"><span class="linenos">423</span></a><span class="sd">        Results are aggregated into reports via `build_reports()`.</span>
</span><span id="SpValueValidator.run-424"><a href="#SpValueValidator.run-424"><span class="linenos">424</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpValueValidator.run-425"><a href="#SpValueValidator.run-425"><span class="linenos">425</span></a>
</span><span id="SpValueValidator.run-426"><a href="#SpValueValidator.run-426"><span class="linenos">426</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpValueValidator.run-427"><a href="#SpValueValidator.run-427"><span class="linenos">427</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpValueValidator.run-428"><a href="#SpValueValidator.run-428"><span class="linenos">428</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_value_combination_relation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">VAL_COMB</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpValueValidator.run-429"><a href="#SpValueValidator.run-429"><span class="linenos">429</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unavailable_codes_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UNAV_INV</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpValueValidator.run-430"><a href="#SpValueValidator.run-430"><span class="linenos">430</span></a>        <span class="p">]</span>
</span><span id="SpValueValidator.run-431"><a href="#SpValueValidator.run-431"><span class="linenos">431</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpValueValidator.run-432"><a href="#SpValueValidator.run-432"><span class="linenos">432</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpValueValidator.run-433"><a href="#SpValueValidator.run-433"><span class="linenos">433</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpValueValidator.run-434"><a href="#SpValueValidator.run-434"><span class="linenos">434</span></a>
</span><span id="SpValueValidator.run-435"><a href="#SpValueValidator.run-435"><span class="linenos">435</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpValueValidator.run-436"><a href="#SpValueValidator.run-436"><span class="linenos">436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpValueValidator.run-437"><a href="#SpValueValidator.run-437"><span class="linenos">437</span></a>
</span><span id="SpValueValidator.run-438"><a href="#SpValueValidator.run-438"><span class="linenos">438</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all value validations.</p>

<p>Orchestrates the execution of all value validators including:</p>

<ul>
<li>Indicator relationship validation with description</li>
<li>Column combination validation based on level and scenario</li>
<li>Data format and quality validation (invalid/unavailable values)</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<p>All validations are skipped if the value dataframe is empty.
Results are aggregated into reports via <code><a href="#SpValueValidator.build_reports">build_reports()</a></code>.</p>
</div>


                            </div>
                </section>
                <section id="SpCompositionTreeValidator">
                            <input id="SpCompositionTreeValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpCompositionTreeValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpCompositionTreeValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionTreeValidator-23"><a href="#SpCompositionTreeValidator-23"><span class="linenos"> 23</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpCompositionTreeValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpCompositionTreeValidator-24"><a href="#SpCompositionTreeValidator-24"><span class="linenos"> 24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-25"><a href="#SpCompositionTreeValidator-25"><span class="linenos"> 25</span></a><span class="sd">    Validates hierarchical tree structures in SpComposition spreadsheets.</span>
</span><span id="SpCompositionTreeValidator-26"><a href="#SpCompositionTreeValidator-26"><span class="linenos"> 26</span></a>
</span><span id="SpCompositionTreeValidator-27"><a href="#SpCompositionTreeValidator-27"><span class="linenos"> 27</span></a><span class="sd">    This validator ensures that composition data forms a valid tree structure</span>
</span><span id="SpCompositionTreeValidator-28"><a href="#SpCompositionTreeValidator-28"><span class="linenos"> 28</span></a><span class="sd">    without cycles and maintains proper level hierarchies between parent and</span>
</span><span id="SpCompositionTreeValidator-29"><a href="#SpCompositionTreeValidator-29"><span class="linenos"> 29</span></a><span class="sd">    child indicator relationships.</span>
</span><span id="SpCompositionTreeValidator-30"><a href="#SpCompositionTreeValidator-30"><span class="linenos"> 30</span></a>
</span><span id="SpCompositionTreeValidator-31"><a href="#SpCompositionTreeValidator-31"><span class="linenos"> 31</span></a><span class="sd">    Attributes</span>
</span><span id="SpCompositionTreeValidator-32"><a href="#SpCompositionTreeValidator-32"><span class="linenos"> 32</span></a><span class="sd">    ----------</span>
</span><span id="SpCompositionTreeValidator-33"><a href="#SpCompositionTreeValidator-33"><span class="linenos"> 33</span></a><span class="sd">    model_sp_composition : SpComposition</span>
</span><span id="SpCompositionTreeValidator-34"><a href="#SpCompositionTreeValidator-34"><span class="linenos"> 34</span></a><span class="sd">        Composition model instance containing parent-child relationships.</span>
</span><span id="SpCompositionTreeValidator-35"><a href="#SpCompositionTreeValidator-35"><span class="linenos"> 35</span></a><span class="sd">    model_sp_description : SpDescription</span>
</span><span id="SpCompositionTreeValidator-36"><a href="#SpCompositionTreeValidator-36"><span class="linenos"> 36</span></a><span class="sd">        Description model instance containing indicator metadata and levels.</span>
</span><span id="SpCompositionTreeValidator-37"><a href="#SpCompositionTreeValidator-37"><span class="linenos"> 37</span></a><span class="sd">    sp_name_description : str</span>
</span><span id="SpCompositionTreeValidator-38"><a href="#SpCompositionTreeValidator-38"><span class="linenos"> 38</span></a><span class="sd">        Description spreadsheet filename.</span>
</span><span id="SpCompositionTreeValidator-39"><a href="#SpCompositionTreeValidator-39"><span class="linenos"> 39</span></a><span class="sd">    sp_name_composition : str</span>
</span><span id="SpCompositionTreeValidator-40"><a href="#SpCompositionTreeValidator-40"><span class="linenos"> 40</span></a><span class="sd">        Composition spreadsheet filename.</span>
</span><span id="SpCompositionTreeValidator-41"><a href="#SpCompositionTreeValidator-41"><span class="linenos"> 41</span></a><span class="sd">    column_name_code : str</span>
</span><span id="SpCompositionTreeValidator-42"><a href="#SpCompositionTreeValidator-42"><span class="linenos"> 42</span></a><span class="sd">        Code column name from description spreadsheet.</span>
</span><span id="SpCompositionTreeValidator-43"><a href="#SpCompositionTreeValidator-43"><span class="linenos"> 43</span></a><span class="sd">    column_name_level : str</span>
</span><span id="SpCompositionTreeValidator-44"><a href="#SpCompositionTreeValidator-44"><span class="linenos"> 44</span></a><span class="sd">        Level column name from description spreadsheet.</span>
</span><span id="SpCompositionTreeValidator-45"><a href="#SpCompositionTreeValidator-45"><span class="linenos"> 45</span></a><span class="sd">    column_name_parent : str</span>
</span><span id="SpCompositionTreeValidator-46"><a href="#SpCompositionTreeValidator-46"><span class="linenos"> 46</span></a><span class="sd">        Parent code column name from composition spreadsheet.</span>
</span><span id="SpCompositionTreeValidator-47"><a href="#SpCompositionTreeValidator-47"><span class="linenos"> 47</span></a><span class="sd">    column_name_child : str</span>
</span><span id="SpCompositionTreeValidator-48"><a href="#SpCompositionTreeValidator-48"><span class="linenos"> 48</span></a><span class="sd">        Child code column name from composition spreadsheet.</span>
</span><span id="SpCompositionTreeValidator-49"><a href="#SpCompositionTreeValidator-49"><span class="linenos"> 49</span></a><span class="sd">    global_required_columns : Dict[str, List[str]]</span>
</span><span id="SpCompositionTreeValidator-50"><a href="#SpCompositionTreeValidator-50"><span class="linenos"> 50</span></a><span class="sd">        Required columns mapping for validation.</span>
</span><span id="SpCompositionTreeValidator-51"><a href="#SpCompositionTreeValidator-51"><span class="linenos"> 51</span></a><span class="sd">    model_dataframes : Dict[str, pd.DataFrame]</span>
</span><span id="SpCompositionTreeValidator-52"><a href="#SpCompositionTreeValidator-52"><span class="linenos"> 52</span></a><span class="sd">        DataFrames mapping for each model.</span>
</span><span id="SpCompositionTreeValidator-53"><a href="#SpCompositionTreeValidator-53"><span class="linenos"> 53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-54"><a href="#SpCompositionTreeValidator-54"><span class="linenos"> 54</span></a>
</span><span id="SpCompositionTreeValidator-55"><a href="#SpCompositionTreeValidator-55"><span class="linenos"> 55</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-56"><a href="#SpCompositionTreeValidator-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-57"><a href="#SpCompositionTreeValidator-57"><span class="linenos"> 57</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-58"><a href="#SpCompositionTreeValidator-58"><span class="linenos"> 58</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-59"><a href="#SpCompositionTreeValidator-59"><span class="linenos"> 59</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator-60"><a href="#SpCompositionTreeValidator-60"><span class="linenos"> 60</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-61"><a href="#SpCompositionTreeValidator-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-62"><a href="#SpCompositionTreeValidator-62"><span class="linenos"> 62</span></a><span class="sd">        Initialize the tree validator with required context and models.</span>
</span><span id="SpCompositionTreeValidator-63"><a href="#SpCompositionTreeValidator-63"><span class="linenos"> 63</span></a>
</span><span id="SpCompositionTreeValidator-64"><a href="#SpCompositionTreeValidator-64"><span class="linenos"> 64</span></a><span class="sd">        Args</span>
</span><span id="SpCompositionTreeValidator-65"><a href="#SpCompositionTreeValidator-65"><span class="linenos"> 65</span></a><span class="sd">        ----</span>
</span><span id="SpCompositionTreeValidator-66"><a href="#SpCompositionTreeValidator-66"><span class="linenos"> 66</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpCompositionTreeValidator-67"><a href="#SpCompositionTreeValidator-67"><span class="linenos"> 67</span></a><span class="sd">            Context containing all data models and configuration.</span>
</span><span id="SpCompositionTreeValidator-68"><a href="#SpCompositionTreeValidator-68"><span class="linenos"> 68</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpCompositionTreeValidator-69"><a href="#SpCompositionTreeValidator-69"><span class="linenos"> 69</span></a><span class="sd">            Report list for validation results aggregation.</span>
</span><span id="SpCompositionTreeValidator-70"><a href="#SpCompositionTreeValidator-70"><span class="linenos"> 70</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpCompositionTreeValidator-71"><a href="#SpCompositionTreeValidator-71"><span class="linenos"> 71</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpCompositionTreeValidator-72"><a href="#SpCompositionTreeValidator-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-73"><a href="#SpCompositionTreeValidator-73"><span class="linenos"> 73</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-74"><a href="#SpCompositionTreeValidator-74"><span class="linenos"> 74</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-75"><a href="#SpCompositionTreeValidator-75"><span class="linenos"> 75</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-76"><a href="#SpCompositionTreeValidator-76"><span class="linenos"> 76</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpComposition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-77"><a href="#SpCompositionTreeValidator-77"><span class="linenos"> 77</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-78"><a href="#SpCompositionTreeValidator-78"><span class="linenos"> 78</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator-79"><a href="#SpCompositionTreeValidator-79"><span class="linenos"> 79</span></a>
</span><span id="SpCompositionTreeValidator-80"><a href="#SpCompositionTreeValidator-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpCompositionTreeValidator-81"><a href="#SpCompositionTreeValidator-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-82"><a href="#SpCompositionTreeValidator-82"><span class="linenos"> 82</span></a>
</span><span id="SpCompositionTreeValidator-83"><a href="#SpCompositionTreeValidator-83"><span class="linenos"> 83</span></a>        <span class="c1"># Initialize attributes</span>
</span><span id="SpCompositionTreeValidator-84"><a href="#SpCompositionTreeValidator-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-85"><a href="#SpCompositionTreeValidator-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-86"><a href="#SpCompositionTreeValidator-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-87"><a href="#SpCompositionTreeValidator-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-88"><a href="#SpCompositionTreeValidator-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-89"><a href="#SpCompositionTreeValidator-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-90"><a href="#SpCompositionTreeValidator-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionTreeValidator-91"><a href="#SpCompositionTreeValidator-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionTreeValidator-92"><a href="#SpCompositionTreeValidator-92"><span class="linenos"> 92</span></a>
</span><span id="SpCompositionTreeValidator-93"><a href="#SpCompositionTreeValidator-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator-94"><a href="#SpCompositionTreeValidator-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator-95"><a href="#SpCompositionTreeValidator-95"><span class="linenos"> 95</span></a>
</span><span id="SpCompositionTreeValidator-96"><a href="#SpCompositionTreeValidator-96"><span class="linenos"> 96</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-97"><a href="#SpCompositionTreeValidator-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-98"><a href="#SpCompositionTreeValidator-98"><span class="linenos"> 98</span></a><span class="sd">        Prepare validation context and column mappings.</span>
</span><span id="SpCompositionTreeValidator-99"><a href="#SpCompositionTreeValidator-99"><span class="linenos"> 99</span></a>
</span><span id="SpCompositionTreeValidator-100"><a href="#SpCompositionTreeValidator-100"><span class="linenos">100</span></a><span class="sd">        Sets up:</span>
</span><span id="SpCompositionTreeValidator-101"><a href="#SpCompositionTreeValidator-101"><span class="linenos">101</span></a><span class="sd">        - Spreadsheet names for composition and description</span>
</span><span id="SpCompositionTreeValidator-102"><a href="#SpCompositionTreeValidator-102"><span class="linenos">102</span></a><span class="sd">        - Column name mappings for validation</span>
</span><span id="SpCompositionTreeValidator-103"><a href="#SpCompositionTreeValidator-103"><span class="linenos">103</span></a><span class="sd">        - Required columns dictionary</span>
</span><span id="SpCompositionTreeValidator-104"><a href="#SpCompositionTreeValidator-104"><span class="linenos">104</span></a><span class="sd">        - DataFrame references for both models</span>
</span><span id="SpCompositionTreeValidator-105"><a href="#SpCompositionTreeValidator-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-106"><a href="#SpCompositionTreeValidator-106"><span class="linenos">106</span></a>        <span class="c1"># Set spreadsheet names</span>
</span><span id="SpCompositionTreeValidator-107"><a href="#SpCompositionTreeValidator-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpCompositionTreeValidator-108"><a href="#SpCompositionTreeValidator-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpCompositionTreeValidator-109"><a href="#SpCompositionTreeValidator-109"><span class="linenos">109</span></a>
</span><span id="SpCompositionTreeValidator-110"><a href="#SpCompositionTreeValidator-110"><span class="linenos">110</span></a>        <span class="c1"># Set column names</span>
</span><span id="SpCompositionTreeValidator-111"><a href="#SpCompositionTreeValidator-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionTreeValidator-112"><a href="#SpCompositionTreeValidator-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionTreeValidator-113"><a href="#SpCompositionTreeValidator-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span> <span class="o">=</span> <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionTreeValidator-114"><a href="#SpCompositionTreeValidator-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span> <span class="o">=</span> <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionTreeValidator-115"><a href="#SpCompositionTreeValidator-115"><span class="linenos">115</span></a>
</span><span id="SpCompositionTreeValidator-116"><a href="#SpCompositionTreeValidator-116"><span class="linenos">116</span></a>        <span class="c1"># Define required columns</span>
</span><span id="SpCompositionTreeValidator-117"><a href="#SpCompositionTreeValidator-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionTreeValidator-118"><a href="#SpCompositionTreeValidator-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionTreeValidator-119"><a href="#SpCompositionTreeValidator-119"><span class="linenos">119</span></a>                <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-120"><a href="#SpCompositionTreeValidator-120"><span class="linenos">120</span></a>                <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-121"><a href="#SpCompositionTreeValidator-121"><span class="linenos">121</span></a>            <span class="p">],</span>
</span><span id="SpCompositionTreeValidator-122"><a href="#SpCompositionTreeValidator-122"><span class="linenos">122</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionTreeValidator-123"><a href="#SpCompositionTreeValidator-123"><span class="linenos">123</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-124"><a href="#SpCompositionTreeValidator-124"><span class="linenos">124</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-125"><a href="#SpCompositionTreeValidator-125"><span class="linenos">125</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">OptionalColumn</span><span class="o">.</span><span class="n">COLUMN_RELATION</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-126"><a href="#SpCompositionTreeValidator-126"><span class="linenos">126</span></a>            <span class="p">],</span>
</span><span id="SpCompositionTreeValidator-127"><a href="#SpCompositionTreeValidator-127"><span class="linenos">127</span></a>        <span class="p">}</span>
</span><span id="SpCompositionTreeValidator-128"><a href="#SpCompositionTreeValidator-128"><span class="linenos">128</span></a>
</span><span id="SpCompositionTreeValidator-129"><a href="#SpCompositionTreeValidator-129"><span class="linenos">129</span></a>        <span class="c1"># Set dataframes</span>
</span><span id="SpCompositionTreeValidator-130"><a href="#SpCompositionTreeValidator-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionTreeValidator-131"><a href="#SpCompositionTreeValidator-131"><span class="linenos">131</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-132"><a href="#SpCompositionTreeValidator-132"><span class="linenos">132</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-133"><a href="#SpCompositionTreeValidator-133"><span class="linenos">133</span></a>        <span class="p">}</span>
</span><span id="SpCompositionTreeValidator-134"><a href="#SpCompositionTreeValidator-134"><span class="linenos">134</span></a>
</span><span id="SpCompositionTreeValidator-135"><a href="#SpCompositionTreeValidator-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_hierarchy_with_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionTreeValidator-136"><a href="#SpCompositionTreeValidator-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-137"><a href="#SpCompositionTreeValidator-137"><span class="linenos">137</span></a><span class="sd">        Validate tree composition structure and detect cycles.</span>
</span><span id="SpCompositionTreeValidator-138"><a href="#SpCompositionTreeValidator-138"><span class="linenos">138</span></a>
</span><span id="SpCompositionTreeValidator-139"><a href="#SpCompositionTreeValidator-139"><span class="linenos">139</span></a><span class="sd">        Performs comprehensive tree validation including:</span>
</span><span id="SpCompositionTreeValidator-140"><a href="#SpCompositionTreeValidator-140"><span class="linenos">140</span></a><span class="sd">        - Required column presence checks</span>
</span><span id="SpCompositionTreeValidator-141"><a href="#SpCompositionTreeValidator-141"><span class="linenos">141</span></a><span class="sd">        - Data cleaning and integer conversion</span>
</span><span id="SpCompositionTreeValidator-142"><a href="#SpCompositionTreeValidator-142"><span class="linenos">142</span></a><span class="sd">        - Root node insertion if missing</span>
</span><span id="SpCompositionTreeValidator-143"><a href="#SpCompositionTreeValidator-143"><span class="linenos">143</span></a><span class="sd">        - Cycle detection in parent-child relationships</span>
</span><span id="SpCompositionTreeValidator-144"><a href="#SpCompositionTreeValidator-144"><span class="linenos">144</span></a><span class="sd">        - Level hierarchy validation</span>
</span><span id="SpCompositionTreeValidator-145"><a href="#SpCompositionTreeValidator-145"><span class="linenos">145</span></a>
</span><span id="SpCompositionTreeValidator-146"><a href="#SpCompositionTreeValidator-146"><span class="linenos">146</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionTreeValidator-147"><a href="#SpCompositionTreeValidator-147"><span class="linenos">147</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionTreeValidator-148"><a href="#SpCompositionTreeValidator-148"><span class="linenos">148</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionTreeValidator-149"><a href="#SpCompositionTreeValidator-149"><span class="linenos">149</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionTreeValidator-150"><a href="#SpCompositionTreeValidator-150"><span class="linenos">150</span></a><span class="sd">                - List[str]: Error messages for structure violations and cycles</span>
</span><span id="SpCompositionTreeValidator-151"><a href="#SpCompositionTreeValidator-151"><span class="linenos">151</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionTreeValidator-152"><a href="#SpCompositionTreeValidator-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-153"><a href="#SpCompositionTreeValidator-153"><span class="linenos">153</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator-154"><a href="#SpCompositionTreeValidator-154"><span class="linenos">154</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator-155"><a href="#SpCompositionTreeValidator-155"><span class="linenos">155</span></a>
</span><span id="SpCompositionTreeValidator-156"><a href="#SpCompositionTreeValidator-156"><span class="linenos">156</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionTreeValidator-157"><a href="#SpCompositionTreeValidator-157"><span class="linenos">157</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-158"><a href="#SpCompositionTreeValidator-158"><span class="linenos">158</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-159"><a href="#SpCompositionTreeValidator-159"><span class="linenos">159</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionTreeValidator-160"><a href="#SpCompositionTreeValidator-160"><span class="linenos">160</span></a>
</span><span id="SpCompositionTreeValidator-161"><a href="#SpCompositionTreeValidator-161"><span class="linenos">161</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpCompositionTreeValidator-162"><a href="#SpCompositionTreeValidator-162"><span class="linenos">162</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator-163"><a href="#SpCompositionTreeValidator-163"><span class="linenos">163</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator-164"><a href="#SpCompositionTreeValidator-164"><span class="linenos">164</span></a>
</span><span id="SpCompositionTreeValidator-165"><a href="#SpCompositionTreeValidator-165"><span class="linenos">165</span></a>        <span class="c1"># Clean integer columns: df_composition</span>
</span><span id="SpCompositionTreeValidator-166"><a href="#SpCompositionTreeValidator-166"><span class="linenos">166</span></a>        <span class="n">df_composition</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-167"><a href="#SpCompositionTreeValidator-167"><span class="linenos">167</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-168"><a href="#SpCompositionTreeValidator-168"><span class="linenos">168</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-169"><a href="#SpCompositionTreeValidator-169"><span class="linenos">169</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator-170"><a href="#SpCompositionTreeValidator-170"><span class="linenos">170</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-171"><a href="#SpCompositionTreeValidator-171"><span class="linenos">171</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator-172"><a href="#SpCompositionTreeValidator-172"><span class="linenos">172</span></a>        <span class="n">df_composition</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-173"><a href="#SpCompositionTreeValidator-173"><span class="linenos">173</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-174"><a href="#SpCompositionTreeValidator-174"><span class="linenos">174</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-175"><a href="#SpCompositionTreeValidator-175"><span class="linenos">175</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator-176"><a href="#SpCompositionTreeValidator-176"><span class="linenos">176</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-177"><a href="#SpCompositionTreeValidator-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator-178"><a href="#SpCompositionTreeValidator-178"><span class="linenos">178</span></a>
</span><span id="SpCompositionTreeValidator-179"><a href="#SpCompositionTreeValidator-179"><span class="linenos">179</span></a>        <span class="c1"># Clean integer columns: df_description</span>
</span><span id="SpCompositionTreeValidator-180"><a href="#SpCompositionTreeValidator-180"><span class="linenos">180</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-181"><a href="#SpCompositionTreeValidator-181"><span class="linenos">181</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_description</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-182"><a href="#SpCompositionTreeValidator-182"><span class="linenos">182</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-183"><a href="#SpCompositionTreeValidator-183"><span class="linenos">183</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator-184"><a href="#SpCompositionTreeValidator-184"><span class="linenos">184</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-185"><a href="#SpCompositionTreeValidator-185"><span class="linenos">185</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator-186"><a href="#SpCompositionTreeValidator-186"><span class="linenos">186</span></a>
</span><span id="SpCompositionTreeValidator-187"><a href="#SpCompositionTreeValidator-187"><span class="linenos">187</span></a>        <span class="c1"># Add root node if not present</span>
</span><span id="SpCompositionTreeValidator-188"><a href="#SpCompositionTreeValidator-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="SpCompositionTreeValidator-189"><a href="#SpCompositionTreeValidator-189"><span class="linenos">189</span></a>            <span class="n">root_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-190"><a href="#SpCompositionTreeValidator-190"><span class="linenos">190</span></a>                <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">EXPECTED_COLUMNS</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
</span><span id="SpCompositionTreeValidator-191"><a href="#SpCompositionTreeValidator-191"><span class="linenos">191</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">EXPECTED_COLUMNS</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-192"><a href="#SpCompositionTreeValidator-192"><span class="linenos">192</span></a>            <span class="p">)</span>
</span><span id="SpCompositionTreeValidator-193"><a href="#SpCompositionTreeValidator-193"><span class="linenos">193</span></a>            <span class="n">df_description</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_description</span><span class="p">,</span> <span class="n">root_row</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-194"><a href="#SpCompositionTreeValidator-194"><span class="linenos">194</span></a>
</span><span id="SpCompositionTreeValidator-195"><a href="#SpCompositionTreeValidator-195"><span class="linenos">195</span></a>        <span class="c1"># Build tree and check for cycles</span>
</span><span id="SpCompositionTreeValidator-196"><a href="#SpCompositionTreeValidator-196"><span class="linenos">196</span></a>        <span class="n">tree</span> <span class="o">=</span> <span class="n">TreeProcessing</span><span class="o">.</span><span class="n">create_tree_structure</span><span class="p">(</span><span class="n">df_composition</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-197"><a href="#SpCompositionTreeValidator-197"><span class="linenos">197</span></a>
</span><span id="SpCompositionTreeValidator-198"><a href="#SpCompositionTreeValidator-198"><span class="linenos">198</span></a>        <span class="n">cycle_found</span><span class="p">,</span> <span class="n">cycle</span> <span class="o">=</span> <span class="n">TreeProcessing</span><span class="o">.</span><span class="n">detect_tree_cycles</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-199"><a href="#SpCompositionTreeValidator-199"><span class="linenos">199</span></a>        <span class="k">if</span> <span class="n">cycle_found</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-200"><a href="#SpCompositionTreeValidator-200"><span class="linenos">200</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Ciclo encontrado: [</span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-201"><a href="#SpCompositionTreeValidator-201"><span class="linenos">201</span></a>
</span><span id="SpCompositionTreeValidator-202"><a href="#SpCompositionTreeValidator-202"><span class="linenos">202</span></a>        <span class="c1"># Validate level composition</span>
</span><span id="SpCompositionTreeValidator-203"><a href="#SpCompositionTreeValidator-203"><span class="linenos">203</span></a>        <span class="n">level_errors</span> <span class="o">=</span> <span class="n">TreeProcessing</span><span class="o">.</span><span class="n">validate_level_hierarchy</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-204"><a href="#SpCompositionTreeValidator-204"><span class="linenos">204</span></a>            <span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-205"><a href="#SpCompositionTreeValidator-205"><span class="linenos">205</span></a>            <span class="n">df_description</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-206"><a href="#SpCompositionTreeValidator-206"><span class="linenos">206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-207"><a href="#SpCompositionTreeValidator-207"><span class="linenos">207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-208"><a href="#SpCompositionTreeValidator-208"><span class="linenos">208</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-209"><a href="#SpCompositionTreeValidator-209"><span class="linenos">209</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-210"><a href="#SpCompositionTreeValidator-210"><span class="linenos">210</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator-211"><a href="#SpCompositionTreeValidator-211"><span class="linenos">211</span></a>
</span><span id="SpCompositionTreeValidator-212"><a href="#SpCompositionTreeValidator-212"><span class="linenos">212</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_level_errors</span><span class="p">(</span><span class="n">level_errors</span><span class="p">,</span> <span class="n">df_composition</span><span class="p">,</span> <span class="n">df_description</span><span class="p">))</span>
</span><span id="SpCompositionTreeValidator-213"><a href="#SpCompositionTreeValidator-213"><span class="linenos">213</span></a>
</span><span id="SpCompositionTreeValidator-214"><a href="#SpCompositionTreeValidator-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionTreeValidator-215"><a href="#SpCompositionTreeValidator-215"><span class="linenos">215</span></a>
</span><span id="SpCompositionTreeValidator-216"><a href="#SpCompositionTreeValidator-216"><span class="linenos">216</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_tree_levels_children</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionTreeValidator-217"><a href="#SpCompositionTreeValidator-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-218"><a href="#SpCompositionTreeValidator-218"><span class="linenos">218</span></a><span class="sd">        Validate that all children of the same parent have the same level.</span>
</span><span id="SpCompositionTreeValidator-219"><a href="#SpCompositionTreeValidator-219"><span class="linenos">219</span></a>
</span><span id="SpCompositionTreeValidator-220"><a href="#SpCompositionTreeValidator-220"><span class="linenos">220</span></a><span class="sd">        Ensures consistency in the tree structure by checking that all indicators</span>
</span><span id="SpCompositionTreeValidator-221"><a href="#SpCompositionTreeValidator-221"><span class="linenos">221</span></a><span class="sd">        sharing the same parent are at the same hierarchical level. This prevents</span>
</span><span id="SpCompositionTreeValidator-222"><a href="#SpCompositionTreeValidator-222"><span class="linenos">222</span></a><span class="sd">        inconsistent tree structures where siblings have different levels.</span>
</span><span id="SpCompositionTreeValidator-223"><a href="#SpCompositionTreeValidator-223"><span class="linenos">223</span></a>
</span><span id="SpCompositionTreeValidator-224"><a href="#SpCompositionTreeValidator-224"><span class="linenos">224</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionTreeValidator-225"><a href="#SpCompositionTreeValidator-225"><span class="linenos">225</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionTreeValidator-226"><a href="#SpCompositionTreeValidator-226"><span class="linenos">226</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionTreeValidator-227"><a href="#SpCompositionTreeValidator-227"><span class="linenos">227</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionTreeValidator-228"><a href="#SpCompositionTreeValidator-228"><span class="linenos">228</span></a><span class="sd">                - List[str]: Error messages for level inconsistencies and missing codes</span>
</span><span id="SpCompositionTreeValidator-229"><a href="#SpCompositionTreeValidator-229"><span class="linenos">229</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionTreeValidator-230"><a href="#SpCompositionTreeValidator-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-231"><a href="#SpCompositionTreeValidator-231"><span class="linenos">231</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator-232"><a href="#SpCompositionTreeValidator-232"><span class="linenos">232</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator-233"><a href="#SpCompositionTreeValidator-233"><span class="linenos">233</span></a>
</span><span id="SpCompositionTreeValidator-234"><a href="#SpCompositionTreeValidator-234"><span class="linenos">234</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionTreeValidator-235"><a href="#SpCompositionTreeValidator-235"><span class="linenos">235</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-236"><a href="#SpCompositionTreeValidator-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-237"><a href="#SpCompositionTreeValidator-237"><span class="linenos">237</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionTreeValidator-238"><a href="#SpCompositionTreeValidator-238"><span class="linenos">238</span></a>
</span><span id="SpCompositionTreeValidator-239"><a href="#SpCompositionTreeValidator-239"><span class="linenos">239</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator-240"><a href="#SpCompositionTreeValidator-240"><span class="linenos">240</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator-241"><a href="#SpCompositionTreeValidator-241"><span class="linenos">241</span></a>
</span><span id="SpCompositionTreeValidator-242"><a href="#SpCompositionTreeValidator-242"><span class="linenos">242</span></a>        <span class="c1"># Create level mapping</span>
</span><span id="SpCompositionTreeValidator-243"><a href="#SpCompositionTreeValidator-243"><span class="linenos">243</span></a>        <span class="n">levels</span> <span class="o">=</span> <span class="p">{</span><span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]:</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_description</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()}</span>
</span><span id="SpCompositionTreeValidator-244"><a href="#SpCompositionTreeValidator-244"><span class="linenos">244</span></a>
</span><span id="SpCompositionTreeValidator-245"><a href="#SpCompositionTreeValidator-245"><span class="linenos">245</span></a>        <span class="c1"># Group by parent and validate children levels</span>
</span><span id="SpCompositionTreeValidator-246"><a href="#SpCompositionTreeValidator-246"><span class="linenos">246</span></a>        <span class="n">parent_groups</span> <span class="o">=</span> <span class="n">df_composition</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-247"><a href="#SpCompositionTreeValidator-247"><span class="linenos">247</span></a>        <span class="k">for</span> <span class="n">parent</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">parent_groups</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-248"><a href="#SpCompositionTreeValidator-248"><span class="linenos">248</span></a>            <span class="k">if</span> <span class="n">parent</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-249"><a href="#SpCompositionTreeValidator-249"><span class="linenos">249</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Cdigo pai </span><span class="si">{</span><span class="n">parent</span><span class="si">}</span><span class="s2"> no encontrado na descrio.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-250"><a href="#SpCompositionTreeValidator-250"><span class="linenos">250</span></a>                <span class="k">continue</span>
</span><span id="SpCompositionTreeValidator-251"><a href="#SpCompositionTreeValidator-251"><span class="linenos">251</span></a>
</span><span id="SpCompositionTreeValidator-252"><a href="#SpCompositionTreeValidator-252"><span class="linenos">252</span></a>            <span class="n">children_info</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator-253"><a href="#SpCompositionTreeValidator-253"><span class="linenos">253</span></a>
</span><span id="SpCompositionTreeValidator-254"><a href="#SpCompositionTreeValidator-254"><span class="linenos">254</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpCompositionTreeValidator-255"><a href="#SpCompositionTreeValidator-255"><span class="linenos">255</span></a>                <span class="n">child</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">]</span>
</span><span id="SpCompositionTreeValidator-256"><a href="#SpCompositionTreeValidator-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-257"><a href="#SpCompositionTreeValidator-257"><span class="linenos">257</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Cdigo filho </span><span class="si">{</span><span class="n">child</span><span class="si">}</span><span class="s2"> no encontrado na descrio.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-258"><a href="#SpCompositionTreeValidator-258"><span class="linenos">258</span></a>                    <span class="k">continue</span>
</span><span id="SpCompositionTreeValidator-259"><a href="#SpCompositionTreeValidator-259"><span class="linenos">259</span></a>                <span class="n">child_level</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[</span><span class="n">child</span><span class="p">]</span>
</span><span id="SpCompositionTreeValidator-260"><a href="#SpCompositionTreeValidator-260"><span class="linenos">260</span></a>                <span class="n">children_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">child_level</span><span class="p">))</span>
</span><span id="SpCompositionTreeValidator-261"><a href="#SpCompositionTreeValidator-261"><span class="linenos">261</span></a>
</span><span id="SpCompositionTreeValidator-262"><a href="#SpCompositionTreeValidator-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="n">children_info</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">({</span><span class="n">level</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">children_info</span><span class="p">})</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-263"><a href="#SpCompositionTreeValidator-263"><span class="linenos">263</span></a>                <span class="n">error_children</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;indicador </span><span class="si">{</span><span class="n">child</span><span class="si">}</span><span class="s2"> possui nvel &#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">child</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">children_info</span><span class="p">])</span>
</span><span id="SpCompositionTreeValidator-264"><a href="#SpCompositionTreeValidator-264"><span class="linenos">264</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Indicadores filhos do pai </span><span class="si">{</span><span class="n">parent</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="sa">f</span><span class="s2">&quot;no esto no mesmo nvel: [</span><span class="si">{</span><span class="n">error_children</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-265"><a href="#SpCompositionTreeValidator-265"><span class="linenos">265</span></a>
</span><span id="SpCompositionTreeValidator-266"><a href="#SpCompositionTreeValidator-266"><span class="linenos">266</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionTreeValidator-267"><a href="#SpCompositionTreeValidator-267"><span class="linenos">267</span></a>
</span><span id="SpCompositionTreeValidator-268"><a href="#SpCompositionTreeValidator-268"><span class="linenos">268</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_level_errors</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-269"><a href="#SpCompositionTreeValidator-269"><span class="linenos">269</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-270"><a href="#SpCompositionTreeValidator-270"><span class="linenos">270</span></a>        <span class="n">level_errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
</span><span id="SpCompositionTreeValidator-271"><a href="#SpCompositionTreeValidator-271"><span class="linenos">271</span></a>        <span class="n">df_composition</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-272"><a href="#SpCompositionTreeValidator-272"><span class="linenos">272</span></a>        <span class="n">df_description</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator-273"><a href="#SpCompositionTreeValidator-273"><span class="linenos">273</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="SpCompositionTreeValidator-274"><a href="#SpCompositionTreeValidator-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-275"><a href="#SpCompositionTreeValidator-275"><span class="linenos">275</span></a><span class="sd">        Format level composition errors with proper line numbers and descriptions.</span>
</span><span id="SpCompositionTreeValidator-276"><a href="#SpCompositionTreeValidator-276"><span class="linenos">276</span></a>
</span><span id="SpCompositionTreeValidator-277"><a href="#SpCompositionTreeValidator-277"><span class="linenos">277</span></a><span class="sd">        Creates detailed error messages for level hierarchy violations by looking up</span>
</span><span id="SpCompositionTreeValidator-278"><a href="#SpCompositionTreeValidator-278"><span class="linenos">278</span></a><span class="sd">        the specific row numbers, parent levels, and child levels involved in the error.</span>
</span><span id="SpCompositionTreeValidator-279"><a href="#SpCompositionTreeValidator-279"><span class="linenos">279</span></a>
</span><span id="SpCompositionTreeValidator-280"><a href="#SpCompositionTreeValidator-280"><span class="linenos">280</span></a><span class="sd">        Args</span>
</span><span id="SpCompositionTreeValidator-281"><a href="#SpCompositionTreeValidator-281"><span class="linenos">281</span></a><span class="sd">        ----</span>
</span><span id="SpCompositionTreeValidator-282"><a href="#SpCompositionTreeValidator-282"><span class="linenos">282</span></a><span class="sd">        level_errors : List[Tuple[Any, Any]]</span>
</span><span id="SpCompositionTreeValidator-283"><a href="#SpCompositionTreeValidator-283"><span class="linenos">283</span></a><span class="sd">            List of (parent, child) tuples representing invalid relationships.</span>
</span><span id="SpCompositionTreeValidator-284"><a href="#SpCompositionTreeValidator-284"><span class="linenos">284</span></a><span class="sd">        df_composition : pd.DataFrame</span>
</span><span id="SpCompositionTreeValidator-285"><a href="#SpCompositionTreeValidator-285"><span class="linenos">285</span></a><span class="sd">            Composition DataFrame for row number lookup.</span>
</span><span id="SpCompositionTreeValidator-286"><a href="#SpCompositionTreeValidator-286"><span class="linenos">286</span></a><span class="sd">        df_description : pd.DataFrame</span>
</span><span id="SpCompositionTreeValidator-287"><a href="#SpCompositionTreeValidator-287"><span class="linenos">287</span></a><span class="sd">            Description DataFrame for level lookup.</span>
</span><span id="SpCompositionTreeValidator-288"><a href="#SpCompositionTreeValidator-288"><span class="linenos">288</span></a>
</span><span id="SpCompositionTreeValidator-289"><a href="#SpCompositionTreeValidator-289"><span class="linenos">289</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionTreeValidator-290"><a href="#SpCompositionTreeValidator-290"><span class="linenos">290</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionTreeValidator-291"><a href="#SpCompositionTreeValidator-291"><span class="linenos">291</span></a><span class="sd">        List[str]</span>
</span><span id="SpCompositionTreeValidator-292"><a href="#SpCompositionTreeValidator-292"><span class="linenos">292</span></a><span class="sd">            Formatted error messages with file names, line numbers, and level details.</span>
</span><span id="SpCompositionTreeValidator-293"><a href="#SpCompositionTreeValidator-293"><span class="linenos">293</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-294"><a href="#SpCompositionTreeValidator-294"><span class="linenos">294</span></a>        <span class="n">formatted_errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator-295"><a href="#SpCompositionTreeValidator-295"><span class="linenos">295</span></a>
</span><span id="SpCompositionTreeValidator-296"><a href="#SpCompositionTreeValidator-296"><span class="linenos">296</span></a>        <span class="k">for</span> <span class="n">parent</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">level_errors</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-297"><a href="#SpCompositionTreeValidator-297"><span class="linenos">297</span></a>            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">child</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-298"><a href="#SpCompositionTreeValidator-298"><span class="linenos">298</span></a>                <span class="c1"># Find the row with this relationship</span>
</span><span id="SpCompositionTreeValidator-299"><a href="#SpCompositionTreeValidator-299"><span class="linenos">299</span></a>                <span class="n">matching_rows</span> <span class="o">=</span> <span class="n">df_composition</span><span class="p">[</span>
</span><span id="SpCompositionTreeValidator-300"><a href="#SpCompositionTreeValidator-300"><span class="linenos">300</span></a>                    <span class="p">(</span><span class="n">df_composition</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_composition</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">child</span><span class="p">))</span>
</span><span id="SpCompositionTreeValidator-301"><a href="#SpCompositionTreeValidator-301"><span class="linenos">301</span></a>                <span class="p">]</span>
</span><span id="SpCompositionTreeValidator-302"><a href="#SpCompositionTreeValidator-302"><span class="linenos">302</span></a>
</span><span id="SpCompositionTreeValidator-303"><a href="#SpCompositionTreeValidator-303"><span class="linenos">303</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">matching_rows</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-304"><a href="#SpCompositionTreeValidator-304"><span class="linenos">304</span></a>                    <span class="n">row_index</span> <span class="o">=</span> <span class="n">matching_rows</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpCompositionTreeValidator-305"><a href="#SpCompositionTreeValidator-305"><span class="linenos">305</span></a>                    <span class="n">line_number</span> <span class="o">=</span> <span class="n">row_index</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="SpCompositionTreeValidator-306"><a href="#SpCompositionTreeValidator-306"><span class="linenos">306</span></a>
</span><span id="SpCompositionTreeValidator-307"><a href="#SpCompositionTreeValidator-307"><span class="linenos">307</span></a>                    <span class="n">parent_level</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">parent</span><span class="p">)][</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpCompositionTreeValidator-308"><a href="#SpCompositionTreeValidator-308"><span class="linenos">308</span></a>
</span><span id="SpCompositionTreeValidator-309"><a href="#SpCompositionTreeValidator-309"><span class="linenos">309</span></a>                    <span class="n">child_level</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">child</span><span class="p">)][</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpCompositionTreeValidator-310"><a href="#SpCompositionTreeValidator-310"><span class="linenos">310</span></a>
</span><span id="SpCompositionTreeValidator-311"><a href="#SpCompositionTreeValidator-311"><span class="linenos">311</span></a>                    <span class="n">formatted_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator-312"><a href="#SpCompositionTreeValidator-312"><span class="linenos">312</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">line_number</span><span class="si">}</span><span class="s2">: &quot;</span>
</span><span id="SpCompositionTreeValidator-313"><a href="#SpCompositionTreeValidator-313"><span class="linenos">313</span></a>                        <span class="sa">f</span><span class="s2">&quot;O indicador </span><span class="si">{</span><span class="n">parent</span><span class="si">}</span><span class="s2"> (nvel </span><span class="si">{</span><span class="n">parent_level</span><span class="si">}</span><span class="s2">) no pode ser pai &quot;</span>
</span><span id="SpCompositionTreeValidator-314"><a href="#SpCompositionTreeValidator-314"><span class="linenos">314</span></a>                        <span class="sa">f</span><span class="s2">&quot;do indicador </span><span class="si">{</span><span class="n">child</span><span class="si">}</span><span class="s2"> (nvel </span><span class="si">{</span><span class="n">child_level</span><span class="si">}</span><span class="s2">). &quot;</span>
</span><span id="SpCompositionTreeValidator-315"><a href="#SpCompositionTreeValidator-315"><span class="linenos">315</span></a>                        <span class="sa">f</span><span class="s2">&quot;Atualize os nveis no arquivo de descrio.&quot;</span>
</span><span id="SpCompositionTreeValidator-316"><a href="#SpCompositionTreeValidator-316"><span class="linenos">316</span></a>                    <span class="p">)</span>
</span><span id="SpCompositionTreeValidator-317"><a href="#SpCompositionTreeValidator-317"><span class="linenos">317</span></a>
</span><span id="SpCompositionTreeValidator-318"><a href="#SpCompositionTreeValidator-318"><span class="linenos">318</span></a>        <span class="k">return</span> <span class="n">formatted_errors</span>
</span><span id="SpCompositionTreeValidator-319"><a href="#SpCompositionTreeValidator-319"><span class="linenos">319</span></a>
</span><span id="SpCompositionTreeValidator-320"><a href="#SpCompositionTreeValidator-320"><span class="linenos">320</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionTreeValidator-321"><a href="#SpCompositionTreeValidator-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-322"><a href="#SpCompositionTreeValidator-322"><span class="linenos">322</span></a><span class="sd">        Execute all tree validation checks.</span>
</span><span id="SpCompositionTreeValidator-323"><a href="#SpCompositionTreeValidator-323"><span class="linenos">323</span></a>
</span><span id="SpCompositionTreeValidator-324"><a href="#SpCompositionTreeValidator-324"><span class="linenos">324</span></a><span class="sd">        Orchestrates the execution of tree hierarchy validations and child level</span>
</span><span id="SpCompositionTreeValidator-325"><a href="#SpCompositionTreeValidator-325"><span class="linenos">325</span></a><span class="sd">        consistency checks. If either composition or description dataframes are empty,</span>
</span><span id="SpCompositionTreeValidator-326"><a href="#SpCompositionTreeValidator-326"><span class="linenos">326</span></a><span class="sd">        all validations are marked as not executed.</span>
</span><span id="SpCompositionTreeValidator-327"><a href="#SpCompositionTreeValidator-327"><span class="linenos">327</span></a>
</span><span id="SpCompositionTreeValidator-328"><a href="#SpCompositionTreeValidator-328"><span class="linenos">328</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionTreeValidator-329"><a href="#SpCompositionTreeValidator-329"><span class="linenos">329</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionTreeValidator-330"><a href="#SpCompositionTreeValidator-330"><span class="linenos">330</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionTreeValidator-331"><a href="#SpCompositionTreeValidator-331"><span class="linenos">331</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionTreeValidator-332"><a href="#SpCompositionTreeValidator-332"><span class="linenos">332</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpCompositionTreeValidator-333"><a href="#SpCompositionTreeValidator-333"><span class="linenos">333</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpCompositionTreeValidator-334"><a href="#SpCompositionTreeValidator-334"><span class="linenos">334</span></a>
</span><span id="SpCompositionTreeValidator-335"><a href="#SpCompositionTreeValidator-335"><span class="linenos">335</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionTreeValidator-336"><a href="#SpCompositionTreeValidator-336"><span class="linenos">336</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionTreeValidator-337"><a href="#SpCompositionTreeValidator-337"><span class="linenos">337</span></a><span class="sd">        Validations are skipped if composition or description data is unavailable.</span>
</span><span id="SpCompositionTreeValidator-338"><a href="#SpCompositionTreeValidator-338"><span class="linenos">338</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator-339"><a href="#SpCompositionTreeValidator-339"><span class="linenos">339</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpCompositionTreeValidator-340"><a href="#SpCompositionTreeValidator-340"><span class="linenos">340</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_hierarchy_with_tree</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">TH</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionTreeValidator-341"><a href="#SpCompositionTreeValidator-341"><span class="linenos">341</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_tree_levels_children</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">CHILD_LVL</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionTreeValidator-342"><a href="#SpCompositionTreeValidator-342"><span class="linenos">342</span></a>        <span class="p">]</span>
</span><span id="SpCompositionTreeValidator-343"><a href="#SpCompositionTreeValidator-343"><span class="linenos">343</span></a>
</span><span id="SpCompositionTreeValidator-344"><a href="#SpCompositionTreeValidator-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator-345"><a href="#SpCompositionTreeValidator-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-346"><a href="#SpCompositionTreeValidator-346"><span class="linenos">346</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpCompositionTreeValidator-347"><a href="#SpCompositionTreeValidator-347"><span class="linenos">347</span></a>
</span><span id="SpCompositionTreeValidator-348"><a href="#SpCompositionTreeValidator-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator-349"><a href="#SpCompositionTreeValidator-349"><span class="linenos">349</span></a>
</span><span id="SpCompositionTreeValidator-350"><a href="#SpCompositionTreeValidator-350"><span class="linenos">350</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates hierarchical tree structures in SpComposition spreadsheets.</p>

<p>This validator ensures that composition data forms a valid tree structure
without cycles and maintains proper level hierarchies between parent and
child indicator relationships.</p>

<h2 id="attributes">Attributes</h2>

<p>model_sp_composition : SpComposition
    Composition model instance containing parent-child relationships.
model_sp_description : SpDescription
    Description model instance containing indicator metadata and levels.
sp_name_description : str
    Description spreadsheet filename.
sp_name_composition : str
    Composition spreadsheet filename.
column_name_code : str
    Code column name from description spreadsheet.
column_name_level : str
    Level column name from description spreadsheet.
column_name_parent : str
    Parent code column name from composition spreadsheet.
column_name_child : str
    Child code column name from composition spreadsheet.
global_required_columns : Dict[str, List[str]]
    Required columns mapping for validation.
model_dataframes : Dict[str, pd.DataFrame]
    DataFrames mapping for each model.</p>
</div>


                            <div id="SpCompositionTreeValidator.__init__" class="classattr">
                                        <input id="SpCompositionTreeValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpCompositionTreeValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpCompositionTreeValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionTreeValidator.__init__-55"><a href="#SpCompositionTreeValidator.__init__-55"><span class="linenos">55</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator.__init__-56"><a href="#SpCompositionTreeValidator.__init__-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.__init__-57"><a href="#SpCompositionTreeValidator.__init__-57"><span class="linenos">57</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.__init__-58"><a href="#SpCompositionTreeValidator.__init__-58"><span class="linenos">58</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.__init__-59"><a href="#SpCompositionTreeValidator.__init__-59"><span class="linenos">59</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator.__init__-60"><a href="#SpCompositionTreeValidator.__init__-60"><span class="linenos">60</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.__init__-61"><a href="#SpCompositionTreeValidator.__init__-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-62"><a href="#SpCompositionTreeValidator.__init__-62"><span class="linenos">62</span></a><span class="sd">        Initialize the tree validator with required context and models.</span>
</span><span id="SpCompositionTreeValidator.__init__-63"><a href="#SpCompositionTreeValidator.__init__-63"><span class="linenos">63</span></a>
</span><span id="SpCompositionTreeValidator.__init__-64"><a href="#SpCompositionTreeValidator.__init__-64"><span class="linenos">64</span></a><span class="sd">        Args</span>
</span><span id="SpCompositionTreeValidator.__init__-65"><a href="#SpCompositionTreeValidator.__init__-65"><span class="linenos">65</span></a><span class="sd">        ----</span>
</span><span id="SpCompositionTreeValidator.__init__-66"><a href="#SpCompositionTreeValidator.__init__-66"><span class="linenos">66</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpCompositionTreeValidator.__init__-67"><a href="#SpCompositionTreeValidator.__init__-67"><span class="linenos">67</span></a><span class="sd">            Context containing all data models and configuration.</span>
</span><span id="SpCompositionTreeValidator.__init__-68"><a href="#SpCompositionTreeValidator.__init__-68"><span class="linenos">68</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpCompositionTreeValidator.__init__-69"><a href="#SpCompositionTreeValidator.__init__-69"><span class="linenos">69</span></a><span class="sd">            Report list for validation results aggregation.</span>
</span><span id="SpCompositionTreeValidator.__init__-70"><a href="#SpCompositionTreeValidator.__init__-70"><span class="linenos">70</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpCompositionTreeValidator.__init__-71"><a href="#SpCompositionTreeValidator.__init__-71"><span class="linenos">71</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpCompositionTreeValidator.__init__-72"><a href="#SpCompositionTreeValidator.__init__-72"><span class="linenos">72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-73"><a href="#SpCompositionTreeValidator.__init__-73"><span class="linenos">73</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator.__init__-74"><a href="#SpCompositionTreeValidator.__init__-74"><span class="linenos">74</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.__init__-75"><a href="#SpCompositionTreeValidator.__init__-75"><span class="linenos">75</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.__init__-76"><a href="#SpCompositionTreeValidator.__init__-76"><span class="linenos">76</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpComposition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.__init__-77"><a href="#SpCompositionTreeValidator.__init__-77"><span class="linenos">77</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.__init__-78"><a href="#SpCompositionTreeValidator.__init__-78"><span class="linenos">78</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator.__init__-79"><a href="#SpCompositionTreeValidator.__init__-79"><span class="linenos">79</span></a>
</span><span id="SpCompositionTreeValidator.__init__-80"><a href="#SpCompositionTreeValidator.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpCompositionTreeValidator.__init__-81"><a href="#SpCompositionTreeValidator.__init__-81"><span class="linenos">81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.__init__-82"><a href="#SpCompositionTreeValidator.__init__-82"><span class="linenos">82</span></a>
</span><span id="SpCompositionTreeValidator.__init__-83"><a href="#SpCompositionTreeValidator.__init__-83"><span class="linenos">83</span></a>        <span class="c1"># Initialize attributes</span>
</span><span id="SpCompositionTreeValidator.__init__-84"><a href="#SpCompositionTreeValidator.__init__-84"><span class="linenos">84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-85"><a href="#SpCompositionTreeValidator.__init__-85"><span class="linenos">85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-86"><a href="#SpCompositionTreeValidator.__init__-86"><span class="linenos">86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-87"><a href="#SpCompositionTreeValidator.__init__-87"><span class="linenos">87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-88"><a href="#SpCompositionTreeValidator.__init__-88"><span class="linenos">88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-89"><a href="#SpCompositionTreeValidator.__init__-89"><span class="linenos">89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.__init__-90"><a href="#SpCompositionTreeValidator.__init__-90"><span class="linenos">90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionTreeValidator.__init__-91"><a href="#SpCompositionTreeValidator.__init__-91"><span class="linenos">91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionTreeValidator.__init__-92"><a href="#SpCompositionTreeValidator.__init__-92"><span class="linenos">92</span></a>
</span><span id="SpCompositionTreeValidator.__init__-93"><a href="#SpCompositionTreeValidator.__init__-93"><span class="linenos">93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator.__init__-94"><a href="#SpCompositionTreeValidator.__init__-94"><span class="linenos">94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the tree validator with required context and models.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all data models and configuration.
report_list : ModelListReport
    Report list for validation results aggregation.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpCompositionTreeValidator.model_sp_composition" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_composition</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.model_sp_composition"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.model_sp_description" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_description</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.model_sp_description"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.sp_name_description" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_description</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.sp_name_description"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.sp_name_composition" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_composition</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.sp_name_composition"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.column_name_code" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_code</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.column_name_code"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.column_name_level" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_level</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.column_name_level"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.column_name_parent" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_parent</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.column_name_parent"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.column_name_child" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_child</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.column_name_child"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.global_required_columns" class="classattr">
                                <div class="attr variable">
            <span class="name">global_required_columns</span><span class="annotation">: Dict[str, List[str]]</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.global_required_columns"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.model_dataframes" class="classattr">
                                <div class="attr variable">
            <span class="name">model_dataframes</span><span class="annotation">: Dict[str, pandas.DataFrame]</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.model_dataframes"></a>
    
    

                            </div>
                            <div id="SpCompositionTreeValidator.validate_hierarchy_with_tree" class="classattr">
                                        <input id="SpCompositionTreeValidator.validate_hierarchy_with_tree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_hierarchy_with_tree</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionTreeValidator.validate_hierarchy_with_tree-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.validate_hierarchy_with_tree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-135"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_hierarchy_with_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-136"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-137"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-137"><span class="linenos">137</span></a><span class="sd">        Validate tree composition structure and detect cycles.</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-138"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-138"><span class="linenos">138</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-139"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-139"><span class="linenos">139</span></a><span class="sd">        Performs comprehensive tree validation including:</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-140"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-140"><span class="linenos">140</span></a><span class="sd">        - Required column presence checks</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-141"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-141"><span class="linenos">141</span></a><span class="sd">        - Data cleaning and integer conversion</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-142"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-142"><span class="linenos">142</span></a><span class="sd">        - Root node insertion if missing</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-143"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-143"><span class="linenos">143</span></a><span class="sd">        - Cycle detection in parent-child relationships</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-144"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-144"><span class="linenos">144</span></a><span class="sd">        - Level hierarchy validation</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-145"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-145"><span class="linenos">145</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-146"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-146"><span class="linenos">146</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-147"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-147"><span class="linenos">147</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-148"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-148"><span class="linenos">148</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-149"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-149"><span class="linenos">149</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-150"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-150"><span class="linenos">150</span></a><span class="sd">                - List[str]: Error messages for structure violations and cycles</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-151"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-151"><span class="linenos">151</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-152"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-153"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-153"><span class="linenos">153</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-154"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-154"><span class="linenos">154</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-155"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-155"><span class="linenos">155</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-156"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-156"><span class="linenos">156</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-157"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-157"><span class="linenos">157</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-158"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-158"><span class="linenos">158</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-159"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-159"><span class="linenos">159</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-160"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-160"><span class="linenos">160</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-161"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-161"><span class="linenos">161</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-162"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-162"><span class="linenos">162</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-163"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-163"><span class="linenos">163</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-164"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-164"><span class="linenos">164</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-165"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-165"><span class="linenos">165</span></a>        <span class="c1"># Clean integer columns: df_composition</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-166"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-166"><span class="linenos">166</span></a>        <span class="n">df_composition</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-167"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-167"><span class="linenos">167</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-168"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-168"><span class="linenos">168</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-169"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-169"><span class="linenos">169</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-170"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-170"><span class="linenos">170</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-171"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-171"><span class="linenos">171</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-172"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-172"><span class="linenos">172</span></a>        <span class="n">df_composition</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-173"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-173"><span class="linenos">173</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-174"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-174"><span class="linenos">174</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-175"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-175"><span class="linenos">175</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-176"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-176"><span class="linenos">176</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-177"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-178"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-178"><span class="linenos">178</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-179"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-179"><span class="linenos">179</span></a>        <span class="c1"># Clean integer columns: df_description</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-180"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-180"><span class="linenos">180</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-181"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-181"><span class="linenos">181</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_description</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-182"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-182"><span class="linenos">182</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-183"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-183"><span class="linenos">183</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">],</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-184"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-184"><span class="linenos">184</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-185"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-185"><span class="linenos">185</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-186"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-186"><span class="linenos">186</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-187"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-187"><span class="linenos">187</span></a>        <span class="c1"># Add root node if not present</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-188"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-189"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-189"><span class="linenos">189</span></a>            <span class="n">root_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-190"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-190"><span class="linenos">190</span></a>                <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">EXPECTED_COLUMNS</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-191"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-191"><span class="linenos">191</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">EXPECTED_COLUMNS</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-192"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-192"><span class="linenos">192</span></a>            <span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-193"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-193"><span class="linenos">193</span></a>            <span class="n">df_description</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_description</span><span class="p">,</span> <span class="n">root_row</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-194"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-194"><span class="linenos">194</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-195"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-195"><span class="linenos">195</span></a>        <span class="c1"># Build tree and check for cycles</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-196"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-196"><span class="linenos">196</span></a>        <span class="n">tree</span> <span class="o">=</span> <span class="n">TreeProcessing</span><span class="o">.</span><span class="n">create_tree_structure</span><span class="p">(</span><span class="n">df_composition</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-197"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-197"><span class="linenos">197</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-198"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-198"><span class="linenos">198</span></a>        <span class="n">cycle_found</span><span class="p">,</span> <span class="n">cycle</span> <span class="o">=</span> <span class="n">TreeProcessing</span><span class="o">.</span><span class="n">detect_tree_cycles</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-199"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-199"><span class="linenos">199</span></a>        <span class="k">if</span> <span class="n">cycle_found</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-200"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-200"><span class="linenos">200</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Ciclo encontrado: [</span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-201"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-201"><span class="linenos">201</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-202"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-202"><span class="linenos">202</span></a>        <span class="c1"># Validate level composition</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-203"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-203"><span class="linenos">203</span></a>        <span class="n">level_errors</span> <span class="o">=</span> <span class="n">TreeProcessing</span><span class="o">.</span><span class="n">validate_level_hierarchy</span><span class="p">(</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-204"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-204"><span class="linenos">204</span></a>            <span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-205"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-205"><span class="linenos">205</span></a>            <span class="n">df_description</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-206"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-206"><span class="linenos">206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-207"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-207"><span class="linenos">207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-208"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-208"><span class="linenos">208</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-209"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-209"><span class="linenos">209</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">,</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-210"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-210"><span class="linenos">210</span></a>        <span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-211"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-211"><span class="linenos">211</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-212"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-212"><span class="linenos">212</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_level_errors</span><span class="p">(</span><span class="n">level_errors</span><span class="p">,</span> <span class="n">df_composition</span><span class="p">,</span> <span class="n">df_description</span><span class="p">))</span>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-213"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-213"><span class="linenos">213</span></a>
</span><span id="SpCompositionTreeValidator.validate_hierarchy_with_tree-214"><a href="#SpCompositionTreeValidator.validate_hierarchy_with_tree-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate tree composition structure and detect cycles.</p>

<p>Performs comprehensive tree validation including:</p>

<ul>
<li>Required column presence checks</li>
<li>Data cleaning and integer conversion</li>
<li>Root node insertion if missing</li>
<li>Cycle detection in parent-child relationships</li>
<li>Level hierarchy validation</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for structure violations and cycles
        - List[str]: Warning messages (currently empty)</p>
</div>


                            </div>
                            <div id="SpCompositionTreeValidator.validate_tree_levels_children" class="classattr">
                                        <input id="SpCompositionTreeValidator.validate_tree_levels_children-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_tree_levels_children</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionTreeValidator.validate_tree_levels_children-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.validate_tree_levels_children"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionTreeValidator.validate_tree_levels_children-216"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-216"><span class="linenos">216</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_tree_levels_children</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-217"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-218"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-218"><span class="linenos">218</span></a><span class="sd">        Validate that all children of the same parent have the same level.</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-219"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-219"><span class="linenos">219</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-220"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-220"><span class="linenos">220</span></a><span class="sd">        Ensures consistency in the tree structure by checking that all indicators</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-221"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-221"><span class="linenos">221</span></a><span class="sd">        sharing the same parent are at the same hierarchical level. This prevents</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-222"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-222"><span class="linenos">222</span></a><span class="sd">        inconsistent tree structures where siblings have different levels.</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-223"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-223"><span class="linenos">223</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-224"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-224"><span class="linenos">224</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-225"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-225"><span class="linenos">225</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-226"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-226"><span class="linenos">226</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-227"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-227"><span class="linenos">227</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-228"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-228"><span class="linenos">228</span></a><span class="sd">                - List[str]: Error messages for level inconsistencies and missing codes</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-229"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-229"><span class="linenos">229</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-230"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-231"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-231"><span class="linenos">231</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-232"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-232"><span class="linenos">232</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-233"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-233"><span class="linenos">233</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-234"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-234"><span class="linenos">234</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-235"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-235"><span class="linenos">235</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-236"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-237"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-237"><span class="linenos">237</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-238"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-238"><span class="linenos">238</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-239"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-239"><span class="linenos">239</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-240"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-240"><span class="linenos">240</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-241"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-241"><span class="linenos">241</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-242"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-242"><span class="linenos">242</span></a>        <span class="c1"># Create level mapping</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-243"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-243"><span class="linenos">243</span></a>        <span class="n">levels</span> <span class="o">=</span> <span class="p">{</span><span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]:</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_description</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()}</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-244"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-244"><span class="linenos">244</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-245"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-245"><span class="linenos">245</span></a>        <span class="c1"># Group by parent and validate children levels</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-246"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-246"><span class="linenos">246</span></a>        <span class="n">parent_groups</span> <span class="o">=</span> <span class="n">df_composition</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-247"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-247"><span class="linenos">247</span></a>        <span class="k">for</span> <span class="n">parent</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">parent_groups</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-248"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-248"><span class="linenos">248</span></a>            <span class="k">if</span> <span class="n">parent</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-249"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-249"><span class="linenos">249</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Cdigo pai </span><span class="si">{</span><span class="n">parent</span><span class="si">}</span><span class="s2"> no encontrado na descrio.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-250"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-250"><span class="linenos">250</span></a>                <span class="k">continue</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-251"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-251"><span class="linenos">251</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-252"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-252"><span class="linenos">252</span></a>            <span class="n">children_info</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-253"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-253"><span class="linenos">253</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-254"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-254"><span class="linenos">254</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-255"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-255"><span class="linenos">255</span></a>                <span class="n">child</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">]</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-256"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-257"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-257"><span class="linenos">257</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Cdigo filho </span><span class="si">{</span><span class="n">child</span><span class="si">}</span><span class="s2"> no encontrado na descrio.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-258"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-258"><span class="linenos">258</span></a>                    <span class="k">continue</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-259"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-259"><span class="linenos">259</span></a>                <span class="n">child_level</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[</span><span class="n">child</span><span class="p">]</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-260"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-260"><span class="linenos">260</span></a>                <span class="n">children_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">child_level</span><span class="p">))</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-261"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-261"><span class="linenos">261</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-262"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="n">children_info</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">({</span><span class="n">level</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">children_info</span><span class="p">})</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-263"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-263"><span class="linenos">263</span></a>                <span class="n">error_children</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;indicador </span><span class="si">{</span><span class="n">child</span><span class="si">}</span><span class="s2"> possui nvel &#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">child</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">children_info</span><span class="p">])</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-264"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-264"><span class="linenos">264</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Indicadores filhos do pai </span><span class="si">{</span><span class="n">parent</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="sa">f</span><span class="s2">&quot;no esto no mesmo nvel: [</span><span class="si">{</span><span class="n">error_children</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-265"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-265"><span class="linenos">265</span></a>
</span><span id="SpCompositionTreeValidator.validate_tree_levels_children-266"><a href="#SpCompositionTreeValidator.validate_tree_levels_children-266"><span class="linenos">266</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate that all children of the same parent have the same level.</p>

<p>Ensures consistency in the tree structure by checking that all indicators
sharing the same parent are at the same hierarchical level. This prevents
inconsistent tree structures where siblings have different levels.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for level inconsistencies and missing codes
        - List[str]: Warning messages (currently empty)</p>
</div>


                            </div>
                            <div id="SpCompositionTreeValidator.run" class="classattr">
                                        <input id="SpCompositionTreeValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionTreeValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionTreeValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionTreeValidator.run-320"><a href="#SpCompositionTreeValidator.run-320"><span class="linenos">320</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionTreeValidator.run-321"><a href="#SpCompositionTreeValidator.run-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.run-322"><a href="#SpCompositionTreeValidator.run-322"><span class="linenos">322</span></a><span class="sd">        Execute all tree validation checks.</span>
</span><span id="SpCompositionTreeValidator.run-323"><a href="#SpCompositionTreeValidator.run-323"><span class="linenos">323</span></a>
</span><span id="SpCompositionTreeValidator.run-324"><a href="#SpCompositionTreeValidator.run-324"><span class="linenos">324</span></a><span class="sd">        Orchestrates the execution of tree hierarchy validations and child level</span>
</span><span id="SpCompositionTreeValidator.run-325"><a href="#SpCompositionTreeValidator.run-325"><span class="linenos">325</span></a><span class="sd">        consistency checks. If either composition or description dataframes are empty,</span>
</span><span id="SpCompositionTreeValidator.run-326"><a href="#SpCompositionTreeValidator.run-326"><span class="linenos">326</span></a><span class="sd">        all validations are marked as not executed.</span>
</span><span id="SpCompositionTreeValidator.run-327"><a href="#SpCompositionTreeValidator.run-327"><span class="linenos">327</span></a>
</span><span id="SpCompositionTreeValidator.run-328"><a href="#SpCompositionTreeValidator.run-328"><span class="linenos">328</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionTreeValidator.run-329"><a href="#SpCompositionTreeValidator.run-329"><span class="linenos">329</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionTreeValidator.run-330"><a href="#SpCompositionTreeValidator.run-330"><span class="linenos">330</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionTreeValidator.run-331"><a href="#SpCompositionTreeValidator.run-331"><span class="linenos">331</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionTreeValidator.run-332"><a href="#SpCompositionTreeValidator.run-332"><span class="linenos">332</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpCompositionTreeValidator.run-333"><a href="#SpCompositionTreeValidator.run-333"><span class="linenos">333</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpCompositionTreeValidator.run-334"><a href="#SpCompositionTreeValidator.run-334"><span class="linenos">334</span></a>
</span><span id="SpCompositionTreeValidator.run-335"><a href="#SpCompositionTreeValidator.run-335"><span class="linenos">335</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionTreeValidator.run-336"><a href="#SpCompositionTreeValidator.run-336"><span class="linenos">336</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionTreeValidator.run-337"><a href="#SpCompositionTreeValidator.run-337"><span class="linenos">337</span></a><span class="sd">        Validations are skipped if composition or description data is unavailable.</span>
</span><span id="SpCompositionTreeValidator.run-338"><a href="#SpCompositionTreeValidator.run-338"><span class="linenos">338</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionTreeValidator.run-339"><a href="#SpCompositionTreeValidator.run-339"><span class="linenos">339</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpCompositionTreeValidator.run-340"><a href="#SpCompositionTreeValidator.run-340"><span class="linenos">340</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_hierarchy_with_tree</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">TH</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionTreeValidator.run-341"><a href="#SpCompositionTreeValidator.run-341"><span class="linenos">341</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_tree_levels_children</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">CHILD_LVL</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionTreeValidator.run-342"><a href="#SpCompositionTreeValidator.run-342"><span class="linenos">342</span></a>        <span class="p">]</span>
</span><span id="SpCompositionTreeValidator.run-343"><a href="#SpCompositionTreeValidator.run-343"><span class="linenos">343</span></a>
</span><span id="SpCompositionTreeValidator.run-344"><a href="#SpCompositionTreeValidator.run-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionTreeValidator.run-345"><a href="#SpCompositionTreeValidator.run-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.run-346"><a href="#SpCompositionTreeValidator.run-346"><span class="linenos">346</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpCompositionTreeValidator.run-347"><a href="#SpCompositionTreeValidator.run-347"><span class="linenos">347</span></a>
</span><span id="SpCompositionTreeValidator.run-348"><a href="#SpCompositionTreeValidator.run-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionTreeValidator.run-349"><a href="#SpCompositionTreeValidator.run-349"><span class="linenos">349</span></a>
</span><span id="SpCompositionTreeValidator.run-350"><a href="#SpCompositionTreeValidator.run-350"><span class="linenos">350</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all tree validation checks.</p>

<p>Orchestrates the execution of tree hierarchy validations and child level
consistency checks. If either composition or description dataframes are empty,
all validations are marked as not executed.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<p>Validations are skipped if composition or description data is unavailable.</p>
</div>


                            </div>
                </section>
                <section id="SpCompositionGraphValidator">
                            <input id="SpCompositionGraphValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpCompositionGraphValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpCompositionGraphValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionGraphValidator-32"><a href="#SpCompositionGraphValidator-32"><span class="linenos"> 32</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpCompositionGraphValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpCompositionGraphValidator-33"><a href="#SpCompositionGraphValidator-33"><span class="linenos"> 33</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-34"><a href="#SpCompositionGraphValidator-34"><span class="linenos"> 34</span></a><span class="sd">    Validates composition structures using graph-based analysis.</span>
</span><span id="SpCompositionGraphValidator-35"><a href="#SpCompositionGraphValidator-35"><span class="linenos"> 35</span></a>
</span><span id="SpCompositionGraphValidator-36"><a href="#SpCompositionGraphValidator-36"><span class="linenos"> 36</span></a><span class="sd">    This validator uses graph theory to analyze composition hierarchies, detecting</span>
</span><span id="SpCompositionGraphValidator-37"><a href="#SpCompositionGraphValidator-37"><span class="linenos"> 37</span></a><span class="sd">    cycles, disconnected components, unique title constraints, and data associations</span>
</span><span id="SpCompositionGraphValidator-38"><a href="#SpCompositionGraphValidator-38"><span class="linenos"> 38</span></a><span class="sd">    for leaf indicators.</span>
</span><span id="SpCompositionGraphValidator-39"><a href="#SpCompositionGraphValidator-39"><span class="linenos"> 39</span></a>
</span><span id="SpCompositionGraphValidator-40"><a href="#SpCompositionGraphValidator-40"><span class="linenos"> 40</span></a><span class="sd">    Attributes</span>
</span><span id="SpCompositionGraphValidator-41"><a href="#SpCompositionGraphValidator-41"><span class="linenos"> 41</span></a><span class="sd">    ----------</span>
</span><span id="SpCompositionGraphValidator-42"><a href="#SpCompositionGraphValidator-42"><span class="linenos"> 42</span></a><span class="sd">    model_sp_composition : SpComposition</span>
</span><span id="SpCompositionGraphValidator-43"><a href="#SpCompositionGraphValidator-43"><span class="linenos"> 43</span></a><span class="sd">        Composition model instance containing parent-child relationships.</span>
</span><span id="SpCompositionGraphValidator-44"><a href="#SpCompositionGraphValidator-44"><span class="linenos"> 44</span></a><span class="sd">    model_sp_description : SpDescription | SpModelABC</span>
</span><span id="SpCompositionGraphValidator-45"><a href="#SpCompositionGraphValidator-45"><span class="linenos"> 45</span></a><span class="sd">        Description model instance containing indicator metadata.</span>
</span><span id="SpCompositionGraphValidator-46"><a href="#SpCompositionGraphValidator-46"><span class="linenos"> 46</span></a><span class="sd">    model_sp_value : SpValue</span>
</span><span id="SpCompositionGraphValidator-47"><a href="#SpCompositionGraphValidator-47"><span class="linenos"> 47</span></a><span class="sd">        Value model instance containing indicator data.</span>
</span><span id="SpCompositionGraphValidator-48"><a href="#SpCompositionGraphValidator-48"><span class="linenos"> 48</span></a><span class="sd">    model_sp_proportionality : SpProportionality</span>
</span><span id="SpCompositionGraphValidator-49"><a href="#SpCompositionGraphValidator-49"><span class="linenos"> 49</span></a><span class="sd">        Proportionality model instance containing indicator proportions.</span>
</span><span id="SpCompositionGraphValidator-50"><a href="#SpCompositionGraphValidator-50"><span class="linenos"> 50</span></a><span class="sd">    sp_name_composition : str</span>
</span><span id="SpCompositionGraphValidator-51"><a href="#SpCompositionGraphValidator-51"><span class="linenos"> 51</span></a><span class="sd">        Composition spreadsheet filename.</span>
</span><span id="SpCompositionGraphValidator-52"><a href="#SpCompositionGraphValidator-52"><span class="linenos"> 52</span></a><span class="sd">    sp_name_description : str</span>
</span><span id="SpCompositionGraphValidator-53"><a href="#SpCompositionGraphValidator-53"><span class="linenos"> 53</span></a><span class="sd">        Description spreadsheet filename.</span>
</span><span id="SpCompositionGraphValidator-54"><a href="#SpCompositionGraphValidator-54"><span class="linenos"> 54</span></a><span class="sd">    sp_name_value : str</span>
</span><span id="SpCompositionGraphValidator-55"><a href="#SpCompositionGraphValidator-55"><span class="linenos"> 55</span></a><span class="sd">        Value spreadsheet filename.</span>
</span><span id="SpCompositionGraphValidator-56"><a href="#SpCompositionGraphValidator-56"><span class="linenos"> 56</span></a><span class="sd">    sp_name_proportionality : str</span>
</span><span id="SpCompositionGraphValidator-57"><a href="#SpCompositionGraphValidator-57"><span class="linenos"> 57</span></a><span class="sd">        Proportionality spreadsheet filename.</span>
</span><span id="SpCompositionGraphValidator-58"><a href="#SpCompositionGraphValidator-58"><span class="linenos"> 58</span></a><span class="sd">    column_name_parent : str</span>
</span><span id="SpCompositionGraphValidator-59"><a href="#SpCompositionGraphValidator-59"><span class="linenos"> 59</span></a><span class="sd">        Parent code column name.</span>
</span><span id="SpCompositionGraphValidator-60"><a href="#SpCompositionGraphValidator-60"><span class="linenos"> 60</span></a><span class="sd">    column_name_child : str</span>
</span><span id="SpCompositionGraphValidator-61"><a href="#SpCompositionGraphValidator-61"><span class="linenos"> 61</span></a><span class="sd">        Child code column name.</span>
</span><span id="SpCompositionGraphValidator-62"><a href="#SpCompositionGraphValidator-62"><span class="linenos"> 62</span></a><span class="sd">    column_name_code : str</span>
</span><span id="SpCompositionGraphValidator-63"><a href="#SpCompositionGraphValidator-63"><span class="linenos"> 63</span></a><span class="sd">        Indicator code column name.</span>
</span><span id="SpCompositionGraphValidator-64"><a href="#SpCompositionGraphValidator-64"><span class="linenos"> 64</span></a><span class="sd">    column_name_simple_name : str</span>
</span><span id="SpCompositionGraphValidator-65"><a href="#SpCompositionGraphValidator-65"><span class="linenos"> 65</span></a><span class="sd">        Simple name column name.</span>
</span><span id="SpCompositionGraphValidator-66"><a href="#SpCompositionGraphValidator-66"><span class="linenos"> 66</span></a><span class="sd">    column_name_complete_name : str</span>
</span><span id="SpCompositionGraphValidator-67"><a href="#SpCompositionGraphValidator-67"><span class="linenos"> 67</span></a><span class="sd">        Complete name column name.</span>
</span><span id="SpCompositionGraphValidator-68"><a href="#SpCompositionGraphValidator-68"><span class="linenos"> 68</span></a><span class="sd">    column_name_id : str</span>
</span><span id="SpCompositionGraphValidator-69"><a href="#SpCompositionGraphValidator-69"><span class="linenos"> 69</span></a><span class="sd">        ID column name.</span>
</span><span id="SpCompositionGraphValidator-70"><a href="#SpCompositionGraphValidator-70"><span class="linenos"> 70</span></a><span class="sd">    global_required_columns : Dict[str, List[str]]</span>
</span><span id="SpCompositionGraphValidator-71"><a href="#SpCompositionGraphValidator-71"><span class="linenos"> 71</span></a><span class="sd">        Required columns mapping for validation.</span>
</span><span id="SpCompositionGraphValidator-72"><a href="#SpCompositionGraphValidator-72"><span class="linenos"> 72</span></a><span class="sd">    model_dataframes : Dict[str, DataFrame]</span>
</span><span id="SpCompositionGraphValidator-73"><a href="#SpCompositionGraphValidator-73"><span class="linenos"> 73</span></a><span class="sd">        DataFrames mapping for each model.</span>
</span><span id="SpCompositionGraphValidator-74"><a href="#SpCompositionGraphValidator-74"><span class="linenos"> 74</span></a><span class="sd">    graph_processing : GraphProcessing | None</span>
</span><span id="SpCompositionGraphValidator-75"><a href="#SpCompositionGraphValidator-75"><span class="linenos"> 75</span></a><span class="sd">        Graph processing utility for analysis.</span>
</span><span id="SpCompositionGraphValidator-76"><a href="#SpCompositionGraphValidator-76"><span class="linenos"> 76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-77"><a href="#SpCompositionGraphValidator-77"><span class="linenos"> 77</span></a>
</span><span id="SpCompositionGraphValidator-78"><a href="#SpCompositionGraphValidator-78"><span class="linenos"> 78</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-79"><a href="#SpCompositionGraphValidator-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-80"><a href="#SpCompositionGraphValidator-80"><span class="linenos"> 80</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-81"><a href="#SpCompositionGraphValidator-81"><span class="linenos"> 81</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-82"><a href="#SpCompositionGraphValidator-82"><span class="linenos"> 82</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-83"><a href="#SpCompositionGraphValidator-83"><span class="linenos"> 83</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-84"><a href="#SpCompositionGraphValidator-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-85"><a href="#SpCompositionGraphValidator-85"><span class="linenos"> 85</span></a><span class="sd">        Initialize the graph validator with required context and models.</span>
</span><span id="SpCompositionGraphValidator-86"><a href="#SpCompositionGraphValidator-86"><span class="linenos"> 86</span></a>
</span><span id="SpCompositionGraphValidator-87"><a href="#SpCompositionGraphValidator-87"><span class="linenos"> 87</span></a><span class="sd">        Args</span>
</span><span id="SpCompositionGraphValidator-88"><a href="#SpCompositionGraphValidator-88"><span class="linenos"> 88</span></a><span class="sd">        ----</span>
</span><span id="SpCompositionGraphValidator-89"><a href="#SpCompositionGraphValidator-89"><span class="linenos"> 89</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpCompositionGraphValidator-90"><a href="#SpCompositionGraphValidator-90"><span class="linenos"> 90</span></a><span class="sd">            Context containing all data models and configuration.</span>
</span><span id="SpCompositionGraphValidator-91"><a href="#SpCompositionGraphValidator-91"><span class="linenos"> 91</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpCompositionGraphValidator-92"><a href="#SpCompositionGraphValidator-92"><span class="linenos"> 92</span></a><span class="sd">            Report list for validation results aggregation.</span>
</span><span id="SpCompositionGraphValidator-93"><a href="#SpCompositionGraphValidator-93"><span class="linenos"> 93</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpCompositionGraphValidator-94"><a href="#SpCompositionGraphValidator-94"><span class="linenos"> 94</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpCompositionGraphValidator-95"><a href="#SpCompositionGraphValidator-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-96"><a href="#SpCompositionGraphValidator-96"><span class="linenos"> 96</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-97"><a href="#SpCompositionGraphValidator-97"><span class="linenos"> 97</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-98"><a href="#SpCompositionGraphValidator-98"><span class="linenos"> 98</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-99"><a href="#SpCompositionGraphValidator-99"><span class="linenos"> 99</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpComposition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-100"><a href="#SpCompositionGraphValidator-100"><span class="linenos">100</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-101"><a href="#SpCompositionGraphValidator-101"><span class="linenos">101</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-102"><a href="#SpCompositionGraphValidator-102"><span class="linenos">102</span></a>
</span><span id="SpCompositionGraphValidator-103"><a href="#SpCompositionGraphValidator-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpCompositionGraphValidator-104"><a href="#SpCompositionGraphValidator-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="p">:</span> <span class="n">SpDescription</span> <span class="o">|</span> <span class="n">SpModelABC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-105"><a href="#SpCompositionGraphValidator-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpValue</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-106"><a href="#SpCompositionGraphValidator-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpProportionality</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-107"><a href="#SpCompositionGraphValidator-107"><span class="linenos">107</span></a>
</span><span id="SpCompositionGraphValidator-108"><a href="#SpCompositionGraphValidator-108"><span class="linenos">108</span></a>        <span class="c1"># Initialize attributes</span>
</span><span id="SpCompositionGraphValidator-109"><a href="#SpCompositionGraphValidator-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-110"><a href="#SpCompositionGraphValidator-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-111"><a href="#SpCompositionGraphValidator-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-112"><a href="#SpCompositionGraphValidator-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-113"><a href="#SpCompositionGraphValidator-113"><span class="linenos">113</span></a>
</span><span id="SpCompositionGraphValidator-114"><a href="#SpCompositionGraphValidator-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-115"><a href="#SpCompositionGraphValidator-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-116"><a href="#SpCompositionGraphValidator-116"><span class="linenos">116</span></a>
</span><span id="SpCompositionGraphValidator-117"><a href="#SpCompositionGraphValidator-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-118"><a href="#SpCompositionGraphValidator-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_simple_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-119"><a href="#SpCompositionGraphValidator-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_complete_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-120"><a href="#SpCompositionGraphValidator-120"><span class="linenos">120</span></a>
</span><span id="SpCompositionGraphValidator-121"><a href="#SpCompositionGraphValidator-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-122"><a href="#SpCompositionGraphValidator-122"><span class="linenos">122</span></a>
</span><span id="SpCompositionGraphValidator-123"><a href="#SpCompositionGraphValidator-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionGraphValidator-124"><a href="#SpCompositionGraphValidator-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionGraphValidator-125"><a href="#SpCompositionGraphValidator-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="p">:</span> <span class="n">GraphProcessing</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SpCompositionGraphValidator-126"><a href="#SpCompositionGraphValidator-126"><span class="linenos">126</span></a>
</span><span id="SpCompositionGraphValidator-127"><a href="#SpCompositionGraphValidator-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-128"><a href="#SpCompositionGraphValidator-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-129"><a href="#SpCompositionGraphValidator-129"><span class="linenos">129</span></a>
</span><span id="SpCompositionGraphValidator-130"><a href="#SpCompositionGraphValidator-130"><span class="linenos">130</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-131"><a href="#SpCompositionGraphValidator-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-132"><a href="#SpCompositionGraphValidator-132"><span class="linenos">132</span></a><span class="sd">        Prepare validation context, column mappings, and graph processing.</span>
</span><span id="SpCompositionGraphValidator-133"><a href="#SpCompositionGraphValidator-133"><span class="linenos">133</span></a>
</span><span id="SpCompositionGraphValidator-134"><a href="#SpCompositionGraphValidator-134"><span class="linenos">134</span></a><span class="sd">        Sets up:</span>
</span><span id="SpCompositionGraphValidator-135"><a href="#SpCompositionGraphValidator-135"><span class="linenos">135</span></a><span class="sd">        - Spreadsheet names for all models</span>
</span><span id="SpCompositionGraphValidator-136"><a href="#SpCompositionGraphValidator-136"><span class="linenos">136</span></a><span class="sd">        - Column name mappings for validation</span>
</span><span id="SpCompositionGraphValidator-137"><a href="#SpCompositionGraphValidator-137"><span class="linenos">137</span></a><span class="sd">        - Required columns dictionary</span>
</span><span id="SpCompositionGraphValidator-138"><a href="#SpCompositionGraphValidator-138"><span class="linenos">138</span></a><span class="sd">        - DataFrame references for all models</span>
</span><span id="SpCompositionGraphValidator-139"><a href="#SpCompositionGraphValidator-139"><span class="linenos">139</span></a><span class="sd">        - Graph processing utility with cleaned composition data</span>
</span><span id="SpCompositionGraphValidator-140"><a href="#SpCompositionGraphValidator-140"><span class="linenos">140</span></a>
</span><span id="SpCompositionGraphValidator-141"><a href="#SpCompositionGraphValidator-141"><span class="linenos">141</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator-142"><a href="#SpCompositionGraphValidator-142"><span class="linenos">142</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator-143"><a href="#SpCompositionGraphValidator-143"><span class="linenos">143</span></a><span class="sd">        Integer columns are cleaned during setup to ensure valid graph construction.</span>
</span><span id="SpCompositionGraphValidator-144"><a href="#SpCompositionGraphValidator-144"><span class="linenos">144</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-145"><a href="#SpCompositionGraphValidator-145"><span class="linenos">145</span></a>        <span class="c1"># Set spreadsheet names</span>
</span><span id="SpCompositionGraphValidator-146"><a href="#SpCompositionGraphValidator-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpCompositionGraphValidator-147"><a href="#SpCompositionGraphValidator-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpCompositionGraphValidator-148"><a href="#SpCompositionGraphValidator-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpCompositionGraphValidator-149"><a href="#SpCompositionGraphValidator-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpCompositionGraphValidator-150"><a href="#SpCompositionGraphValidator-150"><span class="linenos">150</span></a>
</span><span id="SpCompositionGraphValidator-151"><a href="#SpCompositionGraphValidator-151"><span class="linenos">151</span></a>        <span class="c1"># Set column names</span>
</span><span id="SpCompositionGraphValidator-152"><a href="#SpCompositionGraphValidator-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span> <span class="o">=</span> <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-153"><a href="#SpCompositionGraphValidator-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span> <span class="o">=</span> <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-154"><a href="#SpCompositionGraphValidator-154"><span class="linenos">154</span></a>
</span><span id="SpCompositionGraphValidator-155"><a href="#SpCompositionGraphValidator-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-156"><a href="#SpCompositionGraphValidator-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_simple_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-157"><a href="#SpCompositionGraphValidator-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_complete_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-158"><a href="#SpCompositionGraphValidator-158"><span class="linenos">158</span></a>
</span><span id="SpCompositionGraphValidator-159"><a href="#SpCompositionGraphValidator-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span> <span class="o">=</span> <span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-160"><a href="#SpCompositionGraphValidator-160"><span class="linenos">160</span></a>
</span><span id="SpCompositionGraphValidator-161"><a href="#SpCompositionGraphValidator-161"><span class="linenos">161</span></a>        <span class="c1"># Define required columns</span>
</span><span id="SpCompositionGraphValidator-162"><a href="#SpCompositionGraphValidator-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator-163"><a href="#SpCompositionGraphValidator-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-164"><a href="#SpCompositionGraphValidator-164"><span class="linenos">164</span></a>                <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-165"><a href="#SpCompositionGraphValidator-165"><span class="linenos">165</span></a>                <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-166"><a href="#SpCompositionGraphValidator-166"><span class="linenos">166</span></a>            <span class="p">],</span>
</span><span id="SpCompositionGraphValidator-167"><a href="#SpCompositionGraphValidator-167"><span class="linenos">167</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-168"><a href="#SpCompositionGraphValidator-168"><span class="linenos">168</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-169"><a href="#SpCompositionGraphValidator-169"><span class="linenos">169</span></a>            <span class="p">],</span>
</span><span id="SpCompositionGraphValidator-170"><a href="#SpCompositionGraphValidator-170"><span class="linenos">170</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="p">[</span><span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-171"><a href="#SpCompositionGraphValidator-171"><span class="linenos">171</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator-172"><a href="#SpCompositionGraphValidator-172"><span class="linenos">172</span></a>
</span><span id="SpCompositionGraphValidator-173"><a href="#SpCompositionGraphValidator-173"><span class="linenos">173</span></a>        <span class="c1"># Set dataframes</span>
</span><span id="SpCompositionGraphValidator-174"><a href="#SpCompositionGraphValidator-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator-175"><a href="#SpCompositionGraphValidator-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-176"><a href="#SpCompositionGraphValidator-176"><span class="linenos">176</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-177"><a href="#SpCompositionGraphValidator-177"><span class="linenos">177</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-178"><a href="#SpCompositionGraphValidator-178"><span class="linenos">178</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-179"><a href="#SpCompositionGraphValidator-179"><span class="linenos">179</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator-180"><a href="#SpCompositionGraphValidator-180"><span class="linenos">180</span></a>
</span><span id="SpCompositionGraphValidator-181"><a href="#SpCompositionGraphValidator-181"><span class="linenos">181</span></a>        <span class="c1"># Setup graph processing if composition data is available</span>
</span><span id="SpCompositionGraphValidator-182"><a href="#SpCompositionGraphValidator-182"><span class="linenos">182</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpCompositionGraphValidator-183"><a href="#SpCompositionGraphValidator-183"><span class="linenos">183</span></a>        <span class="n">df_composition</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-184"><a href="#SpCompositionGraphValidator-184"><span class="linenos">184</span></a>
</span><span id="SpCompositionGraphValidator-185"><a href="#SpCompositionGraphValidator-185"><span class="linenos">185</span></a>        <span class="c1"># Clean integer columns: df_composition</span>
</span><span id="SpCompositionGraphValidator-186"><a href="#SpCompositionGraphValidator-186"><span class="linenos">186</span></a>        <span class="n">df_composition</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-187"><a href="#SpCompositionGraphValidator-187"><span class="linenos">187</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-188"><a href="#SpCompositionGraphValidator-188"><span class="linenos">188</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-189"><a href="#SpCompositionGraphValidator-189"><span class="linenos">189</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-190"><a href="#SpCompositionGraphValidator-190"><span class="linenos">190</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-191"><a href="#SpCompositionGraphValidator-191"><span class="linenos">191</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-192"><a href="#SpCompositionGraphValidator-192"><span class="linenos">192</span></a>        <span class="n">df_composition</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-193"><a href="#SpCompositionGraphValidator-193"><span class="linenos">193</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-194"><a href="#SpCompositionGraphValidator-194"><span class="linenos">194</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-195"><a href="#SpCompositionGraphValidator-195"><span class="linenos">195</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-196"><a href="#SpCompositionGraphValidator-196"><span class="linenos">196</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-197"><a href="#SpCompositionGraphValidator-197"><span class="linenos">197</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-198"><a href="#SpCompositionGraphValidator-198"><span class="linenos">198</span></a>        <span class="c1"># Configure processing helpers</span>
</span><span id="SpCompositionGraphValidator-199"><a href="#SpCompositionGraphValidator-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span> <span class="o">=</span> <span class="n">GraphProcessing</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-200"><a href="#SpCompositionGraphValidator-200"><span class="linenos">200</span></a>            <span class="n">dataframe</span><span class="o">=</span><span class="n">df_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-201"><a href="#SpCompositionGraphValidator-201"><span class="linenos">201</span></a>            <span class="n">parent_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-202"><a href="#SpCompositionGraphValidator-202"><span class="linenos">202</span></a>            <span class="n">child_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-203"><a href="#SpCompositionGraphValidator-203"><span class="linenos">203</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-204"><a href="#SpCompositionGraphValidator-204"><span class="linenos">204</span></a>
</span><span id="SpCompositionGraphValidator-205"><a href="#SpCompositionGraphValidator-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_composition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator-206"><a href="#SpCompositionGraphValidator-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-207"><a href="#SpCompositionGraphValidator-207"><span class="linenos">207</span></a><span class="sd">        Validate that all indicators in composition exist in description.</span>
</span><span id="SpCompositionGraphValidator-208"><a href="#SpCompositionGraphValidator-208"><span class="linenos">208</span></a>
</span><span id="SpCompositionGraphValidator-209"><a href="#SpCompositionGraphValidator-209"><span class="linenos">209</span></a><span class="sd">        Ensures that every parent and child code referenced in the composition</span>
</span><span id="SpCompositionGraphValidator-210"><a href="#SpCompositionGraphValidator-210"><span class="linenos">210</span></a><span class="sd">        spreadsheet has a corresponding entry in the description spreadsheet.</span>
</span><span id="SpCompositionGraphValidator-211"><a href="#SpCompositionGraphValidator-211"><span class="linenos">211</span></a>
</span><span id="SpCompositionGraphValidator-212"><a href="#SpCompositionGraphValidator-212"><span class="linenos">212</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator-213"><a href="#SpCompositionGraphValidator-213"><span class="linenos">213</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator-214"><a href="#SpCompositionGraphValidator-214"><span class="linenos">214</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator-215"><a href="#SpCompositionGraphValidator-215"><span class="linenos">215</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator-216"><a href="#SpCompositionGraphValidator-216"><span class="linenos">216</span></a><span class="sd">                - List[str]: Error messages for codes not found in description</span>
</span><span id="SpCompositionGraphValidator-217"><a href="#SpCompositionGraphValidator-217"><span class="linenos">217</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionGraphValidator-218"><a href="#SpCompositionGraphValidator-218"><span class="linenos">218</span></a>
</span><span id="SpCompositionGraphValidator-219"><a href="#SpCompositionGraphValidator-219"><span class="linenos">219</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator-220"><a href="#SpCompositionGraphValidator-220"><span class="linenos">220</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator-221"><a href="#SpCompositionGraphValidator-221"><span class="linenos">221</span></a><span class="sd">        This validation is skipped if the description dataframe is empty.</span>
</span><span id="SpCompositionGraphValidator-222"><a href="#SpCompositionGraphValidator-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-223"><a href="#SpCompositionGraphValidator-223"><span class="linenos">223</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-224"><a href="#SpCompositionGraphValidator-224"><span class="linenos">224</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-225"><a href="#SpCompositionGraphValidator-225"><span class="linenos">225</span></a>
</span><span id="SpCompositionGraphValidator-226"><a href="#SpCompositionGraphValidator-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-227"><a href="#SpCompositionGraphValidator-227"><span class="linenos">227</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-228"><a href="#SpCompositionGraphValidator-228"><span class="linenos">228</span></a>                <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-229"><a href="#SpCompositionGraphValidator-229"><span class="linenos">229</span></a>                    <span class="p">(</span>
</span><span id="SpCompositionGraphValidator-230"><a href="#SpCompositionGraphValidator-230"><span class="linenos">230</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-231"><a href="#SpCompositionGraphValidator-231"><span class="linenos">231</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-232"><a href="#SpCompositionGraphValidator-232"><span class="linenos">232</span></a>                    <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-233"><a href="#SpCompositionGraphValidator-233"><span class="linenos">233</span></a>                <span class="p">]</span>
</span><span id="SpCompositionGraphValidator-234"><a href="#SpCompositionGraphValidator-234"><span class="linenos">234</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-235"><a href="#SpCompositionGraphValidator-235"><span class="linenos">235</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-236"><a href="#SpCompositionGraphValidator-236"><span class="linenos">236</span></a>
</span><span id="SpCompositionGraphValidator-237"><a href="#SpCompositionGraphValidator-237"><span class="linenos">237</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpCompositionGraphValidator-238"><a href="#SpCompositionGraphValidator-238"><span class="linenos">238</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator-239"><a href="#SpCompositionGraphValidator-239"><span class="linenos">239</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-240"><a href="#SpCompositionGraphValidator-240"><span class="linenos">240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-241"><a href="#SpCompositionGraphValidator-241"><span class="linenos">241</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-242"><a href="#SpCompositionGraphValidator-242"><span class="linenos">242</span></a>            <span class="p">],</span>
</span><span id="SpCompositionGraphValidator-243"><a href="#SpCompositionGraphValidator-243"><span class="linenos">243</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator-244"><a href="#SpCompositionGraphValidator-244"><span class="linenos">244</span></a>
</span><span id="SpCompositionGraphValidator-245"><a href="#SpCompositionGraphValidator-245"><span class="linenos">245</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator-246"><a href="#SpCompositionGraphValidator-246"><span class="linenos">246</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-247"><a href="#SpCompositionGraphValidator-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-248"><a href="#SpCompositionGraphValidator-248"><span class="linenos">248</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-249"><a href="#SpCompositionGraphValidator-249"><span class="linenos">249</span></a>
</span><span id="SpCompositionGraphValidator-250"><a href="#SpCompositionGraphValidator-250"><span class="linenos">250</span></a>        <span class="c1"># Extract valid description codes</span>
</span><span id="SpCompositionGraphValidator-251"><a href="#SpCompositionGraphValidator-251"><span class="linenos">251</span></a>        <span class="n">list_codes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-252"><a href="#SpCompositionGraphValidator-252"><span class="linenos">252</span></a>        <span class="n">valid_description_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span><span class="n">id_values_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_codes</span><span class="p">)))</span>
</span><span id="SpCompositionGraphValidator-253"><a href="#SpCompositionGraphValidator-253"><span class="linenos">253</span></a>
</span><span id="SpCompositionGraphValidator-254"><a href="#SpCompositionGraphValidator-254"><span class="linenos">254</span></a>        <span class="c1"># Extract valid composition parent</span>
</span><span id="SpCompositionGraphValidator-255"><a href="#SpCompositionGraphValidator-255"><span class="linenos">255</span></a>        <span class="n">list_parents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-256"><a href="#SpCompositionGraphValidator-256"><span class="linenos">256</span></a>        <span class="n">valid_compositions_parent_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span><span class="n">id_values_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_parents</span><span class="p">)))</span>
</span><span id="SpCompositionGraphValidator-257"><a href="#SpCompositionGraphValidator-257"><span class="linenos">257</span></a>
</span><span id="SpCompositionGraphValidator-258"><a href="#SpCompositionGraphValidator-258"><span class="linenos">258</span></a>        <span class="c1"># Extract valid composition child codes</span>
</span><span id="SpCompositionGraphValidator-259"><a href="#SpCompositionGraphValidator-259"><span class="linenos">259</span></a>        <span class="n">list_childs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-260"><a href="#SpCompositionGraphValidator-260"><span class="linenos">260</span></a>        <span class="n">valid_compositions_childs_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span><span class="n">id_values_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_childs</span><span class="p">)))</span>
</span><span id="SpCompositionGraphValidator-261"><a href="#SpCompositionGraphValidator-261"><span class="linenos">261</span></a>
</span><span id="SpCompositionGraphValidator-262"><a href="#SpCompositionGraphValidator-262"><span class="linenos">262</span></a>        <span class="c1"># Compare codes between description and values</span>
</span><span id="SpCompositionGraphValidator-263"><a href="#SpCompositionGraphValidator-263"><span class="linenos">263</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-264"><a href="#SpCompositionGraphValidator-264"><span class="linenos">264</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">valid_description_codes</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-265"><a href="#SpCompositionGraphValidator-265"><span class="linenos">265</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-266"><a href="#SpCompositionGraphValidator-266"><span class="linenos">266</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">valid_compositions_parent_codes</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">valid_compositions_childs_codes</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator-267"><a href="#SpCompositionGraphValidator-267"><span class="linenos">267</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-268"><a href="#SpCompositionGraphValidator-268"><span class="linenos">268</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-269"><a href="#SpCompositionGraphValidator-269"><span class="linenos">269</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-270"><a href="#SpCompositionGraphValidator-270"><span class="linenos">270</span></a>
</span><span id="SpCompositionGraphValidator-271"><a href="#SpCompositionGraphValidator-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-272"><a href="#SpCompositionGraphValidator-272"><span class="linenos">272</span></a>
</span><span id="SpCompositionGraphValidator-273"><a href="#SpCompositionGraphValidator-273"><span class="linenos">273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relations_hierarchy_with_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator-274"><a href="#SpCompositionGraphValidator-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-275"><a href="#SpCompositionGraphValidator-275"><span class="linenos">275</span></a><span class="sd">        Detect cycles and disconnected components in the composition graph structure.</span>
</span><span id="SpCompositionGraphValidator-276"><a href="#SpCompositionGraphValidator-276"><span class="linenos">276</span></a>
</span><span id="SpCompositionGraphValidator-277"><a href="#SpCompositionGraphValidator-277"><span class="linenos">277</span></a><span class="sd">        Uses graph analysis to identify circular dependencies in parent-child</span>
</span><span id="SpCompositionGraphValidator-278"><a href="#SpCompositionGraphValidator-278"><span class="linenos">278</span></a><span class="sd">        relationships and disconnected indicator subgraphs, which would create</span>
</span><span id="SpCompositionGraphValidator-279"><a href="#SpCompositionGraphValidator-279"><span class="linenos">279</span></a><span class="sd">        invalid hierarchical structures.</span>
</span><span id="SpCompositionGraphValidator-280"><a href="#SpCompositionGraphValidator-280"><span class="linenos">280</span></a>
</span><span id="SpCompositionGraphValidator-281"><a href="#SpCompositionGraphValidator-281"><span class="linenos">281</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator-282"><a href="#SpCompositionGraphValidator-282"><span class="linenos">282</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator-283"><a href="#SpCompositionGraphValidator-283"><span class="linenos">283</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator-284"><a href="#SpCompositionGraphValidator-284"><span class="linenos">284</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator-285"><a href="#SpCompositionGraphValidator-285"><span class="linenos">285</span></a><span class="sd">                - List[str]: Error messages for detected cycles and disconnected components</span>
</span><span id="SpCompositionGraphValidator-286"><a href="#SpCompositionGraphValidator-286"><span class="linenos">286</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionGraphValidator-287"><a href="#SpCompositionGraphValidator-287"><span class="linenos">287</span></a>
</span><span id="SpCompositionGraphValidator-288"><a href="#SpCompositionGraphValidator-288"><span class="linenos">288</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator-289"><a href="#SpCompositionGraphValidator-289"><span class="linenos">289</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator-290"><a href="#SpCompositionGraphValidator-290"><span class="linenos">290</span></a><span class="sd">        - Cycles are formatted to show the complete path of the circular dependency</span>
</span><span id="SpCompositionGraphValidator-291"><a href="#SpCompositionGraphValidator-291"><span class="linenos">291</span></a><span class="sd">        - Disconnected components indicate isolated indicator groups not connected to main tree</span>
</span><span id="SpCompositionGraphValidator-292"><a href="#SpCompositionGraphValidator-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-293"><a href="#SpCompositionGraphValidator-293"><span class="linenos">293</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-294"><a href="#SpCompositionGraphValidator-294"><span class="linenos">294</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-295"><a href="#SpCompositionGraphValidator-295"><span class="linenos">295</span></a>
</span><span id="SpCompositionGraphValidator-296"><a href="#SpCompositionGraphValidator-296"><span class="linenos">296</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpCompositionGraphValidator-297"><a href="#SpCompositionGraphValidator-297"><span class="linenos">297</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator-298"><a href="#SpCompositionGraphValidator-298"><span class="linenos">298</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-299"><a href="#SpCompositionGraphValidator-299"><span class="linenos">299</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator-300"><a href="#SpCompositionGraphValidator-300"><span class="linenos">300</span></a>
</span><span id="SpCompositionGraphValidator-301"><a href="#SpCompositionGraphValidator-301"><span class="linenos">301</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator-302"><a href="#SpCompositionGraphValidator-302"><span class="linenos">302</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-303"><a href="#SpCompositionGraphValidator-303"><span class="linenos">303</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-304"><a href="#SpCompositionGraphValidator-304"><span class="linenos">304</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-305"><a href="#SpCompositionGraphValidator-305"><span class="linenos">305</span></a>
</span><span id="SpCompositionGraphValidator-306"><a href="#SpCompositionGraphValidator-306"><span class="linenos">306</span></a>        <span class="n">exists_cycle</span><span class="p">,</span> <span class="n">cycle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_cycles</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-307"><a href="#SpCompositionGraphValidator-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="n">exists_cycle</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-308"><a href="#SpCompositionGraphValidator-308"><span class="linenos">308</span></a>            <span class="n">text_cycles</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-309"><a href="#SpCompositionGraphValidator-309"><span class="linenos">309</span></a>            <span class="k">for</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">cycle</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-310"><a href="#SpCompositionGraphValidator-310"><span class="linenos">310</span></a>                <span class="n">text_cycles</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="SpCompositionGraphValidator-311"><a href="#SpCompositionGraphValidator-311"><span class="linenos">311</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Ciclo encontrado: [</span><span class="si">{</span><span class="n">text_cycles</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-312"><a href="#SpCompositionGraphValidator-312"><span class="linenos">312</span></a>
</span><span id="SpCompositionGraphValidator-313"><a href="#SpCompositionGraphValidator-313"><span class="linenos">313</span></a>        <span class="n">graphs_disconnected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_disconnected_components</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-314"><a href="#SpCompositionGraphValidator-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="n">graphs_disconnected</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-315"><a href="#SpCompositionGraphValidator-315"><span class="linenos">315</span></a>            <span class="n">list_graphs_disconnected</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-316"><a href="#SpCompositionGraphValidator-316"><span class="linenos">316</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grafo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">graphs_disconnected</span><span class="p">):</span>
</span><span id="SpCompositionGraphValidator-317"><a href="#SpCompositionGraphValidator-317"><span class="linenos">317</span></a>                <span class="n">text_disconnected</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">generate_graph_report</span><span class="p">(</span><span class="n">grafo</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
</span><span id="SpCompositionGraphValidator-318"><a href="#SpCompositionGraphValidator-318"><span class="linenos">318</span></a>                <span class="n">list_graphs_disconnected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_disconnected</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-319"><a href="#SpCompositionGraphValidator-319"><span class="linenos">319</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Indicadores desconectados encontrados: &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">list_graphs_disconnected</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-320"><a href="#SpCompositionGraphValidator-320"><span class="linenos">320</span></a>
</span><span id="SpCompositionGraphValidator-321"><a href="#SpCompositionGraphValidator-321"><span class="linenos">321</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-322"><a href="#SpCompositionGraphValidator-322"><span class="linenos">322</span></a>
</span><span id="SpCompositionGraphValidator-323"><a href="#SpCompositionGraphValidator-323"><span class="linenos">323</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_titles_with_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator-324"><a href="#SpCompositionGraphValidator-324"><span class="linenos">324</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-325"><a href="#SpCompositionGraphValidator-325"><span class="linenos">325</span></a><span class="sd">        Validate uniqueness of indicator titles using graph analysis.</span>
</span><span id="SpCompositionGraphValidator-326"><a href="#SpCompositionGraphValidator-326"><span class="linenos">326</span></a>
</span><span id="SpCompositionGraphValidator-327"><a href="#SpCompositionGraphValidator-327"><span class="linenos">327</span></a><span class="sd">        Checks that simple names and complete names are unique within each subtree</span>
</span><span id="SpCompositionGraphValidator-328"><a href="#SpCompositionGraphValidator-328"><span class="linenos">328</span></a><span class="sd">        of the indicator hierarchy, using graph structure to determine sibling</span>
</span><span id="SpCompositionGraphValidator-329"><a href="#SpCompositionGraphValidator-329"><span class="linenos">329</span></a><span class="sd">        relationships. Validates by traversing from root node through all subtrees.</span>
</span><span id="SpCompositionGraphValidator-330"><a href="#SpCompositionGraphValidator-330"><span class="linenos">330</span></a>
</span><span id="SpCompositionGraphValidator-331"><a href="#SpCompositionGraphValidator-331"><span class="linenos">331</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator-332"><a href="#SpCompositionGraphValidator-332"><span class="linenos">332</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator-333"><a href="#SpCompositionGraphValidator-333"><span class="linenos">333</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator-334"><a href="#SpCompositionGraphValidator-334"><span class="linenos">334</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator-335"><a href="#SpCompositionGraphValidator-335"><span class="linenos">335</span></a><span class="sd">                - List[str]: Empty list (no errors for title uniqueness issues)</span>
</span><span id="SpCompositionGraphValidator-336"><a href="#SpCompositionGraphValidator-336"><span class="linenos">336</span></a><span class="sd">                - List[str]: Warning messages for duplicate titles within same subtree</span>
</span><span id="SpCompositionGraphValidator-337"><a href="#SpCompositionGraphValidator-337"><span class="linenos">337</span></a>
</span><span id="SpCompositionGraphValidator-338"><a href="#SpCompositionGraphValidator-338"><span class="linenos">338</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator-339"><a href="#SpCompositionGraphValidator-339"><span class="linenos">339</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator-340"><a href="#SpCompositionGraphValidator-340"><span class="linenos">340</span></a><span class="sd">        - This validation is skipped if the description dataframe is empty</span>
</span><span id="SpCompositionGraphValidator-341"><a href="#SpCompositionGraphValidator-341"><span class="linenos">341</span></a><span class="sd">        - Requires a valid tree structure without cycles or disconnected components</span>
</span><span id="SpCompositionGraphValidator-342"><a href="#SpCompositionGraphValidator-342"><span class="linenos">342</span></a><span class="sd">        - Root node must exist in the composition graph</span>
</span><span id="SpCompositionGraphValidator-343"><a href="#SpCompositionGraphValidator-343"><span class="linenos">343</span></a><span class="sd">        - Titles are checked within each subtree independently</span>
</span><span id="SpCompositionGraphValidator-344"><a href="#SpCompositionGraphValidator-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-345"><a href="#SpCompositionGraphValidator-345"><span class="linenos">345</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-346"><a href="#SpCompositionGraphValidator-346"><span class="linenos">346</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-347"><a href="#SpCompositionGraphValidator-347"><span class="linenos">347</span></a>
</span><span id="SpCompositionGraphValidator-348"><a href="#SpCompositionGraphValidator-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-349"><a href="#SpCompositionGraphValidator-349"><span class="linenos">349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-350"><a href="#SpCompositionGraphValidator-350"><span class="linenos">350</span></a>                <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-351"><a href="#SpCompositionGraphValidator-351"><span class="linenos">351</span></a>                    <span class="p">(</span>
</span><span id="SpCompositionGraphValidator-352"><a href="#SpCompositionGraphValidator-352"><span class="linenos">352</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_titles_with_graph</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-353"><a href="#SpCompositionGraphValidator-353"><span class="linenos">353</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UT</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-354"><a href="#SpCompositionGraphValidator-354"><span class="linenos">354</span></a>                    <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-355"><a href="#SpCompositionGraphValidator-355"><span class="linenos">355</span></a>                <span class="p">]</span>
</span><span id="SpCompositionGraphValidator-356"><a href="#SpCompositionGraphValidator-356"><span class="linenos">356</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-357"><a href="#SpCompositionGraphValidator-357"><span class="linenos">357</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-358"><a href="#SpCompositionGraphValidator-358"><span class="linenos">358</span></a>
</span><span id="SpCompositionGraphValidator-359"><a href="#SpCompositionGraphValidator-359"><span class="linenos">359</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator-360"><a href="#SpCompositionGraphValidator-360"><span class="linenos">360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-361"><a href="#SpCompositionGraphValidator-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-362"><a href="#SpCompositionGraphValidator-362"><span class="linenos">362</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-363"><a href="#SpCompositionGraphValidator-363"><span class="linenos">363</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-364"><a href="#SpCompositionGraphValidator-364"><span class="linenos">364</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-365"><a href="#SpCompositionGraphValidator-365"><span class="linenos">365</span></a>            <span class="p">],</span>
</span><span id="SpCompositionGraphValidator-366"><a href="#SpCompositionGraphValidator-366"><span class="linenos">366</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator-367"><a href="#SpCompositionGraphValidator-367"><span class="linenos">367</span></a>
</span><span id="SpCompositionGraphValidator-368"><a href="#SpCompositionGraphValidator-368"><span class="linenos">368</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator-369"><a href="#SpCompositionGraphValidator-369"><span class="linenos">369</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-370"><a href="#SpCompositionGraphValidator-370"><span class="linenos">370</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-371"><a href="#SpCompositionGraphValidator-371"><span class="linenos">371</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-372"><a href="#SpCompositionGraphValidator-372"><span class="linenos">372</span></a>
</span><span id="SpCompositionGraphValidator-373"><a href="#SpCompositionGraphValidator-373"><span class="linenos">373</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpCompositionGraphValidator-374"><a href="#SpCompositionGraphValidator-374"><span class="linenos">374</span></a>        <span class="n">df_description</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-375"><a href="#SpCompositionGraphValidator-375"><span class="linenos">375</span></a>        <span class="n">root_node</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="SpCompositionGraphValidator-376"><a href="#SpCompositionGraphValidator-376"><span class="linenos">376</span></a>        <span class="n">column_plural_simple_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">PluralColumn</span><span class="o">.</span><span class="n">COLUMN_PLURAL_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-377"><a href="#SpCompositionGraphValidator-377"><span class="linenos">377</span></a>        <span class="n">column_plural_complete_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">PluralColumn</span><span class="o">.</span><span class="n">COLUMN_PLURAL_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator-378"><a href="#SpCompositionGraphValidator-378"><span class="linenos">378</span></a>
</span><span id="SpCompositionGraphValidator-379"><a href="#SpCompositionGraphValidator-379"><span class="linenos">379</span></a>        <span class="c1"># Clean integer columns: df_description</span>
</span><span id="SpCompositionGraphValidator-380"><a href="#SpCompositionGraphValidator-380"><span class="linenos">380</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-381"><a href="#SpCompositionGraphValidator-381"><span class="linenos">381</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-382"><a href="#SpCompositionGraphValidator-382"><span class="linenos">382</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-383"><a href="#SpCompositionGraphValidator-383"><span class="linenos">383</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-384"><a href="#SpCompositionGraphValidator-384"><span class="linenos">384</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-385"><a href="#SpCompositionGraphValidator-385"><span class="linenos">385</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-386"><a href="#SpCompositionGraphValidator-386"><span class="linenos">386</span></a>        <span class="n">comparison_errors</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_composition</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-387"><a href="#SpCompositionGraphValidator-387"><span class="linenos">387</span></a>        <span class="k">if</span> <span class="n">comparison_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-388"><a href="#SpCompositionGraphValidator-388"><span class="linenos">388</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-389"><a href="#SpCompositionGraphValidator-389"><span class="linenos">389</span></a>
</span><span id="SpCompositionGraphValidator-390"><a href="#SpCompositionGraphValidator-390"><span class="linenos">390</span></a>        <span class="n">exists_cycle</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_cycles</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-391"><a href="#SpCompositionGraphValidator-391"><span class="linenos">391</span></a>        <span class="k">if</span> <span class="n">exists_cycle</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-392"><a href="#SpCompositionGraphValidator-392"><span class="linenos">392</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-393"><a href="#SpCompositionGraphValidator-393"><span class="linenos">393</span></a>
</span><span id="SpCompositionGraphValidator-394"><a href="#SpCompositionGraphValidator-394"><span class="linenos">394</span></a>        <span class="n">graphs_disconnected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_disconnected_components</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-395"><a href="#SpCompositionGraphValidator-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">graphs_disconnected</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-396"><a href="#SpCompositionGraphValidator-396"><span class="linenos">396</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-397"><a href="#SpCompositionGraphValidator-397"><span class="linenos">397</span></a>
</span><span id="SpCompositionGraphValidator-398"><a href="#SpCompositionGraphValidator-398"><span class="linenos">398</span></a>        <span class="c1"># Check if there is at least 1 parent node == 1, otherwise show error and request correction</span>
</span><span id="SpCompositionGraphValidator-399"><a href="#SpCompositionGraphValidator-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">has_node</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">):</span>
</span><span id="SpCompositionGraphValidator-400"><a href="#SpCompositionGraphValidator-400"><span class="linenos">400</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: N raiz &#39;</span><span class="si">{</span><span class="n">root_node</span><span class="si">}</span><span class="s2">&#39; no encontrado.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-401"><a href="#SpCompositionGraphValidator-401"><span class="linenos">401</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-402"><a href="#SpCompositionGraphValidator-402"><span class="linenos">402</span></a>
</span><span id="SpCompositionGraphValidator-403"><a href="#SpCompositionGraphValidator-403"><span class="linenos">403</span></a>        <span class="c1"># Convert the graph to a tree</span>
</span><span id="SpCompositionGraphValidator-404"><a href="#SpCompositionGraphValidator-404"><span class="linenos">404</span></a>        <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">convert_to_tree</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-405"><a href="#SpCompositionGraphValidator-405"><span class="linenos">405</span></a>
</span><span id="SpCompositionGraphValidator-406"><a href="#SpCompositionGraphValidator-406"><span class="linenos">406</span></a>        <span class="c1"># All children of root node (1)</span>
</span><span id="SpCompositionGraphValidator-407"><a href="#SpCompositionGraphValidator-407"><span class="linenos">407</span></a>        <span class="n">childs_root_node</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">root_node</span><span class="p">))</span>
</span><span id="SpCompositionGraphValidator-408"><a href="#SpCompositionGraphValidator-408"><span class="linenos">408</span></a>
</span><span id="SpCompositionGraphValidator-409"><a href="#SpCompositionGraphValidator-409"><span class="linenos">409</span></a>        <span class="c1"># For each child of 1, get the entire subtree below</span>
</span><span id="SpCompositionGraphValidator-410"><a href="#SpCompositionGraphValidator-410"><span class="linenos">410</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs_root_node</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-411"><a href="#SpCompositionGraphValidator-411"><span class="linenos">411</span></a>            <span class="c1"># Run a BFS from the child</span>
</span><span id="SpCompositionGraphValidator-412"><a href="#SpCompositionGraphValidator-412"><span class="linenos">412</span></a>            <span class="n">sub_tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">breadth_first_search_from_node</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-413"><a href="#SpCompositionGraphValidator-413"><span class="linenos">413</span></a>
</span><span id="SpCompositionGraphValidator-414"><a href="#SpCompositionGraphValidator-414"><span class="linenos">414</span></a>            <span class="c1"># Build a list with only node codes</span>
</span><span id="SpCompositionGraphValidator-415"><a href="#SpCompositionGraphValidator-415"><span class="linenos">415</span></a>            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sub_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
</span><span id="SpCompositionGraphValidator-416"><a href="#SpCompositionGraphValidator-416"><span class="linenos">416</span></a>
</span><span id="SpCompositionGraphValidator-417"><a href="#SpCompositionGraphValidator-417"><span class="linenos">417</span></a>            <span class="c1"># Search for a sub-dataframe from description with codes that are in the node list</span>
</span><span id="SpCompositionGraphValidator-418"><a href="#SpCompositionGraphValidator-418"><span class="linenos">418</span></a>            <span class="n">df_slice_description</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">nodes</span><span class="p">)]</span>
</span><span id="SpCompositionGraphValidator-419"><a href="#SpCompositionGraphValidator-419"><span class="linenos">419</span></a>
</span><span id="SpCompositionGraphValidator-420"><a href="#SpCompositionGraphValidator-420"><span class="linenos">420</span></a>            <span class="c1"># Check if the titles are unique</span>
</span><span id="SpCompositionGraphValidator-421"><a href="#SpCompositionGraphValidator-421"><span class="linenos">421</span></a>            <span class="n">warnings_i</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">check_dataframe_titles_uniques</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-422"><a href="#SpCompositionGraphValidator-422"><span class="linenos">422</span></a>                <span class="n">dataframe</span><span class="o">=</span><span class="n">df_slice_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-423"><a href="#SpCompositionGraphValidator-423"><span class="linenos">423</span></a>                <span class="n">column_one</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_simple_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-424"><a href="#SpCompositionGraphValidator-424"><span class="linenos">424</span></a>                <span class="n">column_two</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_complete_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-425"><a href="#SpCompositionGraphValidator-425"><span class="linenos">425</span></a>                <span class="n">plural_column_one</span><span class="o">=</span><span class="n">column_plural_simple_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-426"><a href="#SpCompositionGraphValidator-426"><span class="linenos">426</span></a>                <span class="n">plural_column_two</span><span class="o">=</span><span class="n">column_plural_complete_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-427"><a href="#SpCompositionGraphValidator-427"><span class="linenos">427</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-428"><a href="#SpCompositionGraphValidator-428"><span class="linenos">428</span></a>            <span class="c1"># Add prefix to warnings</span>
</span><span id="SpCompositionGraphValidator-429"><a href="#SpCompositionGraphValidator-429"><span class="linenos">429</span></a>            <span class="n">warnings_i</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">warning</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">warnings_i</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator-430"><a href="#SpCompositionGraphValidator-430"><span class="linenos">430</span></a>
</span><span id="SpCompositionGraphValidator-431"><a href="#SpCompositionGraphValidator-431"><span class="linenos">431</span></a>            <span class="c1"># Add to main warnings list</span>
</span><span id="SpCompositionGraphValidator-432"><a href="#SpCompositionGraphValidator-432"><span class="linenos">432</span></a>            <span class="n">warnings</span> <span class="o">+=</span> <span class="n">warnings_i</span>
</span><span id="SpCompositionGraphValidator-433"><a href="#SpCompositionGraphValidator-433"><span class="linenos">433</span></a>
</span><span id="SpCompositionGraphValidator-434"><a href="#SpCompositionGraphValidator-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-435"><a href="#SpCompositionGraphValidator-435"><span class="linenos">435</span></a>
</span><span id="SpCompositionGraphValidator-436"><a href="#SpCompositionGraphValidator-436"><span class="linenos">436</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_associated_indicators_leafs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator-437"><a href="#SpCompositionGraphValidator-437"><span class="linenos">437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-438"><a href="#SpCompositionGraphValidator-438"><span class="linenos">438</span></a><span class="sd">        Validate that leaf indicators have associated data in value and proportionality.</span>
</span><span id="SpCompositionGraphValidator-439"><a href="#SpCompositionGraphValidator-439"><span class="linenos">439</span></a>
</span><span id="SpCompositionGraphValidator-440"><a href="#SpCompositionGraphValidator-440"><span class="linenos">440</span></a><span class="sd">        Checks that all leaf nodes (indicators with no children) have corresponding</span>
</span><span id="SpCompositionGraphValidator-441"><a href="#SpCompositionGraphValidator-441"><span class="linenos">441</span></a><span class="sd">        data entries in the value spreadsheet and optionally in the proportionality</span>
</span><span id="SpCompositionGraphValidator-442"><a href="#SpCompositionGraphValidator-442"><span class="linenos">442</span></a><span class="sd">        spreadsheet if it exists.</span>
</span><span id="SpCompositionGraphValidator-443"><a href="#SpCompositionGraphValidator-443"><span class="linenos">443</span></a>
</span><span id="SpCompositionGraphValidator-444"><a href="#SpCompositionGraphValidator-444"><span class="linenos">444</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator-445"><a href="#SpCompositionGraphValidator-445"><span class="linenos">445</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator-446"><a href="#SpCompositionGraphValidator-446"><span class="linenos">446</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator-447"><a href="#SpCompositionGraphValidator-447"><span class="linenos">447</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator-448"><a href="#SpCompositionGraphValidator-448"><span class="linenos">448</span></a><span class="sd">                - List[str]: Error messages for leaf indicators without associated data</span>
</span><span id="SpCompositionGraphValidator-449"><a href="#SpCompositionGraphValidator-449"><span class="linenos">449</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionGraphValidator-450"><a href="#SpCompositionGraphValidator-450"><span class="linenos">450</span></a>
</span><span id="SpCompositionGraphValidator-451"><a href="#SpCompositionGraphValidator-451"><span class="linenos">451</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator-452"><a href="#SpCompositionGraphValidator-452"><span class="linenos">452</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator-453"><a href="#SpCompositionGraphValidator-453"><span class="linenos">453</span></a><span class="sd">        - This validation is skipped if the value dataframe is empty</span>
</span><span id="SpCompositionGraphValidator-454"><a href="#SpCompositionGraphValidator-454"><span class="linenos">454</span></a><span class="sd">        - Proportionality validation is only performed if that model is available</span>
</span><span id="SpCompositionGraphValidator-455"><a href="#SpCompositionGraphValidator-455"><span class="linenos">455</span></a><span class="sd">        - Leaf nodes are determined from the composition graph structure</span>
</span><span id="SpCompositionGraphValidator-456"><a href="#SpCompositionGraphValidator-456"><span class="linenos">456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-457"><a href="#SpCompositionGraphValidator-457"><span class="linenos">457</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-458"><a href="#SpCompositionGraphValidator-458"><span class="linenos">458</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator-459"><a href="#SpCompositionGraphValidator-459"><span class="linenos">459</span></a>
</span><span id="SpCompositionGraphValidator-460"><a href="#SpCompositionGraphValidator-460"><span class="linenos">460</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-461"><a href="#SpCompositionGraphValidator-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator-462"><a href="#SpCompositionGraphValidator-462"><span class="linenos">462</span></a>                <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-463"><a href="#SpCompositionGraphValidator-463"><span class="linenos">463</span></a>                    <span class="p">(</span>
</span><span id="SpCompositionGraphValidator-464"><a href="#SpCompositionGraphValidator-464"><span class="linenos">464</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_associated_indicators_leafs</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-465"><a href="#SpCompositionGraphValidator-465"><span class="linenos">465</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEAF_NO_DATA</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator-466"><a href="#SpCompositionGraphValidator-466"><span class="linenos">466</span></a>                    <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-467"><a href="#SpCompositionGraphValidator-467"><span class="linenos">467</span></a>                <span class="p">]</span>
</span><span id="SpCompositionGraphValidator-468"><a href="#SpCompositionGraphValidator-468"><span class="linenos">468</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator-469"><a href="#SpCompositionGraphValidator-469"><span class="linenos">469</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-470"><a href="#SpCompositionGraphValidator-470"><span class="linenos">470</span></a>
</span><span id="SpCompositionGraphValidator-471"><a href="#SpCompositionGraphValidator-471"><span class="linenos">471</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator-472"><a href="#SpCompositionGraphValidator-472"><span class="linenos">472</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator-473"><a href="#SpCompositionGraphValidator-473"><span class="linenos">473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-474"><a href="#SpCompositionGraphValidator-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator-475"><a href="#SpCompositionGraphValidator-475"><span class="linenos">475</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator-476"><a href="#SpCompositionGraphValidator-476"><span class="linenos">476</span></a>
</span><span id="SpCompositionGraphValidator-477"><a href="#SpCompositionGraphValidator-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">read_success</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-478"><a href="#SpCompositionGraphValidator-478"><span class="linenos">478</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpProportionality</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator-479"><a href="#SpCompositionGraphValidator-479"><span class="linenos">479</span></a>
</span><span id="SpCompositionGraphValidator-480"><a href="#SpCompositionGraphValidator-480"><span class="linenos">480</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-481"><a href="#SpCompositionGraphValidator-481"><span class="linenos">481</span></a>
</span><span id="SpCompositionGraphValidator-482"><a href="#SpCompositionGraphValidator-482"><span class="linenos">482</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-483"><a href="#SpCompositionGraphValidator-483"><span class="linenos">483</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-484"><a href="#SpCompositionGraphValidator-484"><span class="linenos">484</span></a>
</span><span id="SpCompositionGraphValidator-485"><a href="#SpCompositionGraphValidator-485"><span class="linenos">485</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpCompositionGraphValidator-486"><a href="#SpCompositionGraphValidator-486"><span class="linenos">486</span></a>        <span class="n">df_value</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-487"><a href="#SpCompositionGraphValidator-487"><span class="linenos">487</span></a>        <span class="n">df_proportionality</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-488"><a href="#SpCompositionGraphValidator-488"><span class="linenos">488</span></a>
</span><span id="SpCompositionGraphValidator-489"><a href="#SpCompositionGraphValidator-489"><span class="linenos">489</span></a>        <span class="n">leafs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">get_leaf_nodes</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-490"><a href="#SpCompositionGraphValidator-490"><span class="linenos">490</span></a>
</span><span id="SpCompositionGraphValidator-491"><a href="#SpCompositionGraphValidator-491"><span class="linenos">491</span></a>        <span class="c1"># Validation for values</span>
</span><span id="SpCompositionGraphValidator-492"><a href="#SpCompositionGraphValidator-492"><span class="linenos">492</span></a>        <span class="n">codes_values</span> <span class="o">=</span> <span class="n">df_value</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-493"><a href="#SpCompositionGraphValidator-493"><span class="linenos">493</span></a>        <span class="n">codes_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes_values</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator-494"><a href="#SpCompositionGraphValidator-494"><span class="linenos">494</span></a>        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leafs</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-495"><a href="#SpCompositionGraphValidator-495"><span class="linenos">495</span></a>            <span class="k">if</span> <span class="n">leaf</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">codes_values</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-496"><a href="#SpCompositionGraphValidator-496"><span class="linenos">496</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="si">}</span><span class="s2">: Indicador folha &#39;</span><span class="si">{</span><span class="n">leaf</span><span class="si">}</span><span class="s2">&#39; no possui dados associados.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-497"><a href="#SpCompositionGraphValidator-497"><span class="linenos">497</span></a>
</span><span id="SpCompositionGraphValidator-498"><a href="#SpCompositionGraphValidator-498"><span class="linenos">498</span></a>        <span class="c1"># Validation for proportionality (if available)</span>
</span><span id="SpCompositionGraphValidator-499"><a href="#SpCompositionGraphValidator-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-500"><a href="#SpCompositionGraphValidator-500"><span class="linenos">500</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator-501"><a href="#SpCompositionGraphValidator-501"><span class="linenos">501</span></a>
</span><span id="SpCompositionGraphValidator-502"><a href="#SpCompositionGraphValidator-502"><span class="linenos">502</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span> <span class="ow">in</span> <span class="n">level_two_columns</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-503"><a href="#SpCompositionGraphValidator-503"><span class="linenos">503</span></a>                <span class="n">level_two_columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-504"><a href="#SpCompositionGraphValidator-504"><span class="linenos">504</span></a>
</span><span id="SpCompositionGraphValidator-505"><a href="#SpCompositionGraphValidator-505"><span class="linenos">505</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpCompositionGraphValidator-506"><a href="#SpCompositionGraphValidator-506"><span class="linenos">506</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpCompositionGraphValidator-507"><a href="#SpCompositionGraphValidator-507"><span class="linenos">507</span></a>
</span><span id="SpCompositionGraphValidator-508"><a href="#SpCompositionGraphValidator-508"><span class="linenos">508</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator-509"><a href="#SpCompositionGraphValidator-509"><span class="linenos">509</span></a>            <span class="n">all_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">level_two_columns</span><span class="p">))</span>
</span><span id="SpCompositionGraphValidator-510"><a href="#SpCompositionGraphValidator-510"><span class="linenos">510</span></a>
</span><span id="SpCompositionGraphValidator-511"><a href="#SpCompositionGraphValidator-511"><span class="linenos">511</span></a>            <span class="c1"># Check if all leaf codes are present in level_one_columns</span>
</span><span id="SpCompositionGraphValidator-512"><a href="#SpCompositionGraphValidator-512"><span class="linenos">512</span></a>            <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leafs</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-513"><a href="#SpCompositionGraphValidator-513"><span class="linenos">513</span></a>                <span class="k">if</span> <span class="n">leaf</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_columns</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-514"><a href="#SpCompositionGraphValidator-514"><span class="linenos">514</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: Indicador folha &#39;</span><span class="si">{</span><span class="n">leaf</span><span class="si">}</span><span class="s2">&#39; no possui dados associados.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-515"><a href="#SpCompositionGraphValidator-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator-516"><a href="#SpCompositionGraphValidator-516"><span class="linenos">516</span></a>
</span><span id="SpCompositionGraphValidator-517"><a href="#SpCompositionGraphValidator-517"><span class="linenos">517</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator-518"><a href="#SpCompositionGraphValidator-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-519"><a href="#SpCompositionGraphValidator-519"><span class="linenos">519</span></a><span class="sd">        Execute all graph-based composition validations.</span>
</span><span id="SpCompositionGraphValidator-520"><a href="#SpCompositionGraphValidator-520"><span class="linenos">520</span></a>
</span><span id="SpCompositionGraphValidator-521"><a href="#SpCompositionGraphValidator-521"><span class="linenos">521</span></a><span class="sd">        Orchestrates the execution of all composition validators using graph analysis,</span>
</span><span id="SpCompositionGraphValidator-522"><a href="#SpCompositionGraphValidator-522"><span class="linenos">522</span></a><span class="sd">        including indicator relationships, hierarchy validation, title uniqueness,</span>
</span><span id="SpCompositionGraphValidator-523"><a href="#SpCompositionGraphValidator-523"><span class="linenos">523</span></a><span class="sd">        and leaf data associations.</span>
</span><span id="SpCompositionGraphValidator-524"><a href="#SpCompositionGraphValidator-524"><span class="linenos">524</span></a>
</span><span id="SpCompositionGraphValidator-525"><a href="#SpCompositionGraphValidator-525"><span class="linenos">525</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator-526"><a href="#SpCompositionGraphValidator-526"><span class="linenos">526</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator-527"><a href="#SpCompositionGraphValidator-527"><span class="linenos">527</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator-528"><a href="#SpCompositionGraphValidator-528"><span class="linenos">528</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator-529"><a href="#SpCompositionGraphValidator-529"><span class="linenos">529</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpCompositionGraphValidator-530"><a href="#SpCompositionGraphValidator-530"><span class="linenos">530</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpCompositionGraphValidator-531"><a href="#SpCompositionGraphValidator-531"><span class="linenos">531</span></a>
</span><span id="SpCompositionGraphValidator-532"><a href="#SpCompositionGraphValidator-532"><span class="linenos">532</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator-533"><a href="#SpCompositionGraphValidator-533"><span class="linenos">533</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator-534"><a href="#SpCompositionGraphValidator-534"><span class="linenos">534</span></a><span class="sd">        All validations are skipped if the composition dataframe is empty.</span>
</span><span id="SpCompositionGraphValidator-535"><a href="#SpCompositionGraphValidator-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator-536"><a href="#SpCompositionGraphValidator-536"><span class="linenos">536</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator-537"><a href="#SpCompositionGraphValidator-537"><span class="linenos">537</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_composition</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator-538"><a href="#SpCompositionGraphValidator-538"><span class="linenos">538</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relations_hierarchy_with_graph</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator-539"><a href="#SpCompositionGraphValidator-539"><span class="linenos">539</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_titles_with_graph</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UT</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator-540"><a href="#SpCompositionGraphValidator-540"><span class="linenos">540</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_associated_indicators_leafs</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEAF_NO_DATA</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator-541"><a href="#SpCompositionGraphValidator-541"><span class="linenos">541</span></a>        <span class="p">]</span>
</span><span id="SpCompositionGraphValidator-542"><a href="#SpCompositionGraphValidator-542"><span class="linenos">542</span></a>
</span><span id="SpCompositionGraphValidator-543"><a href="#SpCompositionGraphValidator-543"><span class="linenos">543</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator-544"><a href="#SpCompositionGraphValidator-544"><span class="linenos">544</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-545"><a href="#SpCompositionGraphValidator-545"><span class="linenos">545</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpCompositionGraphValidator-546"><a href="#SpCompositionGraphValidator-546"><span class="linenos">546</span></a>
</span><span id="SpCompositionGraphValidator-547"><a href="#SpCompositionGraphValidator-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator-548"><a href="#SpCompositionGraphValidator-548"><span class="linenos">548</span></a>
</span><span id="SpCompositionGraphValidator-549"><a href="#SpCompositionGraphValidator-549"><span class="linenos">549</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates composition structures using graph-based analysis.</p>

<p>This validator uses graph theory to analyze composition hierarchies, detecting
cycles, disconnected components, unique title constraints, and data associations
for leaf indicators.</p>

<h2 id="attributes">Attributes</h2>

<p>model_sp_composition : SpComposition
    Composition model instance containing parent-child relationships.
model_sp_description : SpDescription | SpModelABC
    Description model instance containing indicator metadata.
model_sp_value : SpValue
    Value model instance containing indicator data.
model_sp_proportionality : SpProportionality
    Proportionality model instance containing indicator proportions.
sp_name_composition : str
    Composition spreadsheet filename.
sp_name_description : str
    Description spreadsheet filename.
sp_name_value : str
    Value spreadsheet filename.
sp_name_proportionality : str
    Proportionality spreadsheet filename.
column_name_parent : str
    Parent code column name.
column_name_child : str
    Child code column name.
column_name_code : str
    Indicator code column name.
column_name_simple_name : str
    Simple name column name.
column_name_complete_name : str
    Complete name column name.
column_name_id : str
    ID column name.
global_required_columns : Dict[str, List[str]]
    Required columns mapping for validation.
model_dataframes : Dict[str, DataFrame]
    DataFrames mapping for each model.
graph_processing : GraphProcessing | None
    Graph processing utility for analysis.</p>
</div>


                            <div id="SpCompositionGraphValidator.__init__" class="classattr">
                                        <input id="SpCompositionGraphValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpCompositionGraphValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpCompositionGraphValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionGraphValidator.__init__-78"><a href="#SpCompositionGraphValidator.__init__-78"><span class="linenos"> 78</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.__init__-79"><a href="#SpCompositionGraphValidator.__init__-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.__init__-80"><a href="#SpCompositionGraphValidator.__init__-80"><span class="linenos"> 80</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.__init__-81"><a href="#SpCompositionGraphValidator.__init__-81"><span class="linenos"> 81</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.__init__-82"><a href="#SpCompositionGraphValidator.__init__-82"><span class="linenos"> 82</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator.__init__-83"><a href="#SpCompositionGraphValidator.__init__-83"><span class="linenos"> 83</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.__init__-84"><a href="#SpCompositionGraphValidator.__init__-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-85"><a href="#SpCompositionGraphValidator.__init__-85"><span class="linenos"> 85</span></a><span class="sd">        Initialize the graph validator with required context and models.</span>
</span><span id="SpCompositionGraphValidator.__init__-86"><a href="#SpCompositionGraphValidator.__init__-86"><span class="linenos"> 86</span></a>
</span><span id="SpCompositionGraphValidator.__init__-87"><a href="#SpCompositionGraphValidator.__init__-87"><span class="linenos"> 87</span></a><span class="sd">        Args</span>
</span><span id="SpCompositionGraphValidator.__init__-88"><a href="#SpCompositionGraphValidator.__init__-88"><span class="linenos"> 88</span></a><span class="sd">        ----</span>
</span><span id="SpCompositionGraphValidator.__init__-89"><a href="#SpCompositionGraphValidator.__init__-89"><span class="linenos"> 89</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpCompositionGraphValidator.__init__-90"><a href="#SpCompositionGraphValidator.__init__-90"><span class="linenos"> 90</span></a><span class="sd">            Context containing all data models and configuration.</span>
</span><span id="SpCompositionGraphValidator.__init__-91"><a href="#SpCompositionGraphValidator.__init__-91"><span class="linenos"> 91</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpCompositionGraphValidator.__init__-92"><a href="#SpCompositionGraphValidator.__init__-92"><span class="linenos"> 92</span></a><span class="sd">            Report list for validation results aggregation.</span>
</span><span id="SpCompositionGraphValidator.__init__-93"><a href="#SpCompositionGraphValidator.__init__-93"><span class="linenos"> 93</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpCompositionGraphValidator.__init__-94"><a href="#SpCompositionGraphValidator.__init__-94"><span class="linenos"> 94</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpCompositionGraphValidator.__init__-95"><a href="#SpCompositionGraphValidator.__init__-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-96"><a href="#SpCompositionGraphValidator.__init__-96"><span class="linenos"> 96</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.__init__-97"><a href="#SpCompositionGraphValidator.__init__-97"><span class="linenos"> 97</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.__init__-98"><a href="#SpCompositionGraphValidator.__init__-98"><span class="linenos"> 98</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.__init__-99"><a href="#SpCompositionGraphValidator.__init__-99"><span class="linenos"> 99</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpComposition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.__init__-100"><a href="#SpCompositionGraphValidator.__init__-100"><span class="linenos">100</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.__init__-101"><a href="#SpCompositionGraphValidator.__init__-101"><span class="linenos">101</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.__init__-102"><a href="#SpCompositionGraphValidator.__init__-102"><span class="linenos">102</span></a>
</span><span id="SpCompositionGraphValidator.__init__-103"><a href="#SpCompositionGraphValidator.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpCompositionGraphValidator.__init__-104"><a href="#SpCompositionGraphValidator.__init__-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="p">:</span> <span class="n">SpDescription</span> <span class="o">|</span> <span class="n">SpModelABC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.__init__-105"><a href="#SpCompositionGraphValidator.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpValue</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.__init__-106"><a href="#SpCompositionGraphValidator.__init__-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpProportionality</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.__init__-107"><a href="#SpCompositionGraphValidator.__init__-107"><span class="linenos">107</span></a>
</span><span id="SpCompositionGraphValidator.__init__-108"><a href="#SpCompositionGraphValidator.__init__-108"><span class="linenos">108</span></a>        <span class="c1"># Initialize attributes</span>
</span><span id="SpCompositionGraphValidator.__init__-109"><a href="#SpCompositionGraphValidator.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-110"><a href="#SpCompositionGraphValidator.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-111"><a href="#SpCompositionGraphValidator.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-112"><a href="#SpCompositionGraphValidator.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-113"><a href="#SpCompositionGraphValidator.__init__-113"><span class="linenos">113</span></a>
</span><span id="SpCompositionGraphValidator.__init__-114"><a href="#SpCompositionGraphValidator.__init__-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-115"><a href="#SpCompositionGraphValidator.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-116"><a href="#SpCompositionGraphValidator.__init__-116"><span class="linenos">116</span></a>
</span><span id="SpCompositionGraphValidator.__init__-117"><a href="#SpCompositionGraphValidator.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-118"><a href="#SpCompositionGraphValidator.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_simple_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-119"><a href="#SpCompositionGraphValidator.__init__-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_complete_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-120"><a href="#SpCompositionGraphValidator.__init__-120"><span class="linenos">120</span></a>
</span><span id="SpCompositionGraphValidator.__init__-121"><a href="#SpCompositionGraphValidator.__init__-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.__init__-122"><a href="#SpCompositionGraphValidator.__init__-122"><span class="linenos">122</span></a>
</span><span id="SpCompositionGraphValidator.__init__-123"><a href="#SpCompositionGraphValidator.__init__-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionGraphValidator.__init__-124"><a href="#SpCompositionGraphValidator.__init__-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpCompositionGraphValidator.__init__-125"><a href="#SpCompositionGraphValidator.__init__-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="p">:</span> <span class="n">GraphProcessing</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SpCompositionGraphValidator.__init__-126"><a href="#SpCompositionGraphValidator.__init__-126"><span class="linenos">126</span></a>
</span><span id="SpCompositionGraphValidator.__init__-127"><a href="#SpCompositionGraphValidator.__init__-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.__init__-128"><a href="#SpCompositionGraphValidator.__init__-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the graph validator with required context and models.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all data models and configuration.
report_list : ModelListReport
    Report list for validation results aggregation.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpCompositionGraphValidator.model_sp_composition" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_composition</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.model_sp_composition"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.model_sp_description" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_description</span><span class="annotation">: <a href="models.html#SpDescription">data_validate.models.SpDescription</a> | <a href="models.html#SpModelABC">data_validate.models.SpModelABC</a></span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.model_sp_description"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.model_sp_value" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_value</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.model_sp_value"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.model_sp_proportionality" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_proportionality</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.model_sp_proportionality"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.sp_name_composition" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_composition</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.sp_name_composition"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.sp_name_description" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_description</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.sp_name_description"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.sp_name_value" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_value</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.sp_name_value"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.sp_name_proportionality" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_proportionality</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.sp_name_proportionality"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.column_name_parent" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_parent</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.column_name_parent"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.column_name_child" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_child</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.column_name_child"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.column_name_code" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_code</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.column_name_code"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.column_name_simple_name" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_simple_name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.column_name_simple_name"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.column_name_complete_name" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_complete_name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.column_name_complete_name"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.column_name_id" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_id</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.column_name_id"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.global_required_columns" class="classattr">
                                <div class="attr variable">
            <span class="name">global_required_columns</span><span class="annotation">: Dict[str, List[str]]</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.global_required_columns"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.model_dataframes" class="classattr">
                                <div class="attr variable">
            <span class="name">model_dataframes</span><span class="annotation">: Dict[str, pandas.DataFrame]</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.model_dataframes"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.graph_processing" class="classattr">
                                <div class="attr variable">
            <span class="name">graph_processing</span><span class="annotation">: <a href="helpers/common/validation/graph_processing.html#GraphProcessing">data_validate.helpers.common.validation.graph_processing.GraphProcessing</a> | None</span>

        
    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.graph_processing"></a>
    
    

                            </div>
                            <div id="SpCompositionGraphValidator.validate_relation_indicators_in_composition" class="classattr">
                                        <input id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_relation_indicators_in_composition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionGraphValidator.validate_relation_indicators_in_composition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-205"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_composition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-206"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-207"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-207"><span class="linenos">207</span></a><span class="sd">        Validate that all indicators in composition exist in description.</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-208"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-208"><span class="linenos">208</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-209"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-209"><span class="linenos">209</span></a><span class="sd">        Ensures that every parent and child code referenced in the composition</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-210"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-210"><span class="linenos">210</span></a><span class="sd">        spreadsheet has a corresponding entry in the description spreadsheet.</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-211"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-211"><span class="linenos">211</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-212"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-212"><span class="linenos">212</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-213"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-213"><span class="linenos">213</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-214"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-214"><span class="linenos">214</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-215"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-215"><span class="linenos">215</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-216"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-216"><span class="linenos">216</span></a><span class="sd">                - List[str]: Error messages for codes not found in description</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-217"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-217"><span class="linenos">217</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-218"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-218"><span class="linenos">218</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-219"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-219"><span class="linenos">219</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-220"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-220"><span class="linenos">220</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-221"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-221"><span class="linenos">221</span></a><span class="sd">        This validation is skipped if the description dataframe is empty.</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-222"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-223"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-223"><span class="linenos">223</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-224"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-224"><span class="linenos">224</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-225"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-225"><span class="linenos">225</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-226"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-227"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-227"><span class="linenos">227</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-228"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-228"><span class="linenos">228</span></a>                <span class="p">[</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-229"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-229"><span class="linenos">229</span></a>                    <span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-230"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-230"><span class="linenos">230</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-231"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-231"><span class="linenos">231</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-232"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-232"><span class="linenos">232</span></a>                    <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-233"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-233"><span class="linenos">233</span></a>                <span class="p">]</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-234"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-234"><span class="linenos">234</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-235"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-235"><span class="linenos">235</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-236"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-236"><span class="linenos">236</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-237"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-237"><span class="linenos">237</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-238"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-238"><span class="linenos">238</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-239"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-239"><span class="linenos">239</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-240"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-240"><span class="linenos">240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-241"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-241"><span class="linenos">241</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-242"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-242"><span class="linenos">242</span></a>            <span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-243"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-243"><span class="linenos">243</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-244"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-244"><span class="linenos">244</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-245"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-245"><span class="linenos">245</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-246"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-246"><span class="linenos">246</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-247"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-248"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-248"><span class="linenos">248</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-249"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-249"><span class="linenos">249</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-250"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-250"><span class="linenos">250</span></a>        <span class="c1"># Extract valid description codes</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-251"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-251"><span class="linenos">251</span></a>        <span class="n">list_codes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-252"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-252"><span class="linenos">252</span></a>        <span class="n">valid_description_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span><span class="n">id_values_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_codes</span><span class="p">)))</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-253"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-253"><span class="linenos">253</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-254"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-254"><span class="linenos">254</span></a>        <span class="c1"># Extract valid composition parent</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-255"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-255"><span class="linenos">255</span></a>        <span class="n">list_parents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-256"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-256"><span class="linenos">256</span></a>        <span class="n">valid_compositions_parent_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span><span class="n">id_values_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_parents</span><span class="p">)))</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-257"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-257"><span class="linenos">257</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-258"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-258"><span class="linenos">258</span></a>        <span class="c1"># Extract valid composition child codes</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-259"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-259"><span class="linenos">259</span></a>        <span class="n">list_childs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-260"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-260"><span class="linenos">260</span></a>        <span class="n">valid_compositions_childs_codes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">extract_numeric_integer_ids_from_list</span><span class="p">(</span><span class="n">id_values_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_childs</span><span class="p">)))</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-261"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-261"><span class="linenos">261</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-262"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-262"><span class="linenos">262</span></a>        <span class="c1"># Compare codes between description and values</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-263"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-263"><span class="linenos">263</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-264"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-264"><span class="linenos">264</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">valid_description_codes</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-265"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-265"><span class="linenos">265</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-266"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-266"><span class="linenos">266</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">valid_compositions_parent_codes</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">valid_compositions_childs_codes</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-267"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-267"><span class="linenos">267</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-268"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-268"><span class="linenos">268</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-269"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-269"><span class="linenos">269</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-270"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-270"><span class="linenos">270</span></a>
</span><span id="SpCompositionGraphValidator.validate_relation_indicators_in_composition-271"><a href="#SpCompositionGraphValidator.validate_relation_indicators_in_composition-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate that all indicators in composition exist in description.</p>

<p>Ensures that every parent and child code referenced in the composition
spreadsheet has a corresponding entry in the description spreadsheet.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for codes not found in description
        - List[str]: Warning messages (currently empty)</p>

<h2 id="notes">Notes</h2>

<p>This validation is skipped if the description dataframe is empty.</p>
</div>


                            </div>
                            <div id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph" class="classattr">
                                        <input id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_relations_hierarchy_with_graph</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-273"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-273"><span class="linenos">273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relations_hierarchy_with_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-274"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-275"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-275"><span class="linenos">275</span></a><span class="sd">        Detect cycles and disconnected components in the composition graph structure.</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-276"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-276"><span class="linenos">276</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-277"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-277"><span class="linenos">277</span></a><span class="sd">        Uses graph analysis to identify circular dependencies in parent-child</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-278"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-278"><span class="linenos">278</span></a><span class="sd">        relationships and disconnected indicator subgraphs, which would create</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-279"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-279"><span class="linenos">279</span></a><span class="sd">        invalid hierarchical structures.</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-280"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-280"><span class="linenos">280</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-281"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-281"><span class="linenos">281</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-282"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-282"><span class="linenos">282</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-283"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-283"><span class="linenos">283</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-284"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-284"><span class="linenos">284</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-285"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-285"><span class="linenos">285</span></a><span class="sd">                - List[str]: Error messages for detected cycles and disconnected components</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-286"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-286"><span class="linenos">286</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-287"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-287"><span class="linenos">287</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-288"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-288"><span class="linenos">288</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-289"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-289"><span class="linenos">289</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-290"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-290"><span class="linenos">290</span></a><span class="sd">        - Cycles are formatted to show the complete path of the circular dependency</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-291"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-291"><span class="linenos">291</span></a><span class="sd">        - Disconnected components indicate isolated indicator groups not connected to main tree</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-292"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-293"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-293"><span class="linenos">293</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-294"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-294"><span class="linenos">294</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-295"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-295"><span class="linenos">295</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-296"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-296"><span class="linenos">296</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-297"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-297"><span class="linenos">297</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-298"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-298"><span class="linenos">298</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-299"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-299"><span class="linenos">299</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-300"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-300"><span class="linenos">300</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-301"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-301"><span class="linenos">301</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-302"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-302"><span class="linenos">302</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-303"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-303"><span class="linenos">303</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-304"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-304"><span class="linenos">304</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-305"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-305"><span class="linenos">305</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-306"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-306"><span class="linenos">306</span></a>        <span class="n">exists_cycle</span><span class="p">,</span> <span class="n">cycle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_cycles</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-307"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="n">exists_cycle</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-308"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-308"><span class="linenos">308</span></a>            <span class="n">text_cycles</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-309"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-309"><span class="linenos">309</span></a>            <span class="k">for</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">cycle</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-310"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-310"><span class="linenos">310</span></a>                <span class="n">text_cycles</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-311"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-311"><span class="linenos">311</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Ciclo encontrado: [</span><span class="si">{</span><span class="n">text_cycles</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-312"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-312"><span class="linenos">312</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-313"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-313"><span class="linenos">313</span></a>        <span class="n">graphs_disconnected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_disconnected_components</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-314"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="n">graphs_disconnected</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-315"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-315"><span class="linenos">315</span></a>            <span class="n">list_graphs_disconnected</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-316"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-316"><span class="linenos">316</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grafo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">graphs_disconnected</span><span class="p">):</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-317"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-317"><span class="linenos">317</span></a>                <span class="n">text_disconnected</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">generate_graph_report</span><span class="p">(</span><span class="n">grafo</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-318"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-318"><span class="linenos">318</span></a>                <span class="n">list_graphs_disconnected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_disconnected</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-319"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-319"><span class="linenos">319</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: Indicadores desconectados encontrados: &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">list_graphs_disconnected</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-320"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-320"><span class="linenos">320</span></a>
</span><span id="SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-321"><a href="#SpCompositionGraphValidator.validate_relations_hierarchy_with_graph-321"><span class="linenos">321</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Detect cycles and disconnected components in the composition graph structure.</p>

<p>Uses graph analysis to identify circular dependencies in parent-child
relationships and disconnected indicator subgraphs, which would create
invalid hierarchical structures.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for detected cycles and disconnected components
        - List[str]: Warning messages (currently empty)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Cycles are formatted to show the complete path of the circular dependency</li>
<li>Disconnected components indicate isolated indicator groups not connected to main tree</li>
</ul>
</div>


                            </div>
                            <div id="SpCompositionGraphValidator.validate_unique_titles_with_graph" class="classattr">
                                        <input id="SpCompositionGraphValidator.validate_unique_titles_with_graph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_unique_titles_with_graph</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionGraphValidator.validate_unique_titles_with_graph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.validate_unique_titles_with_graph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-323"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-323"><span class="linenos">323</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_titles_with_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-324"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-324"><span class="linenos">324</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-325"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-325"><span class="linenos">325</span></a><span class="sd">        Validate uniqueness of indicator titles using graph analysis.</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-326"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-326"><span class="linenos">326</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-327"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-327"><span class="linenos">327</span></a><span class="sd">        Checks that simple names and complete names are unique within each subtree</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-328"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-328"><span class="linenos">328</span></a><span class="sd">        of the indicator hierarchy, using graph structure to determine sibling</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-329"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-329"><span class="linenos">329</span></a><span class="sd">        relationships. Validates by traversing from root node through all subtrees.</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-330"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-330"><span class="linenos">330</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-331"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-331"><span class="linenos">331</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-332"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-332"><span class="linenos">332</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-333"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-333"><span class="linenos">333</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-334"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-334"><span class="linenos">334</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-335"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-335"><span class="linenos">335</span></a><span class="sd">                - List[str]: Empty list (no errors for title uniqueness issues)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-336"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-336"><span class="linenos">336</span></a><span class="sd">                - List[str]: Warning messages for duplicate titles within same subtree</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-337"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-337"><span class="linenos">337</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-338"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-338"><span class="linenos">338</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-339"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-339"><span class="linenos">339</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-340"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-340"><span class="linenos">340</span></a><span class="sd">        - This validation is skipped if the description dataframe is empty</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-341"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-341"><span class="linenos">341</span></a><span class="sd">        - Requires a valid tree structure without cycles or disconnected components</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-342"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-342"><span class="linenos">342</span></a><span class="sd">        - Root node must exist in the composition graph</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-343"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-343"><span class="linenos">343</span></a><span class="sd">        - Titles are checked within each subtree independently</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-344"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-345"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-345"><span class="linenos">345</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-346"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-346"><span class="linenos">346</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-347"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-347"><span class="linenos">347</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-348"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-349"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-349"><span class="linenos">349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-350"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-350"><span class="linenos">350</span></a>                <span class="p">[</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-351"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-351"><span class="linenos">351</span></a>                    <span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-352"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-352"><span class="linenos">352</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_titles_with_graph</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-353"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-353"><span class="linenos">353</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UT</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-354"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-354"><span class="linenos">354</span></a>                    <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-355"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-355"><span class="linenos">355</span></a>                <span class="p">]</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-356"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-356"><span class="linenos">356</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-357"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-357"><span class="linenos">357</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-358"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-358"><span class="linenos">358</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-359"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-359"><span class="linenos">359</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-360"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-360"><span class="linenos">360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-361"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-362"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-362"><span class="linenos">362</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-363"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-363"><span class="linenos">363</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-364"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-364"><span class="linenos">364</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-365"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-365"><span class="linenos">365</span></a>            <span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-366"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-366"><span class="linenos">366</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-367"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-367"><span class="linenos">367</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-368"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-368"><span class="linenos">368</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-369"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-369"><span class="linenos">369</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-370"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-370"><span class="linenos">370</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-371"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-371"><span class="linenos">371</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-372"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-372"><span class="linenos">372</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-373"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-373"><span class="linenos">373</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-374"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-374"><span class="linenos">374</span></a>        <span class="n">df_description</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-375"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-375"><span class="linenos">375</span></a>        <span class="n">root_node</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-376"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-376"><span class="linenos">376</span></a>        <span class="n">column_plural_simple_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">PluralColumn</span><span class="o">.</span><span class="n">COLUMN_PLURAL_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-377"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-377"><span class="linenos">377</span></a>        <span class="n">column_plural_complete_name</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">PluralColumn</span><span class="o">.</span><span class="n">COLUMN_PLURAL_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-378"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-378"><span class="linenos">378</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-379"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-379"><span class="linenos">379</span></a>        <span class="c1"># Clean integer columns: df_description</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-380"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-380"><span class="linenos">380</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-381"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-381"><span class="linenos">381</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-382"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-382"><span class="linenos">382</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-383"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-383"><span class="linenos">383</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-384"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-384"><span class="linenos">384</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-385"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-385"><span class="linenos">385</span></a>        <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-386"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-386"><span class="linenos">386</span></a>        <span class="n">comparison_errors</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_composition</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-387"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-387"><span class="linenos">387</span></a>        <span class="k">if</span> <span class="n">comparison_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-388"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-388"><span class="linenos">388</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-389"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-389"><span class="linenos">389</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-390"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-390"><span class="linenos">390</span></a>        <span class="n">exists_cycle</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_cycles</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-391"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-391"><span class="linenos">391</span></a>        <span class="k">if</span> <span class="n">exists_cycle</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-392"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-392"><span class="linenos">392</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-393"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-393"><span class="linenos">393</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-394"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-394"><span class="linenos">394</span></a>        <span class="n">graphs_disconnected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">detect_disconnected_components</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-395"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">graphs_disconnected</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-396"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-396"><span class="linenos">396</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-397"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-397"><span class="linenos">397</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-398"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-398"><span class="linenos">398</span></a>        <span class="c1"># Check if there is at least 1 parent node == 1, otherwise show error and request correction</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-399"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">has_node</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">):</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-400"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-400"><span class="linenos">400</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">: N raiz &#39;</span><span class="si">{</span><span class="n">root_node</span><span class="si">}</span><span class="s2">&#39; no encontrado.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-401"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-401"><span class="linenos">401</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-402"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-402"><span class="linenos">402</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-403"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-403"><span class="linenos">403</span></a>        <span class="c1"># Convert the graph to a tree</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-404"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-404"><span class="linenos">404</span></a>        <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">convert_to_tree</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-405"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-405"><span class="linenos">405</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-406"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-406"><span class="linenos">406</span></a>        <span class="c1"># All children of root node (1)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-407"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-407"><span class="linenos">407</span></a>        <span class="n">childs_root_node</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">root_node</span><span class="p">))</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-408"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-408"><span class="linenos">408</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-409"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-409"><span class="linenos">409</span></a>        <span class="c1"># For each child of 1, get the entire subtree below</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-410"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-410"><span class="linenos">410</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs_root_node</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-411"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-411"><span class="linenos">411</span></a>            <span class="c1"># Run a BFS from the child</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-412"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-412"><span class="linenos">412</span></a>            <span class="n">sub_tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">breadth_first_search_from_node</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-413"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-413"><span class="linenos">413</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-414"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-414"><span class="linenos">414</span></a>            <span class="c1"># Build a list with only node codes</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-415"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-415"><span class="linenos">415</span></a>            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sub_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-416"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-416"><span class="linenos">416</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-417"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-417"><span class="linenos">417</span></a>            <span class="c1"># Search for a sub-dataframe from description with codes that are in the node list</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-418"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-418"><span class="linenos">418</span></a>            <span class="n">df_slice_description</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">nodes</span><span class="p">)]</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-419"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-419"><span class="linenos">419</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-420"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-420"><span class="linenos">420</span></a>            <span class="c1"># Check if the titles are unique</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-421"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-421"><span class="linenos">421</span></a>            <span class="n">warnings_i</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">check_dataframe_titles_uniques</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-422"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-422"><span class="linenos">422</span></a>                <span class="n">dataframe</span><span class="o">=</span><span class="n">df_slice_description</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-423"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-423"><span class="linenos">423</span></a>                <span class="n">column_one</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_simple_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-424"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-424"><span class="linenos">424</span></a>                <span class="n">column_two</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_complete_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-425"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-425"><span class="linenos">425</span></a>                <span class="n">plural_column_one</span><span class="o">=</span><span class="n">column_plural_simple_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-426"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-426"><span class="linenos">426</span></a>                <span class="n">plural_column_two</span><span class="o">=</span><span class="n">column_plural_complete_name</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-427"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-427"><span class="linenos">427</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-428"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-428"><span class="linenos">428</span></a>            <span class="c1"># Add prefix to warnings</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-429"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-429"><span class="linenos">429</span></a>            <span class="n">warnings_i</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">warning</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">warnings_i</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-430"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-430"><span class="linenos">430</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-431"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-431"><span class="linenos">431</span></a>            <span class="c1"># Add to main warnings list</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-432"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-432"><span class="linenos">432</span></a>            <span class="n">warnings</span> <span class="o">+=</span> <span class="n">warnings_i</span>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-433"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-433"><span class="linenos">433</span></a>
</span><span id="SpCompositionGraphValidator.validate_unique_titles_with_graph-434"><a href="#SpCompositionGraphValidator.validate_unique_titles_with_graph-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate uniqueness of indicator titles using graph analysis.</p>

<p>Checks that simple names and complete names are unique within each subtree
of the indicator hierarchy, using graph structure to determine sibling
relationships. Validates by traversing from root node through all subtrees.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors for title uniqueness issues)
        - List[str]: Warning messages for duplicate titles within same subtree</p>

<h2 id="notes">Notes</h2>

<ul>
<li>This validation is skipped if the description dataframe is empty</li>
<li>Requires a valid tree structure without cycles or disconnected components</li>
<li>Root node must exist in the composition graph</li>
<li>Titles are checked within each subtree independently</li>
</ul>
</div>


                            </div>
                            <div id="SpCompositionGraphValidator.validate_associated_indicators_leafs" class="classattr">
                                        <input id="SpCompositionGraphValidator.validate_associated_indicators_leafs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_associated_indicators_leafs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionGraphValidator.validate_associated_indicators_leafs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.validate_associated_indicators_leafs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-436"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-436"><span class="linenos">436</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_associated_indicators_leafs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-437"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-437"><span class="linenos">437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-438"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-438"><span class="linenos">438</span></a><span class="sd">        Validate that leaf indicators have associated data in value and proportionality.</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-439"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-439"><span class="linenos">439</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-440"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-440"><span class="linenos">440</span></a><span class="sd">        Checks that all leaf nodes (indicators with no children) have corresponding</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-441"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-441"><span class="linenos">441</span></a><span class="sd">        data entries in the value spreadsheet and optionally in the proportionality</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-442"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-442"><span class="linenos">442</span></a><span class="sd">        spreadsheet if it exists.</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-443"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-443"><span class="linenos">443</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-444"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-444"><span class="linenos">444</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-445"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-445"><span class="linenos">445</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-446"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-446"><span class="linenos">446</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-447"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-447"><span class="linenos">447</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-448"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-448"><span class="linenos">448</span></a><span class="sd">                - List[str]: Error messages for leaf indicators without associated data</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-449"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-449"><span class="linenos">449</span></a><span class="sd">                - List[str]: Warning messages (currently empty)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-450"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-450"><span class="linenos">450</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-451"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-451"><span class="linenos">451</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-452"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-452"><span class="linenos">452</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-453"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-453"><span class="linenos">453</span></a><span class="sd">        - This validation is skipped if the value dataframe is empty</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-454"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-454"><span class="linenos">454</span></a><span class="sd">        - Proportionality validation is only performed if that model is available</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-455"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-455"><span class="linenos">455</span></a><span class="sd">        - Leaf nodes are determined from the composition graph structure</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-456"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-456"><span class="linenos">456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-457"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-457"><span class="linenos">457</span></a>        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-458"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-458"><span class="linenos">458</span></a>        <span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-459"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-459"><span class="linenos">459</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-460"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-460"><span class="linenos">460</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-461"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-462"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-462"><span class="linenos">462</span></a>                <span class="p">[</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-463"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-463"><span class="linenos">463</span></a>                    <span class="p">(</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-464"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-464"><span class="linenos">464</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_associated_indicators_leafs</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-465"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-465"><span class="linenos">465</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEAF_NO_DATA</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-466"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-466"><span class="linenos">466</span></a>                    <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-467"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-467"><span class="linenos">467</span></a>                <span class="p">]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-468"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-468"><span class="linenos">468</span></a>            <span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-469"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-469"><span class="linenos">469</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-470"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-470"><span class="linenos">470</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-471"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-471"><span class="linenos">471</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-472"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-472"><span class="linenos">472</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-473"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-473"><span class="linenos">473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-474"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">],</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-475"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-475"><span class="linenos">475</span></a>        <span class="p">}</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-476"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-476"><span class="linenos">476</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-477"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">read_success</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-478"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-478"><span class="linenos">478</span></a>            <span class="n">local_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpProportionality</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-479"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-479"><span class="linenos">479</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-480"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-480"><span class="linenos">480</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-481"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-481"><span class="linenos">481</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-482"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-482"><span class="linenos">482</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-483"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-483"><span class="linenos">483</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-484"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-484"><span class="linenos">484</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-485"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-485"><span class="linenos">485</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-486"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-486"><span class="linenos">486</span></a>        <span class="n">df_value</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-487"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-487"><span class="linenos">487</span></a>        <span class="n">df_proportionality</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-488"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-488"><span class="linenos">488</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-489"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-489"><span class="linenos">489</span></a>        <span class="n">leafs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_processing</span><span class="o">.</span><span class="n">get_leaf_nodes</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-490"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-490"><span class="linenos">490</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-491"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-491"><span class="linenos">491</span></a>        <span class="c1"># Validation for values</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-492"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-492"><span class="linenos">492</span></a>        <span class="n">codes_values</span> <span class="o">=</span> <span class="n">df_value</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-493"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-493"><span class="linenos">493</span></a>        <span class="n">codes_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes_values</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-494"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-494"><span class="linenos">494</span></a>        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leafs</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-495"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-495"><span class="linenos">495</span></a>            <span class="k">if</span> <span class="n">leaf</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">codes_values</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-496"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-496"><span class="linenos">496</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="si">}</span><span class="s2">: Indicador folha &#39;</span><span class="si">{</span><span class="n">leaf</span><span class="si">}</span><span class="s2">&#39; no possui dados associados.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-497"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-497"><span class="linenos">497</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-498"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-498"><span class="linenos">498</span></a>        <span class="c1"># Validation for proportionality (if available)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-499"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-500"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-500"><span class="linenos">500</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-501"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-501"><span class="linenos">501</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-502"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-502"><span class="linenos">502</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span> <span class="ow">in</span> <span class="n">level_two_columns</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-503"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-503"><span class="linenos">503</span></a>                <span class="n">level_two_columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-504"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-504"><span class="linenos">504</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-505"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-505"><span class="linenos">505</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-506"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-506"><span class="linenos">506</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-507"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-507"><span class="linenos">507</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-508"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-508"><span class="linenos">508</span></a>            <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span><span class="p">]</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-509"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-509"><span class="linenos">509</span></a>            <span class="n">all_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">level_two_columns</span><span class="p">))</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-510"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-510"><span class="linenos">510</span></a>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-511"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-511"><span class="linenos">511</span></a>            <span class="c1"># Check if all leaf codes are present in level_one_columns</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-512"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-512"><span class="linenos">512</span></a>            <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leafs</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-513"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-513"><span class="linenos">513</span></a>                <span class="k">if</span> <span class="n">leaf</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_columns</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-514"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-514"><span class="linenos">514</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: Indicador folha &#39;</span><span class="si">{</span><span class="n">leaf</span><span class="si">}</span><span class="s2">&#39; no possui dados associados.&quot;</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.validate_associated_indicators_leafs-515"><a href="#SpCompositionGraphValidator.validate_associated_indicators_leafs-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate that leaf indicators have associated data in value and proportionality.</p>

<p>Checks that all leaf nodes (indicators with no children) have corresponding
data entries in the value spreadsheet and optionally in the proportionality
spreadsheet if it exists.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for leaf indicators without associated data
        - List[str]: Warning messages (currently empty)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>This validation is skipped if the value dataframe is empty</li>
<li>Proportionality validation is only performed if that model is available</li>
<li>Leaf nodes are determined from the composition graph structure</li>
</ul>
</div>


                            </div>
                            <div id="SpCompositionGraphValidator.run" class="classattr">
                                        <input id="SpCompositionGraphValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpCompositionGraphValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpCompositionGraphValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpCompositionGraphValidator.run-517"><a href="#SpCompositionGraphValidator.run-517"><span class="linenos">517</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpCompositionGraphValidator.run-518"><a href="#SpCompositionGraphValidator.run-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.run-519"><a href="#SpCompositionGraphValidator.run-519"><span class="linenos">519</span></a><span class="sd">        Execute all graph-based composition validations.</span>
</span><span id="SpCompositionGraphValidator.run-520"><a href="#SpCompositionGraphValidator.run-520"><span class="linenos">520</span></a>
</span><span id="SpCompositionGraphValidator.run-521"><a href="#SpCompositionGraphValidator.run-521"><span class="linenos">521</span></a><span class="sd">        Orchestrates the execution of all composition validators using graph analysis,</span>
</span><span id="SpCompositionGraphValidator.run-522"><a href="#SpCompositionGraphValidator.run-522"><span class="linenos">522</span></a><span class="sd">        including indicator relationships, hierarchy validation, title uniqueness,</span>
</span><span id="SpCompositionGraphValidator.run-523"><a href="#SpCompositionGraphValidator.run-523"><span class="linenos">523</span></a><span class="sd">        and leaf data associations.</span>
</span><span id="SpCompositionGraphValidator.run-524"><a href="#SpCompositionGraphValidator.run-524"><span class="linenos">524</span></a>
</span><span id="SpCompositionGraphValidator.run-525"><a href="#SpCompositionGraphValidator.run-525"><span class="linenos">525</span></a><span class="sd">        Returns</span>
</span><span id="SpCompositionGraphValidator.run-526"><a href="#SpCompositionGraphValidator.run-526"><span class="linenos">526</span></a><span class="sd">        -------</span>
</span><span id="SpCompositionGraphValidator.run-527"><a href="#SpCompositionGraphValidator.run-527"><span class="linenos">527</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpCompositionGraphValidator.run-528"><a href="#SpCompositionGraphValidator.run-528"><span class="linenos">528</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpCompositionGraphValidator.run-529"><a href="#SpCompositionGraphValidator.run-529"><span class="linenos">529</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpCompositionGraphValidator.run-530"><a href="#SpCompositionGraphValidator.run-530"><span class="linenos">530</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpCompositionGraphValidator.run-531"><a href="#SpCompositionGraphValidator.run-531"><span class="linenos">531</span></a>
</span><span id="SpCompositionGraphValidator.run-532"><a href="#SpCompositionGraphValidator.run-532"><span class="linenos">532</span></a><span class="sd">        Notes</span>
</span><span id="SpCompositionGraphValidator.run-533"><a href="#SpCompositionGraphValidator.run-533"><span class="linenos">533</span></a><span class="sd">        -----</span>
</span><span id="SpCompositionGraphValidator.run-534"><a href="#SpCompositionGraphValidator.run-534"><span class="linenos">534</span></a><span class="sd">        All validations are skipped if the composition dataframe is empty.</span>
</span><span id="SpCompositionGraphValidator.run-535"><a href="#SpCompositionGraphValidator.run-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpCompositionGraphValidator.run-536"><a href="#SpCompositionGraphValidator.run-536"><span class="linenos">536</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpCompositionGraphValidator.run-537"><a href="#SpCompositionGraphValidator.run-537"><span class="linenos">537</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_composition</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator.run-538"><a href="#SpCompositionGraphValidator.run-538"><span class="linenos">538</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relations_hierarchy_with_graph</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator.run-539"><a href="#SpCompositionGraphValidator.run-539"><span class="linenos">539</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_titles_with_graph</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UT</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator.run-540"><a href="#SpCompositionGraphValidator.run-540"><span class="linenos">540</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_associated_indicators_leafs</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEAF_NO_DATA</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpCompositionGraphValidator.run-541"><a href="#SpCompositionGraphValidator.run-541"><span class="linenos">541</span></a>        <span class="p">]</span>
</span><span id="SpCompositionGraphValidator.run-542"><a href="#SpCompositionGraphValidator.run-542"><span class="linenos">542</span></a>
</span><span id="SpCompositionGraphValidator.run-543"><a href="#SpCompositionGraphValidator.run-543"><span class="linenos">543</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpCompositionGraphValidator.run-544"><a href="#SpCompositionGraphValidator.run-544"><span class="linenos">544</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.run-545"><a href="#SpCompositionGraphValidator.run-545"><span class="linenos">545</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpCompositionGraphValidator.run-546"><a href="#SpCompositionGraphValidator.run-546"><span class="linenos">546</span></a>
</span><span id="SpCompositionGraphValidator.run-547"><a href="#SpCompositionGraphValidator.run-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpCompositionGraphValidator.run-548"><a href="#SpCompositionGraphValidator.run-548"><span class="linenos">548</span></a>
</span><span id="SpCompositionGraphValidator.run-549"><a href="#SpCompositionGraphValidator.run-549"><span class="linenos">549</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all graph-based composition validations.</p>

<p>Orchestrates the execution of all composition validators using graph analysis,
including indicator relationships, hierarchy validation, title uniqueness,
and leaf data associations.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<p>All validations are skipped if the composition dataframe is empty.</p>
</div>


                            </div>
                </section>
                <section id="SpTemporalReferenceValidator">
                            <input id="SpTemporalReferenceValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpTemporalReferenceValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpTemporalReferenceValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpTemporalReferenceValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpTemporalReferenceValidator-21"><a href="#SpTemporalReferenceValidator-21"><span class="linenos"> 21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpTemporalReferenceValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpTemporalReferenceValidator-22"><a href="#SpTemporalReferenceValidator-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-23"><a href="#SpTemporalReferenceValidator-23"><span class="linenos"> 23</span></a><span class="sd">    Validates Temporal Reference spreadsheet content.</span>
</span><span id="SpTemporalReferenceValidator-24"><a href="#SpTemporalReferenceValidator-24"><span class="linenos"> 24</span></a>
</span><span id="SpTemporalReferenceValidator-25"><a href="#SpTemporalReferenceValidator-25"><span class="linenos"> 25</span></a><span class="sd">    This validator performs comprehensive checks on temporal reference data including:</span>
</span><span id="SpTemporalReferenceValidator-26"><a href="#SpTemporalReferenceValidator-26"><span class="linenos"> 26</span></a><span class="sd">    - Punctuation validation for description fields</span>
</span><span id="SpTemporalReferenceValidator-27"><a href="#SpTemporalReferenceValidator-27"><span class="linenos"> 27</span></a><span class="sd">    - Reference year validation (must be future years)</span>
</span><span id="SpTemporalReferenceValidator-28"><a href="#SpTemporalReferenceValidator-28"><span class="linenos"> 28</span></a><span class="sd">    - Unique value constraints for name and symbol columns</span>
</span><span id="SpTemporalReferenceValidator-29"><a href="#SpTemporalReferenceValidator-29"><span class="linenos"> 29</span></a>
</span><span id="SpTemporalReferenceValidator-30"><a href="#SpTemporalReferenceValidator-30"><span class="linenos"> 30</span></a><span class="sd">    Notes</span>
</span><span id="SpTemporalReferenceValidator-31"><a href="#SpTemporalReferenceValidator-31"><span class="linenos"> 31</span></a><span class="sd">    -----</span>
</span><span id="SpTemporalReferenceValidator-32"><a href="#SpTemporalReferenceValidator-32"><span class="linenos"> 32</span></a><span class="sd">    Inherits validation infrastructure from ValidatorModelABC including column</span>
</span><span id="SpTemporalReferenceValidator-33"><a href="#SpTemporalReferenceValidator-33"><span class="linenos"> 33</span></a><span class="sd">    existence checks and report generation capabilities.</span>
</span><span id="SpTemporalReferenceValidator-34"><a href="#SpTemporalReferenceValidator-34"><span class="linenos"> 34</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-35"><a href="#SpTemporalReferenceValidator-35"><span class="linenos"> 35</span></a>
</span><span id="SpTemporalReferenceValidator-36"><a href="#SpTemporalReferenceValidator-36"><span class="linenos"> 36</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator-37"><a href="#SpTemporalReferenceValidator-37"><span class="linenos"> 37</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-38"><a href="#SpTemporalReferenceValidator-38"><span class="linenos"> 38</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-39"><a href="#SpTemporalReferenceValidator-39"><span class="linenos"> 39</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-40"><a href="#SpTemporalReferenceValidator-40"><span class="linenos"> 40</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpTemporalReferenceValidator-41"><a href="#SpTemporalReferenceValidator-41"><span class="linenos"> 41</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-42"><a href="#SpTemporalReferenceValidator-42"><span class="linenos"> 42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-43"><a href="#SpTemporalReferenceValidator-43"><span class="linenos"> 43</span></a><span class="sd">        Initialize the Temporal Reference validator.</span>
</span><span id="SpTemporalReferenceValidator-44"><a href="#SpTemporalReferenceValidator-44"><span class="linenos"> 44</span></a>
</span><span id="SpTemporalReferenceValidator-45"><a href="#SpTemporalReferenceValidator-45"><span class="linenos"> 45</span></a><span class="sd">        Args</span>
</span><span id="SpTemporalReferenceValidator-46"><a href="#SpTemporalReferenceValidator-46"><span class="linenos"> 46</span></a><span class="sd">        ----</span>
</span><span id="SpTemporalReferenceValidator-47"><a href="#SpTemporalReferenceValidator-47"><span class="linenos"> 47</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpTemporalReferenceValidator-48"><a href="#SpTemporalReferenceValidator-48"><span class="linenos"> 48</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpTemporalReferenceValidator-49"><a href="#SpTemporalReferenceValidator-49"><span class="linenos"> 49</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpTemporalReferenceValidator-50"><a href="#SpTemporalReferenceValidator-50"><span class="linenos"> 50</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpTemporalReferenceValidator-51"><a href="#SpTemporalReferenceValidator-51"><span class="linenos"> 51</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpTemporalReferenceValidator-52"><a href="#SpTemporalReferenceValidator-52"><span class="linenos"> 52</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpTemporalReferenceValidator-53"><a href="#SpTemporalReferenceValidator-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-54"><a href="#SpTemporalReferenceValidator-54"><span class="linenos"> 54</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator-55"><a href="#SpTemporalReferenceValidator-55"><span class="linenos"> 55</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-56"><a href="#SpTemporalReferenceValidator-56"><span class="linenos"> 56</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-57"><a href="#SpTemporalReferenceValidator-57"><span class="linenos"> 57</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpTemporalReference</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-58"><a href="#SpTemporalReferenceValidator-58"><span class="linenos"> 58</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-59"><a href="#SpTemporalReferenceValidator-59"><span class="linenos"> 59</span></a>        <span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-60"><a href="#SpTemporalReferenceValidator-60"><span class="linenos"> 60</span></a>
</span><span id="SpTemporalReferenceValidator-61"><a href="#SpTemporalReferenceValidator-61"><span class="linenos"> 61</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpTemporalReferenceValidator-62"><a href="#SpTemporalReferenceValidator-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpTemporalReferenceValidator-63"><a href="#SpTemporalReferenceValidator-63"><span class="linenos"> 63</span></a>
</span><span id="SpTemporalReferenceValidator-64"><a href="#SpTemporalReferenceValidator-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_punctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator-65"><a href="#SpTemporalReferenceValidator-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-66"><a href="#SpTemporalReferenceValidator-66"><span class="linenos"> 66</span></a><span class="sd">        Validate punctuation rules for temporal reference descriptions.</span>
</span><span id="SpTemporalReferenceValidator-67"><a href="#SpTemporalReferenceValidator-67"><span class="linenos"> 67</span></a>
</span><span id="SpTemporalReferenceValidator-68"><a href="#SpTemporalReferenceValidator-68"><span class="linenos"> 68</span></a><span class="sd">        Ensures that description fields end with a period (.) as required by</span>
</span><span id="SpTemporalReferenceValidator-69"><a href="#SpTemporalReferenceValidator-69"><span class="linenos"> 69</span></a><span class="sd">        the data quality standards.</span>
</span><span id="SpTemporalReferenceValidator-70"><a href="#SpTemporalReferenceValidator-70"><span class="linenos"> 70</span></a>
</span><span id="SpTemporalReferenceValidator-71"><a href="#SpTemporalReferenceValidator-71"><span class="linenos"> 71</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator-72"><a href="#SpTemporalReferenceValidator-72"><span class="linenos"> 72</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator-73"><a href="#SpTemporalReferenceValidator-73"><span class="linenos"> 73</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator-74"><a href="#SpTemporalReferenceValidator-74"><span class="linenos"> 74</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator-75"><a href="#SpTemporalReferenceValidator-75"><span class="linenos"> 75</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpTemporalReferenceValidator-76"><a href="#SpTemporalReferenceValidator-76"><span class="linenos"> 76</span></a><span class="sd">                - List[str]: Warning messages for punctuation violations</span>
</span><span id="SpTemporalReferenceValidator-77"><a href="#SpTemporalReferenceValidator-77"><span class="linenos"> 77</span></a>
</span><span id="SpTemporalReferenceValidator-78"><a href="#SpTemporalReferenceValidator-78"><span class="linenos"> 78</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator-79"><a href="#SpTemporalReferenceValidator-79"><span class="linenos"> 79</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator-80"><a href="#SpTemporalReferenceValidator-80"><span class="linenos"> 80</span></a><span class="sd">        Only the description column is validated for ending punctuation.</span>
</span><span id="SpTemporalReferenceValidator-81"><a href="#SpTemporalReferenceValidator-81"><span class="linenos"> 81</span></a><span class="sd">        Missing columns generate warnings rather than errors.</span>
</span><span id="SpTemporalReferenceValidator-82"><a href="#SpTemporalReferenceValidator-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-83"><a href="#SpTemporalReferenceValidator-83"><span class="linenos"> 83</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator-84"><a href="#SpTemporalReferenceValidator-84"><span class="linenos"> 84</span></a>
</span><span id="SpTemporalReferenceValidator-85"><a href="#SpTemporalReferenceValidator-85"><span class="linenos"> 85</span></a>        <span class="n">columns_dont_punctuation</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator-86"><a href="#SpTemporalReferenceValidator-86"><span class="linenos"> 86</span></a>        <span class="n">columns_must_end_with_dot</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpTemporalReferenceValidator-87"><a href="#SpTemporalReferenceValidator-87"><span class="linenos"> 87</span></a>
</span><span id="SpTemporalReferenceValidator-88"><a href="#SpTemporalReferenceValidator-88"><span class="linenos"> 88</span></a>        <span class="n">list_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns_dont_punctuation</span> <span class="o">+</span> <span class="n">columns_must_end_with_dot</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-89"><a href="#SpTemporalReferenceValidator-89"><span class="linenos"> 89</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">list_columns</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-90"><a href="#SpTemporalReferenceValidator-90"><span class="linenos"> 90</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-91"><a href="#SpTemporalReferenceValidator-91"><span class="linenos"> 91</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-92"><a href="#SpTemporalReferenceValidator-92"><span class="linenos"> 92</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-93"><a href="#SpTemporalReferenceValidator-93"><span class="linenos"> 93</span></a>
</span><span id="SpTemporalReferenceValidator-94"><a href="#SpTemporalReferenceValidator-94"><span class="linenos"> 94</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">punctuation_warnings</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_characters_punctuation_rules</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator-95"><a href="#SpTemporalReferenceValidator-95"><span class="linenos"> 95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-96"><a href="#SpTemporalReferenceValidator-96"><span class="linenos"> 96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-97"><a href="#SpTemporalReferenceValidator-97"><span class="linenos"> 97</span></a>            <span class="n">columns_dont_punctuation</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-98"><a href="#SpTemporalReferenceValidator-98"><span class="linenos"> 98</span></a>            <span class="n">columns_must_end_with_dot</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-99"><a href="#SpTemporalReferenceValidator-99"><span class="linenos"> 99</span></a>        <span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-100"><a href="#SpTemporalReferenceValidator-100"><span class="linenos">100</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">punctuation_warnings</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-101"><a href="#SpTemporalReferenceValidator-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span><span id="SpTemporalReferenceValidator-102"><a href="#SpTemporalReferenceValidator-102"><span class="linenos">102</span></a>
</span><span id="SpTemporalReferenceValidator-103"><a href="#SpTemporalReferenceValidator-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_reference_years</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator-104"><a href="#SpTemporalReferenceValidator-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-105"><a href="#SpTemporalReferenceValidator-105"><span class="linenos">105</span></a><span class="sd">        Validate that reference years are in the future.</span>
</span><span id="SpTemporalReferenceValidator-106"><a href="#SpTemporalReferenceValidator-106"><span class="linenos">106</span></a>
</span><span id="SpTemporalReferenceValidator-107"><a href="#SpTemporalReferenceValidator-107"><span class="linenos">107</span></a><span class="sd">        Checks that all year values in the symbol column (excluding the first row</span>
</span><span id="SpTemporalReferenceValidator-108"><a href="#SpTemporalReferenceValidator-108"><span class="linenos">108</span></a><span class="sd">        which represents the current year) are greater than the configured current</span>
</span><span id="SpTemporalReferenceValidator-109"><a href="#SpTemporalReferenceValidator-109"><span class="linenos">109</span></a><span class="sd">        year. This ensures temporal references only point to future scenarios.</span>
</span><span id="SpTemporalReferenceValidator-110"><a href="#SpTemporalReferenceValidator-110"><span class="linenos">110</span></a>
</span><span id="SpTemporalReferenceValidator-111"><a href="#SpTemporalReferenceValidator-111"><span class="linenos">111</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator-112"><a href="#SpTemporalReferenceValidator-112"><span class="linenos">112</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator-113"><a href="#SpTemporalReferenceValidator-113"><span class="linenos">113</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator-114"><a href="#SpTemporalReferenceValidator-114"><span class="linenos">114</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator-115"><a href="#SpTemporalReferenceValidator-115"><span class="linenos">115</span></a><span class="sd">                - List[str]: Error messages for past years in temporal references</span>
</span><span id="SpTemporalReferenceValidator-116"><a href="#SpTemporalReferenceValidator-116"><span class="linenos">116</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpTemporalReferenceValidator-117"><a href="#SpTemporalReferenceValidator-117"><span class="linenos">117</span></a>
</span><span id="SpTemporalReferenceValidator-118"><a href="#SpTemporalReferenceValidator-118"><span class="linenos">118</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator-119"><a href="#SpTemporalReferenceValidator-119"><span class="linenos">119</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator-120"><a href="#SpTemporalReferenceValidator-120"><span class="linenos">120</span></a><span class="sd">        - First row is excluded from validation (represents current year)</span>
</span><span id="SpTemporalReferenceValidator-121"><a href="#SpTemporalReferenceValidator-121"><span class="linenos">121</span></a><span class="sd">        - Years must be greater than config.CURRENT_YEAR</span>
</span><span id="SpTemporalReferenceValidator-122"><a href="#SpTemporalReferenceValidator-122"><span class="linenos">122</span></a><span class="sd">        - Missing symbol column returns errors immediately</span>
</span><span id="SpTemporalReferenceValidator-123"><a href="#SpTemporalReferenceValidator-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-124"><a href="#SpTemporalReferenceValidator-124"><span class="linenos">124</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator-125"><a href="#SpTemporalReferenceValidator-125"><span class="linenos">125</span></a>
</span><span id="SpTemporalReferenceValidator-126"><a href="#SpTemporalReferenceValidator-126"><span class="linenos">126</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpTemporalReferenceValidator-127"><a href="#SpTemporalReferenceValidator-127"><span class="linenos">127</span></a>            <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-128"><a href="#SpTemporalReferenceValidator-128"><span class="linenos">128</span></a>        <span class="p">]</span>
</span><span id="SpTemporalReferenceValidator-129"><a href="#SpTemporalReferenceValidator-129"><span class="linenos">129</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-130"><a href="#SpTemporalReferenceValidator-130"><span class="linenos">130</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-131"><a href="#SpTemporalReferenceValidator-131"><span class="linenos">131</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-132"><a href="#SpTemporalReferenceValidator-132"><span class="linenos">132</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-133"><a href="#SpTemporalReferenceValidator-133"><span class="linenos">133</span></a>                <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator-134"><a href="#SpTemporalReferenceValidator-134"><span class="linenos">134</span></a>
</span><span id="SpTemporalReferenceValidator-135"><a href="#SpTemporalReferenceValidator-135"><span class="linenos">135</span></a>        <span class="c1"># Remove first row: This is actual year</span>
</span><span id="SpTemporalReferenceValidator-136"><a href="#SpTemporalReferenceValidator-136"><span class="linenos">136</span></a>        <span class="n">column_series_symbol</span> <span class="o">=</span> <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="SpTemporalReferenceValidator-137"><a href="#SpTemporalReferenceValidator-137"><span class="linenos">137</span></a>        <span class="n">years</span> <span class="o">=</span> <span class="n">column_series_symbol</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="SpTemporalReferenceValidator-138"><a href="#SpTemporalReferenceValidator-138"><span class="linenos">138</span></a>
</span><span id="SpTemporalReferenceValidator-139"><a href="#SpTemporalReferenceValidator-139"><span class="linenos">139</span></a>        <span class="c1"># Check if all years are greater than the current year</span>
</span><span id="SpTemporalReferenceValidator-140"><a href="#SpTemporalReferenceValidator-140"><span class="linenos">140</span></a>        <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-141"><a href="#SpTemporalReferenceValidator-141"><span class="linenos">141</span></a>            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">CURRENT_YEAR</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-142"><a href="#SpTemporalReferenceValidator-142"><span class="linenos">142</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: O ano </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2"> no pode estar associado a cenrios por no ser um ano futuro.&quot;</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-143"><a href="#SpTemporalReferenceValidator-143"><span class="linenos">143</span></a>
</span><span id="SpTemporalReferenceValidator-144"><a href="#SpTemporalReferenceValidator-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator-145"><a href="#SpTemporalReferenceValidator-145"><span class="linenos">145</span></a>
</span><span id="SpTemporalReferenceValidator-146"><a href="#SpTemporalReferenceValidator-146"><span class="linenos">146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator-147"><a href="#SpTemporalReferenceValidator-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-148"><a href="#SpTemporalReferenceValidator-148"><span class="linenos">148</span></a><span class="sd">        Validate uniqueness of name and symbol columns.</span>
</span><span id="SpTemporalReferenceValidator-149"><a href="#SpTemporalReferenceValidator-149"><span class="linenos">149</span></a>
</span><span id="SpTemporalReferenceValidator-150"><a href="#SpTemporalReferenceValidator-150"><span class="linenos">150</span></a><span class="sd">        Ensures that all values in the name and symbol columns are unique across</span>
</span><span id="SpTemporalReferenceValidator-151"><a href="#SpTemporalReferenceValidator-151"><span class="linenos">151</span></a><span class="sd">        the entire temporal reference dataset to prevent duplicate temporal references.</span>
</span><span id="SpTemporalReferenceValidator-152"><a href="#SpTemporalReferenceValidator-152"><span class="linenos">152</span></a>
</span><span id="SpTemporalReferenceValidator-153"><a href="#SpTemporalReferenceValidator-153"><span class="linenos">153</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator-154"><a href="#SpTemporalReferenceValidator-154"><span class="linenos">154</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator-155"><a href="#SpTemporalReferenceValidator-155"><span class="linenos">155</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator-156"><a href="#SpTemporalReferenceValidator-156"><span class="linenos">156</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator-157"><a href="#SpTemporalReferenceValidator-157"><span class="linenos">157</span></a><span class="sd">                - List[str]: Error messages for duplicate values</span>
</span><span id="SpTemporalReferenceValidator-158"><a href="#SpTemporalReferenceValidator-158"><span class="linenos">158</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpTemporalReferenceValidator-159"><a href="#SpTemporalReferenceValidator-159"><span class="linenos">159</span></a>
</span><span id="SpTemporalReferenceValidator-160"><a href="#SpTemporalReferenceValidator-160"><span class="linenos">160</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator-161"><a href="#SpTemporalReferenceValidator-161"><span class="linenos">161</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator-162"><a href="#SpTemporalReferenceValidator-162"><span class="linenos">162</span></a><span class="sd">        Validates uniqueness for:</span>
</span><span id="SpTemporalReferenceValidator-163"><a href="#SpTemporalReferenceValidator-163"><span class="linenos">163</span></a><span class="sd">        - COLUMN_NAME: Temporal reference names must be unique</span>
</span><span id="SpTemporalReferenceValidator-164"><a href="#SpTemporalReferenceValidator-164"><span class="linenos">164</span></a><span class="sd">        - COLUMN_SYMBOL: Year symbols must be unique</span>
</span><span id="SpTemporalReferenceValidator-165"><a href="#SpTemporalReferenceValidator-165"><span class="linenos">165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-166"><a href="#SpTemporalReferenceValidator-166"><span class="linenos">166</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator-167"><a href="#SpTemporalReferenceValidator-167"><span class="linenos">167</span></a>
</span><span id="SpTemporalReferenceValidator-168"><a href="#SpTemporalReferenceValidator-168"><span class="linenos">168</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpTemporalReferenceValidator-169"><a href="#SpTemporalReferenceValidator-169"><span class="linenos">169</span></a>            <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-170"><a href="#SpTemporalReferenceValidator-170"><span class="linenos">170</span></a>            <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-171"><a href="#SpTemporalReferenceValidator-171"><span class="linenos">171</span></a>        <span class="p">]</span>
</span><span id="SpTemporalReferenceValidator-172"><a href="#SpTemporalReferenceValidator-172"><span class="linenos">172</span></a>
</span><span id="SpTemporalReferenceValidator-173"><a href="#SpTemporalReferenceValidator-173"><span class="linenos">173</span></a>        <span class="c1"># Check if columns exist</span>
</span><span id="SpTemporalReferenceValidator-174"><a href="#SpTemporalReferenceValidator-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-175"><a href="#SpTemporalReferenceValidator-175"><span class="linenos">175</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-176"><a href="#SpTemporalReferenceValidator-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-177"><a href="#SpTemporalReferenceValidator-177"><span class="linenos">177</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-178"><a href="#SpTemporalReferenceValidator-178"><span class="linenos">178</span></a>
</span><span id="SpTemporalReferenceValidator-179"><a href="#SpTemporalReferenceValidator-179"><span class="linenos">179</span></a>        <span class="n">__</span><span class="p">,</span> <span class="n">unique_errors</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">check_dataframe_unique_values</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator-180"><a href="#SpTemporalReferenceValidator-180"><span class="linenos">180</span></a>            <span class="n">dataframe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-181"><a href="#SpTemporalReferenceValidator-181"><span class="linenos">181</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-182"><a href="#SpTemporalReferenceValidator-182"><span class="linenos">182</span></a>            <span class="n">columns_uniques</span><span class="o">=</span><span class="n">columns_to_check</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator-183"><a href="#SpTemporalReferenceValidator-183"><span class="linenos">183</span></a>        <span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-184"><a href="#SpTemporalReferenceValidator-184"><span class="linenos">184</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">unique_errors</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-185"><a href="#SpTemporalReferenceValidator-185"><span class="linenos">185</span></a>
</span><span id="SpTemporalReferenceValidator-186"><a href="#SpTemporalReferenceValidator-186"><span class="linenos">186</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator-187"><a href="#SpTemporalReferenceValidator-187"><span class="linenos">187</span></a>
</span><span id="SpTemporalReferenceValidator-188"><a href="#SpTemporalReferenceValidator-188"><span class="linenos">188</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-189"><a href="#SpTemporalReferenceValidator-189"><span class="linenos">189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-190"><a href="#SpTemporalReferenceValidator-190"><span class="linenos">190</span></a><span class="sd">        Prepare validation statements.</span>
</span><span id="SpTemporalReferenceValidator-191"><a href="#SpTemporalReferenceValidator-191"><span class="linenos">191</span></a>
</span><span id="SpTemporalReferenceValidator-192"><a href="#SpTemporalReferenceValidator-192"><span class="linenos">192</span></a><span class="sd">        This method is currently a placeholder for future initialization logic</span>
</span><span id="SpTemporalReferenceValidator-193"><a href="#SpTemporalReferenceValidator-193"><span class="linenos">193</span></a><span class="sd">        that may be needed before running validations.</span>
</span><span id="SpTemporalReferenceValidator-194"><a href="#SpTemporalReferenceValidator-194"><span class="linenos">194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-195"><a href="#SpTemporalReferenceValidator-195"><span class="linenos">195</span></a>        <span class="k">pass</span>
</span><span id="SpTemporalReferenceValidator-196"><a href="#SpTemporalReferenceValidator-196"><span class="linenos">196</span></a>
</span><span id="SpTemporalReferenceValidator-197"><a href="#SpTemporalReferenceValidator-197"><span class="linenos">197</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator-198"><a href="#SpTemporalReferenceValidator-198"><span class="linenos">198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-199"><a href="#SpTemporalReferenceValidator-199"><span class="linenos">199</span></a><span class="sd">        Execute all temporal reference validations.</span>
</span><span id="SpTemporalReferenceValidator-200"><a href="#SpTemporalReferenceValidator-200"><span class="linenos">200</span></a>
</span><span id="SpTemporalReferenceValidator-201"><a href="#SpTemporalReferenceValidator-201"><span class="linenos">201</span></a><span class="sd">        Orchestrates the execution of all temporal reference validators including:</span>
</span><span id="SpTemporalReferenceValidator-202"><a href="#SpTemporalReferenceValidator-202"><span class="linenos">202</span></a><span class="sd">        - Punctuation validation for descriptions</span>
</span><span id="SpTemporalReferenceValidator-203"><a href="#SpTemporalReferenceValidator-203"><span class="linenos">203</span></a><span class="sd">        - Reference year validation (future years only)</span>
</span><span id="SpTemporalReferenceValidator-204"><a href="#SpTemporalReferenceValidator-204"><span class="linenos">204</span></a><span class="sd">        - Unique value validation for names and symbols</span>
</span><span id="SpTemporalReferenceValidator-205"><a href="#SpTemporalReferenceValidator-205"><span class="linenos">205</span></a>
</span><span id="SpTemporalReferenceValidator-206"><a href="#SpTemporalReferenceValidator-206"><span class="linenos">206</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator-207"><a href="#SpTemporalReferenceValidator-207"><span class="linenos">207</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator-208"><a href="#SpTemporalReferenceValidator-208"><span class="linenos">208</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator-209"><a href="#SpTemporalReferenceValidator-209"><span class="linenos">209</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator-210"><a href="#SpTemporalReferenceValidator-210"><span class="linenos">210</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpTemporalReferenceValidator-211"><a href="#SpTemporalReferenceValidator-211"><span class="linenos">211</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpTemporalReferenceValidator-212"><a href="#SpTemporalReferenceValidator-212"><span class="linenos">212</span></a>
</span><span id="SpTemporalReferenceValidator-213"><a href="#SpTemporalReferenceValidator-213"><span class="linenos">213</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator-214"><a href="#SpTemporalReferenceValidator-214"><span class="linenos">214</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator-215"><a href="#SpTemporalReferenceValidator-215"><span class="linenos">215</span></a><span class="sd">        All validations are skipped if the temporal reference dataframe is empty.</span>
</span><span id="SpTemporalReferenceValidator-216"><a href="#SpTemporalReferenceValidator-216"><span class="linenos">216</span></a><span class="sd">        Results are aggregated into reports via `build_reports()`.</span>
</span><span id="SpTemporalReferenceValidator-217"><a href="#SpTemporalReferenceValidator-217"><span class="linenos">217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator-218"><a href="#SpTemporalReferenceValidator-218"><span class="linenos">218</span></a>
</span><span id="SpTemporalReferenceValidator-219"><a href="#SpTemporalReferenceValidator-219"><span class="linenos">219</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpTemporalReferenceValidator-220"><a href="#SpTemporalReferenceValidator-220"><span class="linenos">220</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_punctuation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">MAND_PUNC_TEMP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpTemporalReferenceValidator-221"><a href="#SpTemporalReferenceValidator-221"><span class="linenos">221</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_reference_years</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">YEARS_TEMP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpTemporalReferenceValidator-222"><a href="#SpTemporalReferenceValidator-222"><span class="linenos">222</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UVR_TEMP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpTemporalReferenceValidator-223"><a href="#SpTemporalReferenceValidator-223"><span class="linenos">223</span></a>        <span class="p">]</span>
</span><span id="SpTemporalReferenceValidator-224"><a href="#SpTemporalReferenceValidator-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator-225"><a href="#SpTemporalReferenceValidator-225"><span class="linenos">225</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-226"><a href="#SpTemporalReferenceValidator-226"><span class="linenos">226</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpTemporalReferenceValidator-227"><a href="#SpTemporalReferenceValidator-227"><span class="linenos">227</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpTemporalReferenceValidator-228"><a href="#SpTemporalReferenceValidator-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator-229"><a href="#SpTemporalReferenceValidator-229"><span class="linenos">229</span></a>
</span><span id="SpTemporalReferenceValidator-230"><a href="#SpTemporalReferenceValidator-230"><span class="linenos">230</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates Temporal Reference spreadsheet content.</p>

<p>This validator performs comprehensive checks on temporal reference data including:</p>

<ul>
<li>Punctuation validation for description fields</li>
<li>Reference year validation (must be future years)</li>
<li>Unique value constraints for name and symbol columns</li>
</ul>

<h2 id="notes">Notes</h2>

<p>Inherits validation infrastructure from ValidatorModelABC including column
existence checks and report generation capabilities.</p>
</div>


                            <div id="SpTemporalReferenceValidator.__init__" class="classattr">
                                        <input id="SpTemporalReferenceValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpTemporalReferenceValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpTemporalReferenceValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpTemporalReferenceValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpTemporalReferenceValidator.__init__-36"><a href="#SpTemporalReferenceValidator.__init__-36"><span class="linenos">36</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator.__init__-37"><a href="#SpTemporalReferenceValidator.__init__-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.__init__-38"><a href="#SpTemporalReferenceValidator.__init__-38"><span class="linenos">38</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.__init__-39"><a href="#SpTemporalReferenceValidator.__init__-39"><span class="linenos">39</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.__init__-40"><a href="#SpTemporalReferenceValidator.__init__-40"><span class="linenos">40</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpTemporalReferenceValidator.__init__-41"><a href="#SpTemporalReferenceValidator.__init__-41"><span class="linenos">41</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.__init__-42"><a href="#SpTemporalReferenceValidator.__init__-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.__init__-43"><a href="#SpTemporalReferenceValidator.__init__-43"><span class="linenos">43</span></a><span class="sd">        Initialize the Temporal Reference validator.</span>
</span><span id="SpTemporalReferenceValidator.__init__-44"><a href="#SpTemporalReferenceValidator.__init__-44"><span class="linenos">44</span></a>
</span><span id="SpTemporalReferenceValidator.__init__-45"><a href="#SpTemporalReferenceValidator.__init__-45"><span class="linenos">45</span></a><span class="sd">        Args</span>
</span><span id="SpTemporalReferenceValidator.__init__-46"><a href="#SpTemporalReferenceValidator.__init__-46"><span class="linenos">46</span></a><span class="sd">        ----</span>
</span><span id="SpTemporalReferenceValidator.__init__-47"><a href="#SpTemporalReferenceValidator.__init__-47"><span class="linenos">47</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpTemporalReferenceValidator.__init__-48"><a href="#SpTemporalReferenceValidator.__init__-48"><span class="linenos">48</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpTemporalReferenceValidator.__init__-49"><a href="#SpTemporalReferenceValidator.__init__-49"><span class="linenos">49</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpTemporalReferenceValidator.__init__-50"><a href="#SpTemporalReferenceValidator.__init__-50"><span class="linenos">50</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpTemporalReferenceValidator.__init__-51"><a href="#SpTemporalReferenceValidator.__init__-51"><span class="linenos">51</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpTemporalReferenceValidator.__init__-52"><a href="#SpTemporalReferenceValidator.__init__-52"><span class="linenos">52</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpTemporalReferenceValidator.__init__-53"><a href="#SpTemporalReferenceValidator.__init__-53"><span class="linenos">53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.__init__-54"><a href="#SpTemporalReferenceValidator.__init__-54"><span class="linenos">54</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator.__init__-55"><a href="#SpTemporalReferenceValidator.__init__-55"><span class="linenos">55</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.__init__-56"><a href="#SpTemporalReferenceValidator.__init__-56"><span class="linenos">56</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.__init__-57"><a href="#SpTemporalReferenceValidator.__init__-57"><span class="linenos">57</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpTemporalReference</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.__init__-58"><a href="#SpTemporalReferenceValidator.__init__-58"><span class="linenos">58</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.__init__-59"><a href="#SpTemporalReferenceValidator.__init__-59"><span class="linenos">59</span></a>        <span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.__init__-60"><a href="#SpTemporalReferenceValidator.__init__-60"><span class="linenos">60</span></a>
</span><span id="SpTemporalReferenceValidator.__init__-61"><a href="#SpTemporalReferenceValidator.__init__-61"><span class="linenos">61</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpTemporalReferenceValidator.__init__-62"><a href="#SpTemporalReferenceValidator.__init__-62"><span class="linenos">62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Temporal Reference validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpTemporalReferenceValidator.validate_punctuation" class="classattr">
                                        <input id="SpTemporalReferenceValidator.validate_punctuation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_punctuation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpTemporalReferenceValidator.validate_punctuation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpTemporalReferenceValidator.validate_punctuation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpTemporalReferenceValidator.validate_punctuation-64"><a href="#SpTemporalReferenceValidator.validate_punctuation-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_punctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-65"><a href="#SpTemporalReferenceValidator.validate_punctuation-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-66"><a href="#SpTemporalReferenceValidator.validate_punctuation-66"><span class="linenos"> 66</span></a><span class="sd">        Validate punctuation rules for temporal reference descriptions.</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-67"><a href="#SpTemporalReferenceValidator.validate_punctuation-67"><span class="linenos"> 67</span></a>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-68"><a href="#SpTemporalReferenceValidator.validate_punctuation-68"><span class="linenos"> 68</span></a><span class="sd">        Ensures that description fields end with a period (.) as required by</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-69"><a href="#SpTemporalReferenceValidator.validate_punctuation-69"><span class="linenos"> 69</span></a><span class="sd">        the data quality standards.</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-70"><a href="#SpTemporalReferenceValidator.validate_punctuation-70"><span class="linenos"> 70</span></a>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-71"><a href="#SpTemporalReferenceValidator.validate_punctuation-71"><span class="linenos"> 71</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-72"><a href="#SpTemporalReferenceValidator.validate_punctuation-72"><span class="linenos"> 72</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-73"><a href="#SpTemporalReferenceValidator.validate_punctuation-73"><span class="linenos"> 73</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-74"><a href="#SpTemporalReferenceValidator.validate_punctuation-74"><span class="linenos"> 74</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-75"><a href="#SpTemporalReferenceValidator.validate_punctuation-75"><span class="linenos"> 75</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-76"><a href="#SpTemporalReferenceValidator.validate_punctuation-76"><span class="linenos"> 76</span></a><span class="sd">                - List[str]: Warning messages for punctuation violations</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-77"><a href="#SpTemporalReferenceValidator.validate_punctuation-77"><span class="linenos"> 77</span></a>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-78"><a href="#SpTemporalReferenceValidator.validate_punctuation-78"><span class="linenos"> 78</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-79"><a href="#SpTemporalReferenceValidator.validate_punctuation-79"><span class="linenos"> 79</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-80"><a href="#SpTemporalReferenceValidator.validate_punctuation-80"><span class="linenos"> 80</span></a><span class="sd">        Only the description column is validated for ending punctuation.</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-81"><a href="#SpTemporalReferenceValidator.validate_punctuation-81"><span class="linenos"> 81</span></a><span class="sd">        Missing columns generate warnings rather than errors.</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-82"><a href="#SpTemporalReferenceValidator.validate_punctuation-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-83"><a href="#SpTemporalReferenceValidator.validate_punctuation-83"><span class="linenos"> 83</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-84"><a href="#SpTemporalReferenceValidator.validate_punctuation-84"><span class="linenos"> 84</span></a>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-85"><a href="#SpTemporalReferenceValidator.validate_punctuation-85"><span class="linenos"> 85</span></a>        <span class="n">columns_dont_punctuation</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-86"><a href="#SpTemporalReferenceValidator.validate_punctuation-86"><span class="linenos"> 86</span></a>        <span class="n">columns_must_end_with_dot</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-87"><a href="#SpTemporalReferenceValidator.validate_punctuation-87"><span class="linenos"> 87</span></a>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-88"><a href="#SpTemporalReferenceValidator.validate_punctuation-88"><span class="linenos"> 88</span></a>        <span class="n">list_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns_dont_punctuation</span> <span class="o">+</span> <span class="n">columns_must_end_with_dot</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-89"><a href="#SpTemporalReferenceValidator.validate_punctuation-89"><span class="linenos"> 89</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">list_columns</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-90"><a href="#SpTemporalReferenceValidator.validate_punctuation-90"><span class="linenos"> 90</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-91"><a href="#SpTemporalReferenceValidator.validate_punctuation-91"><span class="linenos"> 91</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-92"><a href="#SpTemporalReferenceValidator.validate_punctuation-92"><span class="linenos"> 92</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-93"><a href="#SpTemporalReferenceValidator.validate_punctuation-93"><span class="linenos"> 93</span></a>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-94"><a href="#SpTemporalReferenceValidator.validate_punctuation-94"><span class="linenos"> 94</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">punctuation_warnings</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_characters_punctuation_rules</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-95"><a href="#SpTemporalReferenceValidator.validate_punctuation-95"><span class="linenos"> 95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-96"><a href="#SpTemporalReferenceValidator.validate_punctuation-96"><span class="linenos"> 96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-97"><a href="#SpTemporalReferenceValidator.validate_punctuation-97"><span class="linenos"> 97</span></a>            <span class="n">columns_dont_punctuation</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-98"><a href="#SpTemporalReferenceValidator.validate_punctuation-98"><span class="linenos"> 98</span></a>            <span class="n">columns_must_end_with_dot</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-99"><a href="#SpTemporalReferenceValidator.validate_punctuation-99"><span class="linenos"> 99</span></a>        <span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-100"><a href="#SpTemporalReferenceValidator.validate_punctuation-100"><span class="linenos">100</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">punctuation_warnings</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_punctuation-101"><a href="#SpTemporalReferenceValidator.validate_punctuation-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate punctuation rules for temporal reference descriptions.</p>

<p>Ensures that description fields end with a period (.) as required by
the data quality standards.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors generated)
        - List[str]: Warning messages for punctuation violations</p>

<h2 id="notes">Notes</h2>

<p>Only the description column is validated for ending punctuation.
Missing columns generate warnings rather than errors.</p>
</div>


                            </div>
                            <div id="SpTemporalReferenceValidator.validate_reference_years" class="classattr">
                                        <input id="SpTemporalReferenceValidator.validate_reference_years-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_reference_years</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpTemporalReferenceValidator.validate_reference_years-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpTemporalReferenceValidator.validate_reference_years"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpTemporalReferenceValidator.validate_reference_years-103"><a href="#SpTemporalReferenceValidator.validate_reference_years-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_reference_years</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-104"><a href="#SpTemporalReferenceValidator.validate_reference_years-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-105"><a href="#SpTemporalReferenceValidator.validate_reference_years-105"><span class="linenos">105</span></a><span class="sd">        Validate that reference years are in the future.</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-106"><a href="#SpTemporalReferenceValidator.validate_reference_years-106"><span class="linenos">106</span></a>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-107"><a href="#SpTemporalReferenceValidator.validate_reference_years-107"><span class="linenos">107</span></a><span class="sd">        Checks that all year values in the symbol column (excluding the first row</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-108"><a href="#SpTemporalReferenceValidator.validate_reference_years-108"><span class="linenos">108</span></a><span class="sd">        which represents the current year) are greater than the configured current</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-109"><a href="#SpTemporalReferenceValidator.validate_reference_years-109"><span class="linenos">109</span></a><span class="sd">        year. This ensures temporal references only point to future scenarios.</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-110"><a href="#SpTemporalReferenceValidator.validate_reference_years-110"><span class="linenos">110</span></a>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-111"><a href="#SpTemporalReferenceValidator.validate_reference_years-111"><span class="linenos">111</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-112"><a href="#SpTemporalReferenceValidator.validate_reference_years-112"><span class="linenos">112</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-113"><a href="#SpTemporalReferenceValidator.validate_reference_years-113"><span class="linenos">113</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-114"><a href="#SpTemporalReferenceValidator.validate_reference_years-114"><span class="linenos">114</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-115"><a href="#SpTemporalReferenceValidator.validate_reference_years-115"><span class="linenos">115</span></a><span class="sd">                - List[str]: Error messages for past years in temporal references</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-116"><a href="#SpTemporalReferenceValidator.validate_reference_years-116"><span class="linenos">116</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-117"><a href="#SpTemporalReferenceValidator.validate_reference_years-117"><span class="linenos">117</span></a>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-118"><a href="#SpTemporalReferenceValidator.validate_reference_years-118"><span class="linenos">118</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-119"><a href="#SpTemporalReferenceValidator.validate_reference_years-119"><span class="linenos">119</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-120"><a href="#SpTemporalReferenceValidator.validate_reference_years-120"><span class="linenos">120</span></a><span class="sd">        - First row is excluded from validation (represents current year)</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-121"><a href="#SpTemporalReferenceValidator.validate_reference_years-121"><span class="linenos">121</span></a><span class="sd">        - Years must be greater than config.CURRENT_YEAR</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-122"><a href="#SpTemporalReferenceValidator.validate_reference_years-122"><span class="linenos">122</span></a><span class="sd">        - Missing symbol column returns errors immediately</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-123"><a href="#SpTemporalReferenceValidator.validate_reference_years-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-124"><a href="#SpTemporalReferenceValidator.validate_reference_years-124"><span class="linenos">124</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-125"><a href="#SpTemporalReferenceValidator.validate_reference_years-125"><span class="linenos">125</span></a>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-126"><a href="#SpTemporalReferenceValidator.validate_reference_years-126"><span class="linenos">126</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-127"><a href="#SpTemporalReferenceValidator.validate_reference_years-127"><span class="linenos">127</span></a>            <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-128"><a href="#SpTemporalReferenceValidator.validate_reference_years-128"><span class="linenos">128</span></a>        <span class="p">]</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-129"><a href="#SpTemporalReferenceValidator.validate_reference_years-129"><span class="linenos">129</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-130"><a href="#SpTemporalReferenceValidator.validate_reference_years-130"><span class="linenos">130</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-131"><a href="#SpTemporalReferenceValidator.validate_reference_years-131"><span class="linenos">131</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-132"><a href="#SpTemporalReferenceValidator.validate_reference_years-132"><span class="linenos">132</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-133"><a href="#SpTemporalReferenceValidator.validate_reference_years-133"><span class="linenos">133</span></a>                <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-134"><a href="#SpTemporalReferenceValidator.validate_reference_years-134"><span class="linenos">134</span></a>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-135"><a href="#SpTemporalReferenceValidator.validate_reference_years-135"><span class="linenos">135</span></a>        <span class="c1"># Remove first row: This is actual year</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-136"><a href="#SpTemporalReferenceValidator.validate_reference_years-136"><span class="linenos">136</span></a>        <span class="n">column_series_symbol</span> <span class="o">=</span> <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-137"><a href="#SpTemporalReferenceValidator.validate_reference_years-137"><span class="linenos">137</span></a>        <span class="n">years</span> <span class="o">=</span> <span class="n">column_series_symbol</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-138"><a href="#SpTemporalReferenceValidator.validate_reference_years-138"><span class="linenos">138</span></a>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-139"><a href="#SpTemporalReferenceValidator.validate_reference_years-139"><span class="linenos">139</span></a>        <span class="c1"># Check if all years are greater than the current year</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-140"><a href="#SpTemporalReferenceValidator.validate_reference_years-140"><span class="linenos">140</span></a>        <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-141"><a href="#SpTemporalReferenceValidator.validate_reference_years-141"><span class="linenos">141</span></a>            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">CURRENT_YEAR</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-142"><a href="#SpTemporalReferenceValidator.validate_reference_years-142"><span class="linenos">142</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="si">}</span><span class="s2">: O ano </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2"> no pode estar associado a cenrios por no ser um ano futuro.&quot;</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-143"><a href="#SpTemporalReferenceValidator.validate_reference_years-143"><span class="linenos">143</span></a>
</span><span id="SpTemporalReferenceValidator.validate_reference_years-144"><a href="#SpTemporalReferenceValidator.validate_reference_years-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Validate that reference years are in the future.</p>

<p>Checks that all year values in the symbol column (excluding the first row
which represents the current year) are greater than the configured current
year. This ensures temporal references only point to future scenarios.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for past years in temporal references
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>First row is excluded from validation (represents current year)</li>
<li>Years must be greater than config.CURRENT_YEAR</li>
<li>Missing symbol column returns errors immediately</li>
</ul>
</div>


                            </div>
                            <div id="SpTemporalReferenceValidator.validate_unique_values" class="classattr">
                                        <input id="SpTemporalReferenceValidator.validate_unique_values-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_unique_values</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpTemporalReferenceValidator.validate_unique_values-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpTemporalReferenceValidator.validate_unique_values"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpTemporalReferenceValidator.validate_unique_values-146"><a href="#SpTemporalReferenceValidator.validate_unique_values-146"><span class="linenos">146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-147"><a href="#SpTemporalReferenceValidator.validate_unique_values-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-148"><a href="#SpTemporalReferenceValidator.validate_unique_values-148"><span class="linenos">148</span></a><span class="sd">        Validate uniqueness of name and symbol columns.</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-149"><a href="#SpTemporalReferenceValidator.validate_unique_values-149"><span class="linenos">149</span></a>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-150"><a href="#SpTemporalReferenceValidator.validate_unique_values-150"><span class="linenos">150</span></a><span class="sd">        Ensures that all values in the name and symbol columns are unique across</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-151"><a href="#SpTemporalReferenceValidator.validate_unique_values-151"><span class="linenos">151</span></a><span class="sd">        the entire temporal reference dataset to prevent duplicate temporal references.</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-152"><a href="#SpTemporalReferenceValidator.validate_unique_values-152"><span class="linenos">152</span></a>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-153"><a href="#SpTemporalReferenceValidator.validate_unique_values-153"><span class="linenos">153</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-154"><a href="#SpTemporalReferenceValidator.validate_unique_values-154"><span class="linenos">154</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-155"><a href="#SpTemporalReferenceValidator.validate_unique_values-155"><span class="linenos">155</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-156"><a href="#SpTemporalReferenceValidator.validate_unique_values-156"><span class="linenos">156</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-157"><a href="#SpTemporalReferenceValidator.validate_unique_values-157"><span class="linenos">157</span></a><span class="sd">                - List[str]: Error messages for duplicate values</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-158"><a href="#SpTemporalReferenceValidator.validate_unique_values-158"><span class="linenos">158</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-159"><a href="#SpTemporalReferenceValidator.validate_unique_values-159"><span class="linenos">159</span></a>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-160"><a href="#SpTemporalReferenceValidator.validate_unique_values-160"><span class="linenos">160</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-161"><a href="#SpTemporalReferenceValidator.validate_unique_values-161"><span class="linenos">161</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-162"><a href="#SpTemporalReferenceValidator.validate_unique_values-162"><span class="linenos">162</span></a><span class="sd">        Validates uniqueness for:</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-163"><a href="#SpTemporalReferenceValidator.validate_unique_values-163"><span class="linenos">163</span></a><span class="sd">        - COLUMN_NAME: Temporal reference names must be unique</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-164"><a href="#SpTemporalReferenceValidator.validate_unique_values-164"><span class="linenos">164</span></a><span class="sd">        - COLUMN_SYMBOL: Year symbols must be unique</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-165"><a href="#SpTemporalReferenceValidator.validate_unique_values-165"><span class="linenos">165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-166"><a href="#SpTemporalReferenceValidator.validate_unique_values-166"><span class="linenos">166</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-167"><a href="#SpTemporalReferenceValidator.validate_unique_values-167"><span class="linenos">167</span></a>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-168"><a href="#SpTemporalReferenceValidator.validate_unique_values-168"><span class="linenos">168</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-169"><a href="#SpTemporalReferenceValidator.validate_unique_values-169"><span class="linenos">169</span></a>            <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-170"><a href="#SpTemporalReferenceValidator.validate_unique_values-170"><span class="linenos">170</span></a>            <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-171"><a href="#SpTemporalReferenceValidator.validate_unique_values-171"><span class="linenos">171</span></a>        <span class="p">]</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-172"><a href="#SpTemporalReferenceValidator.validate_unique_values-172"><span class="linenos">172</span></a>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-173"><a href="#SpTemporalReferenceValidator.validate_unique_values-173"><span class="linenos">173</span></a>        <span class="c1"># Check if columns exist</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-174"><a href="#SpTemporalReferenceValidator.validate_unique_values-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-175"><a href="#SpTemporalReferenceValidator.validate_unique_values-175"><span class="linenos">175</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-176"><a href="#SpTemporalReferenceValidator.validate_unique_values-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-177"><a href="#SpTemporalReferenceValidator.validate_unique_values-177"><span class="linenos">177</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-178"><a href="#SpTemporalReferenceValidator.validate_unique_values-178"><span class="linenos">178</span></a>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-179"><a href="#SpTemporalReferenceValidator.validate_unique_values-179"><span class="linenos">179</span></a>        <span class="n">__</span><span class="p">,</span> <span class="n">unique_errors</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">check_dataframe_unique_values</span><span class="p">(</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-180"><a href="#SpTemporalReferenceValidator.validate_unique_values-180"><span class="linenos">180</span></a>            <span class="n">dataframe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-181"><a href="#SpTemporalReferenceValidator.validate_unique_values-181"><span class="linenos">181</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-182"><a href="#SpTemporalReferenceValidator.validate_unique_values-182"><span class="linenos">182</span></a>            <span class="n">columns_uniques</span><span class="o">=</span><span class="n">columns_to_check</span><span class="p">,</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-183"><a href="#SpTemporalReferenceValidator.validate_unique_values-183"><span class="linenos">183</span></a>        <span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-184"><a href="#SpTemporalReferenceValidator.validate_unique_values-184"><span class="linenos">184</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">unique_errors</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-185"><a href="#SpTemporalReferenceValidator.validate_unique_values-185"><span class="linenos">185</span></a>
</span><span id="SpTemporalReferenceValidator.validate_unique_values-186"><a href="#SpTemporalReferenceValidator.validate_unique_values-186"><span class="linenos">186</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Validate uniqueness of name and symbol columns.</p>

<p>Ensures that all values in the name and symbol columns are unique across
the entire temporal reference dataset to prevent duplicate temporal references.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for duplicate values
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<p>Validates uniqueness for:</p>

<ul>
<li>COLUMN_NAME: Temporal reference names must be unique</li>
<li>COLUMN_SYMBOL: Year symbols must be unique</li>
</ul>
</div>


                            </div>
                            <div id="SpTemporalReferenceValidator.run" class="classattr">
                                        <input id="SpTemporalReferenceValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpTemporalReferenceValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpTemporalReferenceValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpTemporalReferenceValidator.run-197"><a href="#SpTemporalReferenceValidator.run-197"><span class="linenos">197</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpTemporalReferenceValidator.run-198"><a href="#SpTemporalReferenceValidator.run-198"><span class="linenos">198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.run-199"><a href="#SpTemporalReferenceValidator.run-199"><span class="linenos">199</span></a><span class="sd">        Execute all temporal reference validations.</span>
</span><span id="SpTemporalReferenceValidator.run-200"><a href="#SpTemporalReferenceValidator.run-200"><span class="linenos">200</span></a>
</span><span id="SpTemporalReferenceValidator.run-201"><a href="#SpTemporalReferenceValidator.run-201"><span class="linenos">201</span></a><span class="sd">        Orchestrates the execution of all temporal reference validators including:</span>
</span><span id="SpTemporalReferenceValidator.run-202"><a href="#SpTemporalReferenceValidator.run-202"><span class="linenos">202</span></a><span class="sd">        - Punctuation validation for descriptions</span>
</span><span id="SpTemporalReferenceValidator.run-203"><a href="#SpTemporalReferenceValidator.run-203"><span class="linenos">203</span></a><span class="sd">        - Reference year validation (future years only)</span>
</span><span id="SpTemporalReferenceValidator.run-204"><a href="#SpTemporalReferenceValidator.run-204"><span class="linenos">204</span></a><span class="sd">        - Unique value validation for names and symbols</span>
</span><span id="SpTemporalReferenceValidator.run-205"><a href="#SpTemporalReferenceValidator.run-205"><span class="linenos">205</span></a>
</span><span id="SpTemporalReferenceValidator.run-206"><a href="#SpTemporalReferenceValidator.run-206"><span class="linenos">206</span></a><span class="sd">        Returns</span>
</span><span id="SpTemporalReferenceValidator.run-207"><a href="#SpTemporalReferenceValidator.run-207"><span class="linenos">207</span></a><span class="sd">        -------</span>
</span><span id="SpTemporalReferenceValidator.run-208"><a href="#SpTemporalReferenceValidator.run-208"><span class="linenos">208</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpTemporalReferenceValidator.run-209"><a href="#SpTemporalReferenceValidator.run-209"><span class="linenos">209</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpTemporalReferenceValidator.run-210"><a href="#SpTemporalReferenceValidator.run-210"><span class="linenos">210</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpTemporalReferenceValidator.run-211"><a href="#SpTemporalReferenceValidator.run-211"><span class="linenos">211</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpTemporalReferenceValidator.run-212"><a href="#SpTemporalReferenceValidator.run-212"><span class="linenos">212</span></a>
</span><span id="SpTemporalReferenceValidator.run-213"><a href="#SpTemporalReferenceValidator.run-213"><span class="linenos">213</span></a><span class="sd">        Notes</span>
</span><span id="SpTemporalReferenceValidator.run-214"><a href="#SpTemporalReferenceValidator.run-214"><span class="linenos">214</span></a><span class="sd">        -----</span>
</span><span id="SpTemporalReferenceValidator.run-215"><a href="#SpTemporalReferenceValidator.run-215"><span class="linenos">215</span></a><span class="sd">        All validations are skipped if the temporal reference dataframe is empty.</span>
</span><span id="SpTemporalReferenceValidator.run-216"><a href="#SpTemporalReferenceValidator.run-216"><span class="linenos">216</span></a><span class="sd">        Results are aggregated into reports via `build_reports()`.</span>
</span><span id="SpTemporalReferenceValidator.run-217"><a href="#SpTemporalReferenceValidator.run-217"><span class="linenos">217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpTemporalReferenceValidator.run-218"><a href="#SpTemporalReferenceValidator.run-218"><span class="linenos">218</span></a>
</span><span id="SpTemporalReferenceValidator.run-219"><a href="#SpTemporalReferenceValidator.run-219"><span class="linenos">219</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpTemporalReferenceValidator.run-220"><a href="#SpTemporalReferenceValidator.run-220"><span class="linenos">220</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_punctuation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">MAND_PUNC_TEMP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpTemporalReferenceValidator.run-221"><a href="#SpTemporalReferenceValidator.run-221"><span class="linenos">221</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_reference_years</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">YEARS_TEMP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpTemporalReferenceValidator.run-222"><a href="#SpTemporalReferenceValidator.run-222"><span class="linenos">222</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UVR_TEMP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpTemporalReferenceValidator.run-223"><a href="#SpTemporalReferenceValidator.run-223"><span class="linenos">223</span></a>        <span class="p">]</span>
</span><span id="SpTemporalReferenceValidator.run-224"><a href="#SpTemporalReferenceValidator.run-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpTemporalReferenceValidator.run-225"><a href="#SpTemporalReferenceValidator.run-225"><span class="linenos">225</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.run-226"><a href="#SpTemporalReferenceValidator.run-226"><span class="linenos">226</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpTemporalReferenceValidator.run-227"><a href="#SpTemporalReferenceValidator.run-227"><span class="linenos">227</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpTemporalReferenceValidator.run-228"><a href="#SpTemporalReferenceValidator.run-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpTemporalReferenceValidator.run-229"><a href="#SpTemporalReferenceValidator.run-229"><span class="linenos">229</span></a>
</span><span id="SpTemporalReferenceValidator.run-230"><a href="#SpTemporalReferenceValidator.run-230"><span class="linenos">230</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all temporal reference validations.</p>

<p>Orchestrates the execution of all temporal reference validators including:</p>

<ul>
<li>Punctuation validation for descriptions</li>
<li>Reference year validation (future years only)</li>
<li>Unique value validation for names and symbols</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<p>All validations are skipped if the temporal reference dataframe is empty.
Results are aggregated into reports via <code><a href="#SpTemporalReferenceValidator.build_reports">build_reports()</a></code>.</p>
</div>


                            </div>
                </section>
                <section id="SpProportionalityValidator">
                            <input id="SpProportionalityValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpProportionalityValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpProportionalityValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator-29"><a href="#SpProportionalityValidator-29"><span class="linenos"> 29</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpProportionalityValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpProportionalityValidator-30"><a href="#SpProportionalityValidator-30"><span class="linenos"> 30</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-31"><a href="#SpProportionalityValidator-31"><span class="linenos"> 31</span></a><span class="sd">    Validates Proportionality spreadsheet content and relationships.</span>
</span><span id="SpProportionalityValidator-32"><a href="#SpProportionalityValidator-32"><span class="linenos"> 32</span></a>
</span><span id="SpProportionalityValidator-33"><a href="#SpProportionalityValidator-33"><span class="linenos"> 33</span></a><span class="sd">    This validator performs comprehensive checks on proportionality data including:</span>
</span><span id="SpProportionalityValidator-34"><a href="#SpProportionalityValidator-34"><span class="linenos"> 34</span></a><span class="sd">    - Indicator relationship validation across multiple models</span>
</span><span id="SpProportionalityValidator-35"><a href="#SpProportionalityValidator-35"><span class="linenos"> 35</span></a><span class="sd">    - Parent-child relationship consistency with composition</span>
</span><span id="SpProportionalityValidator-36"><a href="#SpProportionalityValidator-36"><span class="linenos"> 36</span></a><span class="sd">    - Sum properties validation (proportions must sum to 1.0)</span>
</span><span id="SpProportionalityValidator-37"><a href="#SpProportionalityValidator-37"><span class="linenos"> 37</span></a><span class="sd">    - Duplicate indicator detection</span>
</span><span id="SpProportionalityValidator-38"><a href="#SpProportionalityValidator-38"><span class="linenos"> 38</span></a><span class="sd">    - Value-proportionality relationship validation</span>
</span><span id="SpProportionalityValidator-39"><a href="#SpProportionalityValidator-39"><span class="linenos"> 39</span></a>
</span><span id="SpProportionalityValidator-40"><a href="#SpProportionalityValidator-40"><span class="linenos"> 40</span></a><span class="sd">    Attributes</span>
</span><span id="SpProportionalityValidator-41"><a href="#SpProportionalityValidator-41"><span class="linenos"> 41</span></a><span class="sd">    ----------</span>
</span><span id="SpProportionalityValidator-42"><a href="#SpProportionalityValidator-42"><span class="linenos"> 42</span></a><span class="sd">    model_sp_proportionality : SpProportionality</span>
</span><span id="SpProportionalityValidator-43"><a href="#SpProportionalityValidator-43"><span class="linenos"> 43</span></a><span class="sd">        Proportionality model instance containing proportion data.</span>
</span><span id="SpProportionalityValidator-44"><a href="#SpProportionalityValidator-44"><span class="linenos"> 44</span></a><span class="sd">    model_sp_description : SpDescription</span>
</span><span id="SpProportionalityValidator-45"><a href="#SpProportionalityValidator-45"><span class="linenos"> 45</span></a><span class="sd">        Description model instance containing indicator metadata.</span>
</span><span id="SpProportionalityValidator-46"><a href="#SpProportionalityValidator-46"><span class="linenos"> 46</span></a><span class="sd">    model_sp_value : SpValue</span>
</span><span id="SpProportionalityValidator-47"><a href="#SpProportionalityValidator-47"><span class="linenos"> 47</span></a><span class="sd">        Value model instance containing indicator data.</span>
</span><span id="SpProportionalityValidator-48"><a href="#SpProportionalityValidator-48"><span class="linenos"> 48</span></a><span class="sd">    model_sp_composition : SpComposition</span>
</span><span id="SpProportionalityValidator-49"><a href="#SpProportionalityValidator-49"><span class="linenos"> 49</span></a><span class="sd">        Composition model instance containing parent-child relationships.</span>
</span><span id="SpProportionalityValidator-50"><a href="#SpProportionalityValidator-50"><span class="linenos"> 50</span></a><span class="sd">    exists_scenario : bool</span>
</span><span id="SpProportionalityValidator-51"><a href="#SpProportionalityValidator-51"><span class="linenos"> 51</span></a><span class="sd">        Flag indicating if scenario file exists.</span>
</span><span id="SpProportionalityValidator-52"><a href="#SpProportionalityValidator-52"><span class="linenos"> 52</span></a><span class="sd">    list_scenarios : List[str]</span>
</span><span id="SpProportionalityValidator-53"><a href="#SpProportionalityValidator-53"><span class="linenos"> 53</span></a><span class="sd">        List of available scenario identifiers.</span>
</span><span id="SpProportionalityValidator-54"><a href="#SpProportionalityValidator-54"><span class="linenos"> 54</span></a><span class="sd">    sp_name_proportionality : str</span>
</span><span id="SpProportionalityValidator-55"><a href="#SpProportionalityValidator-55"><span class="linenos"> 55</span></a><span class="sd">        Proportionality spreadsheet filename.</span>
</span><span id="SpProportionalityValidator-56"><a href="#SpProportionalityValidator-56"><span class="linenos"> 56</span></a><span class="sd">    sp_name_description : str</span>
</span><span id="SpProportionalityValidator-57"><a href="#SpProportionalityValidator-57"><span class="linenos"> 57</span></a><span class="sd">        Description spreadsheet filename.</span>
</span><span id="SpProportionalityValidator-58"><a href="#SpProportionalityValidator-58"><span class="linenos"> 58</span></a><span class="sd">    sp_name_value : str</span>
</span><span id="SpProportionalityValidator-59"><a href="#SpProportionalityValidator-59"><span class="linenos"> 59</span></a><span class="sd">        Value spreadsheet filename.</span>
</span><span id="SpProportionalityValidator-60"><a href="#SpProportionalityValidator-60"><span class="linenos"> 60</span></a><span class="sd">    sp_name_composition : str</span>
</span><span id="SpProportionalityValidator-61"><a href="#SpProportionalityValidator-61"><span class="linenos"> 61</span></a><span class="sd">        Composition spreadsheet filename.</span>
</span><span id="SpProportionalityValidator-62"><a href="#SpProportionalityValidator-62"><span class="linenos"> 62</span></a><span class="sd">    column_name_id : str</span>
</span><span id="SpProportionalityValidator-63"><a href="#SpProportionalityValidator-63"><span class="linenos"> 63</span></a><span class="sd">        ID column name used in proportionality and value.</span>
</span><span id="SpProportionalityValidator-64"><a href="#SpProportionalityValidator-64"><span class="linenos"> 64</span></a><span class="sd">    column_name_code : str</span>
</span><span id="SpProportionalityValidator-65"><a href="#SpProportionalityValidator-65"><span class="linenos"> 65</span></a><span class="sd">        Code column name from description.</span>
</span><span id="SpProportionalityValidator-66"><a href="#SpProportionalityValidator-66"><span class="linenos"> 66</span></a><span class="sd">    column_name_level : str</span>
</span><span id="SpProportionalityValidator-67"><a href="#SpProportionalityValidator-67"><span class="linenos"> 67</span></a><span class="sd">        Level column name from description.</span>
</span><span id="SpProportionalityValidator-68"><a href="#SpProportionalityValidator-68"><span class="linenos"> 68</span></a><span class="sd">    column_name_scenario : str</span>
</span><span id="SpProportionalityValidator-69"><a href="#SpProportionalityValidator-69"><span class="linenos"> 69</span></a><span class="sd">        Scenario column name from description.</span>
</span><span id="SpProportionalityValidator-70"><a href="#SpProportionalityValidator-70"><span class="linenos"> 70</span></a><span class="sd">    column_name_parent : str</span>
</span><span id="SpProportionalityValidator-71"><a href="#SpProportionalityValidator-71"><span class="linenos"> 71</span></a><span class="sd">        Parent code column name from composition.</span>
</span><span id="SpProportionalityValidator-72"><a href="#SpProportionalityValidator-72"><span class="linenos"> 72</span></a><span class="sd">    column_name_child : str</span>
</span><span id="SpProportionalityValidator-73"><a href="#SpProportionalityValidator-73"><span class="linenos"> 73</span></a><span class="sd">        Child code column name from composition.</span>
</span><span id="SpProportionalityValidator-74"><a href="#SpProportionalityValidator-74"><span class="linenos"> 74</span></a><span class="sd">    global_required_columns : Dict[str, List[str]]</span>
</span><span id="SpProportionalityValidator-75"><a href="#SpProportionalityValidator-75"><span class="linenos"> 75</span></a><span class="sd">        Required columns mapping for validation.</span>
</span><span id="SpProportionalityValidator-76"><a href="#SpProportionalityValidator-76"><span class="linenos"> 76</span></a><span class="sd">    model_dataframes : Dict[str, DataFrame]</span>
</span><span id="SpProportionalityValidator-77"><a href="#SpProportionalityValidator-77"><span class="linenos"> 77</span></a><span class="sd">        DataFrames mapping for each model.</span>
</span><span id="SpProportionalityValidator-78"><a href="#SpProportionalityValidator-78"><span class="linenos"> 78</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-79"><a href="#SpProportionalityValidator-79"><span class="linenos"> 79</span></a>
</span><span id="SpProportionalityValidator-80"><a href="#SpProportionalityValidator-80"><span class="linenos"> 80</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-81"><a href="#SpProportionalityValidator-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-82"><a href="#SpProportionalityValidator-82"><span class="linenos"> 82</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-83"><a href="#SpProportionalityValidator-83"><span class="linenos"> 83</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-84"><a href="#SpProportionalityValidator-84"><span class="linenos"> 84</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-85"><a href="#SpProportionalityValidator-85"><span class="linenos"> 85</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-86"><a href="#SpProportionalityValidator-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-87"><a href="#SpProportionalityValidator-87"><span class="linenos"> 87</span></a><span class="sd">        Initialize the Proportionality validator.</span>
</span><span id="SpProportionalityValidator-88"><a href="#SpProportionalityValidator-88"><span class="linenos"> 88</span></a>
</span><span id="SpProportionalityValidator-89"><a href="#SpProportionalityValidator-89"><span class="linenos"> 89</span></a><span class="sd">        Args</span>
</span><span id="SpProportionalityValidator-90"><a href="#SpProportionalityValidator-90"><span class="linenos"> 90</span></a><span class="sd">        ----</span>
</span><span id="SpProportionalityValidator-91"><a href="#SpProportionalityValidator-91"><span class="linenos"> 91</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpProportionalityValidator-92"><a href="#SpProportionalityValidator-92"><span class="linenos"> 92</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpProportionalityValidator-93"><a href="#SpProportionalityValidator-93"><span class="linenos"> 93</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpProportionalityValidator-94"><a href="#SpProportionalityValidator-94"><span class="linenos"> 94</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpProportionalityValidator-95"><a href="#SpProportionalityValidator-95"><span class="linenos"> 95</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpProportionalityValidator-96"><a href="#SpProportionalityValidator-96"><span class="linenos"> 96</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpProportionalityValidator-97"><a href="#SpProportionalityValidator-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-98"><a href="#SpProportionalityValidator-98"><span class="linenos"> 98</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-99"><a href="#SpProportionalityValidator-99"><span class="linenos"> 99</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-100"><a href="#SpProportionalityValidator-100"><span class="linenos">100</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-101"><a href="#SpProportionalityValidator-101"><span class="linenos">101</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpProportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-102"><a href="#SpProportionalityValidator-102"><span class="linenos">102</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-103"><a href="#SpProportionalityValidator-103"><span class="linenos">103</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator-104"><a href="#SpProportionalityValidator-104"><span class="linenos">104</span></a>
</span><span id="SpProportionalityValidator-105"><a href="#SpProportionalityValidator-105"><span class="linenos">105</span></a>        <span class="c1"># Configure</span>
</span><span id="SpProportionalityValidator-106"><a href="#SpProportionalityValidator-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpProportionalityValidator-107"><a href="#SpProportionalityValidator-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-108"><a href="#SpProportionalityValidator-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpValue</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-109"><a href="#SpProportionalityValidator-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpComposition</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-110"><a href="#SpProportionalityValidator-110"><span class="linenos">110</span></a>
</span><span id="SpProportionalityValidator-111"><a href="#SpProportionalityValidator-111"><span class="linenos">111</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpProportionalityValidator-112"><a href="#SpProportionalityValidator-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenario_exists_file</span>
</span><span id="SpProportionalityValidator-113"><a href="#SpProportionalityValidator-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenarios_list</span>
</span><span id="SpProportionalityValidator-114"><a href="#SpProportionalityValidator-114"><span class="linenos">114</span></a>
</span><span id="SpProportionalityValidator-115"><a href="#SpProportionalityValidator-115"><span class="linenos">115</span></a>        <span class="c1"># Initialize variables</span>
</span><span id="SpProportionalityValidator-116"><a href="#SpProportionalityValidator-116"><span class="linenos">116</span></a>
</span><span id="SpProportionalityValidator-117"><a href="#SpProportionalityValidator-117"><span class="linenos">117</span></a>        <span class="c1"># Spreadsheet names</span>
</span><span id="SpProportionalityValidator-118"><a href="#SpProportionalityValidator-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-119"><a href="#SpProportionalityValidator-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-120"><a href="#SpProportionalityValidator-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-121"><a href="#SpProportionalityValidator-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-122"><a href="#SpProportionalityValidator-122"><span class="linenos">122</span></a>
</span><span id="SpProportionalityValidator-123"><a href="#SpProportionalityValidator-123"><span class="linenos">123</span></a>        <span class="c1"># Column names used in validations</span>
</span><span id="SpProportionalityValidator-124"><a href="#SpProportionalityValidator-124"><span class="linenos">124</span></a>
</span><span id="SpProportionalityValidator-125"><a href="#SpProportionalityValidator-125"><span class="linenos">125</span></a>        <span class="c1"># Columns in SpProportionality and SpValue</span>
</span><span id="SpProportionalityValidator-126"><a href="#SpProportionalityValidator-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-127"><a href="#SpProportionalityValidator-127"><span class="linenos">127</span></a>
</span><span id="SpProportionalityValidator-128"><a href="#SpProportionalityValidator-128"><span class="linenos">128</span></a>        <span class="c1"># Columns in SpDescription</span>
</span><span id="SpProportionalityValidator-129"><a href="#SpProportionalityValidator-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-130"><a href="#SpProportionalityValidator-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-131"><a href="#SpProportionalityValidator-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_scenario</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-132"><a href="#SpProportionalityValidator-132"><span class="linenos">132</span></a>
</span><span id="SpProportionalityValidator-133"><a href="#SpProportionalityValidator-133"><span class="linenos">133</span></a>        <span class="c1"># Columns in SpComposition</span>
</span><span id="SpProportionalityValidator-134"><a href="#SpProportionalityValidator-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-135"><a href="#SpProportionalityValidator-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator-136"><a href="#SpProportionalityValidator-136"><span class="linenos">136</span></a>
</span><span id="SpProportionalityValidator-137"><a href="#SpProportionalityValidator-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpProportionalityValidator-138"><a href="#SpProportionalityValidator-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpProportionalityValidator-139"><a href="#SpProportionalityValidator-139"><span class="linenos">139</span></a>
</span><span id="SpProportionalityValidator-140"><a href="#SpProportionalityValidator-140"><span class="linenos">140</span></a>        <span class="c1"># Prepare statements</span>
</span><span id="SpProportionalityValidator-141"><a href="#SpProportionalityValidator-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-142"><a href="#SpProportionalityValidator-142"><span class="linenos">142</span></a>
</span><span id="SpProportionalityValidator-143"><a href="#SpProportionalityValidator-143"><span class="linenos">143</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpProportionalityValidator-144"><a href="#SpProportionalityValidator-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-145"><a href="#SpProportionalityValidator-145"><span class="linenos">145</span></a>
</span><span id="SpProportionalityValidator-146"><a href="#SpProportionalityValidator-146"><span class="linenos">146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-147"><a href="#SpProportionalityValidator-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-148"><a href="#SpProportionalityValidator-148"><span class="linenos">148</span></a><span class="sd">        Prepare validation context, column mappings, and dataframe references.</span>
</span><span id="SpProportionalityValidator-149"><a href="#SpProportionalityValidator-149"><span class="linenos">149</span></a>
</span><span id="SpProportionalityValidator-150"><a href="#SpProportionalityValidator-150"><span class="linenos">150</span></a><span class="sd">        Sets up:</span>
</span><span id="SpProportionalityValidator-151"><a href="#SpProportionalityValidator-151"><span class="linenos">151</span></a><span class="sd">        - Spreadsheet names for all models</span>
</span><span id="SpProportionalityValidator-152"><a href="#SpProportionalityValidator-152"><span class="linenos">152</span></a><span class="sd">        - Column name mappings for validation</span>
</span><span id="SpProportionalityValidator-153"><a href="#SpProportionalityValidator-153"><span class="linenos">153</span></a><span class="sd">        - Required columns dictionary</span>
</span><span id="SpProportionalityValidator-154"><a href="#SpProportionalityValidator-154"><span class="linenos">154</span></a><span class="sd">        - DataFrame references for all models</span>
</span><span id="SpProportionalityValidator-155"><a href="#SpProportionalityValidator-155"><span class="linenos">155</span></a>
</span><span id="SpProportionalityValidator-156"><a href="#SpProportionalityValidator-156"><span class="linenos">156</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-157"><a href="#SpProportionalityValidator-157"><span class="linenos">157</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-158"><a href="#SpProportionalityValidator-158"><span class="linenos">158</span></a><span class="sd">        DataFrames are referenced (not copied) to maintain consistency with original data.</span>
</span><span id="SpProportionalityValidator-159"><a href="#SpProportionalityValidator-159"><span class="linenos">159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-160"><a href="#SpProportionalityValidator-160"><span class="linenos">160</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpProportionalityValidator-161"><a href="#SpProportionalityValidator-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpProportionalityValidator-162"><a href="#SpProportionalityValidator-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpProportionalityValidator-163"><a href="#SpProportionalityValidator-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpProportionalityValidator-164"><a href="#SpProportionalityValidator-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpProportionalityValidator-165"><a href="#SpProportionalityValidator-165"><span class="linenos">165</span></a>
</span><span id="SpProportionalityValidator-166"><a href="#SpProportionalityValidator-166"><span class="linenos">166</span></a>        <span class="c1"># Set column names</span>
</span><span id="SpProportionalityValidator-167"><a href="#SpProportionalityValidator-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span> <span class="o">=</span> <span class="n">SpProportionality</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpProportionalityValidator-168"><a href="#SpProportionalityValidator-168"><span class="linenos">168</span></a>
</span><span id="SpProportionalityValidator-169"><a href="#SpProportionalityValidator-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpProportionalityValidator-170"><a href="#SpProportionalityValidator-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpProportionalityValidator-171"><a href="#SpProportionalityValidator-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_scenario</span> <span class="o">=</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_SCENARIO</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpProportionalityValidator-172"><a href="#SpProportionalityValidator-172"><span class="linenos">172</span></a>
</span><span id="SpProportionalityValidator-173"><a href="#SpProportionalityValidator-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span> <span class="o">=</span> <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpProportionalityValidator-174"><a href="#SpProportionalityValidator-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span> <span class="o">=</span> <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpProportionalityValidator-175"><a href="#SpProportionalityValidator-175"><span class="linenos">175</span></a>
</span><span id="SpProportionalityValidator-176"><a href="#SpProportionalityValidator-176"><span class="linenos">176</span></a>        <span class="c1"># Define required columns efficiently</span>
</span><span id="SpProportionalityValidator-177"><a href="#SpProportionalityValidator-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-178"><a href="#SpProportionalityValidator-178"><span class="linenos">178</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="p">[</span><span class="n">SpProportionality</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-179"><a href="#SpProportionalityValidator-179"><span class="linenos">179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpProportionalityValidator-180"><a href="#SpProportionalityValidator-180"><span class="linenos">180</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-181"><a href="#SpProportionalityValidator-181"><span class="linenos">181</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-182"><a href="#SpProportionalityValidator-182"><span class="linenos">182</span></a>            <span class="p">],</span>
</span><span id="SpProportionalityValidator-183"><a href="#SpProportionalityValidator-183"><span class="linenos">183</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="p">[</span><span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-184"><a href="#SpProportionalityValidator-184"><span class="linenos">184</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpProportionalityValidator-185"><a href="#SpProportionalityValidator-185"><span class="linenos">185</span></a>                <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_PARENT_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-186"><a href="#SpProportionalityValidator-186"><span class="linenos">186</span></a>                <span class="n">SpComposition</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CHILD_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-187"><a href="#SpProportionalityValidator-187"><span class="linenos">187</span></a>            <span class="p">],</span>
</span><span id="SpProportionalityValidator-188"><a href="#SpProportionalityValidator-188"><span class="linenos">188</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator-189"><a href="#SpProportionalityValidator-189"><span class="linenos">189</span></a>
</span><span id="SpProportionalityValidator-190"><a href="#SpProportionalityValidator-190"><span class="linenos">190</span></a>        <span class="c1"># Validate all required columns exist</span>
</span><span id="SpProportionalityValidator-191"><a href="#SpProportionalityValidator-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-192"><a href="#SpProportionalityValidator-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-193"><a href="#SpProportionalityValidator-193"><span class="linenos">193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-194"><a href="#SpProportionalityValidator-194"><span class="linenos">194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-195"><a href="#SpProportionalityValidator-195"><span class="linenos">195</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-196"><a href="#SpProportionalityValidator-196"><span class="linenos">196</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator-197"><a href="#SpProportionalityValidator-197"><span class="linenos">197</span></a>
</span><span id="SpProportionalityValidator-198"><a href="#SpProportionalityValidator-198"><span class="linenos">198</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_check_sum_equals_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subdatasets</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">],</span> <span class="n">sp_df_values</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">value_di</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator-199"><a href="#SpProportionalityValidator-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-200"><a href="#SpProportionalityValidator-200"><span class="linenos">200</span></a><span class="sd">        Orchestrate validation that proportions sum to 1.0 for all subdatasets.</span>
</span><span id="SpProportionalityValidator-201"><a href="#SpProportionalityValidator-201"><span class="linenos">201</span></a>
</span><span id="SpProportionalityValidator-202"><a href="#SpProportionalityValidator-202"><span class="linenos">202</span></a><span class="sd">        Performs comprehensive sum validation including:</span>
</span><span id="SpProportionalityValidator-203"><a href="#SpProportionalityValidator-203"><span class="linenos">203</span></a><span class="sd">        - Numeric format validation</span>
</span><span id="SpProportionalityValidator-204"><a href="#SpProportionalityValidator-204"><span class="linenos">204</span></a><span class="sd">        - Excessive decimal detection (&gt;3 decimal places)</span>
</span><span id="SpProportionalityValidator-205"><a href="#SpProportionalityValidator-205"><span class="linenos">205</span></a><span class="sd">        - Decimal conversion with precision truncation</span>
</span><span id="SpProportionalityValidator-206"><a href="#SpProportionalityValidator-206"><span class="linenos">206</span></a><span class="sd">        - Zero sum row identification</span>
</span><span id="SpProportionalityValidator-207"><a href="#SpProportionalityValidator-207"><span class="linenos">207</span></a><span class="sd">        - Sum tolerance validation (must equal 1.0)</span>
</span><span id="SpProportionalityValidator-208"><a href="#SpProportionalityValidator-208"><span class="linenos">208</span></a>
</span><span id="SpProportionalityValidator-209"><a href="#SpProportionalityValidator-209"><span class="linenos">209</span></a><span class="sd">        Args</span>
</span><span id="SpProportionalityValidator-210"><a href="#SpProportionalityValidator-210"><span class="linenos">210</span></a><span class="sd">        ----</span>
</span><span id="SpProportionalityValidator-211"><a href="#SpProportionalityValidator-211"><span class="linenos">211</span></a><span class="sd">        subdatasets : Dict[str, DataFrame]</span>
</span><span id="SpProportionalityValidator-212"><a href="#SpProportionalityValidator-212"><span class="linenos">212</span></a><span class="sd">            Dictionary mapping parent indicators to their child proportion data.</span>
</span><span id="SpProportionalityValidator-213"><a href="#SpProportionalityValidator-213"><span class="linenos">213</span></a><span class="sd">        sp_df_values : DataFrame</span>
</span><span id="SpProportionalityValidator-214"><a href="#SpProportionalityValidator-214"><span class="linenos">214</span></a><span class="sd">            Value dataframe for cross-validation of unavailable data.</span>
</span><span id="SpProportionalityValidator-215"><a href="#SpProportionalityValidator-215"><span class="linenos">215</span></a><span class="sd">        value_di : Any</span>
</span><span id="SpProportionalityValidator-216"><a href="#SpProportionalityValidator-216"><span class="linenos">216</span></a><span class="sd">            Value representing unavailable data (e.g., &quot;Dado indisponvel&quot;).</span>
</span><span id="SpProportionalityValidator-217"><a href="#SpProportionalityValidator-217"><span class="linenos">217</span></a>
</span><span id="SpProportionalityValidator-218"><a href="#SpProportionalityValidator-218"><span class="linenos">218</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator-219"><a href="#SpProportionalityValidator-219"><span class="linenos">219</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator-220"><a href="#SpProportionalityValidator-220"><span class="linenos">220</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator-221"><a href="#SpProportionalityValidator-221"><span class="linenos">221</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator-222"><a href="#SpProportionalityValidator-222"><span class="linenos">222</span></a><span class="sd">                - List[str]: Error messages for invalid sums and format issues</span>
</span><span id="SpProportionalityValidator-223"><a href="#SpProportionalityValidator-223"><span class="linenos">223</span></a><span class="sd">                - List[str]: Warning messages for excessive decimals</span>
</span><span id="SpProportionalityValidator-224"><a href="#SpProportionalityValidator-224"><span class="linenos">224</span></a>
</span><span id="SpProportionalityValidator-225"><a href="#SpProportionalityValidator-225"><span class="linenos">225</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-226"><a href="#SpProportionalityValidator-226"><span class="linenos">226</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-227"><a href="#SpProportionalityValidator-227"><span class="linenos">227</span></a><span class="sd">        - Uses Decimal arithmetic for precise sum calculations</span>
</span><span id="SpProportionalityValidator-228"><a href="#SpProportionalityValidator-228"><span class="linenos">228</span></a><span class="sd">        - Truncates to configured precision (default 3 decimal places)</span>
</span><span id="SpProportionalityValidator-229"><a href="#SpProportionalityValidator-229"><span class="linenos">229</span></a><span class="sd">        - Aggregates excessive decimal warnings across all subdatasets</span>
</span><span id="SpProportionalityValidator-230"><a href="#SpProportionalityValidator-230"><span class="linenos">230</span></a><span class="sd">        - Zero sum rows are errors only if corresponding value data exists</span>
</span><span id="SpProportionalityValidator-231"><a href="#SpProportionalityValidator-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-232"><a href="#SpProportionalityValidator-232"><span class="linenos">232</span></a>        <span class="n">all_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-233"><a href="#SpProportionalityValidator-233"><span class="linenos">233</span></a>        <span class="n">all_warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-234"><a href="#SpProportionalityValidator-234"><span class="linenos">234</span></a>
</span><span id="SpProportionalityValidator-235"><a href="#SpProportionalityValidator-235"><span class="linenos">235</span></a>        <span class="n">global_has_excessive_decimals</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="SpProportionalityValidator-236"><a href="#SpProportionalityValidator-236"><span class="linenos">236</span></a>        <span class="n">global_count_excessive</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="SpProportionalityValidator-237"><a href="#SpProportionalityValidator-237"><span class="linenos">237</span></a>        <span class="n">global_first_line_excessive</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="SpProportionalityValidator-238"><a href="#SpProportionalityValidator-238"><span class="linenos">238</span></a>
</span><span id="SpProportionalityValidator-239"><a href="#SpProportionalityValidator-239"><span class="linenos">239</span></a>        <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PRECISION_DECIMAL_PLACE_TRUNCATE</span>
</span><span id="SpProportionalityValidator-240"><a href="#SpProportionalityValidator-240"><span class="linenos">240</span></a>
</span><span id="SpProportionalityValidator-241"><a href="#SpProportionalityValidator-241"><span class="linenos">241</span></a>        <span class="k">for</span> <span class="n">parent_id</span><span class="p">,</span> <span class="n">subdataset</span> <span class="ow">in</span> <span class="n">subdatasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="SpProportionalityValidator-242"><a href="#SpProportionalityValidator-242"><span class="linenos">242</span></a>            <span class="n">df_data</span> <span class="o">=</span> <span class="n">subdataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-243"><a href="#SpProportionalityValidator-243"><span class="linenos">243</span></a>            <span class="n">ids</span> <span class="o">=</span> <span class="n">subdataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-244"><a href="#SpProportionalityValidator-244"><span class="linenos">244</span></a>
</span><span id="SpProportionalityValidator-245"><a href="#SpProportionalityValidator-245"><span class="linenos">245</span></a>            <span class="c1"># Step 1: Validate numeric format</span>
</span><span id="SpProportionalityValidator-246"><a href="#SpProportionalityValidator-246"><span class="linenos">246</span></a>            <span class="n">is_di</span> <span class="o">=</span> <span class="n">df_data</span> <span class="o">==</span> <span class="n">value_di</span>
</span><span id="SpProportionalityValidator-247"><a href="#SpProportionalityValidator-247"><span class="linenos">247</span></a>            <span class="n">df_data</span><span class="p">,</span> <span class="n">format_errors</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">validate_numeric_format</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-248"><a href="#SpProportionalityValidator-248"><span class="linenos">248</span></a>                <span class="n">df_data</span><span class="p">,</span> <span class="n">is_di</span><span class="p">,</span> <span class="n">value_di</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span>
</span><span id="SpProportionalityValidator-249"><a href="#SpProportionalityValidator-249"><span class="linenos">249</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-250"><a href="#SpProportionalityValidator-250"><span class="linenos">250</span></a>            <span class="n">all_errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">format_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-251"><a href="#SpProportionalityValidator-251"><span class="linenos">251</span></a>
</span><span id="SpProportionalityValidator-252"><a href="#SpProportionalityValidator-252"><span class="linenos">252</span></a>            <span class="c1"># Step 2: Check excessive decimals</span>
</span><span id="SpProportionalityValidator-253"><a href="#SpProportionalityValidator-253"><span class="linenos">253</span></a>            <span class="n">has_excess</span><span class="p">,</span> <span class="n">count_excess</span><span class="p">,</span> <span class="n">first_line</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">check_excessive_decimals</span><span class="p">(</span><span class="n">df_data</span><span class="p">,</span> <span class="n">value_di</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-254"><a href="#SpProportionalityValidator-254"><span class="linenos">254</span></a>
</span><span id="SpProportionalityValidator-255"><a href="#SpProportionalityValidator-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">has_excess</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-256"><a href="#SpProportionalityValidator-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">global_has_excessive_decimals</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-257"><a href="#SpProportionalityValidator-257"><span class="linenos">257</span></a>                    <span class="n">global_first_line_excessive</span> <span class="o">=</span> <span class="n">first_line</span>
</span><span id="SpProportionalityValidator-258"><a href="#SpProportionalityValidator-258"><span class="linenos">258</span></a>                <span class="n">global_has_excessive_decimals</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="SpProportionalityValidator-259"><a href="#SpProportionalityValidator-259"><span class="linenos">259</span></a>                <span class="n">global_count_excessive</span> <span class="o">+=</span> <span class="n">count_excess</span>
</span><span id="SpProportionalityValidator-260"><a href="#SpProportionalityValidator-260"><span class="linenos">260</span></a>
</span><span id="SpProportionalityValidator-261"><a href="#SpProportionalityValidator-261"><span class="linenos">261</span></a>            <span class="c1"># Step 3: Convert to Decimal and sum</span>
</span><span id="SpProportionalityValidator-262"><a href="#SpProportionalityValidator-262"><span class="linenos">262</span></a>            <span class="n">row_sums</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">convert_to_decimal_and_sum</span><span class="p">(</span><span class="n">df_data</span><span class="p">,</span> <span class="n">value_di</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-263"><a href="#SpProportionalityValidator-263"><span class="linenos">263</span></a>
</span><span id="SpProportionalityValidator-264"><a href="#SpProportionalityValidator-264"><span class="linenos">264</span></a>            <span class="c1"># Step 4: Validate zero sum rows</span>
</span><span id="SpProportionalityValidator-265"><a href="#SpProportionalityValidator-265"><span class="linenos">265</span></a>            <span class="n">zero_errors</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">validate_zero_sum_rows</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-266"><a href="#SpProportionalityValidator-266"><span class="linenos">266</span></a>                <span class="n">row_sums</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-267"><a href="#SpProportionalityValidator-267"><span class="linenos">267</span></a>                <span class="n">ids</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-268"><a href="#SpProportionalityValidator-268"><span class="linenos">268</span></a>                <span class="n">df_data</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-269"><a href="#SpProportionalityValidator-269"><span class="linenos">269</span></a>                <span class="n">sp_df_values</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-270"><a href="#SpProportionalityValidator-270"><span class="linenos">270</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-271"><a href="#SpProportionalityValidator-271"><span class="linenos">271</span></a>                <span class="n">value_di</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-272"><a href="#SpProportionalityValidator-272"><span class="linenos">272</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-273"><a href="#SpProportionalityValidator-273"><span class="linenos">273</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-274"><a href="#SpProportionalityValidator-274"><span class="linenos">274</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-275"><a href="#SpProportionalityValidator-275"><span class="linenos">275</span></a>            <span class="n">all_errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">zero_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-276"><a href="#SpProportionalityValidator-276"><span class="linenos">276</span></a>
</span><span id="SpProportionalityValidator-277"><a href="#SpProportionalityValidator-277"><span class="linenos">277</span></a>            <span class="c1"># Step 5: Validate sum tolerance</span>
</span><span id="SpProportionalityValidator-278"><a href="#SpProportionalityValidator-278"><span class="linenos">278</span></a>            <span class="n">tolerance_errors</span><span class="p">,</span> <span class="n">tolerance_warnings</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">validate_sum_tolerance</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-279"><a href="#SpProportionalityValidator-279"><span class="linenos">279</span></a>                <span class="n">row_sums</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-280"><a href="#SpProportionalityValidator-280"><span class="linenos">280</span></a>                <span class="n">parent_id</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-281"><a href="#SpProportionalityValidator-281"><span class="linenos">281</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-282"><a href="#SpProportionalityValidator-282"><span class="linenos">282</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">current_language</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-283"><a href="#SpProportionalityValidator-283"><span class="linenos">283</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-284"><a href="#SpProportionalityValidator-284"><span class="linenos">284</span></a>            <span class="n">all_errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tolerance_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-285"><a href="#SpProportionalityValidator-285"><span class="linenos">285</span></a>            <span class="n">all_warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tolerance_warnings</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-286"><a href="#SpProportionalityValidator-286"><span class="linenos">286</span></a>
</span><span id="SpProportionalityValidator-287"><a href="#SpProportionalityValidator-287"><span class="linenos">287</span></a>        <span class="c1"># Global warning for excessive decimals</span>
</span><span id="SpProportionalityValidator-288"><a href="#SpProportionalityValidator-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="n">global_has_excessive_decimals</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-289"><a href="#SpProportionalityValidator-289"><span class="linenos">289</span></a>            <span class="n">text_existem</span> <span class="o">=</span> <span class="s2">&quot;Existem&quot;</span> <span class="k">if</span> <span class="n">global_count_excessive</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;Existe&quot;</span>
</span><span id="SpProportionalityValidator-290"><a href="#SpProportionalityValidator-290"><span class="linenos">290</span></a>            <span class="n">text_valores</span> <span class="o">=</span> <span class="s2">&quot;valores&quot;</span> <span class="k">if</span> <span class="n">global_count_excessive</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;valor&quot;</span>
</span><span id="SpProportionalityValidator-291"><a href="#SpProportionalityValidator-291"><span class="linenos">291</span></a>            <span class="n">all_warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-292"><a href="#SpProportionalityValidator-292"><span class="linenos">292</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">global_first_line_excessive</span><span class="si">}</span><span class="s2">: &quot;</span>
</span><span id="SpProportionalityValidator-293"><a href="#SpProportionalityValidator-293"><span class="linenos">293</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text_existem</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">global_count_excessive</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">text_valores</span><span class="si">}</span><span class="s2"> com mais de 3 casas decimais, &quot;</span>
</span><span id="SpProportionalityValidator-294"><a href="#SpProportionalityValidator-294"><span class="linenos">294</span></a>                <span class="sa">f</span><span class="s2">&quot;sero consideradas apenas as 3 primeiras casas decimais.&quot;</span>
</span><span id="SpProportionalityValidator-295"><a href="#SpProportionalityValidator-295"><span class="linenos">295</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-296"><a href="#SpProportionalityValidator-296"><span class="linenos">296</span></a>
</span><span id="SpProportionalityValidator-297"><a href="#SpProportionalityValidator-297"><span class="linenos">297</span></a>        <span class="k">return</span> <span class="n">all_errors</span><span class="p">,</span> <span class="n">all_warnings</span>
</span><span id="SpProportionalityValidator-298"><a href="#SpProportionalityValidator-298"><span class="linenos">298</span></a>
</span><span id="SpProportionalityValidator-299"><a href="#SpProportionalityValidator-299"><span class="linenos">299</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_proportionality</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator-300"><a href="#SpProportionalityValidator-300"><span class="linenos">300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-301"><a href="#SpProportionalityValidator-301"><span class="linenos">301</span></a><span class="sd">        Validate indicator relationships between proportionality and description.</span>
</span><span id="SpProportionalityValidator-302"><a href="#SpProportionalityValidator-302"><span class="linenos">302</span></a>
</span><span id="SpProportionalityValidator-303"><a href="#SpProportionalityValidator-303"><span class="linenos">303</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpProportionalityValidator-304"><a href="#SpProportionalityValidator-304"><span class="linenos">304</span></a><span class="sd">        - All indicators in proportionality exist in description</span>
</span><span id="SpProportionalityValidator-305"><a href="#SpProportionalityValidator-305"><span class="linenos">305</span></a><span class="sd">        - All description indicators (except level 1) exist in proportionality</span>
</span><span id="SpProportionalityValidator-306"><a href="#SpProportionalityValidator-306"><span class="linenos">306</span></a><span class="sd">        - MultiIndex column codes are properly extracted and validated</span>
</span><span id="SpProportionalityValidator-307"><a href="#SpProportionalityValidator-307"><span class="linenos">307</span></a><span class="sd">        - Level 1 indicators are excluded from validation</span>
</span><span id="SpProportionalityValidator-308"><a href="#SpProportionalityValidator-308"><span class="linenos">308</span></a>
</span><span id="SpProportionalityValidator-309"><a href="#SpProportionalityValidator-309"><span class="linenos">309</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator-310"><a href="#SpProportionalityValidator-310"><span class="linenos">310</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator-311"><a href="#SpProportionalityValidator-311"><span class="linenos">311</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator-312"><a href="#SpProportionalityValidator-312"><span class="linenos">312</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator-313"><a href="#SpProportionalityValidator-313"><span class="linenos">313</span></a><span class="sd">                - List[str]: Error messages for missing indicators</span>
</span><span id="SpProportionalityValidator-314"><a href="#SpProportionalityValidator-314"><span class="linenos">314</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator-315"><a href="#SpProportionalityValidator-315"><span class="linenos">315</span></a>
</span><span id="SpProportionalityValidator-316"><a href="#SpProportionalityValidator-316"><span class="linenos">316</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-317"><a href="#SpProportionalityValidator-317"><span class="linenos">317</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-318"><a href="#SpProportionalityValidator-318"><span class="linenos">318</span></a><span class="sd">        - Validation is skipped if description dataframe is empty</span>
</span><span id="SpProportionalityValidator-319"><a href="#SpProportionalityValidator-319"><span class="linenos">319</span></a><span class="sd">        - Checks both levels of MultiIndex columns in proportionality</span>
</span><span id="SpProportionalityValidator-320"><a href="#SpProportionalityValidator-320"><span class="linenos">320</span></a><span class="sd">        - Level 1 indicators are automatically excluded from validation</span>
</span><span id="SpProportionalityValidator-321"><a href="#SpProportionalityValidator-321"><span class="linenos">321</span></a><span class="sd">        - Codes are extracted from pattern matching (e.g., &quot;123-scenario&quot;)</span>
</span><span id="SpProportionalityValidator-322"><a href="#SpProportionalityValidator-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-323"><a href="#SpProportionalityValidator-323"><span class="linenos">323</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-324"><a href="#SpProportionalityValidator-324"><span class="linenos">324</span></a>
</span><span id="SpProportionalityValidator-325"><a href="#SpProportionalityValidator-325"><span class="linenos">325</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-326"><a href="#SpProportionalityValidator-326"><span class="linenos">326</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-327"><a href="#SpProportionalityValidator-327"><span class="linenos">327</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator-328"><a href="#SpProportionalityValidator-328"><span class="linenos">328</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator-329"><a href="#SpProportionalityValidator-329"><span class="linenos">329</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-330"><a href="#SpProportionalityValidator-330"><span class="linenos">330</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-331"><a href="#SpProportionalityValidator-331"><span class="linenos">331</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator-332"><a href="#SpProportionalityValidator-332"><span class="linenos">332</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator-333"><a href="#SpProportionalityValidator-333"><span class="linenos">333</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-334"><a href="#SpProportionalityValidator-334"><span class="linenos">334</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-335"><a href="#SpProportionalityValidator-335"><span class="linenos">335</span></a>
</span><span id="SpProportionalityValidator-336"><a href="#SpProportionalityValidator-336"><span class="linenos">336</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator-337"><a href="#SpProportionalityValidator-337"><span class="linenos">337</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-338"><a href="#SpProportionalityValidator-338"><span class="linenos">338</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-339"><a href="#SpProportionalityValidator-339"><span class="linenos">339</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-340"><a href="#SpProportionalityValidator-340"><span class="linenos">340</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator-341"><a href="#SpProportionalityValidator-341"><span class="linenos">341</span></a>
</span><span id="SpProportionalityValidator-342"><a href="#SpProportionalityValidator-342"><span class="linenos">342</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator-343"><a href="#SpProportionalityValidator-343"><span class="linenos">343</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-344"><a href="#SpProportionalityValidator-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-345"><a href="#SpProportionalityValidator-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-346"><a href="#SpProportionalityValidator-346"><span class="linenos">346</span></a>
</span><span id="SpProportionalityValidator-347"><a href="#SpProportionalityValidator-347"><span class="linenos">347</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpProportionalityValidator-348"><a href="#SpProportionalityValidator-348"><span class="linenos">348</span></a>        <span class="n">df_description</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-349"><a href="#SpProportionalityValidator-349"><span class="linenos">349</span></a>        <span class="n">df_proportionality</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-350"><a href="#SpProportionalityValidator-350"><span class="linenos">350</span></a>
</span><span id="SpProportionalityValidator-351"><a href="#SpProportionalityValidator-351"><span class="linenos">351</span></a>        <span class="c1"># Clean integer columns: df_description</span>
</span><span id="SpProportionalityValidator-352"><a href="#SpProportionalityValidator-352"><span class="linenos">352</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-353"><a href="#SpProportionalityValidator-353"><span class="linenos">353</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-354"><a href="#SpProportionalityValidator-354"><span class="linenos">354</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-355"><a href="#SpProportionalityValidator-355"><span class="linenos">355</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-356"><a href="#SpProportionalityValidator-356"><span class="linenos">356</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator-357"><a href="#SpProportionalityValidator-357"><span class="linenos">357</span></a>
</span><span id="SpProportionalityValidator-358"><a href="#SpProportionalityValidator-358"><span class="linenos">358</span></a>        <span class="c1"># List of codes at level 1 to remove</span>
</span><span id="SpProportionalityValidator-359"><a href="#SpProportionalityValidator-359"><span class="linenos">359</span></a>        <span class="n">codes_level_to_remove</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-360"><a href="#SpProportionalityValidator-360"><span class="linenos">360</span></a>        <span class="n">set_valid_codes_description</span> <span class="o">=</span> <span class="n">DescriptionProcessing</span><span class="o">.</span><span class="n">get_valids_codes_from_description</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-361"><a href="#SpProportionalityValidator-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_scenario</span>
</span><span id="SpProportionalityValidator-362"><a href="#SpProportionalityValidator-362"><span class="linenos">362</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator-363"><a href="#SpProportionalityValidator-363"><span class="linenos">363</span></a>
</span><span id="SpProportionalityValidator-364"><a href="#SpProportionalityValidator-364"><span class="linenos">364</span></a>        <span class="c1"># List all codes in proportionality (both levels of MultiIndex)</span>
</span><span id="SpProportionalityValidator-365"><a href="#SpProportionalityValidator-365"><span class="linenos">365</span></a>        <span class="n">level_one_columns</span> <span class="o">=</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-366"><a href="#SpProportionalityValidator-366"><span class="linenos">366</span></a>        <span class="n">level_two_columns</span> <span class="o">=</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-367"><a href="#SpProportionalityValidator-367"><span class="linenos">367</span></a>
</span><span id="SpProportionalityValidator-368"><a href="#SpProportionalityValidator-368"><span class="linenos">368</span></a>        <span class="c1"># Remove ID column from both levels if present</span>
</span><span id="SpProportionalityValidator-369"><a href="#SpProportionalityValidator-369"><span class="linenos">369</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span> <span class="ow">in</span> <span class="n">level_two_columns</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-370"><a href="#SpProportionalityValidator-370"><span class="linenos">370</span></a>            <span class="n">level_two_columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-371"><a href="#SpProportionalityValidator-371"><span class="linenos">371</span></a>
</span><span id="SpProportionalityValidator-372"><a href="#SpProportionalityValidator-372"><span class="linenos">372</span></a>        <span class="c1"># Remove unnamed columns</span>
</span><span id="SpProportionalityValidator-373"><a href="#SpProportionalityValidator-373"><span class="linenos">373</span></a>        <span class="n">level_one_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_one_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator-374"><a href="#SpProportionalityValidator-374"><span class="linenos">374</span></a>        <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator-375"><a href="#SpProportionalityValidator-375"><span class="linenos">375</span></a>
</span><span id="SpProportionalityValidator-376"><a href="#SpProportionalityValidator-376"><span class="linenos">376</span></a>        <span class="c1"># Extract codes from both levels from pattern</span>
</span><span id="SpProportionalityValidator-377"><a href="#SpProportionalityValidator-377"><span class="linenos">377</span></a>        <span class="n">set_valid_codes_prop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-378"><a href="#SpProportionalityValidator-378"><span class="linenos">378</span></a>        <span class="n">level_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">level_one_columns</span><span class="p">,</span> <span class="n">level_two_columns</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-379"><a href="#SpProportionalityValidator-379"><span class="linenos">379</span></a>        <span class="k">for</span> <span class="n">level_column</span> <span class="ow">in</span> <span class="n">level_columns</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-380"><a href="#SpProportionalityValidator-380"><span class="linenos">380</span></a>            <span class="n">codes_matched_by_pattern</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">categorize_strings_by_id_pattern_from_list</span><span class="p">(</span><span class="n">level_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-381"><a href="#SpProportionalityValidator-381"><span class="linenos">381</span></a>            <span class="n">codes_matched_by_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes_matched_by_pattern</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-382"><a href="#SpProportionalityValidator-382"><span class="linenos">382</span></a>            <span class="n">codes_cleaned</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes_matched_by_pattern</span><span class="p">])</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_level_to_remove</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-383"><a href="#SpProportionalityValidator-383"><span class="linenos">383</span></a>
</span><span id="SpProportionalityValidator-384"><a href="#SpProportionalityValidator-384"><span class="linenos">384</span></a>            <span class="c1"># Add to all_codes_proportionalities</span>
</span><span id="SpProportionalityValidator-385"><a href="#SpProportionalityValidator-385"><span class="linenos">385</span></a>            <span class="n">set_valid_codes_prop</span> <span class="o">=</span> <span class="n">set_valid_codes_prop</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">codes_cleaned</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-386"><a href="#SpProportionalityValidator-386"><span class="linenos">386</span></a>
</span><span id="SpProportionalityValidator-387"><a href="#SpProportionalityValidator-387"><span class="linenos">387</span></a>        <span class="c1"># Convert to integers for comparison</span>
</span><span id="SpProportionalityValidator-388"><a href="#SpProportionalityValidator-388"><span class="linenos">388</span></a>        <span class="n">set_valid_codes_description</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">set_valid_codes_description</span><span class="p">])</span>
</span><span id="SpProportionalityValidator-389"><a href="#SpProportionalityValidator-389"><span class="linenos">389</span></a>        <span class="n">set_valid_codes_prop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">set_valid_codes_prop</span><span class="p">)])</span>
</span><span id="SpProportionalityValidator-390"><a href="#SpProportionalityValidator-390"><span class="linenos">390</span></a>
</span><span id="SpProportionalityValidator-391"><a href="#SpProportionalityValidator-391"><span class="linenos">391</span></a>        <span class="c1"># Compare codes between description and proportionality</span>
</span><span id="SpProportionalityValidator-392"><a href="#SpProportionalityValidator-392"><span class="linenos">392</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-393"><a href="#SpProportionalityValidator-393"><span class="linenos">393</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">set_valid_codes_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-394"><a href="#SpProportionalityValidator-394"><span class="linenos">394</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-395"><a href="#SpProportionalityValidator-395"><span class="linenos">395</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">set_valid_codes_prop</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-396"><a href="#SpProportionalityValidator-396"><span class="linenos">396</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-397"><a href="#SpProportionalityValidator-397"><span class="linenos">397</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator-398"><a href="#SpProportionalityValidator-398"><span class="linenos">398</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-399"><a href="#SpProportionalityValidator-399"><span class="linenos">399</span></a>
</span><span id="SpProportionalityValidator-400"><a href="#SpProportionalityValidator-400"><span class="linenos">400</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-401"><a href="#SpProportionalityValidator-401"><span class="linenos">401</span></a>
</span><span id="SpProportionalityValidator-402"><a href="#SpProportionalityValidator-402"><span class="linenos">402</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_columns_repeated_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator-403"><a href="#SpProportionalityValidator-403"><span class="linenos">403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-404"><a href="#SpProportionalityValidator-404"><span class="linenos">404</span></a><span class="sd">        Validate that parent indicators are not duplicated in proportionality.</span>
</span><span id="SpProportionalityValidator-405"><a href="#SpProportionalityValidator-405"><span class="linenos">405</span></a>
</span><span id="SpProportionalityValidator-406"><a href="#SpProportionalityValidator-406"><span class="linenos">406</span></a><span class="sd">        Checks the first level of MultiIndex columns to ensure no parent indicator</span>
</span><span id="SpProportionalityValidator-407"><a href="#SpProportionalityValidator-407"><span class="linenos">407</span></a><span class="sd">        appears more than once in the proportionality spreadsheet structure.</span>
</span><span id="SpProportionalityValidator-408"><a href="#SpProportionalityValidator-408"><span class="linenos">408</span></a>
</span><span id="SpProportionalityValidator-409"><a href="#SpProportionalityValidator-409"><span class="linenos">409</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator-410"><a href="#SpProportionalityValidator-410"><span class="linenos">410</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator-411"><a href="#SpProportionalityValidator-411"><span class="linenos">411</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator-412"><a href="#SpProportionalityValidator-412"><span class="linenos">412</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator-413"><a href="#SpProportionalityValidator-413"><span class="linenos">413</span></a><span class="sd">                - List[str]: Error messages for duplicated parent indicators</span>
</span><span id="SpProportionalityValidator-414"><a href="#SpProportionalityValidator-414"><span class="linenos">414</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator-415"><a href="#SpProportionalityValidator-415"><span class="linenos">415</span></a>
</span><span id="SpProportionalityValidator-416"><a href="#SpProportionalityValidator-416"><span class="linenos">416</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-417"><a href="#SpProportionalityValidator-417"><span class="linenos">417</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-418"><a href="#SpProportionalityValidator-418"><span class="linenos">418</span></a><span class="sd">        - Only checks level 0 of MultiIndex columns (parent indicators)</span>
</span><span id="SpProportionalityValidator-419"><a href="#SpProportionalityValidator-419"><span class="linenos">419</span></a><span class="sd">        - Unnamed columns are automatically excluded</span>
</span><span id="SpProportionalityValidator-420"><a href="#SpProportionalityValidator-420"><span class="linenos">420</span></a><span class="sd">        - Duplicate errors are deduplicated before returning</span>
</span><span id="SpProportionalityValidator-421"><a href="#SpProportionalityValidator-421"><span class="linenos">421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-422"><a href="#SpProportionalityValidator-422"><span class="linenos">422</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-423"><a href="#SpProportionalityValidator-423"><span class="linenos">423</span></a>
</span><span id="SpProportionalityValidator-424"><a href="#SpProportionalityValidator-424"><span class="linenos">424</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-425"><a href="#SpProportionalityValidator-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-426"><a href="#SpProportionalityValidator-426"><span class="linenos">426</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator-427"><a href="#SpProportionalityValidator-427"><span class="linenos">427</span></a>
</span><span id="SpProportionalityValidator-428"><a href="#SpProportionalityValidator-428"><span class="linenos">428</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator-429"><a href="#SpProportionalityValidator-429"><span class="linenos">429</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-430"><a href="#SpProportionalityValidator-430"><span class="linenos">430</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-431"><a href="#SpProportionalityValidator-431"><span class="linenos">431</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-432"><a href="#SpProportionalityValidator-432"><span class="linenos">432</span></a>
</span><span id="SpProportionalityValidator-433"><a href="#SpProportionalityValidator-433"><span class="linenos">433</span></a>        <span class="n">df_proportionalities</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-434"><a href="#SpProportionalityValidator-434"><span class="linenos">434</span></a>
</span><span id="SpProportionalityValidator-435"><a href="#SpProportionalityValidator-435"><span class="linenos">435</span></a>        <span class="c1"># Indicator codes that are at level 1</span>
</span><span id="SpProportionalityValidator-436"><a href="#SpProportionalityValidator-436"><span class="linenos">436</span></a>        <span class="n">level_one_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_proportionalities</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator-437"><a href="#SpProportionalityValidator-437"><span class="linenos">437</span></a>        <span class="n">grouped_columns</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">generate_group_from_list</span><span class="p">(</span><span class="n">level_one_columns</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-438"><a href="#SpProportionalityValidator-438"><span class="linenos">438</span></a>
</span><span id="SpProportionalityValidator-439"><a href="#SpProportionalityValidator-439"><span class="linenos">439</span></a>        <span class="n">unique_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-440"><a href="#SpProportionalityValidator-440"><span class="linenos">440</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_columns</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-441"><a href="#SpProportionalityValidator-441"><span class="linenos">441</span></a>            <span class="n">first_element</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-442"><a href="#SpProportionalityValidator-442"><span class="linenos">442</span></a>            <span class="k">if</span> <span class="n">first_element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_list</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-443"><a href="#SpProportionalityValidator-443"><span class="linenos">443</span></a>                <span class="n">unique_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_element</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-444"><a href="#SpProportionalityValidator-444"><span class="linenos">444</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-445"><a href="#SpProportionalityValidator-445"><span class="linenos">445</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: O indicador pai &#39;</span><span class="si">{</span><span class="n">first_element</span><span class="si">}</span><span class="s2">&#39; est repetido na planilha.&quot;</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-446"><a href="#SpProportionalityValidator-446"><span class="linenos">446</span></a>
</span><span id="SpProportionalityValidator-447"><a href="#SpProportionalityValidator-447"><span class="linenos">447</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
</span><span id="SpProportionalityValidator-448"><a href="#SpProportionalityValidator-448"><span class="linenos">448</span></a>
</span><span id="SpProportionalityValidator-449"><a href="#SpProportionalityValidator-449"><span class="linenos">449</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-450"><a href="#SpProportionalityValidator-450"><span class="linenos">450</span></a>
</span><span id="SpProportionalityValidator-451"><a href="#SpProportionalityValidator-451"><span class="linenos">451</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_value_and_proportionality</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator-452"><a href="#SpProportionalityValidator-452"><span class="linenos">452</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-453"><a href="#SpProportionalityValidator-453"><span class="linenos">453</span></a><span class="sd">        Validate indicator consistency between value and proportionality spreadsheets.</span>
</span><span id="SpProportionalityValidator-454"><a href="#SpProportionalityValidator-454"><span class="linenos">454</span></a>
</span><span id="SpProportionalityValidator-455"><a href="#SpProportionalityValidator-455"><span class="linenos">455</span></a><span class="sd">        Ensures that all indicators present in proportionality (both parent and child</span>
</span><span id="SpProportionalityValidator-456"><a href="#SpProportionalityValidator-456"><span class="linenos">456</span></a><span class="sd">        levels) also exist in the value spreadsheet, and vice versa.</span>
</span><span id="SpProportionalityValidator-457"><a href="#SpProportionalityValidator-457"><span class="linenos">457</span></a>
</span><span id="SpProportionalityValidator-458"><a href="#SpProportionalityValidator-458"><span class="linenos">458</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator-459"><a href="#SpProportionalityValidator-459"><span class="linenos">459</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator-460"><a href="#SpProportionalityValidator-460"><span class="linenos">460</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator-461"><a href="#SpProportionalityValidator-461"><span class="linenos">461</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator-462"><a href="#SpProportionalityValidator-462"><span class="linenos">462</span></a><span class="sd">                - List[str]: Error messages for indicator mismatches</span>
</span><span id="SpProportionalityValidator-463"><a href="#SpProportionalityValidator-463"><span class="linenos">463</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator-464"><a href="#SpProportionalityValidator-464"><span class="linenos">464</span></a>
</span><span id="SpProportionalityValidator-465"><a href="#SpProportionalityValidator-465"><span class="linenos">465</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-466"><a href="#SpProportionalityValidator-466"><span class="linenos">466</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-467"><a href="#SpProportionalityValidator-467"><span class="linenos">467</span></a><span class="sd">        - Validation is skipped if value dataframe is empty</span>
</span><span id="SpProportionalityValidator-468"><a href="#SpProportionalityValidator-468"><span class="linenos">468</span></a><span class="sd">        - Checks both levels of MultiIndex in proportionality</span>
</span><span id="SpProportionalityValidator-469"><a href="#SpProportionalityValidator-469"><span class="linenos">469</span></a><span class="sd">        - ID columns are automatically excluded from comparison</span>
</span><span id="SpProportionalityValidator-470"><a href="#SpProportionalityValidator-470"><span class="linenos">470</span></a><span class="sd">        - Reports indicators missing in either spreadsheet</span>
</span><span id="SpProportionalityValidator-471"><a href="#SpProportionalityValidator-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-472"><a href="#SpProportionalityValidator-472"><span class="linenos">472</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-473"><a href="#SpProportionalityValidator-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-474"><a href="#SpProportionalityValidator-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-475"><a href="#SpProportionalityValidator-475"><span class="linenos">475</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator-476"><a href="#SpProportionalityValidator-476"><span class="linenos">476</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator-477"><a href="#SpProportionalityValidator-477"><span class="linenos">477</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_value_and_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-478"><a href="#SpProportionalityValidator-478"><span class="linenos">478</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IND_VAL_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-479"><a href="#SpProportionalityValidator-479"><span class="linenos">479</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator-480"><a href="#SpProportionalityValidator-480"><span class="linenos">480</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator-481"><a href="#SpProportionalityValidator-481"><span class="linenos">481</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-482"><a href="#SpProportionalityValidator-482"><span class="linenos">482</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-483"><a href="#SpProportionalityValidator-483"><span class="linenos">483</span></a>
</span><span id="SpProportionalityValidator-484"><a href="#SpProportionalityValidator-484"><span class="linenos">484</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator-485"><a href="#SpProportionalityValidator-485"><span class="linenos">485</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-486"><a href="#SpProportionalityValidator-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-487"><a href="#SpProportionalityValidator-487"><span class="linenos">487</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-488"><a href="#SpProportionalityValidator-488"><span class="linenos">488</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator-489"><a href="#SpProportionalityValidator-489"><span class="linenos">489</span></a>
</span><span id="SpProportionalityValidator-490"><a href="#SpProportionalityValidator-490"><span class="linenos">490</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator-491"><a href="#SpProportionalityValidator-491"><span class="linenos">491</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-492"><a href="#SpProportionalityValidator-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-493"><a href="#SpProportionalityValidator-493"><span class="linenos">493</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-494"><a href="#SpProportionalityValidator-494"><span class="linenos">494</span></a>
</span><span id="SpProportionalityValidator-495"><a href="#SpProportionalityValidator-495"><span class="linenos">495</span></a>        <span class="n">df_proportionalities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-496"><a href="#SpProportionalityValidator-496"><span class="linenos">496</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-497"><a href="#SpProportionalityValidator-497"><span class="linenos">497</span></a>
</span><span id="SpProportionalityValidator-498"><a href="#SpProportionalityValidator-498"><span class="linenos">498</span></a>        <span class="c1"># Get all codes in proportionality (both levels of MultiIndex)</span>
</span><span id="SpProportionalityValidator-499"><a href="#SpProportionalityValidator-499"><span class="linenos">499</span></a>
</span><span id="SpProportionalityValidator-500"><a href="#SpProportionalityValidator-500"><span class="linenos">500</span></a>        <span class="c1"># Get all columns in level 1</span>
</span><span id="SpProportionalityValidator-501"><a href="#SpProportionalityValidator-501"><span class="linenos">501</span></a>        <span class="n">columns_level_one_prop</span> <span class="o">=</span> <span class="n">df_proportionalities</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-502"><a href="#SpProportionalityValidator-502"><span class="linenos">502</span></a>        <span class="n">columns_level_one_prop</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_level_one_prop</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;unnamed: 0_level_0&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator-503"><a href="#SpProportionalityValidator-503"><span class="linenos">503</span></a>
</span><span id="SpProportionalityValidator-504"><a href="#SpProportionalityValidator-504"><span class="linenos">504</span></a>        <span class="c1"># Get all columns in level 2</span>
</span><span id="SpProportionalityValidator-505"><a href="#SpProportionalityValidator-505"><span class="linenos">505</span></a>        <span class="n">columns_level_two_prop</span> <span class="o">=</span> <span class="n">df_proportionalities</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-506"><a href="#SpProportionalityValidator-506"><span class="linenos">506</span></a>        <span class="n">columns_level_two_prop</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-507"><a href="#SpProportionalityValidator-507"><span class="linenos">507</span></a>
</span><span id="SpProportionalityValidator-508"><a href="#SpProportionalityValidator-508"><span class="linenos">508</span></a>        <span class="c1"># Create a set with all codes in both levels</span>
</span><span id="SpProportionalityValidator-509"><a href="#SpProportionalityValidator-509"><span class="linenos">509</span></a>        <span class="n">set_all_columns_prop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns_level_one_prop</span> <span class="o">+</span> <span class="n">columns_level_two_prop</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-510"><a href="#SpProportionalityValidator-510"><span class="linenos">510</span></a>
</span><span id="SpProportionalityValidator-511"><a href="#SpProportionalityValidator-511"><span class="linenos">511</span></a>        <span class="c1"># Get all codes in values</span>
</span><span id="SpProportionalityValidator-512"><a href="#SpProportionalityValidator-512"><span class="linenos">512</span></a>        <span class="n">columns_values</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-513"><a href="#SpProportionalityValidator-513"><span class="linenos">513</span></a>        <span class="n">columns_values</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-514"><a href="#SpProportionalityValidator-514"><span class="linenos">514</span></a>        <span class="n">set_all_columns_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns_values</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-515"><a href="#SpProportionalityValidator-515"><span class="linenos">515</span></a>
</span><span id="SpProportionalityValidator-516"><a href="#SpProportionalityValidator-516"><span class="linenos">516</span></a>        <span class="c1"># Compare codes between description and proportionality</span>
</span><span id="SpProportionalityValidator-517"><a href="#SpProportionalityValidator-517"><span class="linenos">517</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-518"><a href="#SpProportionalityValidator-518"><span class="linenos">518</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">set_all_columns_prop</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-519"><a href="#SpProportionalityValidator-519"><span class="linenos">519</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-520"><a href="#SpProportionalityValidator-520"><span class="linenos">520</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">set_all_columns_values</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-521"><a href="#SpProportionalityValidator-521"><span class="linenos">521</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-522"><a href="#SpProportionalityValidator-522"><span class="linenos">522</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator-523"><a href="#SpProportionalityValidator-523"><span class="linenos">523</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-524"><a href="#SpProportionalityValidator-524"><span class="linenos">524</span></a>
</span><span id="SpProportionalityValidator-525"><a href="#SpProportionalityValidator-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-526"><a href="#SpProportionalityValidator-526"><span class="linenos">526</span></a>
</span><span id="SpProportionalityValidator-527"><a href="#SpProportionalityValidator-527"><span class="linenos">527</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_parent_child_relationships</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator-528"><a href="#SpProportionalityValidator-528"><span class="linenos">528</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-529"><a href="#SpProportionalityValidator-529"><span class="linenos">529</span></a><span class="sd">        Validate parent-child relationships against composition definitions.</span>
</span><span id="SpProportionalityValidator-530"><a href="#SpProportionalityValidator-530"><span class="linenos">530</span></a>
</span><span id="SpProportionalityValidator-531"><a href="#SpProportionalityValidator-531"><span class="linenos">531</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpProportionalityValidator-532"><a href="#SpProportionalityValidator-532"><span class="linenos">532</span></a><span class="sd">        - All parent indicators in proportionality exist in composition</span>
</span><span id="SpProportionalityValidator-533"><a href="#SpProportionalityValidator-533"><span class="linenos">533</span></a><span class="sd">        - All children listed under a parent match composition relationships</span>
</span><span id="SpProportionalityValidator-534"><a href="#SpProportionalityValidator-534"><span class="linenos">534</span></a><span class="sd">        - All composition children are present in proportionality subdatasets</span>
</span><span id="SpProportionalityValidator-535"><a href="#SpProportionalityValidator-535"><span class="linenos">535</span></a><span class="sd">        - Relationships are consistent with composition hierarchy</span>
</span><span id="SpProportionalityValidator-536"><a href="#SpProportionalityValidator-536"><span class="linenos">536</span></a>
</span><span id="SpProportionalityValidator-537"><a href="#SpProportionalityValidator-537"><span class="linenos">537</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator-538"><a href="#SpProportionalityValidator-538"><span class="linenos">538</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator-539"><a href="#SpProportionalityValidator-539"><span class="linenos">539</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator-540"><a href="#SpProportionalityValidator-540"><span class="linenos">540</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator-541"><a href="#SpProportionalityValidator-541"><span class="linenos">541</span></a><span class="sd">                - List[str]: Error messages for relationship inconsistencies</span>
</span><span id="SpProportionalityValidator-542"><a href="#SpProportionalityValidator-542"><span class="linenos">542</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator-543"><a href="#SpProportionalityValidator-543"><span class="linenos">543</span></a>
</span><span id="SpProportionalityValidator-544"><a href="#SpProportionalityValidator-544"><span class="linenos">544</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-545"><a href="#SpProportionalityValidator-545"><span class="linenos">545</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-546"><a href="#SpProportionalityValidator-546"><span class="linenos">546</span></a><span class="sd">        - Validation is skipped if composition dataframe is empty</span>
</span><span id="SpProportionalityValidator-547"><a href="#SpProportionalityValidator-547"><span class="linenos">547</span></a><span class="sd">        - Level 1 parents are automatically excluded from validation</span>
</span><span id="SpProportionalityValidator-548"><a href="#SpProportionalityValidator-548"><span class="linenos">548</span></a><span class="sd">        - Compares cleaned indicator codes (without scenario suffixes)</span>
</span><span id="SpProportionalityValidator-549"><a href="#SpProportionalityValidator-549"><span class="linenos">549</span></a><span class="sd">        - Bidirectional validation ensures complete consistency</span>
</span><span id="SpProportionalityValidator-550"><a href="#SpProportionalityValidator-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-551"><a href="#SpProportionalityValidator-551"><span class="linenos">551</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-552"><a href="#SpProportionalityValidator-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-553"><a href="#SpProportionalityValidator-553"><span class="linenos">553</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-554"><a href="#SpProportionalityValidator-554"><span class="linenos">554</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator-555"><a href="#SpProportionalityValidator-555"><span class="linenos">555</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator-556"><a href="#SpProportionalityValidator-556"><span class="linenos">556</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_parent_child_relationships</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-557"><a href="#SpProportionalityValidator-557"><span class="linenos">557</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IND_VAL_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-558"><a href="#SpProportionalityValidator-558"><span class="linenos">558</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator-559"><a href="#SpProportionalityValidator-559"><span class="linenos">559</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator-560"><a href="#SpProportionalityValidator-560"><span class="linenos">560</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-561"><a href="#SpProportionalityValidator-561"><span class="linenos">561</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-562"><a href="#SpProportionalityValidator-562"><span class="linenos">562</span></a>
</span><span id="SpProportionalityValidator-563"><a href="#SpProportionalityValidator-563"><span class="linenos">563</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator-564"><a href="#SpProportionalityValidator-564"><span class="linenos">564</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-565"><a href="#SpProportionalityValidator-565"><span class="linenos">565</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-566"><a href="#SpProportionalityValidator-566"><span class="linenos">566</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-567"><a href="#SpProportionalityValidator-567"><span class="linenos">567</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator-568"><a href="#SpProportionalityValidator-568"><span class="linenos">568</span></a>
</span><span id="SpProportionalityValidator-569"><a href="#SpProportionalityValidator-569"><span class="linenos">569</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator-570"><a href="#SpProportionalityValidator-570"><span class="linenos">570</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-571"><a href="#SpProportionalityValidator-571"><span class="linenos">571</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-572"><a href="#SpProportionalityValidator-572"><span class="linenos">572</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-573"><a href="#SpProportionalityValidator-573"><span class="linenos">573</span></a>
</span><span id="SpProportionalityValidator-574"><a href="#SpProportionalityValidator-574"><span class="linenos">574</span></a>        <span class="c1"># Setup dataframes</span>
</span><span id="SpProportionalityValidator-575"><a href="#SpProportionalityValidator-575"><span class="linenos">575</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-576"><a href="#SpProportionalityValidator-576"><span class="linenos">576</span></a>
</span><span id="SpProportionalityValidator-577"><a href="#SpProportionalityValidator-577"><span class="linenos">577</span></a>        <span class="c1"># Build subdatasets</span>
</span><span id="SpProportionalityValidator-578"><a href="#SpProportionalityValidator-578"><span class="linenos">578</span></a>        <span class="n">subdatasets</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">build_subdatasets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-579"><a href="#SpProportionalityValidator-579"><span class="linenos">579</span></a>
</span><span id="SpProportionalityValidator-580"><a href="#SpProportionalityValidator-580"><span class="linenos">580</span></a>        <span class="c1"># Filter composition to remove level 1 parents</span>
</span><span id="SpProportionalityValidator-581"><a href="#SpProportionalityValidator-581"><span class="linenos">581</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="n">df_composition</span><span class="p">[</span><span class="n">df_composition</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-582"><a href="#SpProportionalityValidator-582"><span class="linenos">582</span></a>
</span><span id="SpProportionalityValidator-583"><a href="#SpProportionalityValidator-583"><span class="linenos">583</span></a>        <span class="n">dict_grouped_composition</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpProportionalityValidator-584"><a href="#SpProportionalityValidator-584"><span class="linenos">584</span></a>        <span class="k">for</span> <span class="n">__</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_composition</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpProportionalityValidator-585"><a href="#SpProportionalityValidator-585"><span class="linenos">585</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-586"><a href="#SpProportionalityValidator-586"><span class="linenos">586</span></a>            <span class="n">child</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-587"><a href="#SpProportionalityValidator-587"><span class="linenos">587</span></a>
</span><span id="SpProportionalityValidator-588"><a href="#SpProportionalityValidator-588"><span class="linenos">588</span></a>            <span class="k">if</span> <span class="n">parent</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-589"><a href="#SpProportionalityValidator-589"><span class="linenos">589</span></a>                <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-590"><a href="#SpProportionalityValidator-590"><span class="linenos">590</span></a>
</span><span id="SpProportionalityValidator-591"><a href="#SpProportionalityValidator-591"><span class="linenos">591</span></a>            <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-592"><a href="#SpProportionalityValidator-592"><span class="linenos">592</span></a>
</span><span id="SpProportionalityValidator-593"><a href="#SpProportionalityValidator-593"><span class="linenos">593</span></a>        <span class="k">for</span> <span class="n">parent_id</span><span class="p">,</span> <span class="n">subdataset</span> <span class="ow">in</span> <span class="n">subdatasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="SpProportionalityValidator-594"><a href="#SpProportionalityValidator-594"><span class="linenos">594</span></a>
</span><span id="SpProportionalityValidator-595"><a href="#SpProportionalityValidator-595"><span class="linenos">595</span></a>            <span class="n">cleaned_parent_id</span> <span class="o">=</span> <span class="n">parent_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-596"><a href="#SpProportionalityValidator-596"><span class="linenos">596</span></a>
</span><span id="SpProportionalityValidator-597"><a href="#SpProportionalityValidator-597"><span class="linenos">597</span></a>            <span class="k">if</span> <span class="n">cleaned_parent_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SpProportionalityValidator-598"><a href="#SpProportionalityValidator-598"><span class="linenos">598</span></a>                <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parent_id</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-599"><a href="#SpProportionalityValidator-599"><span class="linenos">599</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-600"><a href="#SpProportionalityValidator-600"><span class="linenos">600</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: O indicador pai &#39;</span><span class="si">{</span><span class="n">cleaned_parent_id</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">parent_id</span><span class="si">}</span><span class="s2">&#39;) no est presente na coluna &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="si">}</span><span class="s2">&#39; da planilha </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpProportionalityValidator-601"><a href="#SpProportionalityValidator-601"><span class="linenos">601</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator-602"><a href="#SpProportionalityValidator-602"><span class="linenos">602</span></a>                <span class="k">continue</span>
</span><span id="SpProportionalityValidator-603"><a href="#SpProportionalityValidator-603"><span class="linenos">603</span></a>
</span><span id="SpProportionalityValidator-604"><a href="#SpProportionalityValidator-604"><span class="linenos">604</span></a>            <span class="n">children_codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">subdataset</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator-605"><a href="#SpProportionalityValidator-605"><span class="linenos">605</span></a>            <span class="n">children_codes_cleaned</span> <span class="o">=</span> <span class="p">[</span><span class="n">filho</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">filho</span> <span class="ow">in</span> <span class="n">children_codes</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-606"><a href="#SpProportionalityValidator-606"><span class="linenos">606</span></a>
</span><span id="SpProportionalityValidator-607"><a href="#SpProportionalityValidator-607"><span class="linenos">607</span></a>            <span class="n">dict_children_codes_cleaned</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-608"><a href="#SpProportionalityValidator-608"><span class="linenos">608</span></a>            <span class="n">dict_children_codes_cleaned</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">cleaned_parent_id</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">children_codes_cleaned</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-609"><a href="#SpProportionalityValidator-609"><span class="linenos">609</span></a>
</span><span id="SpProportionalityValidator-610"><a href="#SpProportionalityValidator-610"><span class="linenos">610</span></a>            <span class="n">set_errors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-611"><a href="#SpProportionalityValidator-611"><span class="linenos">611</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: O indicador &#39;</span><span class="si">{</span><span class="n">filho</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">filho_orig</span><span class="si">}</span><span class="s2">&#39;) no  filho do indicador &#39;</span><span class="si">{</span><span class="n">cleaned_parent_id</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">parent_id</span><span class="si">}</span><span class="s2">&#39;) conforme especificado em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpProportionalityValidator-612"><a href="#SpProportionalityValidator-612"><span class="linenos">612</span></a>                <span class="k">for</span> <span class="n">filho</span><span class="p">,</span> <span class="n">filho_orig</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">children_codes_cleaned</span><span class="p">,</span> <span class="n">children_codes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-613"><a href="#SpProportionalityValidator-613"><span class="linenos">613</span></a>                <span class="k">if</span> <span class="n">filho</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">cleaned_parent_id</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-614"><a href="#SpProportionalityValidator-614"><span class="linenos">614</span></a>            <span class="p">}</span>
</span><span id="SpProportionalityValidator-615"><a href="#SpProportionalityValidator-615"><span class="linenos">615</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">set_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-616"><a href="#SpProportionalityValidator-616"><span class="linenos">616</span></a>
</span><span id="SpProportionalityValidator-617"><a href="#SpProportionalityValidator-617"><span class="linenos">617</span></a>            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">cleaned_parent_id</span><span class="p">]:</span>
</span><span id="SpProportionalityValidator-618"><a href="#SpProportionalityValidator-618"><span class="linenos">618</span></a>                <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_children_codes_cleaned</span><span class="p">[</span><span class="n">cleaned_parent_id</span><span class="p">]:</span>
</span><span id="SpProportionalityValidator-619"><a href="#SpProportionalityValidator-619"><span class="linenos">619</span></a>                    <span class="n">code_pai_local</span> <span class="o">=</span> <span class="n">parent_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpProportionalityValidator-620"><a href="#SpProportionalityValidator-620"><span class="linenos">620</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-621"><a href="#SpProportionalityValidator-621"><span class="linenos">621</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: Deve existir pelo menos uma relao do indicador filho &#39;</span><span class="si">{</span><span class="n">child</span><span class="si">}</span><span class="s2">&#39; com o indicador pai &#39;</span><span class="si">{</span><span class="n">code_pai_local</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">parent_id</span><span class="si">}</span><span class="s2">&#39;) conforme especificado em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpProportionalityValidator-622"><a href="#SpProportionalityValidator-622"><span class="linenos">622</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator-623"><a href="#SpProportionalityValidator-623"><span class="linenos">623</span></a>
</span><span id="SpProportionalityValidator-624"><a href="#SpProportionalityValidator-624"><span class="linenos">624</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
</span><span id="SpProportionalityValidator-625"><a href="#SpProportionalityValidator-625"><span class="linenos">625</span></a>
</span><span id="SpProportionalityValidator-626"><a href="#SpProportionalityValidator-626"><span class="linenos">626</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-627"><a href="#SpProportionalityValidator-627"><span class="linenos">627</span></a>
</span><span id="SpProportionalityValidator-628"><a href="#SpProportionalityValidator-628"><span class="linenos">628</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_sum_properties_in_influencing_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator-629"><a href="#SpProportionalityValidator-629"><span class="linenos">629</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-630"><a href="#SpProportionalityValidator-630"><span class="linenos">630</span></a><span class="sd">        Validate that proportion sums equal 1.0 for all influencing factor subdatasets.</span>
</span><span id="SpProportionalityValidator-631"><a href="#SpProportionalityValidator-631"><span class="linenos">631</span></a>
</span><span id="SpProportionalityValidator-632"><a href="#SpProportionalityValidator-632"><span class="linenos">632</span></a><span class="sd">        Performs comprehensive sum validation by:</span>
</span><span id="SpProportionalityValidator-633"><a href="#SpProportionalityValidator-633"><span class="linenos">633</span></a><span class="sd">        - Building subdatasets for each parent indicator</span>
</span><span id="SpProportionalityValidator-634"><a href="#SpProportionalityValidator-634"><span class="linenos">634</span></a><span class="sd">        - Validating numeric format of proportion values</span>
</span><span id="SpProportionalityValidator-635"><a href="#SpProportionalityValidator-635"><span class="linenos">635</span></a><span class="sd">        - Checking that proportions sum to exactly 1.0 (with tolerance)</span>
</span><span id="SpProportionalityValidator-636"><a href="#SpProportionalityValidator-636"><span class="linenos">636</span></a><span class="sd">        - Identifying excessive decimal places</span>
</span><span id="SpProportionalityValidator-637"><a href="#SpProportionalityValidator-637"><span class="linenos">637</span></a><span class="sd">        - Cross-validating with value spreadsheet for unavailable data</span>
</span><span id="SpProportionalityValidator-638"><a href="#SpProportionalityValidator-638"><span class="linenos">638</span></a>
</span><span id="SpProportionalityValidator-639"><a href="#SpProportionalityValidator-639"><span class="linenos">639</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator-640"><a href="#SpProportionalityValidator-640"><span class="linenos">640</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator-641"><a href="#SpProportionalityValidator-641"><span class="linenos">641</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator-642"><a href="#SpProportionalityValidator-642"><span class="linenos">642</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator-643"><a href="#SpProportionalityValidator-643"><span class="linenos">643</span></a><span class="sd">                - List[str]: Error messages for sum violations and format issues</span>
</span><span id="SpProportionalityValidator-644"><a href="#SpProportionalityValidator-644"><span class="linenos">644</span></a><span class="sd">                - List[str]: Warning messages for excessive decimals</span>
</span><span id="SpProportionalityValidator-645"><a href="#SpProportionalityValidator-645"><span class="linenos">645</span></a>
</span><span id="SpProportionalityValidator-646"><a href="#SpProportionalityValidator-646"><span class="linenos">646</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-647"><a href="#SpProportionalityValidator-647"><span class="linenos">647</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-648"><a href="#SpProportionalityValidator-648"><span class="linenos">648</span></a><span class="sd">        - Validation is skipped if value dataframe is empty</span>
</span><span id="SpProportionalityValidator-649"><a href="#SpProportionalityValidator-649"><span class="linenos">649</span></a><span class="sd">        - Uses Decimal arithmetic for precise calculations</span>
</span><span id="SpProportionalityValidator-650"><a href="#SpProportionalityValidator-650"><span class="linenos">650</span></a><span class="sd">        - Tolerance for sum validation is configurable</span>
</span><span id="SpProportionalityValidator-651"><a href="#SpProportionalityValidator-651"><span class="linenos">651</span></a><span class="sd">        - Unavailable data markers are excluded from sum calculations</span>
</span><span id="SpProportionalityValidator-652"><a href="#SpProportionalityValidator-652"><span class="linenos">652</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-653"><a href="#SpProportionalityValidator-653"><span class="linenos">653</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator-654"><a href="#SpProportionalityValidator-654"><span class="linenos">654</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-655"><a href="#SpProportionalityValidator-655"><span class="linenos">655</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator-656"><a href="#SpProportionalityValidator-656"><span class="linenos">656</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator-657"><a href="#SpProportionalityValidator-657"><span class="linenos">657</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator-658"><a href="#SpProportionalityValidator-658"><span class="linenos">658</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_sum_properties_in_influencing_factors</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-659"><a href="#SpProportionalityValidator-659"><span class="linenos">659</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SUM_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator-660"><a href="#SpProportionalityValidator-660"><span class="linenos">660</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator-661"><a href="#SpProportionalityValidator-661"><span class="linenos">661</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator-662"><a href="#SpProportionalityValidator-662"><span class="linenos">662</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator-663"><a href="#SpProportionalityValidator-663"><span class="linenos">663</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-664"><a href="#SpProportionalityValidator-664"><span class="linenos">664</span></a>
</span><span id="SpProportionalityValidator-665"><a href="#SpProportionalityValidator-665"><span class="linenos">665</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator-666"><a href="#SpProportionalityValidator-666"><span class="linenos">666</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator-667"><a href="#SpProportionalityValidator-667"><span class="linenos">667</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-668"><a href="#SpProportionalityValidator-668"><span class="linenos">668</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">],</span>
</span><span id="SpProportionalityValidator-669"><a href="#SpProportionalityValidator-669"><span class="linenos">669</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator-670"><a href="#SpProportionalityValidator-670"><span class="linenos">670</span></a>
</span><span id="SpProportionalityValidator-671"><a href="#SpProportionalityValidator-671"><span class="linenos">671</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator-672"><a href="#SpProportionalityValidator-672"><span class="linenos">672</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-673"><a href="#SpProportionalityValidator-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-674"><a href="#SpProportionalityValidator-674"><span class="linenos">674</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-675"><a href="#SpProportionalityValidator-675"><span class="linenos">675</span></a>
</span><span id="SpProportionalityValidator-676"><a href="#SpProportionalityValidator-676"><span class="linenos">676</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator-677"><a href="#SpProportionalityValidator-677"><span class="linenos">677</span></a>
</span><span id="SpProportionalityValidator-678"><a href="#SpProportionalityValidator-678"><span class="linenos">678</span></a>        <span class="n">subdatasets</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">build_subdatasets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-679"><a href="#SpProportionalityValidator-679"><span class="linenos">679</span></a>
</span><span id="SpProportionalityValidator-680"><a href="#SpProportionalityValidator-680"><span class="linenos">680</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_sum_equals_one</span><span class="p">(</span><span class="n">subdatasets</span><span class="p">,</span> <span class="n">df_values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">VALUE_DATA_UNAVAILABLE</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-681"><a href="#SpProportionalityValidator-681"><span class="linenos">681</span></a>
</span><span id="SpProportionalityValidator-682"><a href="#SpProportionalityValidator-682"><span class="linenos">682</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator-683"><a href="#SpProportionalityValidator-683"><span class="linenos">683</span></a>
</span><span id="SpProportionalityValidator-684"><a href="#SpProportionalityValidator-684"><span class="linenos">684</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator-685"><a href="#SpProportionalityValidator-685"><span class="linenos">685</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-686"><a href="#SpProportionalityValidator-686"><span class="linenos">686</span></a><span class="sd">        Execute all proportionality validations.</span>
</span><span id="SpProportionalityValidator-687"><a href="#SpProportionalityValidator-687"><span class="linenos">687</span></a>
</span><span id="SpProportionalityValidator-688"><a href="#SpProportionalityValidator-688"><span class="linenos">688</span></a><span class="sd">        Orchestrates the execution of all proportionality validators including:</span>
</span><span id="SpProportionalityValidator-689"><a href="#SpProportionalityValidator-689"><span class="linenos">689</span></a><span class="sd">        - Indicator relationship validation with description</span>
</span><span id="SpProportionalityValidator-690"><a href="#SpProportionalityValidator-690"><span class="linenos">690</span></a><span class="sd">        - Duplicate parent indicator detection</span>
</span><span id="SpProportionalityValidator-691"><a href="#SpProportionalityValidator-691"><span class="linenos">691</span></a><span class="sd">        - Value-proportionality consistency validation</span>
</span><span id="SpProportionalityValidator-692"><a href="#SpProportionalityValidator-692"><span class="linenos">692</span></a><span class="sd">        - Parent-child relationship validation against composition</span>
</span><span id="SpProportionalityValidator-693"><a href="#SpProportionalityValidator-693"><span class="linenos">693</span></a><span class="sd">        - Sum properties validation (proportions must sum to 1.0)</span>
</span><span id="SpProportionalityValidator-694"><a href="#SpProportionalityValidator-694"><span class="linenos">694</span></a>
</span><span id="SpProportionalityValidator-695"><a href="#SpProportionalityValidator-695"><span class="linenos">695</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator-696"><a href="#SpProportionalityValidator-696"><span class="linenos">696</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator-697"><a href="#SpProportionalityValidator-697"><span class="linenos">697</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator-698"><a href="#SpProportionalityValidator-698"><span class="linenos">698</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator-699"><a href="#SpProportionalityValidator-699"><span class="linenos">699</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpProportionalityValidator-700"><a href="#SpProportionalityValidator-700"><span class="linenos">700</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpProportionalityValidator-701"><a href="#SpProportionalityValidator-701"><span class="linenos">701</span></a>
</span><span id="SpProportionalityValidator-702"><a href="#SpProportionalityValidator-702"><span class="linenos">702</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator-703"><a href="#SpProportionalityValidator-703"><span class="linenos">703</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator-704"><a href="#SpProportionalityValidator-704"><span class="linenos">704</span></a><span class="sd">        - All validations are skipped if proportionality dataframe is empty</span>
</span><span id="SpProportionalityValidator-705"><a href="#SpProportionalityValidator-705"><span class="linenos">705</span></a><span class="sd">        - Validations are conditionally executed based on related data availability</span>
</span><span id="SpProportionalityValidator-706"><a href="#SpProportionalityValidator-706"><span class="linenos">706</span></a><span class="sd">        - Results are aggregated into reports via `build_reports()`</span>
</span><span id="SpProportionalityValidator-707"><a href="#SpProportionalityValidator-707"><span class="linenos">707</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator-708"><a href="#SpProportionalityValidator-708"><span class="linenos">708</span></a>
</span><span id="SpProportionalityValidator-709"><a href="#SpProportionalityValidator-709"><span class="linenos">709</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpProportionalityValidator-710"><a href="#SpProportionalityValidator-710"><span class="linenos">710</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_proportionality</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator-711"><a href="#SpProportionalityValidator-711"><span class="linenos">711</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_columns_repeated_indicators</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">REP_IND_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator-712"><a href="#SpProportionalityValidator-712"><span class="linenos">712</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_value_and_proportionality</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IND_VAL_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator-713"><a href="#SpProportionalityValidator-713"><span class="linenos">713</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_parent_child_relationships</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator-714"><a href="#SpProportionalityValidator-714"><span class="linenos">714</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_sum_properties_in_influencing_factors</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SUM_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator-715"><a href="#SpProportionalityValidator-715"><span class="linenos">715</span></a>        <span class="p">]</span>
</span><span id="SpProportionalityValidator-716"><a href="#SpProportionalityValidator-716"><span class="linenos">716</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator-717"><a href="#SpProportionalityValidator-717"><span class="linenos">717</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-718"><a href="#SpProportionalityValidator-718"><span class="linenos">718</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpProportionalityValidator-719"><a href="#SpProportionalityValidator-719"><span class="linenos">719</span></a>
</span><span id="SpProportionalityValidator-720"><a href="#SpProportionalityValidator-720"><span class="linenos">720</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpProportionalityValidator-721"><a href="#SpProportionalityValidator-721"><span class="linenos">721</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpProportionalityValidator-722"><a href="#SpProportionalityValidator-722"><span class="linenos">722</span></a>
</span><span id="SpProportionalityValidator-723"><a href="#SpProportionalityValidator-723"><span class="linenos">723</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates Proportionality spreadsheet content and relationships.</p>

<p>This validator performs comprehensive checks on proportionality data including:</p>

<ul>
<li>Indicator relationship validation across multiple models</li>
<li>Parent-child relationship consistency with composition</li>
<li>Sum properties validation (proportions must sum to 1.0)</li>
<li>Duplicate indicator detection</li>
<li>Value-proportionality relationship validation</li>
</ul>

<h2 id="attributes">Attributes</h2>

<p>model_sp_proportionality : SpProportionality
    Proportionality model instance containing proportion data.
model_sp_description : SpDescription
    Description model instance containing indicator metadata.
model_sp_value : SpValue
    Value model instance containing indicator data.
model_sp_composition : SpComposition
    Composition model instance containing parent-child relationships.
exists_scenario : bool
    Flag indicating if scenario file exists.
list_scenarios : List[str]
    List of available scenario identifiers.
sp_name_proportionality : str
    Proportionality spreadsheet filename.
sp_name_description : str
    Description spreadsheet filename.
sp_name_value : str
    Value spreadsheet filename.
sp_name_composition : str
    Composition spreadsheet filename.
column_name_id : str
    ID column name used in proportionality and value.
column_name_code : str
    Code column name from description.
column_name_level : str
    Level column name from description.
column_name_scenario : str
    Scenario column name from description.
column_name_parent : str
    Parent code column name from composition.
column_name_child : str
    Child code column name from composition.
global_required_columns : Dict[str, List[str]]
    Required columns mapping for validation.
model_dataframes : Dict[str, DataFrame]
    DataFrames mapping for each model.</p>
</div>


                            <div id="SpProportionalityValidator.__init__" class="classattr">
                                        <input id="SpProportionalityValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpProportionalityValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpProportionalityValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator.__init__-80"><a href="#SpProportionalityValidator.__init__-80"><span class="linenos"> 80</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.__init__-81"><a href="#SpProportionalityValidator.__init__-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.__init__-82"><a href="#SpProportionalityValidator.__init__-82"><span class="linenos"> 82</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.__init__-83"><a href="#SpProportionalityValidator.__init__-83"><span class="linenos"> 83</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.__init__-84"><a href="#SpProportionalityValidator.__init__-84"><span class="linenos"> 84</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.__init__-85"><a href="#SpProportionalityValidator.__init__-85"><span class="linenos"> 85</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.__init__-86"><a href="#SpProportionalityValidator.__init__-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-87"><a href="#SpProportionalityValidator.__init__-87"><span class="linenos"> 87</span></a><span class="sd">        Initialize the Proportionality validator.</span>
</span><span id="SpProportionalityValidator.__init__-88"><a href="#SpProportionalityValidator.__init__-88"><span class="linenos"> 88</span></a>
</span><span id="SpProportionalityValidator.__init__-89"><a href="#SpProportionalityValidator.__init__-89"><span class="linenos"> 89</span></a><span class="sd">        Args</span>
</span><span id="SpProportionalityValidator.__init__-90"><a href="#SpProportionalityValidator.__init__-90"><span class="linenos"> 90</span></a><span class="sd">        ----</span>
</span><span id="SpProportionalityValidator.__init__-91"><a href="#SpProportionalityValidator.__init__-91"><span class="linenos"> 91</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpProportionalityValidator.__init__-92"><a href="#SpProportionalityValidator.__init__-92"><span class="linenos"> 92</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpProportionalityValidator.__init__-93"><a href="#SpProportionalityValidator.__init__-93"><span class="linenos"> 93</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpProportionalityValidator.__init__-94"><a href="#SpProportionalityValidator.__init__-94"><span class="linenos"> 94</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpProportionalityValidator.__init__-95"><a href="#SpProportionalityValidator.__init__-95"><span class="linenos"> 95</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpProportionalityValidator.__init__-96"><a href="#SpProportionalityValidator.__init__-96"><span class="linenos"> 96</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpProportionalityValidator.__init__-97"><a href="#SpProportionalityValidator.__init__-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-98"><a href="#SpProportionalityValidator.__init__-98"><span class="linenos"> 98</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.__init__-99"><a href="#SpProportionalityValidator.__init__-99"><span class="linenos"> 99</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.__init__-100"><a href="#SpProportionalityValidator.__init__-100"><span class="linenos">100</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.__init__-101"><a href="#SpProportionalityValidator.__init__-101"><span class="linenos">101</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpProportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.__init__-102"><a href="#SpProportionalityValidator.__init__-102"><span class="linenos">102</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.__init__-103"><a href="#SpProportionalityValidator.__init__-103"><span class="linenos">103</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator.__init__-104"><a href="#SpProportionalityValidator.__init__-104"><span class="linenos">104</span></a>
</span><span id="SpProportionalityValidator.__init__-105"><a href="#SpProportionalityValidator.__init__-105"><span class="linenos">105</span></a>        <span class="c1"># Configure</span>
</span><span id="SpProportionalityValidator.__init__-106"><a href="#SpProportionalityValidator.__init__-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_proportionality</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpProportionalityValidator.__init__-107"><a href="#SpProportionalityValidator.__init__-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.__init__-108"><a href="#SpProportionalityValidator.__init__-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpValue</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.__init__-109"><a href="#SpProportionalityValidator.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpComposition</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.__init__-110"><a href="#SpProportionalityValidator.__init__-110"><span class="linenos">110</span></a>
</span><span id="SpProportionalityValidator.__init__-111"><a href="#SpProportionalityValidator.__init__-111"><span class="linenos">111</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpProportionalityValidator.__init__-112"><a href="#SpProportionalityValidator.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exists_scenario</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenario_exists_file</span>
</span><span id="SpProportionalityValidator.__init__-113"><a href="#SpProportionalityValidator.__init__-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenarios_list</span>
</span><span id="SpProportionalityValidator.__init__-114"><a href="#SpProportionalityValidator.__init__-114"><span class="linenos">114</span></a>
</span><span id="SpProportionalityValidator.__init__-115"><a href="#SpProportionalityValidator.__init__-115"><span class="linenos">115</span></a>        <span class="c1"># Initialize variables</span>
</span><span id="SpProportionalityValidator.__init__-116"><a href="#SpProportionalityValidator.__init__-116"><span class="linenos">116</span></a>
</span><span id="SpProportionalityValidator.__init__-117"><a href="#SpProportionalityValidator.__init__-117"><span class="linenos">117</span></a>        <span class="c1"># Spreadsheet names</span>
</span><span id="SpProportionalityValidator.__init__-118"><a href="#SpProportionalityValidator.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-119"><a href="#SpProportionalityValidator.__init__-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-120"><a href="#SpProportionalityValidator.__init__-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-121"><a href="#SpProportionalityValidator.__init__-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-122"><a href="#SpProportionalityValidator.__init__-122"><span class="linenos">122</span></a>
</span><span id="SpProportionalityValidator.__init__-123"><a href="#SpProportionalityValidator.__init__-123"><span class="linenos">123</span></a>        <span class="c1"># Column names used in validations</span>
</span><span id="SpProportionalityValidator.__init__-124"><a href="#SpProportionalityValidator.__init__-124"><span class="linenos">124</span></a>
</span><span id="SpProportionalityValidator.__init__-125"><a href="#SpProportionalityValidator.__init__-125"><span class="linenos">125</span></a>        <span class="c1"># Columns in SpProportionality and SpValue</span>
</span><span id="SpProportionalityValidator.__init__-126"><a href="#SpProportionalityValidator.__init__-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-127"><a href="#SpProportionalityValidator.__init__-127"><span class="linenos">127</span></a>
</span><span id="SpProportionalityValidator.__init__-128"><a href="#SpProportionalityValidator.__init__-128"><span class="linenos">128</span></a>        <span class="c1"># Columns in SpDescription</span>
</span><span id="SpProportionalityValidator.__init__-129"><a href="#SpProportionalityValidator.__init__-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-130"><a href="#SpProportionalityValidator.__init__-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-131"><a href="#SpProportionalityValidator.__init__-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_scenario</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-132"><a href="#SpProportionalityValidator.__init__-132"><span class="linenos">132</span></a>
</span><span id="SpProportionalityValidator.__init__-133"><a href="#SpProportionalityValidator.__init__-133"><span class="linenos">133</span></a>        <span class="c1"># Columns in SpComposition</span>
</span><span id="SpProportionalityValidator.__init__-134"><a href="#SpProportionalityValidator.__init__-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-135"><a href="#SpProportionalityValidator.__init__-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpProportionalityValidator.__init__-136"><a href="#SpProportionalityValidator.__init__-136"><span class="linenos">136</span></a>
</span><span id="SpProportionalityValidator.__init__-137"><a href="#SpProportionalityValidator.__init__-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpProportionalityValidator.__init__-138"><a href="#SpProportionalityValidator.__init__-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpProportionalityValidator.__init__-139"><a href="#SpProportionalityValidator.__init__-139"><span class="linenos">139</span></a>
</span><span id="SpProportionalityValidator.__init__-140"><a href="#SpProportionalityValidator.__init__-140"><span class="linenos">140</span></a>        <span class="c1"># Prepare statements</span>
</span><span id="SpProportionalityValidator.__init__-141"><a href="#SpProportionalityValidator.__init__-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.__init__-142"><a href="#SpProportionalityValidator.__init__-142"><span class="linenos">142</span></a>
</span><span id="SpProportionalityValidator.__init__-143"><a href="#SpProportionalityValidator.__init__-143"><span class="linenos">143</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpProportionalityValidator.__init__-144"><a href="#SpProportionalityValidator.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Proportionality validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpProportionalityValidator.model_sp_proportionality" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_proportionality</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.model_sp_proportionality"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.model_sp_description" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_description</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.model_sp_description"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.model_sp_value" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_value</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.model_sp_value"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.model_sp_composition" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_composition</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.model_sp_composition"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.exists_scenario" class="classattr">
                                <div class="attr variable">
            <span class="name">exists_scenario</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.exists_scenario"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.list_scenarios" class="classattr">
                                <div class="attr variable">
            <span class="name">list_scenarios</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.list_scenarios"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.sp_name_proportionality" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_proportionality</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.sp_name_proportionality"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.sp_name_description" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_description</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.sp_name_description"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.sp_name_value" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_value</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.sp_name_value"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.sp_name_composition" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_composition</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.sp_name_composition"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.column_name_id" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_id</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.column_name_id"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.column_name_code" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_code</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.column_name_code"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.column_name_level" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_level</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.column_name_level"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.column_name_scenario" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_scenario</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.column_name_scenario"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.column_name_parent" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_parent</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.column_name_parent"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.column_name_child" class="classattr">
                                <div class="attr variable">
            <span class="name">column_name_child</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.column_name_child"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.global_required_columns" class="classattr">
                                <div class="attr variable">
            <span class="name">global_required_columns</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.global_required_columns"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.model_dataframes" class="classattr">
                                <div class="attr variable">
            <span class="name">model_dataframes</span>

        
    </div>
    <a class="headerlink" href="#SpProportionalityValidator.model_dataframes"></a>
    
    

                            </div>
                            <div id="SpProportionalityValidator.validate_relation_indicators_in_proportionality" class="classattr">
                                        <input id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_relation_indicators_in_proportionality</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpProportionalityValidator.validate_relation_indicators_in_proportionality-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-299"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-299"><span class="linenos">299</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_proportionality</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-300"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-300"><span class="linenos">300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-301"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-301"><span class="linenos">301</span></a><span class="sd">        Validate indicator relationships between proportionality and description.</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-302"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-302"><span class="linenos">302</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-303"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-303"><span class="linenos">303</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-304"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-304"><span class="linenos">304</span></a><span class="sd">        - All indicators in proportionality exist in description</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-305"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-305"><span class="linenos">305</span></a><span class="sd">        - All description indicators (except level 1) exist in proportionality</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-306"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-306"><span class="linenos">306</span></a><span class="sd">        - MultiIndex column codes are properly extracted and validated</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-307"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-307"><span class="linenos">307</span></a><span class="sd">        - Level 1 indicators are excluded from validation</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-308"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-308"><span class="linenos">308</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-309"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-309"><span class="linenos">309</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-310"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-310"><span class="linenos">310</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-311"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-311"><span class="linenos">311</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-312"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-312"><span class="linenos">312</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-313"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-313"><span class="linenos">313</span></a><span class="sd">                - List[str]: Error messages for missing indicators</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-314"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-314"><span class="linenos">314</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-315"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-315"><span class="linenos">315</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-316"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-316"><span class="linenos">316</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-317"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-317"><span class="linenos">317</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-318"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-318"><span class="linenos">318</span></a><span class="sd">        - Validation is skipped if description dataframe is empty</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-319"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-319"><span class="linenos">319</span></a><span class="sd">        - Checks both levels of MultiIndex columns in proportionality</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-320"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-320"><span class="linenos">320</span></a><span class="sd">        - Level 1 indicators are automatically excluded from validation</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-321"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-321"><span class="linenos">321</span></a><span class="sd">        - Codes are extracted from pattern matching (e.g., &quot;123-scenario&quot;)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-322"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-323"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-323"><span class="linenos">323</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-324"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-324"><span class="linenos">324</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-325"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-325"><span class="linenos">325</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-326"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-326"><span class="linenos">326</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-327"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-327"><span class="linenos">327</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-328"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-328"><span class="linenos">328</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-329"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-329"><span class="linenos">329</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-330"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-330"><span class="linenos">330</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-331"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-331"><span class="linenos">331</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-332"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-332"><span class="linenos">332</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-333"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-333"><span class="linenos">333</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-334"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-334"><span class="linenos">334</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-335"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-335"><span class="linenos">335</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-336"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-336"><span class="linenos">336</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-337"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-337"><span class="linenos">337</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-338"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-338"><span class="linenos">338</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-339"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-339"><span class="linenos">339</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-340"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-340"><span class="linenos">340</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-341"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-341"><span class="linenos">341</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-342"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-342"><span class="linenos">342</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-343"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-343"><span class="linenos">343</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-344"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-345"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-346"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-346"><span class="linenos">346</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-347"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-347"><span class="linenos">347</span></a>        <span class="c1"># Create working copies and clean data</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-348"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-348"><span class="linenos">348</span></a>        <span class="n">df_description</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-349"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-349"><span class="linenos">349</span></a>        <span class="n">df_proportionality</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-350"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-350"><span class="linenos">350</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-351"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-351"><span class="linenos">351</span></a>        <span class="c1"># Clean integer columns: df_description</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-352"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-352"><span class="linenos">352</span></a>        <span class="n">df_description</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-353"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-353"><span class="linenos">353</span></a>            <span class="n">df</span><span class="o">=</span><span class="n">df_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-354"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-354"><span class="linenos">354</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-355"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-355"><span class="linenos">355</span></a>            <span class="n">columns_to_clean</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-356"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-356"><span class="linenos">356</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-357"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-357"><span class="linenos">357</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-358"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-358"><span class="linenos">358</span></a>        <span class="c1"># List of codes at level 1 to remove</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-359"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-359"><span class="linenos">359</span></a>        <span class="n">codes_level_to_remove</span> <span class="o">=</span> <span class="n">df_description</span><span class="p">[</span><span class="n">df_description</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-360"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-360"><span class="linenos">360</span></a>        <span class="n">set_valid_codes_description</span> <span class="o">=</span> <span class="n">DescriptionProcessing</span><span class="o">.</span><span class="n">get_valids_codes_from_description</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-361"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_scenario</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-362"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-362"><span class="linenos">362</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-363"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-363"><span class="linenos">363</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-364"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-364"><span class="linenos">364</span></a>        <span class="c1"># List all codes in proportionality (both levels of MultiIndex)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-365"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-365"><span class="linenos">365</span></a>        <span class="n">level_one_columns</span> <span class="o">=</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-366"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-366"><span class="linenos">366</span></a>        <span class="n">level_two_columns</span> <span class="o">=</span> <span class="n">df_proportionality</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-367"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-367"><span class="linenos">367</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-368"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-368"><span class="linenos">368</span></a>        <span class="c1"># Remove ID column from both levels if present</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-369"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-369"><span class="linenos">369</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span> <span class="ow">in</span> <span class="n">level_two_columns</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-370"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-370"><span class="linenos">370</span></a>            <span class="n">level_two_columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-371"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-371"><span class="linenos">371</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-372"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-372"><span class="linenos">372</span></a>        <span class="c1"># Remove unnamed columns</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-373"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-373"><span class="linenos">373</span></a>        <span class="n">level_one_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_one_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-374"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-374"><span class="linenos">374</span></a>        <span class="n">level_two_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">level_two_columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-375"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-375"><span class="linenos">375</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-376"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-376"><span class="linenos">376</span></a>        <span class="c1"># Extract codes from both levels from pattern</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-377"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-377"><span class="linenos">377</span></a>        <span class="n">set_valid_codes_prop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-378"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-378"><span class="linenos">378</span></a>        <span class="n">level_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">level_one_columns</span><span class="p">,</span> <span class="n">level_two_columns</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-379"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-379"><span class="linenos">379</span></a>        <span class="k">for</span> <span class="n">level_column</span> <span class="ow">in</span> <span class="n">level_columns</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-380"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-380"><span class="linenos">380</span></a>            <span class="n">codes_matched_by_pattern</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">categorize_strings_by_id_pattern_from_list</span><span class="p">(</span><span class="n">level_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_scenarios</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-381"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-381"><span class="linenos">381</span></a>            <span class="n">codes_matched_by_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes_matched_by_pattern</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-382"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-382"><span class="linenos">382</span></a>            <span class="n">codes_cleaned</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes_matched_by_pattern</span><span class="p">])</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_level_to_remove</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-383"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-383"><span class="linenos">383</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-384"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-384"><span class="linenos">384</span></a>            <span class="c1"># Add to all_codes_proportionalities</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-385"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-385"><span class="linenos">385</span></a>            <span class="n">set_valid_codes_prop</span> <span class="o">=</span> <span class="n">set_valid_codes_prop</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">codes_cleaned</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-386"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-386"><span class="linenos">386</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-387"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-387"><span class="linenos">387</span></a>        <span class="c1"># Convert to integers for comparison</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-388"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-388"><span class="linenos">388</span></a>        <span class="n">set_valid_codes_description</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">set_valid_codes_description</span><span class="p">])</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-389"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-389"><span class="linenos">389</span></a>        <span class="n">set_valid_codes_prop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">set_valid_codes_prop</span><span class="p">)])</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-390"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-390"><span class="linenos">390</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-391"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-391"><span class="linenos">391</span></a>        <span class="c1"># Compare codes between description and proportionality</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-392"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-392"><span class="linenos">392</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-393"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-393"><span class="linenos">393</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">set_valid_codes_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-394"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-394"><span class="linenos">394</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-395"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-395"><span class="linenos">395</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">set_valid_codes_prop</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-396"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-396"><span class="linenos">396</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-397"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-397"><span class="linenos">397</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-398"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-398"><span class="linenos">398</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-399"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-399"><span class="linenos">399</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_proportionality-400"><a href="#SpProportionalityValidator.validate_relation_indicators_in_proportionality-400"><span class="linenos">400</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate indicator relationships between proportionality and description.</p>

<p>Ensures that:</p>

<ul>
<li>All indicators in proportionality exist in description</li>
<li>All description indicators (except level 1) exist in proportionality</li>
<li>MultiIndex column codes are properly extracted and validated</li>
<li>Level 1 indicators are excluded from validation</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for missing indicators
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if description dataframe is empty</li>
<li>Checks both levels of MultiIndex columns in proportionality</li>
<li>Level 1 indicators are automatically excluded from validation</li>
<li>Codes are extracted from pattern matching (e.g., "123-scenario")</li>
</ul>
</div>


                            </div>
                            <div id="SpProportionalityValidator.validate_columns_repeated_indicators" class="classattr">
                                        <input id="SpProportionalityValidator.validate_columns_repeated_indicators-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_columns_repeated_indicators</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpProportionalityValidator.validate_columns_repeated_indicators-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator.validate_columns_repeated_indicators"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-402"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-402"><span class="linenos">402</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_columns_repeated_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-403"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-403"><span class="linenos">403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-404"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-404"><span class="linenos">404</span></a><span class="sd">        Validate that parent indicators are not duplicated in proportionality.</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-405"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-405"><span class="linenos">405</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-406"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-406"><span class="linenos">406</span></a><span class="sd">        Checks the first level of MultiIndex columns to ensure no parent indicator</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-407"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-407"><span class="linenos">407</span></a><span class="sd">        appears more than once in the proportionality spreadsheet structure.</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-408"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-408"><span class="linenos">408</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-409"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-409"><span class="linenos">409</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-410"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-410"><span class="linenos">410</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-411"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-411"><span class="linenos">411</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-412"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-412"><span class="linenos">412</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-413"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-413"><span class="linenos">413</span></a><span class="sd">                - List[str]: Error messages for duplicated parent indicators</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-414"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-414"><span class="linenos">414</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-415"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-415"><span class="linenos">415</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-416"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-416"><span class="linenos">416</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-417"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-417"><span class="linenos">417</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-418"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-418"><span class="linenos">418</span></a><span class="sd">        - Only checks level 0 of MultiIndex columns (parent indicators)</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-419"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-419"><span class="linenos">419</span></a><span class="sd">        - Unnamed columns are automatically excluded</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-420"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-420"><span class="linenos">420</span></a><span class="sd">        - Duplicate errors are deduplicated before returning</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-421"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-421"><span class="linenos">421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-422"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-422"><span class="linenos">422</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-423"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-423"><span class="linenos">423</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-424"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-424"><span class="linenos">424</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-425"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-426"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-426"><span class="linenos">426</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-427"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-427"><span class="linenos">427</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-428"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-428"><span class="linenos">428</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-429"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-429"><span class="linenos">429</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-430"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-430"><span class="linenos">430</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-431"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-431"><span class="linenos">431</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-432"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-432"><span class="linenos">432</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-433"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-433"><span class="linenos">433</span></a>        <span class="n">df_proportionalities</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-434"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-434"><span class="linenos">434</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-435"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-435"><span class="linenos">435</span></a>        <span class="c1"># Indicator codes that are at level 1</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-436"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-436"><span class="linenos">436</span></a>        <span class="n">level_one_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_proportionalities</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;unnamed&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-437"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-437"><span class="linenos">437</span></a>        <span class="n">grouped_columns</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">generate_group_from_list</span><span class="p">(</span><span class="n">level_one_columns</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-438"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-438"><span class="linenos">438</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-439"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-439"><span class="linenos">439</span></a>        <span class="n">unique_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-440"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-440"><span class="linenos">440</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_columns</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-441"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-441"><span class="linenos">441</span></a>            <span class="n">first_element</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-442"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-442"><span class="linenos">442</span></a>            <span class="k">if</span> <span class="n">first_element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_list</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-443"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-443"><span class="linenos">443</span></a>                <span class="n">unique_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_element</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-444"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-444"><span class="linenos">444</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-445"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-445"><span class="linenos">445</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: O indicador pai &#39;</span><span class="si">{</span><span class="n">first_element</span><span class="si">}</span><span class="s2">&#39; est repetido na planilha.&quot;</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-446"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-446"><span class="linenos">446</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-447"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-447"><span class="linenos">447</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-448"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-448"><span class="linenos">448</span></a>
</span><span id="SpProportionalityValidator.validate_columns_repeated_indicators-449"><a href="#SpProportionalityValidator.validate_columns_repeated_indicators-449"><span class="linenos">449</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate that parent indicators are not duplicated in proportionality.</p>

<p>Checks the first level of MultiIndex columns to ensure no parent indicator
appears more than once in the proportionality spreadsheet structure.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for duplicated parent indicators
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Only checks level 0 of MultiIndex columns (parent indicators)</li>
<li>Unnamed columns are automatically excluded</li>
<li>Duplicate errors are deduplicated before returning</li>
</ul>
</div>


                            </div>
                            <div id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality" class="classattr">
                                        <input id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_relation_indicators_in_value_and_proportionality</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-451"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-451"><span class="linenos">451</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_value_and_proportionality</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-452"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-452"><span class="linenos">452</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-453"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-453"><span class="linenos">453</span></a><span class="sd">        Validate indicator consistency between value and proportionality spreadsheets.</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-454"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-454"><span class="linenos">454</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-455"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-455"><span class="linenos">455</span></a><span class="sd">        Ensures that all indicators present in proportionality (both parent and child</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-456"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-456"><span class="linenos">456</span></a><span class="sd">        levels) also exist in the value spreadsheet, and vice versa.</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-457"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-457"><span class="linenos">457</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-458"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-458"><span class="linenos">458</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-459"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-459"><span class="linenos">459</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-460"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-460"><span class="linenos">460</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-461"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-461"><span class="linenos">461</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-462"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-462"><span class="linenos">462</span></a><span class="sd">                - List[str]: Error messages for indicator mismatches</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-463"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-463"><span class="linenos">463</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-464"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-464"><span class="linenos">464</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-465"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-465"><span class="linenos">465</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-466"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-466"><span class="linenos">466</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-467"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-467"><span class="linenos">467</span></a><span class="sd">        - Validation is skipped if value dataframe is empty</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-468"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-468"><span class="linenos">468</span></a><span class="sd">        - Checks both levels of MultiIndex in proportionality</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-469"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-469"><span class="linenos">469</span></a><span class="sd">        - ID columns are automatically excluded from comparison</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-470"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-470"><span class="linenos">470</span></a><span class="sd">        - Reports indicators missing in either spreadsheet</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-471"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-472"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-472"><span class="linenos">472</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-473"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-474"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-475"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-475"><span class="linenos">475</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-476"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-476"><span class="linenos">476</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-477"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-477"><span class="linenos">477</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_value_and_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-478"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-478"><span class="linenos">478</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IND_VAL_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-479"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-479"><span class="linenos">479</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-480"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-480"><span class="linenos">480</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-481"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-481"><span class="linenos">481</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-482"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-482"><span class="linenos">482</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-483"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-483"><span class="linenos">483</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-484"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-484"><span class="linenos">484</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-485"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-485"><span class="linenos">485</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-486"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-487"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-487"><span class="linenos">487</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-488"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-488"><span class="linenos">488</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-489"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-489"><span class="linenos">489</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-490"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-490"><span class="linenos">490</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-491"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-491"><span class="linenos">491</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-492"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-493"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-493"><span class="linenos">493</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-494"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-494"><span class="linenos">494</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-495"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-495"><span class="linenos">495</span></a>        <span class="n">df_proportionalities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-496"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-496"><span class="linenos">496</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-497"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-497"><span class="linenos">497</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-498"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-498"><span class="linenos">498</span></a>        <span class="c1"># Get all codes in proportionality (both levels of MultiIndex)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-499"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-499"><span class="linenos">499</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-500"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-500"><span class="linenos">500</span></a>        <span class="c1"># Get all columns in level 1</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-501"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-501"><span class="linenos">501</span></a>        <span class="n">columns_level_one_prop</span> <span class="o">=</span> <span class="n">df_proportionalities</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-502"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-502"><span class="linenos">502</span></a>        <span class="n">columns_level_one_prop</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_level_one_prop</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;unnamed: 0_level_0&quot;</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-503"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-503"><span class="linenos">503</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-504"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-504"><span class="linenos">504</span></a>        <span class="c1"># Get all columns in level 2</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-505"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-505"><span class="linenos">505</span></a>        <span class="n">columns_level_two_prop</span> <span class="o">=</span> <span class="n">df_proportionalities</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-506"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-506"><span class="linenos">506</span></a>        <span class="n">columns_level_two_prop</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-507"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-507"><span class="linenos">507</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-508"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-508"><span class="linenos">508</span></a>        <span class="c1"># Create a set with all codes in both levels</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-509"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-509"><span class="linenos">509</span></a>        <span class="n">set_all_columns_prop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns_level_one_prop</span> <span class="o">+</span> <span class="n">columns_level_two_prop</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-510"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-510"><span class="linenos">510</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-511"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-511"><span class="linenos">511</span></a>        <span class="c1"># Get all codes in values</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-512"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-512"><span class="linenos">512</span></a>        <span class="n">columns_values</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-513"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-513"><span class="linenos">513</span></a>        <span class="n">columns_values</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-514"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-514"><span class="linenos">514</span></a>        <span class="n">set_all_columns_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns_values</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-515"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-515"><span class="linenos">515</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-516"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-516"><span class="linenos">516</span></a>        <span class="c1"># Compare codes between description and proportionality</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-517"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-517"><span class="linenos">517</span></a>        <span class="n">comparison_errors</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set_with_message</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-518"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-518"><span class="linenos">518</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">set_all_columns_prop</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-519"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-519"><span class="linenos">519</span></a>            <span class="n">label_1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-520"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-520"><span class="linenos">520</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">set_all_columns_values</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-521"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-521"><span class="linenos">521</span></a>            <span class="n">label_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-522"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-522"><span class="linenos">522</span></a>        <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-523"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-523"><span class="linenos">523</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-524"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-524"><span class="linenos">524</span></a>
</span><span id="SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-525"><a href="#SpProportionalityValidator.validate_relation_indicators_in_value_and_proportionality-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate indicator consistency between value and proportionality spreadsheets.</p>

<p>Ensures that all indicators present in proportionality (both parent and child
levels) also exist in the value spreadsheet, and vice versa.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for indicator mismatches
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if value dataframe is empty</li>
<li>Checks both levels of MultiIndex in proportionality</li>
<li>ID columns are automatically excluded from comparison</li>
<li>Reports indicators missing in either spreadsheet</li>
</ul>
</div>


                            </div>
                            <div id="SpProportionalityValidator.validate_parent_child_relationships" class="classattr">
                                        <input id="SpProportionalityValidator.validate_parent_child_relationships-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_parent_child_relationships</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpProportionalityValidator.validate_parent_child_relationships-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator.validate_parent_child_relationships"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator.validate_parent_child_relationships-527"><a href="#SpProportionalityValidator.validate_parent_child_relationships-527"><span class="linenos">527</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_parent_child_relationships</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-528"><a href="#SpProportionalityValidator.validate_parent_child_relationships-528"><span class="linenos">528</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-529"><a href="#SpProportionalityValidator.validate_parent_child_relationships-529"><span class="linenos">529</span></a><span class="sd">        Validate parent-child relationships against composition definitions.</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-530"><a href="#SpProportionalityValidator.validate_parent_child_relationships-530"><span class="linenos">530</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-531"><a href="#SpProportionalityValidator.validate_parent_child_relationships-531"><span class="linenos">531</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-532"><a href="#SpProportionalityValidator.validate_parent_child_relationships-532"><span class="linenos">532</span></a><span class="sd">        - All parent indicators in proportionality exist in composition</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-533"><a href="#SpProportionalityValidator.validate_parent_child_relationships-533"><span class="linenos">533</span></a><span class="sd">        - All children listed under a parent match composition relationships</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-534"><a href="#SpProportionalityValidator.validate_parent_child_relationships-534"><span class="linenos">534</span></a><span class="sd">        - All composition children are present in proportionality subdatasets</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-535"><a href="#SpProportionalityValidator.validate_parent_child_relationships-535"><span class="linenos">535</span></a><span class="sd">        - Relationships are consistent with composition hierarchy</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-536"><a href="#SpProportionalityValidator.validate_parent_child_relationships-536"><span class="linenos">536</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-537"><a href="#SpProportionalityValidator.validate_parent_child_relationships-537"><span class="linenos">537</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-538"><a href="#SpProportionalityValidator.validate_parent_child_relationships-538"><span class="linenos">538</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-539"><a href="#SpProportionalityValidator.validate_parent_child_relationships-539"><span class="linenos">539</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-540"><a href="#SpProportionalityValidator.validate_parent_child_relationships-540"><span class="linenos">540</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-541"><a href="#SpProportionalityValidator.validate_parent_child_relationships-541"><span class="linenos">541</span></a><span class="sd">                - List[str]: Error messages for relationship inconsistencies</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-542"><a href="#SpProportionalityValidator.validate_parent_child_relationships-542"><span class="linenos">542</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-543"><a href="#SpProportionalityValidator.validate_parent_child_relationships-543"><span class="linenos">543</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-544"><a href="#SpProportionalityValidator.validate_parent_child_relationships-544"><span class="linenos">544</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-545"><a href="#SpProportionalityValidator.validate_parent_child_relationships-545"><span class="linenos">545</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-546"><a href="#SpProportionalityValidator.validate_parent_child_relationships-546"><span class="linenos">546</span></a><span class="sd">        - Validation is skipped if composition dataframe is empty</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-547"><a href="#SpProportionalityValidator.validate_parent_child_relationships-547"><span class="linenos">547</span></a><span class="sd">        - Level 1 parents are automatically excluded from validation</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-548"><a href="#SpProportionalityValidator.validate_parent_child_relationships-548"><span class="linenos">548</span></a><span class="sd">        - Compares cleaned indicator codes (without scenario suffixes)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-549"><a href="#SpProportionalityValidator.validate_parent_child_relationships-549"><span class="linenos">549</span></a><span class="sd">        - Bidirectional validation ensures complete consistency</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-550"><a href="#SpProportionalityValidator.validate_parent_child_relationships-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-551"><a href="#SpProportionalityValidator.validate_parent_child_relationships-551"><span class="linenos">551</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-552"><a href="#SpProportionalityValidator.validate_parent_child_relationships-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-553"><a href="#SpProportionalityValidator.validate_parent_child_relationships-553"><span class="linenos">553</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-554"><a href="#SpProportionalityValidator.validate_parent_child_relationships-554"><span class="linenos">554</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-555"><a href="#SpProportionalityValidator.validate_parent_child_relationships-555"><span class="linenos">555</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-556"><a href="#SpProportionalityValidator.validate_parent_child_relationships-556"><span class="linenos">556</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_parent_child_relationships</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-557"><a href="#SpProportionalityValidator.validate_parent_child_relationships-557"><span class="linenos">557</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IND_VAL_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-558"><a href="#SpProportionalityValidator.validate_parent_child_relationships-558"><span class="linenos">558</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-559"><a href="#SpProportionalityValidator.validate_parent_child_relationships-559"><span class="linenos">559</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-560"><a href="#SpProportionalityValidator.validate_parent_child_relationships-560"><span class="linenos">560</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-561"><a href="#SpProportionalityValidator.validate_parent_child_relationships-561"><span class="linenos">561</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-562"><a href="#SpProportionalityValidator.validate_parent_child_relationships-562"><span class="linenos">562</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-563"><a href="#SpProportionalityValidator.validate_parent_child_relationships-563"><span class="linenos">563</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-564"><a href="#SpProportionalityValidator.validate_parent_child_relationships-564"><span class="linenos">564</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-565"><a href="#SpProportionalityValidator.validate_parent_child_relationships-565"><span class="linenos">565</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-566"><a href="#SpProportionalityValidator.validate_parent_child_relationships-566"><span class="linenos">566</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-567"><a href="#SpProportionalityValidator.validate_parent_child_relationships-567"><span class="linenos">567</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-568"><a href="#SpProportionalityValidator.validate_parent_child_relationships-568"><span class="linenos">568</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-569"><a href="#SpProportionalityValidator.validate_parent_child_relationships-569"><span class="linenos">569</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-570"><a href="#SpProportionalityValidator.validate_parent_child_relationships-570"><span class="linenos">570</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-571"><a href="#SpProportionalityValidator.validate_parent_child_relationships-571"><span class="linenos">571</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-572"><a href="#SpProportionalityValidator.validate_parent_child_relationships-572"><span class="linenos">572</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-573"><a href="#SpProportionalityValidator.validate_parent_child_relationships-573"><span class="linenos">573</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-574"><a href="#SpProportionalityValidator.validate_parent_child_relationships-574"><span class="linenos">574</span></a>        <span class="c1"># Setup dataframes</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-575"><a href="#SpProportionalityValidator.validate_parent_child_relationships-575"><span class="linenos">575</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-576"><a href="#SpProportionalityValidator.validate_parent_child_relationships-576"><span class="linenos">576</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-577"><a href="#SpProportionalityValidator.validate_parent_child_relationships-577"><span class="linenos">577</span></a>        <span class="c1"># Build subdatasets</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-578"><a href="#SpProportionalityValidator.validate_parent_child_relationships-578"><span class="linenos">578</span></a>        <span class="n">subdatasets</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">build_subdatasets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-579"><a href="#SpProportionalityValidator.validate_parent_child_relationships-579"><span class="linenos">579</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-580"><a href="#SpProportionalityValidator.validate_parent_child_relationships-580"><span class="linenos">580</span></a>        <span class="c1"># Filter composition to remove level 1 parents</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-581"><a href="#SpProportionalityValidator.validate_parent_child_relationships-581"><span class="linenos">581</span></a>        <span class="n">df_composition</span> <span class="o">=</span> <span class="n">df_composition</span><span class="p">[</span><span class="n">df_composition</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-582"><a href="#SpProportionalityValidator.validate_parent_child_relationships-582"><span class="linenos">582</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-583"><a href="#SpProportionalityValidator.validate_parent_child_relationships-583"><span class="linenos">583</span></a>        <span class="n">dict_grouped_composition</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-584"><a href="#SpProportionalityValidator.validate_parent_child_relationships-584"><span class="linenos">584</span></a>        <span class="k">for</span> <span class="n">__</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_composition</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-585"><a href="#SpProportionalityValidator.validate_parent_child_relationships-585"><span class="linenos">585</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-586"><a href="#SpProportionalityValidator.validate_parent_child_relationships-586"><span class="linenos">586</span></a>            <span class="n">child</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_child</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-587"><a href="#SpProportionalityValidator.validate_parent_child_relationships-587"><span class="linenos">587</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-588"><a href="#SpProportionalityValidator.validate_parent_child_relationships-588"><span class="linenos">588</span></a>            <span class="k">if</span> <span class="n">parent</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-589"><a href="#SpProportionalityValidator.validate_parent_child_relationships-589"><span class="linenos">589</span></a>                <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-590"><a href="#SpProportionalityValidator.validate_parent_child_relationships-590"><span class="linenos">590</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-591"><a href="#SpProportionalityValidator.validate_parent_child_relationships-591"><span class="linenos">591</span></a>            <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-592"><a href="#SpProportionalityValidator.validate_parent_child_relationships-592"><span class="linenos">592</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-593"><a href="#SpProportionalityValidator.validate_parent_child_relationships-593"><span class="linenos">593</span></a>        <span class="k">for</span> <span class="n">parent_id</span><span class="p">,</span> <span class="n">subdataset</span> <span class="ow">in</span> <span class="n">subdatasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-594"><a href="#SpProportionalityValidator.validate_parent_child_relationships-594"><span class="linenos">594</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-595"><a href="#SpProportionalityValidator.validate_parent_child_relationships-595"><span class="linenos">595</span></a>            <span class="n">cleaned_parent_id</span> <span class="o">=</span> <span class="n">parent_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-596"><a href="#SpProportionalityValidator.validate_parent_child_relationships-596"><span class="linenos">596</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-597"><a href="#SpProportionalityValidator.validate_parent_child_relationships-597"><span class="linenos">597</span></a>            <span class="k">if</span> <span class="n">cleaned_parent_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-598"><a href="#SpProportionalityValidator.validate_parent_child_relationships-598"><span class="linenos">598</span></a>                <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parent_id</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-599"><a href="#SpProportionalityValidator.validate_parent_child_relationships-599"><span class="linenos">599</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-600"><a href="#SpProportionalityValidator.validate_parent_child_relationships-600"><span class="linenos">600</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: O indicador pai &#39;</span><span class="si">{</span><span class="n">cleaned_parent_id</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">parent_id</span><span class="si">}</span><span class="s2">&#39;) no est presente na coluna &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_parent</span><span class="si">}</span><span class="s2">&#39; da planilha </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-601"><a href="#SpProportionalityValidator.validate_parent_child_relationships-601"><span class="linenos">601</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-602"><a href="#SpProportionalityValidator.validate_parent_child_relationships-602"><span class="linenos">602</span></a>                <span class="k">continue</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-603"><a href="#SpProportionalityValidator.validate_parent_child_relationships-603"><span class="linenos">603</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-604"><a href="#SpProportionalityValidator.validate_parent_child_relationships-604"><span class="linenos">604</span></a>            <span class="n">children_codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">subdataset</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-605"><a href="#SpProportionalityValidator.validate_parent_child_relationships-605"><span class="linenos">605</span></a>            <span class="n">children_codes_cleaned</span> <span class="o">=</span> <span class="p">[</span><span class="n">filho</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">filho</span> <span class="ow">in</span> <span class="n">children_codes</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-606"><a href="#SpProportionalityValidator.validate_parent_child_relationships-606"><span class="linenos">606</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-607"><a href="#SpProportionalityValidator.validate_parent_child_relationships-607"><span class="linenos">607</span></a>            <span class="n">dict_children_codes_cleaned</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-608"><a href="#SpProportionalityValidator.validate_parent_child_relationships-608"><span class="linenos">608</span></a>            <span class="n">dict_children_codes_cleaned</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">cleaned_parent_id</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">children_codes_cleaned</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-609"><a href="#SpProportionalityValidator.validate_parent_child_relationships-609"><span class="linenos">609</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-610"><a href="#SpProportionalityValidator.validate_parent_child_relationships-610"><span class="linenos">610</span></a>            <span class="n">set_errors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-611"><a href="#SpProportionalityValidator.validate_parent_child_relationships-611"><span class="linenos">611</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: O indicador &#39;</span><span class="si">{</span><span class="n">filho</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">filho_orig</span><span class="si">}</span><span class="s2">&#39;) no  filho do indicador &#39;</span><span class="si">{</span><span class="n">cleaned_parent_id</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">parent_id</span><span class="si">}</span><span class="s2">&#39;) conforme especificado em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-612"><a href="#SpProportionalityValidator.validate_parent_child_relationships-612"><span class="linenos">612</span></a>                <span class="k">for</span> <span class="n">filho</span><span class="p">,</span> <span class="n">filho_orig</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">children_codes_cleaned</span><span class="p">,</span> <span class="n">children_codes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-613"><a href="#SpProportionalityValidator.validate_parent_child_relationships-613"><span class="linenos">613</span></a>                <span class="k">if</span> <span class="n">filho</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">cleaned_parent_id</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-614"><a href="#SpProportionalityValidator.validate_parent_child_relationships-614"><span class="linenos">614</span></a>            <span class="p">}</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-615"><a href="#SpProportionalityValidator.validate_parent_child_relationships-615"><span class="linenos">615</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">set_errors</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-616"><a href="#SpProportionalityValidator.validate_parent_child_relationships-616"><span class="linenos">616</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-617"><a href="#SpProportionalityValidator.validate_parent_child_relationships-617"><span class="linenos">617</span></a>            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">dict_grouped_composition</span><span class="p">[</span><span class="n">cleaned_parent_id</span><span class="p">]:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-618"><a href="#SpProportionalityValidator.validate_parent_child_relationships-618"><span class="linenos">618</span></a>                <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_children_codes_cleaned</span><span class="p">[</span><span class="n">cleaned_parent_id</span><span class="p">]:</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-619"><a href="#SpProportionalityValidator.validate_parent_child_relationships-619"><span class="linenos">619</span></a>                    <span class="n">code_pai_local</span> <span class="o">=</span> <span class="n">parent_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-620"><a href="#SpProportionalityValidator.validate_parent_child_relationships-620"><span class="linenos">620</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-621"><a href="#SpProportionalityValidator.validate_parent_child_relationships-621"><span class="linenos">621</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="si">}</span><span class="s2">: Deve existir pelo menos uma relao do indicador filho &#39;</span><span class="si">{</span><span class="n">child</span><span class="si">}</span><span class="s2">&#39; com o indicador pai &#39;</span><span class="si">{</span><span class="n">code_pai_local</span><span class="si">}</span><span class="s2">&#39; (em &#39;</span><span class="si">{</span><span class="n">parent_id</span><span class="si">}</span><span class="s2">&#39;) conforme especificado em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_composition</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-622"><a href="#SpProportionalityValidator.validate_parent_child_relationships-622"><span class="linenos">622</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-623"><a href="#SpProportionalityValidator.validate_parent_child_relationships-623"><span class="linenos">623</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-624"><a href="#SpProportionalityValidator.validate_parent_child_relationships-624"><span class="linenos">624</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-625"><a href="#SpProportionalityValidator.validate_parent_child_relationships-625"><span class="linenos">625</span></a>
</span><span id="SpProportionalityValidator.validate_parent_child_relationships-626"><a href="#SpProportionalityValidator.validate_parent_child_relationships-626"><span class="linenos">626</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate parent-child relationships against composition definitions.</p>

<p>Ensures that:</p>

<ul>
<li>All parent indicators in proportionality exist in composition</li>
<li>All children listed under a parent match composition relationships</li>
<li>All composition children are present in proportionality subdatasets</li>
<li>Relationships are consistent with composition hierarchy</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for relationship inconsistencies
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if composition dataframe is empty</li>
<li>Level 1 parents are automatically excluded from validation</li>
<li>Compares cleaned indicator codes (without scenario suffixes)</li>
<li>Bidirectional validation ensures complete consistency</li>
</ul>
</div>


                            </div>
                            <div id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors" class="classattr">
                                        <input id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_sum_properties_in_influencing_factors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-628"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-628"><span class="linenos">628</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_sum_properties_in_influencing_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-629"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-629"><span class="linenos">629</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-630"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-630"><span class="linenos">630</span></a><span class="sd">        Validate that proportion sums equal 1.0 for all influencing factor subdatasets.</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-631"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-631"><span class="linenos">631</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-632"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-632"><span class="linenos">632</span></a><span class="sd">        Performs comprehensive sum validation by:</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-633"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-633"><span class="linenos">633</span></a><span class="sd">        - Building subdatasets for each parent indicator</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-634"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-634"><span class="linenos">634</span></a><span class="sd">        - Validating numeric format of proportion values</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-635"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-635"><span class="linenos">635</span></a><span class="sd">        - Checking that proportions sum to exactly 1.0 (with tolerance)</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-636"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-636"><span class="linenos">636</span></a><span class="sd">        - Identifying excessive decimal places</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-637"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-637"><span class="linenos">637</span></a><span class="sd">        - Cross-validating with value spreadsheet for unavailable data</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-638"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-638"><span class="linenos">638</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-639"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-639"><span class="linenos">639</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-640"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-640"><span class="linenos">640</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-641"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-641"><span class="linenos">641</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-642"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-642"><span class="linenos">642</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-643"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-643"><span class="linenos">643</span></a><span class="sd">                - List[str]: Error messages for sum violations and format issues</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-644"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-644"><span class="linenos">644</span></a><span class="sd">                - List[str]: Warning messages for excessive decimals</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-645"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-645"><span class="linenos">645</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-646"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-646"><span class="linenos">646</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-647"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-647"><span class="linenos">647</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-648"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-648"><span class="linenos">648</span></a><span class="sd">        - Validation is skipped if value dataframe is empty</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-649"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-649"><span class="linenos">649</span></a><span class="sd">        - Uses Decimal arithmetic for precise calculations</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-650"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-650"><span class="linenos">650</span></a><span class="sd">        - Tolerance for sum validation is configurable</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-651"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-651"><span class="linenos">651</span></a><span class="sd">        - Unavailable data markers are excluded from sum calculations</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-652"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-652"><span class="linenos">652</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-653"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-653"><span class="linenos">653</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-654"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-654"><span class="linenos">654</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-655"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-655"><span class="linenos">655</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-656"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-656"><span class="linenos">656</span></a>                <span class="p">[</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-657"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-657"><span class="linenos">657</span></a>                    <span class="p">(</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-658"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-658"><span class="linenos">658</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">validate_sum_properties_in_influencing_factors</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-659"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-659"><span class="linenos">659</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SUM_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-660"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-660"><span class="linenos">660</span></a>                    <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-661"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-661"><span class="linenos">661</span></a>                <span class="p">]</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-662"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-662"><span class="linenos">662</span></a>            <span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-663"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-663"><span class="linenos">663</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-664"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-664"><span class="linenos">664</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-665"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-665"><span class="linenos">665</span></a>        <span class="c1"># Only with description and composition data (should be equal, just extract)</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-666"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-666"><span class="linenos">666</span></a>        <span class="n">local_required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-667"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-667"><span class="linenos">667</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-668"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-668"><span class="linenos">668</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">],</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-669"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-669"><span class="linenos">669</span></a>        <span class="p">}</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-670"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-670"><span class="linenos">670</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-671"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-671"><span class="linenos">671</span></a>        <span class="c1"># Check required columns exist</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-672"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-672"><span class="linenos">672</span></a>        <span class="n">column_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_columns_in_models_dataframes</span><span class="p">(</span><span class="n">local_required_columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-673"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="n">column_errors</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-674"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-674"><span class="linenos">674</span></a>            <span class="k">return</span> <span class="n">column_errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-675"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-675"><span class="linenos">675</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-676"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-676"><span class="linenos">676</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-677"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-677"><span class="linenos">677</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-678"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-678"><span class="linenos">678</span></a>        <span class="n">subdatasets</span> <span class="o">=</span> <span class="n">ProportionalityProcessing</span><span class="o">.</span><span class="n">build_subdatasets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_proportionality</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_name_id</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-679"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-679"><span class="linenos">679</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-680"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-680"><span class="linenos">680</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_sum_equals_one</span><span class="p">(</span><span class="n">subdatasets</span><span class="p">,</span> <span class="n">df_values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">VALUE_DATA_UNAVAILABLE</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-681"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-681"><span class="linenos">681</span></a>
</span><span id="SpProportionalityValidator.validate_sum_properties_in_influencing_factors-682"><a href="#SpProportionalityValidator.validate_sum_properties_in_influencing_factors-682"><span class="linenos">682</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate that proportion sums equal 1.0 for all influencing factor subdatasets.</p>

<p>Performs comprehensive sum validation by:</p>

<ul>
<li>Building subdatasets for each parent indicator</li>
<li>Validating numeric format of proportion values</li>
<li>Checking that proportions sum to exactly 1.0 (with tolerance)</li>
<li>Identifying excessive decimal places</li>
<li>Cross-validating with value spreadsheet for unavailable data</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for sum violations and format issues
        - List[str]: Warning messages for excessive decimals</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if value dataframe is empty</li>
<li>Uses Decimal arithmetic for precise calculations</li>
<li>Tolerance for sum validation is configurable</li>
<li>Unavailable data markers are excluded from sum calculations</li>
</ul>
</div>


                            </div>
                            <div id="SpProportionalityValidator.run" class="classattr">
                                        <input id="SpProportionalityValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpProportionalityValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpProportionalityValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpProportionalityValidator.run-684"><a href="#SpProportionalityValidator.run-684"><span class="linenos">684</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpProportionalityValidator.run-685"><a href="#SpProportionalityValidator.run-685"><span class="linenos">685</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.run-686"><a href="#SpProportionalityValidator.run-686"><span class="linenos">686</span></a><span class="sd">        Execute all proportionality validations.</span>
</span><span id="SpProportionalityValidator.run-687"><a href="#SpProportionalityValidator.run-687"><span class="linenos">687</span></a>
</span><span id="SpProportionalityValidator.run-688"><a href="#SpProportionalityValidator.run-688"><span class="linenos">688</span></a><span class="sd">        Orchestrates the execution of all proportionality validators including:</span>
</span><span id="SpProportionalityValidator.run-689"><a href="#SpProportionalityValidator.run-689"><span class="linenos">689</span></a><span class="sd">        - Indicator relationship validation with description</span>
</span><span id="SpProportionalityValidator.run-690"><a href="#SpProportionalityValidator.run-690"><span class="linenos">690</span></a><span class="sd">        - Duplicate parent indicator detection</span>
</span><span id="SpProportionalityValidator.run-691"><a href="#SpProportionalityValidator.run-691"><span class="linenos">691</span></a><span class="sd">        - Value-proportionality consistency validation</span>
</span><span id="SpProportionalityValidator.run-692"><a href="#SpProportionalityValidator.run-692"><span class="linenos">692</span></a><span class="sd">        - Parent-child relationship validation against composition</span>
</span><span id="SpProportionalityValidator.run-693"><a href="#SpProportionalityValidator.run-693"><span class="linenos">693</span></a><span class="sd">        - Sum properties validation (proportions must sum to 1.0)</span>
</span><span id="SpProportionalityValidator.run-694"><a href="#SpProportionalityValidator.run-694"><span class="linenos">694</span></a>
</span><span id="SpProportionalityValidator.run-695"><a href="#SpProportionalityValidator.run-695"><span class="linenos">695</span></a><span class="sd">        Returns</span>
</span><span id="SpProportionalityValidator.run-696"><a href="#SpProportionalityValidator.run-696"><span class="linenos">696</span></a><span class="sd">        -------</span>
</span><span id="SpProportionalityValidator.run-697"><a href="#SpProportionalityValidator.run-697"><span class="linenos">697</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpProportionalityValidator.run-698"><a href="#SpProportionalityValidator.run-698"><span class="linenos">698</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpProportionalityValidator.run-699"><a href="#SpProportionalityValidator.run-699"><span class="linenos">699</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpProportionalityValidator.run-700"><a href="#SpProportionalityValidator.run-700"><span class="linenos">700</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpProportionalityValidator.run-701"><a href="#SpProportionalityValidator.run-701"><span class="linenos">701</span></a>
</span><span id="SpProportionalityValidator.run-702"><a href="#SpProportionalityValidator.run-702"><span class="linenos">702</span></a><span class="sd">        Notes</span>
</span><span id="SpProportionalityValidator.run-703"><a href="#SpProportionalityValidator.run-703"><span class="linenos">703</span></a><span class="sd">        -----</span>
</span><span id="SpProportionalityValidator.run-704"><a href="#SpProportionalityValidator.run-704"><span class="linenos">704</span></a><span class="sd">        - All validations are skipped if proportionality dataframe is empty</span>
</span><span id="SpProportionalityValidator.run-705"><a href="#SpProportionalityValidator.run-705"><span class="linenos">705</span></a><span class="sd">        - Validations are conditionally executed based on related data availability</span>
</span><span id="SpProportionalityValidator.run-706"><a href="#SpProportionalityValidator.run-706"><span class="linenos">706</span></a><span class="sd">        - Results are aggregated into reports via `build_reports()`</span>
</span><span id="SpProportionalityValidator.run-707"><a href="#SpProportionalityValidator.run-707"><span class="linenos">707</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpProportionalityValidator.run-708"><a href="#SpProportionalityValidator.run-708"><span class="linenos">708</span></a>
</span><span id="SpProportionalityValidator.run-709"><a href="#SpProportionalityValidator.run-709"><span class="linenos">709</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpProportionalityValidator.run-710"><a href="#SpProportionalityValidator.run-710"><span class="linenos">710</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_proportionality</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator.run-711"><a href="#SpProportionalityValidator.run-711"><span class="linenos">711</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_columns_repeated_indicators</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">REP_IND_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator.run-712"><a href="#SpProportionalityValidator.run-712"><span class="linenos">712</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_value_and_proportionality</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IND_VAL_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator.run-713"><a href="#SpProportionalityValidator.run-713"><span class="linenos">713</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_parent_child_relationships</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">IR_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator.run-714"><a href="#SpProportionalityValidator.run-714"><span class="linenos">714</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_sum_properties_in_influencing_factors</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SUM_PROP</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpProportionalityValidator.run-715"><a href="#SpProportionalityValidator.run-715"><span class="linenos">715</span></a>        <span class="p">]</span>
</span><span id="SpProportionalityValidator.run-716"><a href="#SpProportionalityValidator.run-716"><span class="linenos">716</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpProportionalityValidator.run-717"><a href="#SpProportionalityValidator.run-717"><span class="linenos">717</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.run-718"><a href="#SpProportionalityValidator.run-718"><span class="linenos">718</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpProportionalityValidator.run-719"><a href="#SpProportionalityValidator.run-719"><span class="linenos">719</span></a>
</span><span id="SpProportionalityValidator.run-720"><a href="#SpProportionalityValidator.run-720"><span class="linenos">720</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpProportionalityValidator.run-721"><a href="#SpProportionalityValidator.run-721"><span class="linenos">721</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpProportionalityValidator.run-722"><a href="#SpProportionalityValidator.run-722"><span class="linenos">722</span></a>
</span><span id="SpProportionalityValidator.run-723"><a href="#SpProportionalityValidator.run-723"><span class="linenos">723</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all proportionality validations.</p>

<p>Orchestrates the execution of all proportionality validators including:</p>

<ul>
<li>Indicator relationship validation with description</li>
<li>Duplicate parent indicator detection</li>
<li>Value-proportionality consistency validation</li>
<li>Parent-child relationship validation against composition</li>
<li>Sum properties validation (proportions must sum to 1.0)</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<ul>
<li>All validations are skipped if proportionality dataframe is empty</li>
<li>Validations are conditionally executed based on related data availability</li>
<li>Results are aggregated into reports via <code><a href="#SpProportionalityValidator.build_reports">build_reports()</a></code></li>
</ul>
</div>


                            </div>
                </section>
                <section id="SpScenarioValidator">
                            <input id="SpScenarioValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpScenarioValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpScenarioValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpScenarioValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpScenarioValidator-21"><a href="#SpScenarioValidator-21"><span class="linenos"> 21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpScenarioValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpScenarioValidator-22"><a href="#SpScenarioValidator-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-23"><a href="#SpScenarioValidator-23"><span class="linenos"> 23</span></a><span class="sd">    Validates Scenario spreadsheet content.</span>
</span><span id="SpScenarioValidator-24"><a href="#SpScenarioValidator-24"><span class="linenos"> 24</span></a>
</span><span id="SpScenarioValidator-25"><a href="#SpScenarioValidator-25"><span class="linenos"> 25</span></a><span class="sd">    This validator performs comprehensive checks on scenario data including:</span>
</span><span id="SpScenarioValidator-26"><a href="#SpScenarioValidator-26"><span class="linenos"> 26</span></a><span class="sd">    - Punctuation validation for name and description fields</span>
</span><span id="SpScenarioValidator-27"><a href="#SpScenarioValidator-27"><span class="linenos"> 27</span></a><span class="sd">    - Unique value constraints for name and symbol columns</span>
</span><span id="SpScenarioValidator-28"><a href="#SpScenarioValidator-28"><span class="linenos"> 28</span></a>
</span><span id="SpScenarioValidator-29"><a href="#SpScenarioValidator-29"><span class="linenos"> 29</span></a><span class="sd">    Notes</span>
</span><span id="SpScenarioValidator-30"><a href="#SpScenarioValidator-30"><span class="linenos"> 30</span></a><span class="sd">    -----</span>
</span><span id="SpScenarioValidator-31"><a href="#SpScenarioValidator-31"><span class="linenos"> 31</span></a><span class="sd">    Inherits validation infrastructure from ValidatorModelABC including column</span>
</span><span id="SpScenarioValidator-32"><a href="#SpScenarioValidator-32"><span class="linenos"> 32</span></a><span class="sd">    existence checks and report generation capabilities.</span>
</span><span id="SpScenarioValidator-33"><a href="#SpScenarioValidator-33"><span class="linenos"> 33</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-34"><a href="#SpScenarioValidator-34"><span class="linenos"> 34</span></a>
</span><span id="SpScenarioValidator-35"><a href="#SpScenarioValidator-35"><span class="linenos"> 35</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpScenarioValidator-36"><a href="#SpScenarioValidator-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpScenarioValidator-37"><a href="#SpScenarioValidator-37"><span class="linenos"> 37</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpScenarioValidator-38"><a href="#SpScenarioValidator-38"><span class="linenos"> 38</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpScenarioValidator-39"><a href="#SpScenarioValidator-39"><span class="linenos"> 39</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpScenarioValidator-40"><a href="#SpScenarioValidator-40"><span class="linenos"> 40</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpScenarioValidator-41"><a href="#SpScenarioValidator-41"><span class="linenos"> 41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-42"><a href="#SpScenarioValidator-42"><span class="linenos"> 42</span></a><span class="sd">        Initialize the Scenario validator.</span>
</span><span id="SpScenarioValidator-43"><a href="#SpScenarioValidator-43"><span class="linenos"> 43</span></a>
</span><span id="SpScenarioValidator-44"><a href="#SpScenarioValidator-44"><span class="linenos"> 44</span></a><span class="sd">        Args</span>
</span><span id="SpScenarioValidator-45"><a href="#SpScenarioValidator-45"><span class="linenos"> 45</span></a><span class="sd">        ----</span>
</span><span id="SpScenarioValidator-46"><a href="#SpScenarioValidator-46"><span class="linenos"> 46</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpScenarioValidator-47"><a href="#SpScenarioValidator-47"><span class="linenos"> 47</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpScenarioValidator-48"><a href="#SpScenarioValidator-48"><span class="linenos"> 48</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpScenarioValidator-49"><a href="#SpScenarioValidator-49"><span class="linenos"> 49</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpScenarioValidator-50"><a href="#SpScenarioValidator-50"><span class="linenos"> 50</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpScenarioValidator-51"><a href="#SpScenarioValidator-51"><span class="linenos"> 51</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpScenarioValidator-52"><a href="#SpScenarioValidator-52"><span class="linenos"> 52</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-53"><a href="#SpScenarioValidator-53"><span class="linenos"> 53</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpScenarioValidator-54"><a href="#SpScenarioValidator-54"><span class="linenos"> 54</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpScenarioValidator-55"><a href="#SpScenarioValidator-55"><span class="linenos"> 55</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpScenarioValidator-56"><a href="#SpScenarioValidator-56"><span class="linenos"> 56</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpScenario</span><span class="p">,</span>
</span><span id="SpScenarioValidator-57"><a href="#SpScenarioValidator-57"><span class="linenos"> 57</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpScenarioValidator-58"><a href="#SpScenarioValidator-58"><span class="linenos"> 58</span></a>        <span class="p">)</span>
</span><span id="SpScenarioValidator-59"><a href="#SpScenarioValidator-59"><span class="linenos"> 59</span></a>
</span><span id="SpScenarioValidator-60"><a href="#SpScenarioValidator-60"><span class="linenos"> 60</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpScenarioValidator-61"><a href="#SpScenarioValidator-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpScenarioValidator-62"><a href="#SpScenarioValidator-62"><span class="linenos"> 62</span></a>
</span><span id="SpScenarioValidator-63"><a href="#SpScenarioValidator-63"><span class="linenos"> 63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_punctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpScenarioValidator-64"><a href="#SpScenarioValidator-64"><span class="linenos"> 64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-65"><a href="#SpScenarioValidator-65"><span class="linenos"> 65</span></a><span class="sd">        Validate punctuation rules for scenario fields.</span>
</span><span id="SpScenarioValidator-66"><a href="#SpScenarioValidator-66"><span class="linenos"> 66</span></a>
</span><span id="SpScenarioValidator-67"><a href="#SpScenarioValidator-67"><span class="linenos"> 67</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpScenarioValidator-68"><a href="#SpScenarioValidator-68"><span class="linenos"> 68</span></a><span class="sd">        - Name fields do not end with punctuation</span>
</span><span id="SpScenarioValidator-69"><a href="#SpScenarioValidator-69"><span class="linenos"> 69</span></a><span class="sd">        - Description fields end with a period (.)</span>
</span><span id="SpScenarioValidator-70"><a href="#SpScenarioValidator-70"><span class="linenos"> 70</span></a>
</span><span id="SpScenarioValidator-71"><a href="#SpScenarioValidator-71"><span class="linenos"> 71</span></a><span class="sd">        Returns</span>
</span><span id="SpScenarioValidator-72"><a href="#SpScenarioValidator-72"><span class="linenos"> 72</span></a><span class="sd">        -------</span>
</span><span id="SpScenarioValidator-73"><a href="#SpScenarioValidator-73"><span class="linenos"> 73</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpScenarioValidator-74"><a href="#SpScenarioValidator-74"><span class="linenos"> 74</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpScenarioValidator-75"><a href="#SpScenarioValidator-75"><span class="linenos"> 75</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpScenarioValidator-76"><a href="#SpScenarioValidator-76"><span class="linenos"> 76</span></a><span class="sd">                - List[str]: Warning messages for punctuation violations</span>
</span><span id="SpScenarioValidator-77"><a href="#SpScenarioValidator-77"><span class="linenos"> 77</span></a>
</span><span id="SpScenarioValidator-78"><a href="#SpScenarioValidator-78"><span class="linenos"> 78</span></a><span class="sd">        Notes</span>
</span><span id="SpScenarioValidator-79"><a href="#SpScenarioValidator-79"><span class="linenos"> 79</span></a><span class="sd">        -----</span>
</span><span id="SpScenarioValidator-80"><a href="#SpScenarioValidator-80"><span class="linenos"> 80</span></a><span class="sd">        - COLUMN_NAME: Must not end with punctuation</span>
</span><span id="SpScenarioValidator-81"><a href="#SpScenarioValidator-81"><span class="linenos"> 81</span></a><span class="sd">        - COLUMN_DESCRIPTION: Must end with a period</span>
</span><span id="SpScenarioValidator-82"><a href="#SpScenarioValidator-82"><span class="linenos"> 82</span></a><span class="sd">        - Missing columns generate warnings rather than errors</span>
</span><span id="SpScenarioValidator-83"><a href="#SpScenarioValidator-83"><span class="linenos"> 83</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-84"><a href="#SpScenarioValidator-84"><span class="linenos"> 84</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpScenarioValidator-85"><a href="#SpScenarioValidator-85"><span class="linenos"> 85</span></a>
</span><span id="SpScenarioValidator-86"><a href="#SpScenarioValidator-86"><span class="linenos"> 86</span></a>        <span class="n">columns_dont_punctuation</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpScenarioValidator-87"><a href="#SpScenarioValidator-87"><span class="linenos"> 87</span></a>        <span class="n">columns_must_end_with_dot</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpScenarioValidator-88"><a href="#SpScenarioValidator-88"><span class="linenos"> 88</span></a>
</span><span id="SpScenarioValidator-89"><a href="#SpScenarioValidator-89"><span class="linenos"> 89</span></a>        <span class="n">list_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns_dont_punctuation</span> <span class="o">+</span> <span class="n">columns_must_end_with_dot</span><span class="p">)</span>
</span><span id="SpScenarioValidator-90"><a href="#SpScenarioValidator-90"><span class="linenos"> 90</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">list_columns</span><span class="p">:</span>
</span><span id="SpScenarioValidator-91"><a href="#SpScenarioValidator-91"><span class="linenos"> 91</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpScenarioValidator-92"><a href="#SpScenarioValidator-92"><span class="linenos"> 92</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpScenarioValidator-93"><a href="#SpScenarioValidator-93"><span class="linenos"> 93</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpScenarioValidator-94"><a href="#SpScenarioValidator-94"><span class="linenos"> 94</span></a>
</span><span id="SpScenarioValidator-95"><a href="#SpScenarioValidator-95"><span class="linenos"> 95</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">punctuation_warnings</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_characters_punctuation_rules</span><span class="p">(</span>
</span><span id="SpScenarioValidator-96"><a href="#SpScenarioValidator-96"><span class="linenos"> 96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpScenarioValidator-97"><a href="#SpScenarioValidator-97"><span class="linenos"> 97</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpScenarioValidator-98"><a href="#SpScenarioValidator-98"><span class="linenos"> 98</span></a>            <span class="n">columns_dont_punctuation</span><span class="p">,</span>
</span><span id="SpScenarioValidator-99"><a href="#SpScenarioValidator-99"><span class="linenos"> 99</span></a>            <span class="n">columns_must_end_with_dot</span><span class="p">,</span>
</span><span id="SpScenarioValidator-100"><a href="#SpScenarioValidator-100"><span class="linenos">100</span></a>        <span class="p">)</span>
</span><span id="SpScenarioValidator-101"><a href="#SpScenarioValidator-101"><span class="linenos">101</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">punctuation_warnings</span><span class="p">)</span>
</span><span id="SpScenarioValidator-102"><a href="#SpScenarioValidator-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span><span id="SpScenarioValidator-103"><a href="#SpScenarioValidator-103"><span class="linenos">103</span></a>
</span><span id="SpScenarioValidator-104"><a href="#SpScenarioValidator-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpScenarioValidator-105"><a href="#SpScenarioValidator-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-106"><a href="#SpScenarioValidator-106"><span class="linenos">106</span></a><span class="sd">        Validate uniqueness of scenario identifiers.</span>
</span><span id="SpScenarioValidator-107"><a href="#SpScenarioValidator-107"><span class="linenos">107</span></a>
</span><span id="SpScenarioValidator-108"><a href="#SpScenarioValidator-108"><span class="linenos">108</span></a><span class="sd">        Ensures that all values in the name and symbol columns are unique across</span>
</span><span id="SpScenarioValidator-109"><a href="#SpScenarioValidator-109"><span class="linenos">109</span></a><span class="sd">        the entire scenario dataset to prevent duplicate scenario definitions.</span>
</span><span id="SpScenarioValidator-110"><a href="#SpScenarioValidator-110"><span class="linenos">110</span></a>
</span><span id="SpScenarioValidator-111"><a href="#SpScenarioValidator-111"><span class="linenos">111</span></a><span class="sd">        Returns</span>
</span><span id="SpScenarioValidator-112"><a href="#SpScenarioValidator-112"><span class="linenos">112</span></a><span class="sd">        -------</span>
</span><span id="SpScenarioValidator-113"><a href="#SpScenarioValidator-113"><span class="linenos">113</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpScenarioValidator-114"><a href="#SpScenarioValidator-114"><span class="linenos">114</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpScenarioValidator-115"><a href="#SpScenarioValidator-115"><span class="linenos">115</span></a><span class="sd">                - List[str]: Error messages for duplicate values</span>
</span><span id="SpScenarioValidator-116"><a href="#SpScenarioValidator-116"><span class="linenos">116</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpScenarioValidator-117"><a href="#SpScenarioValidator-117"><span class="linenos">117</span></a>
</span><span id="SpScenarioValidator-118"><a href="#SpScenarioValidator-118"><span class="linenos">118</span></a><span class="sd">        Notes</span>
</span><span id="SpScenarioValidator-119"><a href="#SpScenarioValidator-119"><span class="linenos">119</span></a><span class="sd">        -----</span>
</span><span id="SpScenarioValidator-120"><a href="#SpScenarioValidator-120"><span class="linenos">120</span></a><span class="sd">        Validates uniqueness for:</span>
</span><span id="SpScenarioValidator-121"><a href="#SpScenarioValidator-121"><span class="linenos">121</span></a><span class="sd">        - COLUMN_NAME: Scenario names must be unique</span>
</span><span id="SpScenarioValidator-122"><a href="#SpScenarioValidator-122"><span class="linenos">122</span></a><span class="sd">        - COLUMN_SYMBOL: Scenario symbols must be unique</span>
</span><span id="SpScenarioValidator-123"><a href="#SpScenarioValidator-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-124"><a href="#SpScenarioValidator-124"><span class="linenos">124</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpScenarioValidator-125"><a href="#SpScenarioValidator-125"><span class="linenos">125</span></a>
</span><span id="SpScenarioValidator-126"><a href="#SpScenarioValidator-126"><span class="linenos">126</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpScenarioValidator-127"><a href="#SpScenarioValidator-127"><span class="linenos">127</span></a>            <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpScenarioValidator-128"><a href="#SpScenarioValidator-128"><span class="linenos">128</span></a>            <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpScenarioValidator-129"><a href="#SpScenarioValidator-129"><span class="linenos">129</span></a>        <span class="p">]</span>
</span><span id="SpScenarioValidator-130"><a href="#SpScenarioValidator-130"><span class="linenos">130</span></a>
</span><span id="SpScenarioValidator-131"><a href="#SpScenarioValidator-131"><span class="linenos">131</span></a>        <span class="c1"># Check if columns exist</span>
</span><span id="SpScenarioValidator-132"><a href="#SpScenarioValidator-132"><span class="linenos">132</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpScenarioValidator-133"><a href="#SpScenarioValidator-133"><span class="linenos">133</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpScenarioValidator-134"><a href="#SpScenarioValidator-134"><span class="linenos">134</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpScenarioValidator-135"><a href="#SpScenarioValidator-135"><span class="linenos">135</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpScenarioValidator-136"><a href="#SpScenarioValidator-136"><span class="linenos">136</span></a>
</span><span id="SpScenarioValidator-137"><a href="#SpScenarioValidator-137"><span class="linenos">137</span></a>        <span class="n">__</span><span class="p">,</span> <span class="n">unique_errors</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">check_dataframe_unique_values</span><span class="p">(</span>
</span><span id="SpScenarioValidator-138"><a href="#SpScenarioValidator-138"><span class="linenos">138</span></a>            <span class="n">dataframe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpScenarioValidator-139"><a href="#SpScenarioValidator-139"><span class="linenos">139</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpScenarioValidator-140"><a href="#SpScenarioValidator-140"><span class="linenos">140</span></a>            <span class="n">columns_uniques</span><span class="o">=</span><span class="n">columns_to_check</span><span class="p">,</span>
</span><span id="SpScenarioValidator-141"><a href="#SpScenarioValidator-141"><span class="linenos">141</span></a>        <span class="p">)</span>
</span><span id="SpScenarioValidator-142"><a href="#SpScenarioValidator-142"><span class="linenos">142</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">unique_errors</span><span class="p">)</span>
</span><span id="SpScenarioValidator-143"><a href="#SpScenarioValidator-143"><span class="linenos">143</span></a>
</span><span id="SpScenarioValidator-144"><a href="#SpScenarioValidator-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="SpScenarioValidator-145"><a href="#SpScenarioValidator-145"><span class="linenos">145</span></a>
</span><span id="SpScenarioValidator-146"><a href="#SpScenarioValidator-146"><span class="linenos">146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpScenarioValidator-147"><a href="#SpScenarioValidator-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-148"><a href="#SpScenarioValidator-148"><span class="linenos">148</span></a><span class="sd">        Prepare validation statements.</span>
</span><span id="SpScenarioValidator-149"><a href="#SpScenarioValidator-149"><span class="linenos">149</span></a>
</span><span id="SpScenarioValidator-150"><a href="#SpScenarioValidator-150"><span class="linenos">150</span></a><span class="sd">        This method is currently a placeholder for future initialization logic</span>
</span><span id="SpScenarioValidator-151"><a href="#SpScenarioValidator-151"><span class="linenos">151</span></a><span class="sd">        that may be needed before running validations.</span>
</span><span id="SpScenarioValidator-152"><a href="#SpScenarioValidator-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-153"><a href="#SpScenarioValidator-153"><span class="linenos">153</span></a>        <span class="k">pass</span>
</span><span id="SpScenarioValidator-154"><a href="#SpScenarioValidator-154"><span class="linenos">154</span></a>
</span><span id="SpScenarioValidator-155"><a href="#SpScenarioValidator-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpScenarioValidator-156"><a href="#SpScenarioValidator-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-157"><a href="#SpScenarioValidator-157"><span class="linenos">157</span></a><span class="sd">        Execute all scenario validations.</span>
</span><span id="SpScenarioValidator-158"><a href="#SpScenarioValidator-158"><span class="linenos">158</span></a>
</span><span id="SpScenarioValidator-159"><a href="#SpScenarioValidator-159"><span class="linenos">159</span></a><span class="sd">        Orchestrates the execution of all scenario validators including:</span>
</span><span id="SpScenarioValidator-160"><a href="#SpScenarioValidator-160"><span class="linenos">160</span></a><span class="sd">        - Punctuation validation for names and descriptions</span>
</span><span id="SpScenarioValidator-161"><a href="#SpScenarioValidator-161"><span class="linenos">161</span></a><span class="sd">        - Unique value validation for names and symbols</span>
</span><span id="SpScenarioValidator-162"><a href="#SpScenarioValidator-162"><span class="linenos">162</span></a>
</span><span id="SpScenarioValidator-163"><a href="#SpScenarioValidator-163"><span class="linenos">163</span></a><span class="sd">        Returns</span>
</span><span id="SpScenarioValidator-164"><a href="#SpScenarioValidator-164"><span class="linenos">164</span></a><span class="sd">        -------</span>
</span><span id="SpScenarioValidator-165"><a href="#SpScenarioValidator-165"><span class="linenos">165</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpScenarioValidator-166"><a href="#SpScenarioValidator-166"><span class="linenos">166</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpScenarioValidator-167"><a href="#SpScenarioValidator-167"><span class="linenos">167</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpScenarioValidator-168"><a href="#SpScenarioValidator-168"><span class="linenos">168</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpScenarioValidator-169"><a href="#SpScenarioValidator-169"><span class="linenos">169</span></a>
</span><span id="SpScenarioValidator-170"><a href="#SpScenarioValidator-170"><span class="linenos">170</span></a><span class="sd">        Notes</span>
</span><span id="SpScenarioValidator-171"><a href="#SpScenarioValidator-171"><span class="linenos">171</span></a><span class="sd">        -----</span>
</span><span id="SpScenarioValidator-172"><a href="#SpScenarioValidator-172"><span class="linenos">172</span></a><span class="sd">        All validations are skipped if the scenario dataframe is empty.</span>
</span><span id="SpScenarioValidator-173"><a href="#SpScenarioValidator-173"><span class="linenos">173</span></a><span class="sd">        Results are aggregated into reports via `build_reports()`.</span>
</span><span id="SpScenarioValidator-174"><a href="#SpScenarioValidator-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator-175"><a href="#SpScenarioValidator-175"><span class="linenos">175</span></a>
</span><span id="SpScenarioValidator-176"><a href="#SpScenarioValidator-176"><span class="linenos">176</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpScenarioValidator-177"><a href="#SpScenarioValidator-177"><span class="linenos">177</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_punctuation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">MAND_PUNC_SCEN</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpScenarioValidator-178"><a href="#SpScenarioValidator-178"><span class="linenos">178</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UVR_SCEN</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpScenarioValidator-179"><a href="#SpScenarioValidator-179"><span class="linenos">179</span></a>        <span class="p">]</span>
</span><span id="SpScenarioValidator-180"><a href="#SpScenarioValidator-180"><span class="linenos">180</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpScenarioValidator-181"><a href="#SpScenarioValidator-181"><span class="linenos">181</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpScenarioValidator-182"><a href="#SpScenarioValidator-182"><span class="linenos">182</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpScenarioValidator-183"><a href="#SpScenarioValidator-183"><span class="linenos">183</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpScenarioValidator-184"><a href="#SpScenarioValidator-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpScenarioValidator-185"><a href="#SpScenarioValidator-185"><span class="linenos">185</span></a>
</span><span id="SpScenarioValidator-186"><a href="#SpScenarioValidator-186"><span class="linenos">186</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates Scenario spreadsheet content.</p>

<p>This validator performs comprehensive checks on scenario data including:</p>

<ul>
<li>Punctuation validation for name and description fields</li>
<li>Unique value constraints for name and symbol columns</li>
</ul>

<h2 id="notes">Notes</h2>

<p>Inherits validation infrastructure from ValidatorModelABC including column
existence checks and report generation capabilities.</p>
</div>


                            <div id="SpScenarioValidator.__init__" class="classattr">
                                        <input id="SpScenarioValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpScenarioValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpScenarioValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpScenarioValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpScenarioValidator.__init__-35"><a href="#SpScenarioValidator.__init__-35"><span class="linenos">35</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpScenarioValidator.__init__-36"><a href="#SpScenarioValidator.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpScenarioValidator.__init__-37"><a href="#SpScenarioValidator.__init__-37"><span class="linenos">37</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpScenarioValidator.__init__-38"><a href="#SpScenarioValidator.__init__-38"><span class="linenos">38</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpScenarioValidator.__init__-39"><a href="#SpScenarioValidator.__init__-39"><span class="linenos">39</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpScenarioValidator.__init__-40"><a href="#SpScenarioValidator.__init__-40"><span class="linenos">40</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpScenarioValidator.__init__-41"><a href="#SpScenarioValidator.__init__-41"><span class="linenos">41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.__init__-42"><a href="#SpScenarioValidator.__init__-42"><span class="linenos">42</span></a><span class="sd">        Initialize the Scenario validator.</span>
</span><span id="SpScenarioValidator.__init__-43"><a href="#SpScenarioValidator.__init__-43"><span class="linenos">43</span></a>
</span><span id="SpScenarioValidator.__init__-44"><a href="#SpScenarioValidator.__init__-44"><span class="linenos">44</span></a><span class="sd">        Args</span>
</span><span id="SpScenarioValidator.__init__-45"><a href="#SpScenarioValidator.__init__-45"><span class="linenos">45</span></a><span class="sd">        ----</span>
</span><span id="SpScenarioValidator.__init__-46"><a href="#SpScenarioValidator.__init__-46"><span class="linenos">46</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpScenarioValidator.__init__-47"><a href="#SpScenarioValidator.__init__-47"><span class="linenos">47</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpScenarioValidator.__init__-48"><a href="#SpScenarioValidator.__init__-48"><span class="linenos">48</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpScenarioValidator.__init__-49"><a href="#SpScenarioValidator.__init__-49"><span class="linenos">49</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpScenarioValidator.__init__-50"><a href="#SpScenarioValidator.__init__-50"><span class="linenos">50</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpScenarioValidator.__init__-51"><a href="#SpScenarioValidator.__init__-51"><span class="linenos">51</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpScenarioValidator.__init__-52"><a href="#SpScenarioValidator.__init__-52"><span class="linenos">52</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.__init__-53"><a href="#SpScenarioValidator.__init__-53"><span class="linenos">53</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpScenarioValidator.__init__-54"><a href="#SpScenarioValidator.__init__-54"><span class="linenos">54</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpScenarioValidator.__init__-55"><a href="#SpScenarioValidator.__init__-55"><span class="linenos">55</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpScenarioValidator.__init__-56"><a href="#SpScenarioValidator.__init__-56"><span class="linenos">56</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpScenario</span><span class="p">,</span>
</span><span id="SpScenarioValidator.__init__-57"><a href="#SpScenarioValidator.__init__-57"><span class="linenos">57</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpScenarioValidator.__init__-58"><a href="#SpScenarioValidator.__init__-58"><span class="linenos">58</span></a>        <span class="p">)</span>
</span><span id="SpScenarioValidator.__init__-59"><a href="#SpScenarioValidator.__init__-59"><span class="linenos">59</span></a>
</span><span id="SpScenarioValidator.__init__-60"><a href="#SpScenarioValidator.__init__-60"><span class="linenos">60</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpScenarioValidator.__init__-61"><a href="#SpScenarioValidator.__init__-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Scenario validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpScenarioValidator.validate_punctuation" class="classattr">
                                        <input id="SpScenarioValidator.validate_punctuation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_punctuation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpScenarioValidator.validate_punctuation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpScenarioValidator.validate_punctuation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpScenarioValidator.validate_punctuation-63"><a href="#SpScenarioValidator.validate_punctuation-63"><span class="linenos"> 63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_punctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpScenarioValidator.validate_punctuation-64"><a href="#SpScenarioValidator.validate_punctuation-64"><span class="linenos"> 64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.validate_punctuation-65"><a href="#SpScenarioValidator.validate_punctuation-65"><span class="linenos"> 65</span></a><span class="sd">        Validate punctuation rules for scenario fields.</span>
</span><span id="SpScenarioValidator.validate_punctuation-66"><a href="#SpScenarioValidator.validate_punctuation-66"><span class="linenos"> 66</span></a>
</span><span id="SpScenarioValidator.validate_punctuation-67"><a href="#SpScenarioValidator.validate_punctuation-67"><span class="linenos"> 67</span></a><span class="sd">        Ensures that:</span>
</span><span id="SpScenarioValidator.validate_punctuation-68"><a href="#SpScenarioValidator.validate_punctuation-68"><span class="linenos"> 68</span></a><span class="sd">        - Name fields do not end with punctuation</span>
</span><span id="SpScenarioValidator.validate_punctuation-69"><a href="#SpScenarioValidator.validate_punctuation-69"><span class="linenos"> 69</span></a><span class="sd">        - Description fields end with a period (.)</span>
</span><span id="SpScenarioValidator.validate_punctuation-70"><a href="#SpScenarioValidator.validate_punctuation-70"><span class="linenos"> 70</span></a>
</span><span id="SpScenarioValidator.validate_punctuation-71"><a href="#SpScenarioValidator.validate_punctuation-71"><span class="linenos"> 71</span></a><span class="sd">        Returns</span>
</span><span id="SpScenarioValidator.validate_punctuation-72"><a href="#SpScenarioValidator.validate_punctuation-72"><span class="linenos"> 72</span></a><span class="sd">        -------</span>
</span><span id="SpScenarioValidator.validate_punctuation-73"><a href="#SpScenarioValidator.validate_punctuation-73"><span class="linenos"> 73</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpScenarioValidator.validate_punctuation-74"><a href="#SpScenarioValidator.validate_punctuation-74"><span class="linenos"> 74</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpScenarioValidator.validate_punctuation-75"><a href="#SpScenarioValidator.validate_punctuation-75"><span class="linenos"> 75</span></a><span class="sd">                - List[str]: Empty list (no errors generated)</span>
</span><span id="SpScenarioValidator.validate_punctuation-76"><a href="#SpScenarioValidator.validate_punctuation-76"><span class="linenos"> 76</span></a><span class="sd">                - List[str]: Warning messages for punctuation violations</span>
</span><span id="SpScenarioValidator.validate_punctuation-77"><a href="#SpScenarioValidator.validate_punctuation-77"><span class="linenos"> 77</span></a>
</span><span id="SpScenarioValidator.validate_punctuation-78"><a href="#SpScenarioValidator.validate_punctuation-78"><span class="linenos"> 78</span></a><span class="sd">        Notes</span>
</span><span id="SpScenarioValidator.validate_punctuation-79"><a href="#SpScenarioValidator.validate_punctuation-79"><span class="linenos"> 79</span></a><span class="sd">        -----</span>
</span><span id="SpScenarioValidator.validate_punctuation-80"><a href="#SpScenarioValidator.validate_punctuation-80"><span class="linenos"> 80</span></a><span class="sd">        - COLUMN_NAME: Must not end with punctuation</span>
</span><span id="SpScenarioValidator.validate_punctuation-81"><a href="#SpScenarioValidator.validate_punctuation-81"><span class="linenos"> 81</span></a><span class="sd">        - COLUMN_DESCRIPTION: Must end with a period</span>
</span><span id="SpScenarioValidator.validate_punctuation-82"><a href="#SpScenarioValidator.validate_punctuation-82"><span class="linenos"> 82</span></a><span class="sd">        - Missing columns generate warnings rather than errors</span>
</span><span id="SpScenarioValidator.validate_punctuation-83"><a href="#SpScenarioValidator.validate_punctuation-83"><span class="linenos"> 83</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.validate_punctuation-84"><a href="#SpScenarioValidator.validate_punctuation-84"><span class="linenos"> 84</span></a>        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpScenarioValidator.validate_punctuation-85"><a href="#SpScenarioValidator.validate_punctuation-85"><span class="linenos"> 85</span></a>
</span><span id="SpScenarioValidator.validate_punctuation-86"><a href="#SpScenarioValidator.validate_punctuation-86"><span class="linenos"> 86</span></a>        <span class="n">columns_dont_punctuation</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpScenarioValidator.validate_punctuation-87"><a href="#SpScenarioValidator.validate_punctuation-87"><span class="linenos"> 87</span></a>        <span class="n">columns_must_end_with_dot</span> <span class="o">=</span> <span class="p">[</span><span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpScenarioValidator.validate_punctuation-88"><a href="#SpScenarioValidator.validate_punctuation-88"><span class="linenos"> 88</span></a>
</span><span id="SpScenarioValidator.validate_punctuation-89"><a href="#SpScenarioValidator.validate_punctuation-89"><span class="linenos"> 89</span></a>        <span class="n">list_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns_dont_punctuation</span> <span class="o">+</span> <span class="n">columns_must_end_with_dot</span><span class="p">)</span>
</span><span id="SpScenarioValidator.validate_punctuation-90"><a href="#SpScenarioValidator.validate_punctuation-90"><span class="linenos"> 90</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">list_columns</span><span class="p">:</span>
</span><span id="SpScenarioValidator.validate_punctuation-91"><a href="#SpScenarioValidator.validate_punctuation-91"><span class="linenos"> 91</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpScenarioValidator.validate_punctuation-92"><a href="#SpScenarioValidator.validate_punctuation-92"><span class="linenos"> 92</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpScenarioValidator.validate_punctuation-93"><a href="#SpScenarioValidator.validate_punctuation-93"><span class="linenos"> 93</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpScenarioValidator.validate_punctuation-94"><a href="#SpScenarioValidator.validate_punctuation-94"><span class="linenos"> 94</span></a>
</span><span id="SpScenarioValidator.validate_punctuation-95"><a href="#SpScenarioValidator.validate_punctuation-95"><span class="linenos"> 95</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">punctuation_warnings</span> <span class="o">=</span> <span class="n">CharacterProcessing</span><span class="o">.</span><span class="n">check_characters_punctuation_rules</span><span class="p">(</span>
</span><span id="SpScenarioValidator.validate_punctuation-96"><a href="#SpScenarioValidator.validate_punctuation-96"><span class="linenos"> 96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_punctuation-97"><a href="#SpScenarioValidator.validate_punctuation-97"><span class="linenos"> 97</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_punctuation-98"><a href="#SpScenarioValidator.validate_punctuation-98"><span class="linenos"> 98</span></a>            <span class="n">columns_dont_punctuation</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_punctuation-99"><a href="#SpScenarioValidator.validate_punctuation-99"><span class="linenos"> 99</span></a>            <span class="n">columns_must_end_with_dot</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_punctuation-100"><a href="#SpScenarioValidator.validate_punctuation-100"><span class="linenos">100</span></a>        <span class="p">)</span>
</span><span id="SpScenarioValidator.validate_punctuation-101"><a href="#SpScenarioValidator.validate_punctuation-101"><span class="linenos">101</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">punctuation_warnings</span><span class="p">)</span>
</span><span id="SpScenarioValidator.validate_punctuation-102"><a href="#SpScenarioValidator.validate_punctuation-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate punctuation rules for scenario fields.</p>

<p>Ensures that:</p>

<ul>
<li>Name fields do not end with punctuation</li>
<li>Description fields end with a period (.)</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Empty list (no errors generated)
        - List[str]: Warning messages for punctuation violations</p>

<h2 id="notes">Notes</h2>

<ul>
<li>COLUMN_NAME: Must not end with punctuation</li>
<li>COLUMN_DESCRIPTION: Must end with a period</li>
<li>Missing columns generate warnings rather than errors</li>
</ul>
</div>


                            </div>
                            <div id="SpScenarioValidator.validate_unique_values" class="classattr">
                                        <input id="SpScenarioValidator.validate_unique_values-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_unique_values</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpScenarioValidator.validate_unique_values-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpScenarioValidator.validate_unique_values"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpScenarioValidator.validate_unique_values-104"><a href="#SpScenarioValidator.validate_unique_values-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_unique_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpScenarioValidator.validate_unique_values-105"><a href="#SpScenarioValidator.validate_unique_values-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.validate_unique_values-106"><a href="#SpScenarioValidator.validate_unique_values-106"><span class="linenos">106</span></a><span class="sd">        Validate uniqueness of scenario identifiers.</span>
</span><span id="SpScenarioValidator.validate_unique_values-107"><a href="#SpScenarioValidator.validate_unique_values-107"><span class="linenos">107</span></a>
</span><span id="SpScenarioValidator.validate_unique_values-108"><a href="#SpScenarioValidator.validate_unique_values-108"><span class="linenos">108</span></a><span class="sd">        Ensures that all values in the name and symbol columns are unique across</span>
</span><span id="SpScenarioValidator.validate_unique_values-109"><a href="#SpScenarioValidator.validate_unique_values-109"><span class="linenos">109</span></a><span class="sd">        the entire scenario dataset to prevent duplicate scenario definitions.</span>
</span><span id="SpScenarioValidator.validate_unique_values-110"><a href="#SpScenarioValidator.validate_unique_values-110"><span class="linenos">110</span></a>
</span><span id="SpScenarioValidator.validate_unique_values-111"><a href="#SpScenarioValidator.validate_unique_values-111"><span class="linenos">111</span></a><span class="sd">        Returns</span>
</span><span id="SpScenarioValidator.validate_unique_values-112"><a href="#SpScenarioValidator.validate_unique_values-112"><span class="linenos">112</span></a><span class="sd">        -------</span>
</span><span id="SpScenarioValidator.validate_unique_values-113"><a href="#SpScenarioValidator.validate_unique_values-113"><span class="linenos">113</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpScenarioValidator.validate_unique_values-114"><a href="#SpScenarioValidator.validate_unique_values-114"><span class="linenos">114</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpScenarioValidator.validate_unique_values-115"><a href="#SpScenarioValidator.validate_unique_values-115"><span class="linenos">115</span></a><span class="sd">                - List[str]: Error messages for duplicate values</span>
</span><span id="SpScenarioValidator.validate_unique_values-116"><a href="#SpScenarioValidator.validate_unique_values-116"><span class="linenos">116</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpScenarioValidator.validate_unique_values-117"><a href="#SpScenarioValidator.validate_unique_values-117"><span class="linenos">117</span></a>
</span><span id="SpScenarioValidator.validate_unique_values-118"><a href="#SpScenarioValidator.validate_unique_values-118"><span class="linenos">118</span></a><span class="sd">        Notes</span>
</span><span id="SpScenarioValidator.validate_unique_values-119"><a href="#SpScenarioValidator.validate_unique_values-119"><span class="linenos">119</span></a><span class="sd">        -----</span>
</span><span id="SpScenarioValidator.validate_unique_values-120"><a href="#SpScenarioValidator.validate_unique_values-120"><span class="linenos">120</span></a><span class="sd">        Validates uniqueness for:</span>
</span><span id="SpScenarioValidator.validate_unique_values-121"><a href="#SpScenarioValidator.validate_unique_values-121"><span class="linenos">121</span></a><span class="sd">        - COLUMN_NAME: Scenario names must be unique</span>
</span><span id="SpScenarioValidator.validate_unique_values-122"><a href="#SpScenarioValidator.validate_unique_values-122"><span class="linenos">122</span></a><span class="sd">        - COLUMN_SYMBOL: Scenario symbols must be unique</span>
</span><span id="SpScenarioValidator.validate_unique_values-123"><a href="#SpScenarioValidator.validate_unique_values-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.validate_unique_values-124"><a href="#SpScenarioValidator.validate_unique_values-124"><span class="linenos">124</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpScenarioValidator.validate_unique_values-125"><a href="#SpScenarioValidator.validate_unique_values-125"><span class="linenos">125</span></a>
</span><span id="SpScenarioValidator.validate_unique_values-126"><a href="#SpScenarioValidator.validate_unique_values-126"><span class="linenos">126</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpScenarioValidator.validate_unique_values-127"><a href="#SpScenarioValidator.validate_unique_values-127"><span class="linenos">127</span></a>            <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_unique_values-128"><a href="#SpScenarioValidator.validate_unique_values-128"><span class="linenos">128</span></a>            <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SYMBOL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_unique_values-129"><a href="#SpScenarioValidator.validate_unique_values-129"><span class="linenos">129</span></a>        <span class="p">]</span>
</span><span id="SpScenarioValidator.validate_unique_values-130"><a href="#SpScenarioValidator.validate_unique_values-130"><span class="linenos">130</span></a>
</span><span id="SpScenarioValidator.validate_unique_values-131"><a href="#SpScenarioValidator.validate_unique_values-131"><span class="linenos">131</span></a>        <span class="c1"># Check if columns exist</span>
</span><span id="SpScenarioValidator.validate_unique_values-132"><a href="#SpScenarioValidator.validate_unique_values-132"><span class="linenos">132</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpScenarioValidator.validate_unique_values-133"><a href="#SpScenarioValidator.validate_unique_values-133"><span class="linenos">133</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpScenarioValidator.validate_unique_values-134"><a href="#SpScenarioValidator.validate_unique_values-134"><span class="linenos">134</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpScenarioValidator.validate_unique_values-135"><a href="#SpScenarioValidator.validate_unique_values-135"><span class="linenos">135</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpScenarioValidator.validate_unique_values-136"><a href="#SpScenarioValidator.validate_unique_values-136"><span class="linenos">136</span></a>
</span><span id="SpScenarioValidator.validate_unique_values-137"><a href="#SpScenarioValidator.validate_unique_values-137"><span class="linenos">137</span></a>        <span class="n">__</span><span class="p">,</span> <span class="n">unique_errors</span> <span class="o">=</span> <span class="n">DataFrameProcessing</span><span class="o">.</span><span class="n">check_dataframe_unique_values</span><span class="p">(</span>
</span><span id="SpScenarioValidator.validate_unique_values-138"><a href="#SpScenarioValidator.validate_unique_values-138"><span class="linenos">138</span></a>            <span class="n">dataframe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_unique_values-139"><a href="#SpScenarioValidator.validate_unique_values-139"><span class="linenos">139</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_unique_values-140"><a href="#SpScenarioValidator.validate_unique_values-140"><span class="linenos">140</span></a>            <span class="n">columns_uniques</span><span class="o">=</span><span class="n">columns_to_check</span><span class="p">,</span>
</span><span id="SpScenarioValidator.validate_unique_values-141"><a href="#SpScenarioValidator.validate_unique_values-141"><span class="linenos">141</span></a>        <span class="p">)</span>
</span><span id="SpScenarioValidator.validate_unique_values-142"><a href="#SpScenarioValidator.validate_unique_values-142"><span class="linenos">142</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">unique_errors</span><span class="p">)</span>
</span><span id="SpScenarioValidator.validate_unique_values-143"><a href="#SpScenarioValidator.validate_unique_values-143"><span class="linenos">143</span></a>
</span><span id="SpScenarioValidator.validate_unique_values-144"><a href="#SpScenarioValidator.validate_unique_values-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Validate uniqueness of scenario identifiers.</p>

<p>Ensures that all values in the name and symbol columns are unique across
the entire scenario dataset to prevent duplicate scenario definitions.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for duplicate values
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<p>Validates uniqueness for:</p>

<ul>
<li>COLUMN_NAME: Scenario names must be unique</li>
<li>COLUMN_SYMBOL: Scenario symbols must be unique</li>
</ul>
</div>


                            </div>
                            <div id="SpScenarioValidator.run" class="classattr">
                                        <input id="SpScenarioValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpScenarioValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpScenarioValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpScenarioValidator.run-155"><a href="#SpScenarioValidator.run-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpScenarioValidator.run-156"><a href="#SpScenarioValidator.run-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.run-157"><a href="#SpScenarioValidator.run-157"><span class="linenos">157</span></a><span class="sd">        Execute all scenario validations.</span>
</span><span id="SpScenarioValidator.run-158"><a href="#SpScenarioValidator.run-158"><span class="linenos">158</span></a>
</span><span id="SpScenarioValidator.run-159"><a href="#SpScenarioValidator.run-159"><span class="linenos">159</span></a><span class="sd">        Orchestrates the execution of all scenario validators including:</span>
</span><span id="SpScenarioValidator.run-160"><a href="#SpScenarioValidator.run-160"><span class="linenos">160</span></a><span class="sd">        - Punctuation validation for names and descriptions</span>
</span><span id="SpScenarioValidator.run-161"><a href="#SpScenarioValidator.run-161"><span class="linenos">161</span></a><span class="sd">        - Unique value validation for names and symbols</span>
</span><span id="SpScenarioValidator.run-162"><a href="#SpScenarioValidator.run-162"><span class="linenos">162</span></a>
</span><span id="SpScenarioValidator.run-163"><a href="#SpScenarioValidator.run-163"><span class="linenos">163</span></a><span class="sd">        Returns</span>
</span><span id="SpScenarioValidator.run-164"><a href="#SpScenarioValidator.run-164"><span class="linenos">164</span></a><span class="sd">        -------</span>
</span><span id="SpScenarioValidator.run-165"><a href="#SpScenarioValidator.run-165"><span class="linenos">165</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpScenarioValidator.run-166"><a href="#SpScenarioValidator.run-166"><span class="linenos">166</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpScenarioValidator.run-167"><a href="#SpScenarioValidator.run-167"><span class="linenos">167</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpScenarioValidator.run-168"><a href="#SpScenarioValidator.run-168"><span class="linenos">168</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpScenarioValidator.run-169"><a href="#SpScenarioValidator.run-169"><span class="linenos">169</span></a>
</span><span id="SpScenarioValidator.run-170"><a href="#SpScenarioValidator.run-170"><span class="linenos">170</span></a><span class="sd">        Notes</span>
</span><span id="SpScenarioValidator.run-171"><a href="#SpScenarioValidator.run-171"><span class="linenos">171</span></a><span class="sd">        -----</span>
</span><span id="SpScenarioValidator.run-172"><a href="#SpScenarioValidator.run-172"><span class="linenos">172</span></a><span class="sd">        All validations are skipped if the scenario dataframe is empty.</span>
</span><span id="SpScenarioValidator.run-173"><a href="#SpScenarioValidator.run-173"><span class="linenos">173</span></a><span class="sd">        Results are aggregated into reports via `build_reports()`.</span>
</span><span id="SpScenarioValidator.run-174"><a href="#SpScenarioValidator.run-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpScenarioValidator.run-175"><a href="#SpScenarioValidator.run-175"><span class="linenos">175</span></a>
</span><span id="SpScenarioValidator.run-176"><a href="#SpScenarioValidator.run-176"><span class="linenos">176</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="SpScenarioValidator.run-177"><a href="#SpScenarioValidator.run-177"><span class="linenos">177</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_punctuation</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">MAND_PUNC_SCEN</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpScenarioValidator.run-178"><a href="#SpScenarioValidator.run-178"><span class="linenos">178</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_unique_values</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">UVR_SCEN</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="SpScenarioValidator.run-179"><a href="#SpScenarioValidator.run-179"><span class="linenos">179</span></a>        <span class="p">]</span>
</span><span id="SpScenarioValidator.run-180"><a href="#SpScenarioValidator.run-180"><span class="linenos">180</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpScenarioValidator.run-181"><a href="#SpScenarioValidator.run-181"><span class="linenos">181</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpScenarioValidator.run-182"><a href="#SpScenarioValidator.run-182"><span class="linenos">182</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpScenarioValidator.run-183"><a href="#SpScenarioValidator.run-183"><span class="linenos">183</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpScenarioValidator.run-184"><a href="#SpScenarioValidator.run-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpScenarioValidator.run-185"><a href="#SpScenarioValidator.run-185"><span class="linenos">185</span></a>
</span><span id="SpScenarioValidator.run-186"><a href="#SpScenarioValidator.run-186"><span class="linenos">186</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all scenario validations.</p>

<p>Orchestrates the execution of all scenario validators including:</p>

<ul>
<li>Punctuation validation for names and descriptions</li>
<li>Unique value validation for names and symbols</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<p>All validations are skipped if the scenario dataframe is empty.
Results are aggregated into reports via <code><a href="#SpScenarioValidator.build_reports">build_reports()</a></code>.</p>
</div>


                            </div>
                </section>
                <section id="SpLegendValidator">
                            <input id="SpLegendValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpLegendValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpLegendValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpLegendValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpLegendValidator-87"><a href="#SpLegendValidator-87"><span class="linenos"> 87</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpLegendValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpLegendValidator-88"><a href="#SpLegendValidator-88"><span class="linenos"> 88</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-89"><a href="#SpLegendValidator-89"><span class="linenos"> 89</span></a><span class="sd">    Validates Legend spreadsheet content and relationships.</span>
</span><span id="SpLegendValidator-90"><a href="#SpLegendValidator-90"><span class="linenos"> 90</span></a>
</span><span id="SpLegendValidator-91"><a href="#SpLegendValidator-91"><span class="linenos"> 91</span></a><span class="sd">    This validator performs comprehensive checks on legend data including:</span>
</span><span id="SpLegendValidator-92"><a href="#SpLegendValidator-92"><span class="linenos"> 92</span></a><span class="sd">    - Legend-indicator relationship validation</span>
</span><span id="SpLegendValidator-93"><a href="#SpLegendValidator-93"><span class="linenos"> 93</span></a><span class="sd">    - Value range validation against legend definitions</span>
</span><span id="SpLegendValidator-94"><a href="#SpLegendValidator-94"><span class="linenos"> 94</span></a><span class="sd">    - Level-based legend requirement enforcement</span>
</span><span id="SpLegendValidator-95"><a href="#SpLegendValidator-95"><span class="linenos"> 95</span></a><span class="sd">    - Legend reference consistency checks</span>
</span><span id="SpLegendValidator-96"><a href="#SpLegendValidator-96"><span class="linenos"> 96</span></a>
</span><span id="SpLegendValidator-97"><a href="#SpLegendValidator-97"><span class="linenos"> 97</span></a><span class="sd">    Attributes</span>
</span><span id="SpLegendValidator-98"><a href="#SpLegendValidator-98"><span class="linenos"> 98</span></a><span class="sd">    ----------</span>
</span><span id="SpLegendValidator-99"><a href="#SpLegendValidator-99"><span class="linenos"> 99</span></a><span class="sd">    model_sp_legend : SpLegend</span>
</span><span id="SpLegendValidator-100"><a href="#SpLegendValidator-100"><span class="linenos">100</span></a><span class="sd">        Legend model instance containing legend definitions.</span>
</span><span id="SpLegendValidator-101"><a href="#SpLegendValidator-101"><span class="linenos">101</span></a><span class="sd">    model_sp_description : SpDescription</span>
</span><span id="SpLegendValidator-102"><a href="#SpLegendValidator-102"><span class="linenos">102</span></a><span class="sd">        Description model instance containing indicator metadata.</span>
</span><span id="SpLegendValidator-103"><a href="#SpLegendValidator-103"><span class="linenos">103</span></a><span class="sd">    model_sp_value : SpValue</span>
</span><span id="SpLegendValidator-104"><a href="#SpLegendValidator-104"><span class="linenos">104</span></a><span class="sd">        Value model instance containing indicator data.</span>
</span><span id="SpLegendValidator-105"><a href="#SpLegendValidator-105"><span class="linenos">105</span></a><span class="sd">    scenario_exists_file : bool</span>
</span><span id="SpLegendValidator-106"><a href="#SpLegendValidator-106"><span class="linenos">106</span></a><span class="sd">        Flag indicating if scenario file exists.</span>
</span><span id="SpLegendValidator-107"><a href="#SpLegendValidator-107"><span class="linenos">107</span></a><span class="sd">    scenarios_list : List[str]</span>
</span><span id="SpLegendValidator-108"><a href="#SpLegendValidator-108"><span class="linenos">108</span></a><span class="sd">        List of available scenario identifiers.</span>
</span><span id="SpLegendValidator-109"><a href="#SpLegendValidator-109"><span class="linenos">109</span></a><span class="sd">    sp_name_legend : str</span>
</span><span id="SpLegendValidator-110"><a href="#SpLegendValidator-110"><span class="linenos">110</span></a><span class="sd">        Legend spreadsheet filename.</span>
</span><span id="SpLegendValidator-111"><a href="#SpLegendValidator-111"><span class="linenos">111</span></a><span class="sd">    sp_name_description : str</span>
</span><span id="SpLegendValidator-112"><a href="#SpLegendValidator-112"><span class="linenos">112</span></a><span class="sd">        Description spreadsheet filename.</span>
</span><span id="SpLegendValidator-113"><a href="#SpLegendValidator-113"><span class="linenos">113</span></a><span class="sd">    sp_name_value : str</span>
</span><span id="SpLegendValidator-114"><a href="#SpLegendValidator-114"><span class="linenos">114</span></a><span class="sd">        Value spreadsheet filename.</span>
</span><span id="SpLegendValidator-115"><a href="#SpLegendValidator-115"><span class="linenos">115</span></a><span class="sd">    global_required_columns : Dict[str, List[str]]</span>
</span><span id="SpLegendValidator-116"><a href="#SpLegendValidator-116"><span class="linenos">116</span></a><span class="sd">        Required columns mapping for validation.</span>
</span><span id="SpLegendValidator-117"><a href="#SpLegendValidator-117"><span class="linenos">117</span></a><span class="sd">    model_dataframes : Dict[str, pd.DataFrame]</span>
</span><span id="SpLegendValidator-118"><a href="#SpLegendValidator-118"><span class="linenos">118</span></a><span class="sd">        DataFrames mapping for each model.</span>
</span><span id="SpLegendValidator-119"><a href="#SpLegendValidator-119"><span class="linenos">119</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-120"><a href="#SpLegendValidator-120"><span class="linenos">120</span></a>
</span><span id="SpLegendValidator-121"><a href="#SpLegendValidator-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpLegendValidator-122"><a href="#SpLegendValidator-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpLegendValidator-123"><a href="#SpLegendValidator-123"><span class="linenos">123</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpLegendValidator-124"><a href="#SpLegendValidator-124"><span class="linenos">124</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpLegendValidator-125"><a href="#SpLegendValidator-125"><span class="linenos">125</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpLegendValidator-126"><a href="#SpLegendValidator-126"><span class="linenos">126</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpLegendValidator-127"><a href="#SpLegendValidator-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-128"><a href="#SpLegendValidator-128"><span class="linenos">128</span></a><span class="sd">        Initialize the Legend validator.</span>
</span><span id="SpLegendValidator-129"><a href="#SpLegendValidator-129"><span class="linenos">129</span></a>
</span><span id="SpLegendValidator-130"><a href="#SpLegendValidator-130"><span class="linenos">130</span></a><span class="sd">        Args</span>
</span><span id="SpLegendValidator-131"><a href="#SpLegendValidator-131"><span class="linenos">131</span></a><span class="sd">        ----</span>
</span><span id="SpLegendValidator-132"><a href="#SpLegendValidator-132"><span class="linenos">132</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpLegendValidator-133"><a href="#SpLegendValidator-133"><span class="linenos">133</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpLegendValidator-134"><a href="#SpLegendValidator-134"><span class="linenos">134</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpLegendValidator-135"><a href="#SpLegendValidator-135"><span class="linenos">135</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpLegendValidator-136"><a href="#SpLegendValidator-136"><span class="linenos">136</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpLegendValidator-137"><a href="#SpLegendValidator-137"><span class="linenos">137</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpLegendValidator-138"><a href="#SpLegendValidator-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-139"><a href="#SpLegendValidator-139"><span class="linenos">139</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpLegendValidator-140"><a href="#SpLegendValidator-140"><span class="linenos">140</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpLegendValidator-141"><a href="#SpLegendValidator-141"><span class="linenos">141</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpLegendValidator-142"><a href="#SpLegendValidator-142"><span class="linenos">142</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpLegend</span><span class="p">,</span>
</span><span id="SpLegendValidator-143"><a href="#SpLegendValidator-143"><span class="linenos">143</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpLegendValidator-144"><a href="#SpLegendValidator-144"><span class="linenos">144</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-145"><a href="#SpLegendValidator-145"><span class="linenos">145</span></a>
</span><span id="SpLegendValidator-146"><a href="#SpLegendValidator-146"><span class="linenos">146</span></a>        <span class="c1"># Configure</span>
</span><span id="SpLegendValidator-147"><a href="#SpLegendValidator-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpLegendValidator-148"><a href="#SpLegendValidator-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpLegendValidator-149"><a href="#SpLegendValidator-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpValue</span><span class="p">)</span>
</span><span id="SpLegendValidator-150"><a href="#SpLegendValidator-150"><span class="linenos">150</span></a>
</span><span id="SpLegendValidator-151"><a href="#SpLegendValidator-151"><span class="linenos">151</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpLegendValidator-152"><a href="#SpLegendValidator-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scenario_exists_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenario_exists_file</span>
</span><span id="SpLegendValidator-153"><a href="#SpLegendValidator-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scenarios_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenarios_list</span>
</span><span id="SpLegendValidator-154"><a href="#SpLegendValidator-154"><span class="linenos">154</span></a>
</span><span id="SpLegendValidator-155"><a href="#SpLegendValidator-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpLegendValidator-156"><a href="#SpLegendValidator-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpLegendValidator-157"><a href="#SpLegendValidator-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpLegendValidator-158"><a href="#SpLegendValidator-158"><span class="linenos">158</span></a>
</span><span id="SpLegendValidator-159"><a href="#SpLegendValidator-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpLegendValidator-160"><a href="#SpLegendValidator-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpLegendValidator-161"><a href="#SpLegendValidator-161"><span class="linenos">161</span></a>        <span class="c1"># self.</span>
</span><span id="SpLegendValidator-162"><a href="#SpLegendValidator-162"><span class="linenos">162</span></a>
</span><span id="SpLegendValidator-163"><a href="#SpLegendValidator-163"><span class="linenos">163</span></a>        <span class="c1"># Prepare statements</span>
</span><span id="SpLegendValidator-164"><a href="#SpLegendValidator-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpLegendValidator-165"><a href="#SpLegendValidator-165"><span class="linenos">165</span></a>
</span><span id="SpLegendValidator-166"><a href="#SpLegendValidator-166"><span class="linenos">166</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpLegendValidator-167"><a href="#SpLegendValidator-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpLegendValidator-168"><a href="#SpLegendValidator-168"><span class="linenos">168</span></a>
</span><span id="SpLegendValidator-169"><a href="#SpLegendValidator-169"><span class="linenos">169</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpLegendValidator-170"><a href="#SpLegendValidator-170"><span class="linenos">170</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-171"><a href="#SpLegendValidator-171"><span class="linenos">171</span></a><span class="sd">        Prepare validation context and dataframe mappings.</span>
</span><span id="SpLegendValidator-172"><a href="#SpLegendValidator-172"><span class="linenos">172</span></a>
</span><span id="SpLegendValidator-173"><a href="#SpLegendValidator-173"><span class="linenos">173</span></a><span class="sd">        Sets up:</span>
</span><span id="SpLegendValidator-174"><a href="#SpLegendValidator-174"><span class="linenos">174</span></a><span class="sd">        - Spreadsheet names for all models</span>
</span><span id="SpLegendValidator-175"><a href="#SpLegendValidator-175"><span class="linenos">175</span></a><span class="sd">        - DataFrame references for legend, description, and value models</span>
</span><span id="SpLegendValidator-176"><a href="#SpLegendValidator-176"><span class="linenos">176</span></a>
</span><span id="SpLegendValidator-177"><a href="#SpLegendValidator-177"><span class="linenos">177</span></a><span class="sd">        Notes</span>
</span><span id="SpLegendValidator-178"><a href="#SpLegendValidator-178"><span class="linenos">178</span></a><span class="sd">        -----</span>
</span><span id="SpLegendValidator-179"><a href="#SpLegendValidator-179"><span class="linenos">179</span></a><span class="sd">        DataFrames are copied to prevent modification of original data.</span>
</span><span id="SpLegendValidator-180"><a href="#SpLegendValidator-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-181"><a href="#SpLegendValidator-181"><span class="linenos">181</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpLegendValidator-182"><a href="#SpLegendValidator-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpLegendValidator-183"><a href="#SpLegendValidator-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpLegendValidator-184"><a href="#SpLegendValidator-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpLegendValidator-185"><a href="#SpLegendValidator-185"><span class="linenos">185</span></a>
</span><span id="SpLegendValidator-186"><a href="#SpLegendValidator-186"><span class="linenos">186</span></a>        <span class="c1"># Validate all required columns exist</span>
</span><span id="SpLegendValidator-187"><a href="#SpLegendValidator-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpLegendValidator-188"><a href="#SpLegendValidator-188"><span class="linenos">188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="SpLegendValidator-189"><a href="#SpLegendValidator-189"><span class="linenos">189</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="SpLegendValidator-190"><a href="#SpLegendValidator-190"><span class="linenos">190</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="SpLegendValidator-191"><a href="#SpLegendValidator-191"><span class="linenos">191</span></a>        <span class="p">}</span>
</span><span id="SpLegendValidator-192"><a href="#SpLegendValidator-192"><span class="linenos">192</span></a>
</span><span id="SpLegendValidator-193"><a href="#SpLegendValidator-193"><span class="linenos">193</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpLegendValidator-194"><a href="#SpLegendValidator-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-195"><a href="#SpLegendValidator-195"><span class="linenos">195</span></a><span class="sd">        Validate legend-indicator relationships and level-based requirements.</span>
</span><span id="SpLegendValidator-196"><a href="#SpLegendValidator-196"><span class="linenos">196</span></a>
</span><span id="SpLegendValidator-197"><a href="#SpLegendValidator-197"><span class="linenos">197</span></a><span class="sd">        Performs comprehensive validation including:</span>
</span><span id="SpLegendValidator-198"><a href="#SpLegendValidator-198"><span class="linenos">198</span></a><span class="sd">        - Checking that all legend codes in description exist in legend spreadsheet</span>
</span><span id="SpLegendValidator-199"><a href="#SpLegendValidator-199"><span class="linenos">199</span></a><span class="sd">        - Validating that level 1 indicators do not have legend references</span>
</span><span id="SpLegendValidator-200"><a href="#SpLegendValidator-200"><span class="linenos">200</span></a><span class="sd">        - Ensuring indicators at levels other than 1 and 2 have legend references</span>
</span><span id="SpLegendValidator-201"><a href="#SpLegendValidator-201"><span class="linenos">201</span></a><span class="sd">        - Identifying unreferenced legend codes</span>
</span><span id="SpLegendValidator-202"><a href="#SpLegendValidator-202"><span class="linenos">202</span></a>
</span><span id="SpLegendValidator-203"><a href="#SpLegendValidator-203"><span class="linenos">203</span></a><span class="sd">        Returns</span>
</span><span id="SpLegendValidator-204"><a href="#SpLegendValidator-204"><span class="linenos">204</span></a><span class="sd">        -------</span>
</span><span id="SpLegendValidator-205"><a href="#SpLegendValidator-205"><span class="linenos">205</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpLegendValidator-206"><a href="#SpLegendValidator-206"><span class="linenos">206</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpLegendValidator-207"><a href="#SpLegendValidator-207"><span class="linenos">207</span></a><span class="sd">                - List[str]: Error messages for validation failures</span>
</span><span id="SpLegendValidator-208"><a href="#SpLegendValidator-208"><span class="linenos">208</span></a><span class="sd">                - List[str]: Warning messages for unreferenced legend codes</span>
</span><span id="SpLegendValidator-209"><a href="#SpLegendValidator-209"><span class="linenos">209</span></a>
</span><span id="SpLegendValidator-210"><a href="#SpLegendValidator-210"><span class="linenos">210</span></a><span class="sd">        Notes</span>
</span><span id="SpLegendValidator-211"><a href="#SpLegendValidator-211"><span class="linenos">211</span></a><span class="sd">        -----</span>
</span><span id="SpLegendValidator-212"><a href="#SpLegendValidator-212"><span class="linenos">212</span></a><span class="sd">        - Validation is skipped if legend sanity check fails</span>
</span><span id="SpLegendValidator-213"><a href="#SpLegendValidator-213"><span class="linenos">213</span></a><span class="sd">        - Level 1 indicators must not have legend references</span>
</span><span id="SpLegendValidator-214"><a href="#SpLegendValidator-214"><span class="linenos">214</span></a><span class="sd">        - Indicators at levels != 1 and != 2 must have legend references</span>
</span><span id="SpLegendValidator-215"><a href="#SpLegendValidator-215"><span class="linenos">215</span></a><span class="sd">        - Missing legend codes in legend file are errors</span>
</span><span id="SpLegendValidator-216"><a href="#SpLegendValidator-216"><span class="linenos">216</span></a><span class="sd">        - Unreferenced legend codes are warnings</span>
</span><span id="SpLegendValidator-217"><a href="#SpLegendValidator-217"><span class="linenos">217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-218"><a href="#SpLegendValidator-218"><span class="linenos">218</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpLegendValidator-219"><a href="#SpLegendValidator-219"><span class="linenos">219</span></a>
</span><span id="SpLegendValidator-220"><a href="#SpLegendValidator-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">is_sanity_check_passed</span><span class="p">:</span>
</span><span id="SpLegendValidator-221"><a href="#SpLegendValidator-221"><span class="linenos">221</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator-222"><a href="#SpLegendValidator-222"><span class="linenos">222</span></a>
</span><span id="SpLegendValidator-223"><a href="#SpLegendValidator-223"><span class="linenos">223</span></a>        <span class="n">required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpLegendValidator-224"><a href="#SpLegendValidator-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpLegendValidator-225"><a href="#SpLegendValidator-225"><span class="linenos">225</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator-226"><a href="#SpLegendValidator-226"><span class="linenos">226</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator-227"><a href="#SpLegendValidator-227"><span class="linenos">227</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator-228"><a href="#SpLegendValidator-228"><span class="linenos">228</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator-229"><a href="#SpLegendValidator-229"><span class="linenos">229</span></a>        <span class="p">}</span>
</span><span id="SpLegendValidator-230"><a href="#SpLegendValidator-230"><span class="linenos">230</span></a>
</span><span id="SpLegendValidator-231"><a href="#SpLegendValidator-231"><span class="linenos">231</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]:</span>
</span><span id="SpLegendValidator-232"><a href="#SpLegendValidator-232"><span class="linenos">232</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span>
</span><span id="SpLegendValidator-233"><a href="#SpLegendValidator-233"><span class="linenos">233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpLegendValidator-234"><a href="#SpLegendValidator-234"><span class="linenos">234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator-235"><a href="#SpLegendValidator-235"><span class="linenos">235</span></a>                <span class="n">column</span><span class="p">,</span>
</span><span id="SpLegendValidator-236"><a href="#SpLegendValidator-236"><span class="linenos">236</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator-237"><a href="#SpLegendValidator-237"><span class="linenos">237</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpLegendValidator-238"><a href="#SpLegendValidator-238"><span class="linenos">238</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
</span><span id="SpLegendValidator-239"><a href="#SpLegendValidator-239"><span class="linenos">239</span></a>                <span class="k">break</span>
</span><span id="SpLegendValidator-240"><a href="#SpLegendValidator-240"><span class="linenos">240</span></a>
</span><span id="SpLegendValidator-241"><a href="#SpLegendValidator-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpLegendValidator-242"><a href="#SpLegendValidator-242"><span class="linenos">242</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator-243"><a href="#SpLegendValidator-243"><span class="linenos">243</span></a>
</span><span id="SpLegendValidator-244"><a href="#SpLegendValidator-244"><span class="linenos">244</span></a>        <span class="n">df_legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator-245"><a href="#SpLegendValidator-245"><span class="linenos">245</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator-246"><a href="#SpLegendValidator-246"><span class="linenos">246</span></a>
</span><span id="SpLegendValidator-247"><a href="#SpLegendValidator-247"><span class="linenos">247</span></a>        <span class="n">df_description_clean</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpLegendValidator-248"><a href="#SpLegendValidator-248"><span class="linenos">248</span></a>            <span class="n">df_description</span><span class="p">,</span>
</span><span id="SpLegendValidator-249"><a href="#SpLegendValidator-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator-250"><a href="#SpLegendValidator-250"><span class="linenos">250</span></a>            <span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator-251"><a href="#SpLegendValidator-251"><span class="linenos">251</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpLegendValidator-252"><a href="#SpLegendValidator-252"><span class="linenos">252</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-253"><a href="#SpLegendValidator-253"><span class="linenos">253</span></a>
</span><span id="SpLegendValidator-254"><a href="#SpLegendValidator-254"><span class="linenos">254</span></a>        <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator-255"><a href="#SpLegendValidator-255"><span class="linenos">255</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator-256"><a href="#SpLegendValidator-256"><span class="linenos">256</span></a>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator-257"><a href="#SpLegendValidator-257"><span class="linenos">257</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-258"><a href="#SpLegendValidator-258"><span class="linenos">258</span></a>        <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator-259"><a href="#SpLegendValidator-259"><span class="linenos">259</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator-260"><a href="#SpLegendValidator-260"><span class="linenos">260</span></a>        <span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-261"><a href="#SpLegendValidator-261"><span class="linenos">261</span></a>
</span><span id="SpLegendValidator-262"><a href="#SpLegendValidator-262"><span class="linenos">262</span></a>        <span class="c1"># Remove all NaN values in column COLUMN_LEGEND</span>
</span><span id="SpLegendValidator-263"><a href="#SpLegendValidator-263"><span class="linenos">263</span></a>        <span class="n">df_description_clean</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="SpLegendValidator-264"><a href="#SpLegendValidator-264"><span class="linenos">264</span></a>        <span class="n">df_legend</span> <span class="o">=</span> <span class="n">df_legend</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="SpLegendValidator-265"><a href="#SpLegendValidator-265"><span class="linenos">265</span></a>
</span><span id="SpLegendValidator-266"><a href="#SpLegendValidator-266"><span class="linenos">266</span></a>        <span class="n">legends_id_in_description</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator-267"><a href="#SpLegendValidator-267"><span class="linenos">267</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator-268"><a href="#SpLegendValidator-268"><span class="linenos">268</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-269"><a href="#SpLegendValidator-269"><span class="linenos">269</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span>
</span><span id="SpLegendValidator-270"><a href="#SpLegendValidator-270"><span class="linenos">270</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="SpLegendValidator-271"><a href="#SpLegendValidator-271"><span class="linenos">271</span></a>                    <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator-272"><a href="#SpLegendValidator-272"><span class="linenos">272</span></a>                        <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator-273"><a href="#SpLegendValidator-273"><span class="linenos">273</span></a>                        <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator-274"><a href="#SpLegendValidator-274"><span class="linenos">274</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
</span><span id="SpLegendValidator-275"><a href="#SpLegendValidator-275"><span class="linenos">275</span></a>                <span class="p">)</span>
</span><span id="SpLegendValidator-276"><a href="#SpLegendValidator-276"><span class="linenos">276</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator-277"><a href="#SpLegendValidator-277"><span class="linenos">277</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator-278"><a href="#SpLegendValidator-278"><span class="linenos">278</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator-279"><a href="#SpLegendValidator-279"><span class="linenos">279</span></a>        <span class="p">)</span>  <span class="c1"># DROP NA VALUES</span>
</span><span id="SpLegendValidator-280"><a href="#SpLegendValidator-280"><span class="linenos">280</span></a>
</span><span id="SpLegendValidator-281"><a href="#SpLegendValidator-281"><span class="linenos">281</span></a>        <span class="n">legends_id_in_legend</span> <span class="o">=</span> <span class="n">df_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator-282"><a href="#SpLegendValidator-282"><span class="linenos">282</span></a>
</span><span id="SpLegendValidator-283"><a href="#SpLegendValidator-283"><span class="linenos">283</span></a>        <span class="n">set_one</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">legends_id_in_description</span><span class="p">)</span>
</span><span id="SpLegendValidator-284"><a href="#SpLegendValidator-284"><span class="linenos">284</span></a>        <span class="n">set_two</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">legends_id_in_legend</span><span class="p">)</span>
</span><span id="SpLegendValidator-285"><a href="#SpLegendValidator-285"><span class="linenos">285</span></a>
</span><span id="SpLegendValidator-286"><a href="#SpLegendValidator-286"><span class="linenos">286</span></a>        <span class="n">missing_in_b</span><span class="p">,</span> <span class="n">missing_in_a</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set</span><span class="p">(</span>
</span><span id="SpLegendValidator-287"><a href="#SpLegendValidator-287"><span class="linenos">287</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">set_one</span><span class="p">,</span>
</span><span id="SpLegendValidator-288"><a href="#SpLegendValidator-288"><span class="linenos">288</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">set_two</span><span class="p">,</span>
</span><span id="SpLegendValidator-289"><a href="#SpLegendValidator-289"><span class="linenos">289</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-290"><a href="#SpLegendValidator-290"><span class="linenos">290</span></a>
</span><span id="SpLegendValidator-291"><a href="#SpLegendValidator-291"><span class="linenos">291</span></a>        <span class="n">missing_in_b</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">missing_in_b</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()}</span>
</span><span id="SpLegendValidator-292"><a href="#SpLegendValidator-292"><span class="linenos">292</span></a>        <span class="n">missing_in_a</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">missing_in_a</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()}</span>
</span><span id="SpLegendValidator-293"><a href="#SpLegendValidator-293"><span class="linenos">293</span></a>
</span><span id="SpLegendValidator-294"><a href="#SpLegendValidator-294"><span class="linenos">294</span></a>        <span class="k">if</span> <span class="n">missing_in_b</span><span class="p">:</span>
</span><span id="SpLegendValidator-295"><a href="#SpLegendValidator-295"><span class="linenos">295</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Cdigos de legenda ausentes em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">missing_in_b</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-296"><a href="#SpLegendValidator-296"><span class="linenos">296</span></a>
</span><span id="SpLegendValidator-297"><a href="#SpLegendValidator-297"><span class="linenos">297</span></a>        <span class="k">if</span> <span class="n">missing_in_a</span><span class="p">:</span>
</span><span id="SpLegendValidator-298"><a href="#SpLegendValidator-298"><span class="linenos">298</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator-299"><a href="#SpLegendValidator-299"><span class="linenos">299</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: Cdigos de legenda no referenciados em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">missing_in_a</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpLegendValidator-300"><a href="#SpLegendValidator-300"><span class="linenos">300</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator-301"><a href="#SpLegendValidator-301"><span class="linenos">301</span></a>
</span><span id="SpLegendValidator-302"><a href="#SpLegendValidator-302"><span class="linenos">302</span></a>        <span class="c1"># 1. All codes that are level 1 - Cannot have legends: if they do, error</span>
</span><span id="SpLegendValidator-303"><a href="#SpLegendValidator-303"><span class="linenos">303</span></a>
</span><span id="SpLegendValidator-304"><a href="#SpLegendValidator-304"><span class="linenos">304</span></a>        <span class="n">codes_indicators_level_one</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator-305"><a href="#SpLegendValidator-305"><span class="linenos">305</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span>
</span><span id="SpLegendValidator-306"><a href="#SpLegendValidator-306"><span class="linenos">306</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator-307"><a href="#SpLegendValidator-307"><span class="linenos">307</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator-308"><a href="#SpLegendValidator-308"><span class="linenos">308</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator-309"><a href="#SpLegendValidator-309"><span class="linenos">309</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator-310"><a href="#SpLegendValidator-310"><span class="linenos">310</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-311"><a href="#SpLegendValidator-311"><span class="linenos">311</span></a>
</span><span id="SpLegendValidator-312"><a href="#SpLegendValidator-312"><span class="linenos">312</span></a>        <span class="n">legends_id_in_description_level_one</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator-313"><a href="#SpLegendValidator-313"><span class="linenos">313</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator-314"><a href="#SpLegendValidator-314"><span class="linenos">314</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-315"><a href="#SpLegendValidator-315"><span class="linenos">315</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span>
</span><span id="SpLegendValidator-316"><a href="#SpLegendValidator-316"><span class="linenos">316</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator-317"><a href="#SpLegendValidator-317"><span class="linenos">317</span></a>            <span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="SpLegendValidator-318"><a href="#SpLegendValidator-318"><span class="linenos">318</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator-319"><a href="#SpLegendValidator-319"><span class="linenos">319</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator-320"><a href="#SpLegendValidator-320"><span class="linenos">320</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-321"><a href="#SpLegendValidator-321"><span class="linenos">321</span></a>
</span><span id="SpLegendValidator-322"><a href="#SpLegendValidator-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="n">legends_id_in_description_level_one</span><span class="p">:</span>
</span><span id="SpLegendValidator-323"><a href="#SpLegendValidator-323"><span class="linenos">323</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator-324"><a href="#SpLegendValidator-324"><span class="linenos">324</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Indicadores de nvel 1 no podem ter referncia de legenda. Cdigos com referncia em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">codes_indicators_level_one</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpLegendValidator-325"><a href="#SpLegendValidator-325"><span class="linenos">325</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator-326"><a href="#SpLegendValidator-326"><span class="linenos">326</span></a>
</span><span id="SpLegendValidator-327"><a href="#SpLegendValidator-327"><span class="linenos">327</span></a>        <span class="c1"># 3. All codes that are not level 1 and not level 2 - Must have a legend reference: if not, error</span>
</span><span id="SpLegendValidator-328"><a href="#SpLegendValidator-328"><span class="linenos">328</span></a>        <span class="n">codes_indicators_other_levels</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator-329"><a href="#SpLegendValidator-329"><span class="linenos">329</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator-330"><a href="#SpLegendValidator-330"><span class="linenos">330</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-331"><a href="#SpLegendValidator-331"><span class="linenos">331</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-332"><a href="#SpLegendValidator-332"><span class="linenos">332</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator-333"><a href="#SpLegendValidator-333"><span class="linenos">333</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator-334"><a href="#SpLegendValidator-334"><span class="linenos">334</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator-335"><a href="#SpLegendValidator-335"><span class="linenos">335</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-336"><a href="#SpLegendValidator-336"><span class="linenos">336</span></a>
</span><span id="SpLegendValidator-337"><a href="#SpLegendValidator-337"><span class="linenos">337</span></a>        <span class="n">codes_with_legend_other_levels</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator-338"><a href="#SpLegendValidator-338"><span class="linenos">338</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator-339"><a href="#SpLegendValidator-339"><span class="linenos">339</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-340"><a href="#SpLegendValidator-340"><span class="linenos">340</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-341"><a href="#SpLegendValidator-341"><span class="linenos">341</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span>
</span><span id="SpLegendValidator-342"><a href="#SpLegendValidator-342"><span class="linenos">342</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator-343"><a href="#SpLegendValidator-343"><span class="linenos">343</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator-344"><a href="#SpLegendValidator-344"><span class="linenos">344</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator-345"><a href="#SpLegendValidator-345"><span class="linenos">345</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-346"><a href="#SpLegendValidator-346"><span class="linenos">346</span></a>
</span><span id="SpLegendValidator-347"><a href="#SpLegendValidator-347"><span class="linenos">347</span></a>        <span class="n">set_codes_other_levels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_indicators_other_levels</span><span class="p">)</span>
</span><span id="SpLegendValidator-348"><a href="#SpLegendValidator-348"><span class="linenos">348</span></a>        <span class="n">set_codes_with_legend</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_with_legend_other_levels</span><span class="p">)</span>
</span><span id="SpLegendValidator-349"><a href="#SpLegendValidator-349"><span class="linenos">349</span></a>        <span class="n">missing_legends_other_levels</span> <span class="o">=</span> <span class="n">set_codes_other_levels</span> <span class="o">-</span> <span class="n">set_codes_with_legend</span>
</span><span id="SpLegendValidator-350"><a href="#SpLegendValidator-350"><span class="linenos">350</span></a>
</span><span id="SpLegendValidator-351"><a href="#SpLegendValidator-351"><span class="linenos">351</span></a>        <span class="k">if</span> <span class="n">missing_legends_other_levels</span><span class="p">:</span>
</span><span id="SpLegendValidator-352"><a href="#SpLegendValidator-352"><span class="linenos">352</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator-353"><a href="#SpLegendValidator-353"><span class="linenos">353</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Indicadores de nveis diferentes de 1 e 2 devem ter referncia de legenda. Indicadores sem referncia em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">missing_legends_other_levels</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpLegendValidator-354"><a href="#SpLegendValidator-354"><span class="linenos">354</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator-355"><a href="#SpLegendValidator-355"><span class="linenos">355</span></a>
</span><span id="SpLegendValidator-356"><a href="#SpLegendValidator-356"><span class="linenos">356</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator-357"><a href="#SpLegendValidator-357"><span class="linenos">357</span></a>
</span><span id="SpLegendValidator-358"><a href="#SpLegendValidator-358"><span class="linenos">358</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_range_multiple_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpLegendValidator-359"><a href="#SpLegendValidator-359"><span class="linenos">359</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-360"><a href="#SpLegendValidator-360"><span class="linenos">360</span></a><span class="sd">        Validate that indicator values fall within their legend-defined ranges.</span>
</span><span id="SpLegendValidator-361"><a href="#SpLegendValidator-361"><span class="linenos">361</span></a>
</span><span id="SpLegendValidator-362"><a href="#SpLegendValidator-362"><span class="linenos">362</span></a><span class="sd">        Performs value range validation by:</span>
</span><span id="SpLegendValidator-363"><a href="#SpLegendValidator-363"><span class="linenos">363</span></a><span class="sd">        - Mapping each value column to its corresponding legend</span>
</span><span id="SpLegendValidator-364"><a href="#SpLegendValidator-364"><span class="linenos">364</span></a><span class="sd">        - Extracting min/max ranges from legend definitions</span>
</span><span id="SpLegendValidator-365"><a href="#SpLegendValidator-365"><span class="linenos">365</span></a><span class="sd">        - Checking that all non-unavailable values fall within valid ranges</span>
</span><span id="SpLegendValidator-366"><a href="#SpLegendValidator-366"><span class="linenos">366</span></a><span class="sd">        - Using default ranges when no legend is specified</span>
</span><span id="SpLegendValidator-367"><a href="#SpLegendValidator-367"><span class="linenos">367</span></a>
</span><span id="SpLegendValidator-368"><a href="#SpLegendValidator-368"><span class="linenos">368</span></a><span class="sd">        Returns</span>
</span><span id="SpLegendValidator-369"><a href="#SpLegendValidator-369"><span class="linenos">369</span></a><span class="sd">        -------</span>
</span><span id="SpLegendValidator-370"><a href="#SpLegendValidator-370"><span class="linenos">370</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpLegendValidator-371"><a href="#SpLegendValidator-371"><span class="linenos">371</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpLegendValidator-372"><a href="#SpLegendValidator-372"><span class="linenos">372</span></a><span class="sd">                - List[str]: Error messages for values outside valid ranges</span>
</span><span id="SpLegendValidator-373"><a href="#SpLegendValidator-373"><span class="linenos">373</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpLegendValidator-374"><a href="#SpLegendValidator-374"><span class="linenos">374</span></a>
</span><span id="SpLegendValidator-375"><a href="#SpLegendValidator-375"><span class="linenos">375</span></a><span class="sd">        Notes</span>
</span><span id="SpLegendValidator-376"><a href="#SpLegendValidator-376"><span class="linenos">376</span></a><span class="sd">        -----</span>
</span><span id="SpLegendValidator-377"><a href="#SpLegendValidator-377"><span class="linenos">377</span></a><span class="sd">        - Validation is skipped if value dataframe is empty</span>
</span><span id="SpLegendValidator-378"><a href="#SpLegendValidator-378"><span class="linenos">378</span></a><span class="sd">        - Level 1 indicators are excluded from range validation</span>
</span><span id="SpLegendValidator-379"><a href="#SpLegendValidator-379"><span class="linenos">379</span></a><span class="sd">        - Default range is [0, 1] when no legend is specified</span>
</span><span id="SpLegendValidator-380"><a href="#SpLegendValidator-380"><span class="linenos">380</span></a><span class="sd">        - &#39;Dado indisponvel&#39; (unavailable data) values are excluded</span>
</span><span id="SpLegendValidator-381"><a href="#SpLegendValidator-381"><span class="linenos">381</span></a><span class="sd">        - Each error message includes: file, line, value, range, and column</span>
</span><span id="SpLegendValidator-382"><a href="#SpLegendValidator-382"><span class="linenos">382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-383"><a href="#SpLegendValidator-383"><span class="linenos">383</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpLegendValidator-384"><a href="#SpLegendValidator-384"><span class="linenos">384</span></a>
</span><span id="SpLegendValidator-385"><a href="#SpLegendValidator-385"><span class="linenos">385</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator-386"><a href="#SpLegendValidator-386"><span class="linenos">386</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator-387"><a href="#SpLegendValidator-387"><span class="linenos">387</span></a>
</span><span id="SpLegendValidator-388"><a href="#SpLegendValidator-388"><span class="linenos">388</span></a>        <span class="n">min_lower_legend_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MIN_LOWER_LEGEND_DEFAULT</span>
</span><span id="SpLegendValidator-389"><a href="#SpLegendValidator-389"><span class="linenos">389</span></a>        <span class="n">max_upper_legend_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MAX_UPPER_LEGEND_DEFAULT</span>
</span><span id="SpLegendValidator-390"><a href="#SpLegendValidator-390"><span class="linenos">390</span></a>        <span class="n">required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpLegendValidator-391"><a href="#SpLegendValidator-391"><span class="linenos">391</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpLegendValidator-392"><a href="#SpLegendValidator-392"><span class="linenos">392</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator-393"><a href="#SpLegendValidator-393"><span class="linenos">393</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator-394"><a href="#SpLegendValidator-394"><span class="linenos">394</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator-395"><a href="#SpLegendValidator-395"><span class="linenos">395</span></a>        <span class="p">}</span>
</span><span id="SpLegendValidator-396"><a href="#SpLegendValidator-396"><span class="linenos">396</span></a>
</span><span id="SpLegendValidator-397"><a href="#SpLegendValidator-397"><span class="linenos">397</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">legend_read_success</span><span class="p">:</span>
</span><span id="SpLegendValidator-398"><a href="#SpLegendValidator-398"><span class="linenos">398</span></a>            <span class="n">required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SpLegendValidator-399"><a href="#SpLegendValidator-399"><span class="linenos">399</span></a>
</span><span id="SpLegendValidator-400"><a href="#SpLegendValidator-400"><span class="linenos">400</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]:</span>
</span><span id="SpLegendValidator-401"><a href="#SpLegendValidator-401"><span class="linenos">401</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span>
</span><span id="SpLegendValidator-402"><a href="#SpLegendValidator-402"><span class="linenos">402</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpLegendValidator-403"><a href="#SpLegendValidator-403"><span class="linenos">403</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator-404"><a href="#SpLegendValidator-404"><span class="linenos">404</span></a>                <span class="n">column</span><span class="p">,</span>
</span><span id="SpLegendValidator-405"><a href="#SpLegendValidator-405"><span class="linenos">405</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator-406"><a href="#SpLegendValidator-406"><span class="linenos">406</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpLegendValidator-407"><a href="#SpLegendValidator-407"><span class="linenos">407</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
</span><span id="SpLegendValidator-408"><a href="#SpLegendValidator-408"><span class="linenos">408</span></a>                <span class="k">break</span>
</span><span id="SpLegendValidator-409"><a href="#SpLegendValidator-409"><span class="linenos">409</span></a>
</span><span id="SpLegendValidator-410"><a href="#SpLegendValidator-410"><span class="linenos">410</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpLegendValidator-411"><a href="#SpLegendValidator-411"><span class="linenos">411</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator-412"><a href="#SpLegendValidator-412"><span class="linenos">412</span></a>
</span><span id="SpLegendValidator-413"><a href="#SpLegendValidator-413"><span class="linenos">413</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator-414"><a href="#SpLegendValidator-414"><span class="linenos">414</span></a>        <span class="n">df_legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator-415"><a href="#SpLegendValidator-415"><span class="linenos">415</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator-416"><a href="#SpLegendValidator-416"><span class="linenos">416</span></a>
</span><span id="SpLegendValidator-417"><a href="#SpLegendValidator-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpLegendValidator-418"><a href="#SpLegendValidator-418"><span class="linenos">418</span></a>            <span class="n">df_values</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="SpLegendValidator-419"><a href="#SpLegendValidator-419"><span class="linenos">419</span></a>
</span><span id="SpLegendValidator-420"><a href="#SpLegendValidator-420"><span class="linenos">420</span></a>        <span class="n">df_description_clean</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpLegendValidator-421"><a href="#SpLegendValidator-421"><span class="linenos">421</span></a>            <span class="n">df_description</span><span class="p">,</span>
</span><span id="SpLegendValidator-422"><a href="#SpLegendValidator-422"><span class="linenos">422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator-423"><a href="#SpLegendValidator-423"><span class="linenos">423</span></a>            <span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator-424"><a href="#SpLegendValidator-424"><span class="linenos">424</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpLegendValidator-425"><a href="#SpLegendValidator-425"><span class="linenos">425</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-426"><a href="#SpLegendValidator-426"><span class="linenos">426</span></a>
</span><span id="SpLegendValidator-427"><a href="#SpLegendValidator-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_description_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpLegendValidator-428"><a href="#SpLegendValidator-428"><span class="linenos">428</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-429"><a href="#SpLegendValidator-429"><span class="linenos">429</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SpLegendValidator-430"><a href="#SpLegendValidator-430"><span class="linenos">430</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator-431"><a href="#SpLegendValidator-431"><span class="linenos">431</span></a>                <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator-432"><a href="#SpLegendValidator-432"><span class="linenos">432</span></a>                <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator-433"><a href="#SpLegendValidator-433"><span class="linenos">433</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator-434"><a href="#SpLegendValidator-434"><span class="linenos">434</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator-435"><a href="#SpLegendValidator-435"><span class="linenos">435</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator-436"><a href="#SpLegendValidator-436"><span class="linenos">436</span></a>            <span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-437"><a href="#SpLegendValidator-437"><span class="linenos">437</span></a>
</span><span id="SpLegendValidator-438"><a href="#SpLegendValidator-438"><span class="linenos">438</span></a>        <span class="n">codes_indicators_level_one</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator-439"><a href="#SpLegendValidator-439"><span class="linenos">439</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span>
</span><span id="SpLegendValidator-440"><a href="#SpLegendValidator-440"><span class="linenos">440</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator-441"><a href="#SpLegendValidator-441"><span class="linenos">441</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator-442"><a href="#SpLegendValidator-442"><span class="linenos">442</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator-443"><a href="#SpLegendValidator-443"><span class="linenos">443</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator-444"><a href="#SpLegendValidator-444"><span class="linenos">444</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-445"><a href="#SpLegendValidator-445"><span class="linenos">445</span></a>        <span class="n">valid_columns_from_values</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">categorize_strings_by_id_pattern_from_list</span><span class="p">(</span>
</span><span id="SpLegendValidator-446"><a href="#SpLegendValidator-446"><span class="linenos">446</span></a>            <span class="n">items_to_categorize</span><span class="o">=</span><span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="SpLegendValidator-447"><a href="#SpLegendValidator-447"><span class="linenos">447</span></a>            <span class="n">allowed_scenario_suffixes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scenarios_list</span><span class="p">,</span>
</span><span id="SpLegendValidator-448"><a href="#SpLegendValidator-448"><span class="linenos">448</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator-449"><a href="#SpLegendValidator-449"><span class="linenos">449</span></a>
</span><span id="SpLegendValidator-450"><a href="#SpLegendValidator-450"><span class="linenos">450</span></a>        <span class="n">groups_legends</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="nb">str</span><span class="p">(</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="p">[]})</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="SpLegendValidator-451"><a href="#SpLegendValidator-451"><span class="linenos">451</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">is_sanity_check_passed</span><span class="p">:</span>
</span><span id="SpLegendValidator-452"><a href="#SpLegendValidator-452"><span class="linenos">452</span></a>            <span class="n">groups_legends</span> <span class="o">=</span> <span class="n">df_legend</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="SpLegendValidator-453"><a href="#SpLegendValidator-453"><span class="linenos">453</span></a>
</span><span id="SpLegendValidator-454"><a href="#SpLegendValidator-454"><span class="linenos">454</span></a>        <span class="n">mapping_legends</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpLegendValidator-455"><a href="#SpLegendValidator-455"><span class="linenos">455</span></a>        <span class="k">for</span> <span class="n">data_column_sp_value</span> <span class="ow">in</span> <span class="n">valid_columns_from_values</span><span class="p">:</span>
</span><span id="SpLegendValidator-456"><a href="#SpLegendValidator-456"><span class="linenos">456</span></a>            <span class="n">aux_indicator_id</span> <span class="o">=</span> <span class="n">data_column_sp_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpLegendValidator-457"><a href="#SpLegendValidator-457"><span class="linenos">457</span></a>            <span class="n">aux_data_mapping_legend</span> <span class="o">=</span> <span class="n">ModelMappingLegend</span><span class="p">(</span>
</span><span id="SpLegendValidator-458"><a href="#SpLegendValidator-458"><span class="linenos">458</span></a>                <span class="n">column_sp_value</span><span class="o">=</span><span class="n">data_column_sp_value</span><span class="p">,</span>
</span><span id="SpLegendValidator-459"><a href="#SpLegendValidator-459"><span class="linenos">459</span></a>                <span class="n">default_min_value</span><span class="o">=</span><span class="n">min_lower_legend_default</span><span class="p">,</span>
</span><span id="SpLegendValidator-460"><a href="#SpLegendValidator-460"><span class="linenos">460</span></a>                <span class="n">default_max_value</span><span class="o">=</span><span class="n">max_upper_legend_default</span><span class="p">,</span>
</span><span id="SpLegendValidator-461"><a href="#SpLegendValidator-461"><span class="linenos">461</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator-462"><a href="#SpLegendValidator-462"><span class="linenos">462</span></a>
</span><span id="SpLegendValidator-463"><a href="#SpLegendValidator-463"><span class="linenos">463</span></a>            <span class="k">if</span> <span class="n">aux_indicator_id</span> <span class="ow">in</span> <span class="n">codes_indicators_level_one</span><span class="p">:</span>
</span><span id="SpLegendValidator-464"><a href="#SpLegendValidator-464"><span class="linenos">464</span></a>                <span class="k">continue</span>
</span><span id="SpLegendValidator-465"><a href="#SpLegendValidator-465"><span class="linenos">465</span></a>
</span><span id="SpLegendValidator-466"><a href="#SpLegendValidator-466"><span class="linenos">466</span></a>            <span class="n">row_description</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator-467"><a href="#SpLegendValidator-467"><span class="linenos">467</span></a>                <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">==</span> <span class="n">aux_indicator_id</span>
</span><span id="SpLegendValidator-468"><a href="#SpLegendValidator-468"><span class="linenos">468</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator-469"><a href="#SpLegendValidator-469"><span class="linenos">469</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">row_description</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator-470"><a href="#SpLegendValidator-470"><span class="linenos">470</span></a>                <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">indicator_id</span> <span class="o">=</span> <span class="n">aux_indicator_id</span>
</span><span id="SpLegendValidator-471"><a href="#SpLegendValidator-471"><span class="linenos">471</span></a>
</span><span id="SpLegendValidator-472"><a href="#SpLegendValidator-472"><span class="linenos">472</span></a>                <span class="n">key_legend</span> <span class="o">=</span> <span class="n">row_description</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator-473"><a href="#SpLegendValidator-473"><span class="linenos">473</span></a>                <span class="n">group_legend</span> <span class="o">=</span> <span class="n">groups_legends</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">key_legend</span><span class="p">))</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">key_legend</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups_legends</span><span class="o">.</span><span class="n">groups</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="SpLegendValidator-474"><a href="#SpLegendValidator-474"><span class="linenos">474</span></a>
</span><span id="SpLegendValidator-475"><a href="#SpLegendValidator-475"><span class="linenos">475</span></a>                <span class="k">if</span> <span class="n">group_legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpLegendValidator-476"><a href="#SpLegendValidator-476"><span class="linenos">476</span></a>                    <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">legend_id</span> <span class="o">=</span> <span class="n">key_legend</span>
</span><span id="SpLegendValidator-477"><a href="#SpLegendValidator-477"><span class="linenos">477</span></a>
</span><span id="SpLegendValidator-478"><a href="#SpLegendValidator-478"><span class="linenos">478</span></a>                    <span class="n">group_legend</span> <span class="o">=</span> <span class="n">group_legend</span><span class="p">[</span>
</span><span id="SpLegendValidator-479"><a href="#SpLegendValidator-479"><span class="linenos">479</span></a>                        <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LABEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">LABEL_DATA_UNAVAILABLE</span>
</span><span id="SpLegendValidator-480"><a href="#SpLegendValidator-480"><span class="linenos">480</span></a>                    <span class="p">]</span>
</span><span id="SpLegendValidator-481"><a href="#SpLegendValidator-481"><span class="linenos">481</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_legend</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator-482"><a href="#SpLegendValidator-482"><span class="linenos">482</span></a>                        <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MINIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator-483"><a href="#SpLegendValidator-483"><span class="linenos">483</span></a>                            <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MINIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator-484"><a href="#SpLegendValidator-484"><span class="linenos">484</span></a>                            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator-485"><a href="#SpLegendValidator-485"><span class="linenos">485</span></a>                        <span class="p">)</span>
</span><span id="SpLegendValidator-486"><a href="#SpLegendValidator-486"><span class="linenos">486</span></a>                        <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MAXIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator-487"><a href="#SpLegendValidator-487"><span class="linenos">487</span></a>                            <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MAXIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator-488"><a href="#SpLegendValidator-488"><span class="linenos">488</span></a>                            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator-489"><a href="#SpLegendValidator-489"><span class="linenos">489</span></a>                        <span class="p">)</span>
</span><span id="SpLegendValidator-490"><a href="#SpLegendValidator-490"><span class="linenos">490</span></a>
</span><span id="SpLegendValidator-491"><a href="#SpLegendValidator-491"><span class="linenos">491</span></a>                        <span class="n">aux_min_value</span> <span class="o">=</span> <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MINIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="SpLegendValidator-492"><a href="#SpLegendValidator-492"><span class="linenos">492</span></a>                        <span class="n">aux_max_value</span> <span class="o">=</span> <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MAXIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="SpLegendValidator-493"><a href="#SpLegendValidator-493"><span class="linenos">493</span></a>                        <span class="n">legend_id</span> <span class="o">=</span> <span class="n">group_legend</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator-494"><a href="#SpLegendValidator-494"><span class="linenos">494</span></a>
</span><span id="SpLegendValidator-495"><a href="#SpLegendValidator-495"><span class="linenos">495</span></a>                        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">aux_min_value</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">aux_max_value</span><span class="p">)):</span>
</span><span id="SpLegendValidator-496"><a href="#SpLegendValidator-496"><span class="linenos">496</span></a>                            <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="n">aux_min_value</span>
</span><span id="SpLegendValidator-497"><a href="#SpLegendValidator-497"><span class="linenos">497</span></a>                            <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">aux_max_value</span>
</span><span id="SpLegendValidator-498"><a href="#SpLegendValidator-498"><span class="linenos">498</span></a>                            <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">legend_id</span> <span class="o">=</span> <span class="n">legend_id</span>
</span><span id="SpLegendValidator-499"><a href="#SpLegendValidator-499"><span class="linenos">499</span></a>
</span><span id="SpLegendValidator-500"><a href="#SpLegendValidator-500"><span class="linenos">500</span></a>            <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux_data_mapping_legend</span>
</span><span id="SpLegendValidator-501"><a href="#SpLegendValidator-501"><span class="linenos">501</span></a>
</span><span id="SpLegendValidator-502"><a href="#SpLegendValidator-502"><span class="linenos">502</span></a>        <span class="n">df_values_numeric</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator-503"><a href="#SpLegendValidator-503"><span class="linenos">503</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">valid_columns_from_values</span><span class="p">:</span>
</span><span id="SpLegendValidator-504"><a href="#SpLegendValidator-504"><span class="linenos">504</span></a>            <span class="n">df_values_numeric</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_values</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator-505"><a href="#SpLegendValidator-505"><span class="linenos">505</span></a>
</span><span id="SpLegendValidator-506"><a href="#SpLegendValidator-506"><span class="linenos">506</span></a>        <span class="k">for</span> <span class="n">data_column_sp_value</span> <span class="ow">in</span> <span class="n">valid_columns_from_values</span><span class="p">:</span>
</span><span id="SpLegendValidator-507"><a href="#SpLegendValidator-507"><span class="linenos">507</span></a>            <span class="n">code_column</span> <span class="o">=</span> <span class="n">data_column_sp_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpLegendValidator-508"><a href="#SpLegendValidator-508"><span class="linenos">508</span></a>
</span><span id="SpLegendValidator-509"><a href="#SpLegendValidator-509"><span class="linenos">509</span></a>            <span class="k">if</span> <span class="n">code_column</span> <span class="ow">in</span> <span class="n">codes_indicators_level_one</span><span class="p">:</span>
</span><span id="SpLegendValidator-510"><a href="#SpLegendValidator-510"><span class="linenos">510</span></a>                <span class="k">continue</span>
</span><span id="SpLegendValidator-511"><a href="#SpLegendValidator-511"><span class="linenos">511</span></a>
</span><span id="SpLegendValidator-512"><a href="#SpLegendValidator-512"><span class="linenos">512</span></a>            <span class="n">min_value</span> <span class="o">=</span> <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">min_value</span>
</span><span id="SpLegendValidator-513"><a href="#SpLegendValidator-513"><span class="linenos">513</span></a>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">max_value</span>
</span><span id="SpLegendValidator-514"><a href="#SpLegendValidator-514"><span class="linenos">514</span></a>
</span><span id="SpLegendValidator-515"><a href="#SpLegendValidator-515"><span class="linenos">515</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value_numeric</span> <span class="ow">in</span> <span class="n">df_values_numeric</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="SpLegendValidator-516"><a href="#SpLegendValidator-516"><span class="linenos">516</span></a>                <span class="n">value_original</span> <span class="o">=</span> <span class="n">df_values</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
</span><span id="SpLegendValidator-517"><a href="#SpLegendValidator-517"><span class="linenos">517</span></a>                <span class="k">if</span> <span class="n">value_original</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">VALUE_DATA_UNAVAILABLE</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value_numeric</span><span class="p">):</span>
</span><span id="SpLegendValidator-518"><a href="#SpLegendValidator-518"><span class="linenos">518</span></a>                    <span class="k">continue</span>
</span><span id="SpLegendValidator-519"><a href="#SpLegendValidator-519"><span class="linenos">519</span></a>
</span><span id="SpLegendValidator-520"><a href="#SpLegendValidator-520"><span class="linenos">520</span></a>                <span class="k">if</span> <span class="n">value_numeric</span> <span class="o">&lt;</span> <span class="n">min_value</span> <span class="ow">or</span> <span class="n">value_numeric</span> <span class="o">&gt;</span> <span class="n">max_value</span><span class="p">:</span>
</span><span id="SpLegendValidator-521"><a href="#SpLegendValidator-521"><span class="linenos">521</span></a>
</span><span id="SpLegendValidator-522"><a href="#SpLegendValidator-522"><span class="linenos">522</span></a>                    <span class="n">text_code_legend</span> <span class="o">=</span> <span class="s2">&quot;padro&quot;</span>
</span><span id="SpLegendValidator-523"><a href="#SpLegendValidator-523"><span class="linenos">523</span></a>                    <span class="k">if</span> <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">legend_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpLegendValidator-524"><a href="#SpLegendValidator-524"><span class="linenos">524</span></a>                        <span class="n">text_code_legend</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;de cdigo &#39;</span><span class="si">{</span><span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">legend_id</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="SpLegendValidator-525"><a href="#SpLegendValidator-525"><span class="linenos">525</span></a>
</span><span id="SpLegendValidator-526"><a href="#SpLegendValidator-526"><span class="linenos">526</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator-527"><a href="#SpLegendValidator-527"><span class="linenos">527</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: O valor </span><span class="si">{</span><span class="n">value_original</span><span class="si">}</span><span class="s2"> est fora do intervalo da legenda </span><span class="si">{</span><span class="n">text_code_legend</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">min_value</span><span class="si">}</span><span class="s2"> a </span><span class="si">{</span><span class="n">max_value</span><span class="si">}</span><span class="s2">) para a coluna &#39;</span><span class="si">{</span><span class="n">data_column_sp_value</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="SpLegendValidator-528"><a href="#SpLegendValidator-528"><span class="linenos">528</span></a>                    <span class="p">)</span>
</span><span id="SpLegendValidator-529"><a href="#SpLegendValidator-529"><span class="linenos">529</span></a>
</span><span id="SpLegendValidator-530"><a href="#SpLegendValidator-530"><span class="linenos">530</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator-531"><a href="#SpLegendValidator-531"><span class="linenos">531</span></a>
</span><span id="SpLegendValidator-532"><a href="#SpLegendValidator-532"><span class="linenos">532</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpLegendValidator-533"><a href="#SpLegendValidator-533"><span class="linenos">533</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-534"><a href="#SpLegendValidator-534"><span class="linenos">534</span></a><span class="sd">        Execute all legend validations.</span>
</span><span id="SpLegendValidator-535"><a href="#SpLegendValidator-535"><span class="linenos">535</span></a>
</span><span id="SpLegendValidator-536"><a href="#SpLegendValidator-536"><span class="linenos">536</span></a><span class="sd">        Orchestrates the execution of legend validators including relationship</span>
</span><span id="SpLegendValidator-537"><a href="#SpLegendValidator-537"><span class="linenos">537</span></a><span class="sd">        validation and range validation. Validations are conditionally executed</span>
</span><span id="SpLegendValidator-538"><a href="#SpLegendValidator-538"><span class="linenos">538</span></a><span class="sd">        based on data availability and sanity check status.</span>
</span><span id="SpLegendValidator-539"><a href="#SpLegendValidator-539"><span class="linenos">539</span></a>
</span><span id="SpLegendValidator-540"><a href="#SpLegendValidator-540"><span class="linenos">540</span></a><span class="sd">        Returns</span>
</span><span id="SpLegendValidator-541"><a href="#SpLegendValidator-541"><span class="linenos">541</span></a><span class="sd">        -------</span>
</span><span id="SpLegendValidator-542"><a href="#SpLegendValidator-542"><span class="linenos">542</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpLegendValidator-543"><a href="#SpLegendValidator-543"><span class="linenos">543</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpLegendValidator-544"><a href="#SpLegendValidator-544"><span class="linenos">544</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpLegendValidator-545"><a href="#SpLegendValidator-545"><span class="linenos">545</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpLegendValidator-546"><a href="#SpLegendValidator-546"><span class="linenos">546</span></a>
</span><span id="SpLegendValidator-547"><a href="#SpLegendValidator-547"><span class="linenos">547</span></a><span class="sd">        Notes</span>
</span><span id="SpLegendValidator-548"><a href="#SpLegendValidator-548"><span class="linenos">548</span></a><span class="sd">        -----</span>
</span><span id="SpLegendValidator-549"><a href="#SpLegendValidator-549"><span class="linenos">549</span></a><span class="sd">        - Relationship validation only runs if legend sanity check passes</span>
</span><span id="SpLegendValidator-550"><a href="#SpLegendValidator-550"><span class="linenos">550</span></a><span class="sd">        - All validations are skipped if description dataframe is empty</span>
</span><span id="SpLegendValidator-551"><a href="#SpLegendValidator-551"><span class="linenos">551</span></a><span class="sd">        - Results are aggregated into reports via `build_reports()`</span>
</span><span id="SpLegendValidator-552"><a href="#SpLegendValidator-552"><span class="linenos">552</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator-553"><a href="#SpLegendValidator-553"><span class="linenos">553</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpLegendValidator-554"><a href="#SpLegendValidator-554"><span class="linenos">554</span></a>
</span><span id="SpLegendValidator-555"><a href="#SpLegendValidator-555"><span class="linenos">555</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">is_sanity_check_passed</span><span class="p">:</span>
</span><span id="SpLegendValidator-556"><a href="#SpLegendValidator-556"><span class="linenos">556</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_legend</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEG_REL</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="SpLegendValidator-557"><a href="#SpLegendValidator-557"><span class="linenos">557</span></a>        <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_range_multiple_legend</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEG_RANGE</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="SpLegendValidator-558"><a href="#SpLegendValidator-558"><span class="linenos">558</span></a>
</span><span id="SpLegendValidator-559"><a href="#SpLegendValidator-559"><span class="linenos">559</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator-560"><a href="#SpLegendValidator-560"><span class="linenos">560</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpLegendValidator-561"><a href="#SpLegendValidator-561"><span class="linenos">561</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpLegendValidator-562"><a href="#SpLegendValidator-562"><span class="linenos">562</span></a>
</span><span id="SpLegendValidator-563"><a href="#SpLegendValidator-563"><span class="linenos">563</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpLegendValidator-564"><a href="#SpLegendValidator-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpLegendValidator-565"><a href="#SpLegendValidator-565"><span class="linenos">565</span></a>
</span><span id="SpLegendValidator-566"><a href="#SpLegendValidator-566"><span class="linenos">566</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates Legend spreadsheet content and relationships.</p>

<p>This validator performs comprehensive checks on legend data including:</p>

<ul>
<li>Legend-indicator relationship validation</li>
<li>Value range validation against legend definitions</li>
<li>Level-based legend requirement enforcement</li>
<li>Legend reference consistency checks</li>
</ul>

<h2 id="attributes">Attributes</h2>

<p>model_sp_legend : SpLegend
    Legend model instance containing legend definitions.
model_sp_description : SpDescription
    Description model instance containing indicator metadata.
model_sp_value : SpValue
    Value model instance containing indicator data.
scenario_exists_file : bool
    Flag indicating if scenario file exists.
scenarios_list : List[str]
    List of available scenario identifiers.
sp_name_legend : str
    Legend spreadsheet filename.
sp_name_description : str
    Description spreadsheet filename.
sp_name_value : str
    Value spreadsheet filename.
global_required_columns : Dict[str, List[str]]
    Required columns mapping for validation.
model_dataframes : Dict[str, pd.DataFrame]
    DataFrames mapping for each model.</p>
</div>


                            <div id="SpLegendValidator.__init__" class="classattr">
                                        <input id="SpLegendValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpLegendValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpLegendValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpLegendValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpLegendValidator.__init__-121"><a href="#SpLegendValidator.__init__-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpLegendValidator.__init__-122"><a href="#SpLegendValidator.__init__-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpLegendValidator.__init__-123"><a href="#SpLegendValidator.__init__-123"><span class="linenos">123</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpLegendValidator.__init__-124"><a href="#SpLegendValidator.__init__-124"><span class="linenos">124</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpLegendValidator.__init__-125"><a href="#SpLegendValidator.__init__-125"><span class="linenos">125</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpLegendValidator.__init__-126"><a href="#SpLegendValidator.__init__-126"><span class="linenos">126</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpLegendValidator.__init__-127"><a href="#SpLegendValidator.__init__-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.__init__-128"><a href="#SpLegendValidator.__init__-128"><span class="linenos">128</span></a><span class="sd">        Initialize the Legend validator.</span>
</span><span id="SpLegendValidator.__init__-129"><a href="#SpLegendValidator.__init__-129"><span class="linenos">129</span></a>
</span><span id="SpLegendValidator.__init__-130"><a href="#SpLegendValidator.__init__-130"><span class="linenos">130</span></a><span class="sd">        Args</span>
</span><span id="SpLegendValidator.__init__-131"><a href="#SpLegendValidator.__init__-131"><span class="linenos">131</span></a><span class="sd">        ----</span>
</span><span id="SpLegendValidator.__init__-132"><a href="#SpLegendValidator.__init__-132"><span class="linenos">132</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpLegendValidator.__init__-133"><a href="#SpLegendValidator.__init__-133"><span class="linenos">133</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="SpLegendValidator.__init__-134"><a href="#SpLegendValidator.__init__-134"><span class="linenos">134</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpLegendValidator.__init__-135"><a href="#SpLegendValidator.__init__-135"><span class="linenos">135</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpLegendValidator.__init__-136"><a href="#SpLegendValidator.__init__-136"><span class="linenos">136</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpLegendValidator.__init__-137"><a href="#SpLegendValidator.__init__-137"><span class="linenos">137</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpLegendValidator.__init__-138"><a href="#SpLegendValidator.__init__-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.__init__-139"><a href="#SpLegendValidator.__init__-139"><span class="linenos">139</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpLegendValidator.__init__-140"><a href="#SpLegendValidator.__init__-140"><span class="linenos">140</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpLegendValidator.__init__-141"><a href="#SpLegendValidator.__init__-141"><span class="linenos">141</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpLegendValidator.__init__-142"><a href="#SpLegendValidator.__init__-142"><span class="linenos">142</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpLegend</span><span class="p">,</span>
</span><span id="SpLegendValidator.__init__-143"><a href="#SpLegendValidator.__init__-143"><span class="linenos">143</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpLegendValidator.__init__-144"><a href="#SpLegendValidator.__init__-144"><span class="linenos">144</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.__init__-145"><a href="#SpLegendValidator.__init__-145"><span class="linenos">145</span></a>
</span><span id="SpLegendValidator.__init__-146"><a href="#SpLegendValidator.__init__-146"><span class="linenos">146</span></a>        <span class="c1"># Configure</span>
</span><span id="SpLegendValidator.__init__-147"><a href="#SpLegendValidator.__init__-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span>
</span><span id="SpLegendValidator.__init__-148"><a href="#SpLegendValidator.__init__-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">)</span>
</span><span id="SpLegendValidator.__init__-149"><a href="#SpLegendValidator.__init__-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpValue</span><span class="p">)</span>
</span><span id="SpLegendValidator.__init__-150"><a href="#SpLegendValidator.__init__-150"><span class="linenos">150</span></a>
</span><span id="SpLegendValidator.__init__-151"><a href="#SpLegendValidator.__init__-151"><span class="linenos">151</span></a>        <span class="c1"># Get model properties once</span>
</span><span id="SpLegendValidator.__init__-152"><a href="#SpLegendValidator.__init__-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scenario_exists_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenario_exists_file</span>
</span><span id="SpLegendValidator.__init__-153"><a href="#SpLegendValidator.__init__-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scenarios_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">scenarios_list</span>
</span><span id="SpLegendValidator.__init__-154"><a href="#SpLegendValidator.__init__-154"><span class="linenos">154</span></a>
</span><span id="SpLegendValidator.__init__-155"><a href="#SpLegendValidator.__init__-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpLegendValidator.__init__-156"><a href="#SpLegendValidator.__init__-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpLegendValidator.__init__-157"><a href="#SpLegendValidator.__init__-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="SpLegendValidator.__init__-158"><a href="#SpLegendValidator.__init__-158"><span class="linenos">158</span></a>
</span><span id="SpLegendValidator.__init__-159"><a href="#SpLegendValidator.__init__-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_required_columns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpLegendValidator.__init__-160"><a href="#SpLegendValidator.__init__-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpLegendValidator.__init__-161"><a href="#SpLegendValidator.__init__-161"><span class="linenos">161</span></a>        <span class="c1"># self.</span>
</span><span id="SpLegendValidator.__init__-162"><a href="#SpLegendValidator.__init__-162"><span class="linenos">162</span></a>
</span><span id="SpLegendValidator.__init__-163"><a href="#SpLegendValidator.__init__-163"><span class="linenos">163</span></a>        <span class="c1"># Prepare statements</span>
</span><span id="SpLegendValidator.__init__-164"><a href="#SpLegendValidator.__init__-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="SpLegendValidator.__init__-165"><a href="#SpLegendValidator.__init__-165"><span class="linenos">165</span></a>
</span><span id="SpLegendValidator.__init__-166"><a href="#SpLegendValidator.__init__-166"><span class="linenos">166</span></a>        <span class="c1"># Run pipeline</span>
</span><span id="SpLegendValidator.__init__-167"><a href="#SpLegendValidator.__init__-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Legend validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpLegendValidator.model_sp_legend" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_legend</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.model_sp_legend"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.model_sp_description" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_description</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.model_sp_description"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.model_sp_value" class="classattr">
                                <div class="attr variable">
            <span class="name">model_sp_value</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.model_sp_value"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.scenario_exists_file" class="classattr">
                                <div class="attr variable">
            <span class="name">scenario_exists_file</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.scenario_exists_file"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.scenarios_list" class="classattr">
                                <div class="attr variable">
            <span class="name">scenarios_list</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.scenarios_list"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.sp_name_legend" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_legend</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.sp_name_legend"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.sp_name_description" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_description</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.sp_name_description"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.sp_name_value" class="classattr">
                                <div class="attr variable">
            <span class="name">sp_name_value</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.sp_name_value"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.global_required_columns" class="classattr">
                                <div class="attr variable">
            <span class="name">global_required_columns</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.global_required_columns"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.model_dataframes" class="classattr">
                                <div class="attr variable">
            <span class="name">model_dataframes</span>

        
    </div>
    <a class="headerlink" href="#SpLegendValidator.model_dataframes"></a>
    
    

                            </div>
                            <div id="SpLegendValidator.validate_relation_indicators_in_legend" class="classattr">
                                        <input id="SpLegendValidator.validate_relation_indicators_in_legend-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_relation_indicators_in_legend</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpLegendValidator.validate_relation_indicators_in_legend-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpLegendValidator.validate_relation_indicators_in_legend"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpLegendValidator.validate_relation_indicators_in_legend-193"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-193"><span class="linenos">193</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_relation_indicators_in_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-194"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-195"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-195"><span class="linenos">195</span></a><span class="sd">        Validate legend-indicator relationships and level-based requirements.</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-196"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-196"><span class="linenos">196</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-197"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-197"><span class="linenos">197</span></a><span class="sd">        Performs comprehensive validation including:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-198"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-198"><span class="linenos">198</span></a><span class="sd">        - Checking that all legend codes in description exist in legend spreadsheet</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-199"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-199"><span class="linenos">199</span></a><span class="sd">        - Validating that level 1 indicators do not have legend references</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-200"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-200"><span class="linenos">200</span></a><span class="sd">        - Ensuring indicators at levels other than 1 and 2 have legend references</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-201"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-201"><span class="linenos">201</span></a><span class="sd">        - Identifying unreferenced legend codes</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-202"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-202"><span class="linenos">202</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-203"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-203"><span class="linenos">203</span></a><span class="sd">        Returns</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-204"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-204"><span class="linenos">204</span></a><span class="sd">        -------</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-205"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-205"><span class="linenos">205</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-206"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-206"><span class="linenos">206</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-207"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-207"><span class="linenos">207</span></a><span class="sd">                - List[str]: Error messages for validation failures</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-208"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-208"><span class="linenos">208</span></a><span class="sd">                - List[str]: Warning messages for unreferenced legend codes</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-209"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-209"><span class="linenos">209</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-210"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-210"><span class="linenos">210</span></a><span class="sd">        Notes</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-211"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-211"><span class="linenos">211</span></a><span class="sd">        -----</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-212"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-212"><span class="linenos">212</span></a><span class="sd">        - Validation is skipped if legend sanity check fails</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-213"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-213"><span class="linenos">213</span></a><span class="sd">        - Level 1 indicators must not have legend references</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-214"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-214"><span class="linenos">214</span></a><span class="sd">        - Indicators at levels != 1 and != 2 must have legend references</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-215"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-215"><span class="linenos">215</span></a><span class="sd">        - Missing legend codes in legend file are errors</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-216"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-216"><span class="linenos">216</span></a><span class="sd">        - Unreferenced legend codes are warnings</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-217"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-217"><span class="linenos">217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-218"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-218"><span class="linenos">218</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-219"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-219"><span class="linenos">219</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-220"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">is_sanity_check_passed</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-221"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-221"><span class="linenos">221</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-222"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-222"><span class="linenos">222</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-223"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-223"><span class="linenos">223</span></a>        <span class="n">required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-224"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-225"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-225"><span class="linenos">225</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-226"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-226"><span class="linenos">226</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-227"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-227"><span class="linenos">227</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-228"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-228"><span class="linenos">228</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-229"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-229"><span class="linenos">229</span></a>        <span class="p">}</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-230"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-230"><span class="linenos">230</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-231"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-231"><span class="linenos">231</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-232"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-232"><span class="linenos">232</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-233"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-233"><span class="linenos">233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-234"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-234"><span class="linenos">234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-235"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-235"><span class="linenos">235</span></a>                <span class="n">column</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-236"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-236"><span class="linenos">236</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-237"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-237"><span class="linenos">237</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-238"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-238"><span class="linenos">238</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-239"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-239"><span class="linenos">239</span></a>                <span class="k">break</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-240"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-240"><span class="linenos">240</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-241"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-242"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-242"><span class="linenos">242</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-243"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-243"><span class="linenos">243</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-244"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-244"><span class="linenos">244</span></a>        <span class="n">df_legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-245"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-245"><span class="linenos">245</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-246"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-246"><span class="linenos">246</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-247"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-247"><span class="linenos">247</span></a>        <span class="n">df_description_clean</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-248"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-248"><span class="linenos">248</span></a>            <span class="n">df_description</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-249"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-250"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-250"><span class="linenos">250</span></a>            <span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-251"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-251"><span class="linenos">251</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-252"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-252"><span class="linenos">252</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-253"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-253"><span class="linenos">253</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-254"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-254"><span class="linenos">254</span></a>        <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-255"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-255"><span class="linenos">255</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-256"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-256"><span class="linenos">256</span></a>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-257"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-257"><span class="linenos">257</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-258"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-258"><span class="linenos">258</span></a>        <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-259"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-259"><span class="linenos">259</span></a>            <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-260"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-260"><span class="linenos">260</span></a>        <span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-261"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-261"><span class="linenos">261</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-262"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-262"><span class="linenos">262</span></a>        <span class="c1"># Remove all NaN values in column COLUMN_LEGEND</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-263"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-263"><span class="linenos">263</span></a>        <span class="n">df_description_clean</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-264"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-264"><span class="linenos">264</span></a>        <span class="n">df_legend</span> <span class="o">=</span> <span class="n">df_legend</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-265"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-265"><span class="linenos">265</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-266"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-266"><span class="linenos">266</span></a>        <span class="n">legends_id_in_description</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-267"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-267"><span class="linenos">267</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-268"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-268"><span class="linenos">268</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-269"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-269"><span class="linenos">269</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-270"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-270"><span class="linenos">270</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-271"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-271"><span class="linenos">271</span></a>                    <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-272"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-272"><span class="linenos">272</span></a>                        <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-273"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-273"><span class="linenos">273</span></a>                        <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-274"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-274"><span class="linenos">274</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-275"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-275"><span class="linenos">275</span></a>                <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-276"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-276"><span class="linenos">276</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-277"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-277"><span class="linenos">277</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-278"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-278"><span class="linenos">278</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-279"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-279"><span class="linenos">279</span></a>        <span class="p">)</span>  <span class="c1"># DROP NA VALUES</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-280"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-280"><span class="linenos">280</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-281"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-281"><span class="linenos">281</span></a>        <span class="n">legends_id_in_legend</span> <span class="o">=</span> <span class="n">df_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-282"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-282"><span class="linenos">282</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-283"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-283"><span class="linenos">283</span></a>        <span class="n">set_one</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">legends_id_in_description</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-284"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-284"><span class="linenos">284</span></a>        <span class="n">set_two</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">legends_id_in_legend</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-285"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-285"><span class="linenos">285</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-286"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-286"><span class="linenos">286</span></a>        <span class="n">missing_in_b</span><span class="p">,</span> <span class="n">missing_in_a</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">find_differences_in_two_set</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-287"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-287"><span class="linenos">287</span></a>            <span class="n">first_set</span><span class="o">=</span><span class="n">set_one</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-288"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-288"><span class="linenos">288</span></a>            <span class="n">second_set</span><span class="o">=</span><span class="n">set_two</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-289"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-289"><span class="linenos">289</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-290"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-290"><span class="linenos">290</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-291"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-291"><span class="linenos">291</span></a>        <span class="n">missing_in_b</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">missing_in_b</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()}</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-292"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-292"><span class="linenos">292</span></a>        <span class="n">missing_in_a</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">missing_in_a</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()}</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-293"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-293"><span class="linenos">293</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-294"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-294"><span class="linenos">294</span></a>        <span class="k">if</span> <span class="n">missing_in_b</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-295"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-295"><span class="linenos">295</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Cdigos de legenda ausentes em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">missing_in_b</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-296"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-296"><span class="linenos">296</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-297"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-297"><span class="linenos">297</span></a>        <span class="k">if</span> <span class="n">missing_in_a</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-298"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-298"><span class="linenos">298</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-299"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-299"><span class="linenos">299</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: Cdigos de legenda no referenciados em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">missing_in_a</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-300"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-300"><span class="linenos">300</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-301"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-301"><span class="linenos">301</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-302"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-302"><span class="linenos">302</span></a>        <span class="c1"># 1. All codes that are level 1 - Cannot have legends: if they do, error</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-303"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-303"><span class="linenos">303</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-304"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-304"><span class="linenos">304</span></a>        <span class="n">codes_indicators_level_one</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-305"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-305"><span class="linenos">305</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-306"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-306"><span class="linenos">306</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-307"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-307"><span class="linenos">307</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-308"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-308"><span class="linenos">308</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-309"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-309"><span class="linenos">309</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-310"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-310"><span class="linenos">310</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-311"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-311"><span class="linenos">311</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-312"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-312"><span class="linenos">312</span></a>        <span class="n">legends_id_in_description_level_one</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-313"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-313"><span class="linenos">313</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-314"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-314"><span class="linenos">314</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-315"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-315"><span class="linenos">315</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-316"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-316"><span class="linenos">316</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-317"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-317"><span class="linenos">317</span></a>            <span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-318"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-318"><span class="linenos">318</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-319"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-319"><span class="linenos">319</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-320"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-320"><span class="linenos">320</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-321"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-321"><span class="linenos">321</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-322"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="n">legends_id_in_description_level_one</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-323"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-323"><span class="linenos">323</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-324"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-324"><span class="linenos">324</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Indicadores de nvel 1 no podem ter referncia de legenda. Cdigos com referncia em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">codes_indicators_level_one</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-325"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-325"><span class="linenos">325</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-326"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-326"><span class="linenos">326</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-327"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-327"><span class="linenos">327</span></a>        <span class="c1"># 3. All codes that are not level 1 and not level 2 - Must have a legend reference: if not, error</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-328"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-328"><span class="linenos">328</span></a>        <span class="n">codes_indicators_other_levels</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-329"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-329"><span class="linenos">329</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-330"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-330"><span class="linenos">330</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-331"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-331"><span class="linenos">331</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-332"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-332"><span class="linenos">332</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-333"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-333"><span class="linenos">333</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-334"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-334"><span class="linenos">334</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-335"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-335"><span class="linenos">335</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-336"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-336"><span class="linenos">336</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-337"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-337"><span class="linenos">337</span></a>        <span class="n">codes_with_legend_other_levels</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-338"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-338"><span class="linenos">338</span></a>            <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-339"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-339"><span class="linenos">339</span></a>                <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-340"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-340"><span class="linenos">340</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-341"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-341"><span class="linenos">341</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-342"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-342"><span class="linenos">342</span></a>            <span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-343"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-343"><span class="linenos">343</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-344"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-344"><span class="linenos">344</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-345"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-345"><span class="linenos">345</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-346"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-346"><span class="linenos">346</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-347"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-347"><span class="linenos">347</span></a>        <span class="n">set_codes_other_levels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_indicators_other_levels</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-348"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-348"><span class="linenos">348</span></a>        <span class="n">set_codes_with_legend</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_with_legend_other_levels</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-349"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-349"><span class="linenos">349</span></a>        <span class="n">missing_legends_other_levels</span> <span class="o">=</span> <span class="n">set_codes_other_levels</span> <span class="o">-</span> <span class="n">set_codes_with_legend</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-350"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-350"><span class="linenos">350</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-351"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-351"><span class="linenos">351</span></a>        <span class="k">if</span> <span class="n">missing_legends_other_levels</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-352"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-352"><span class="linenos">352</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-353"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-353"><span class="linenos">353</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="si">}</span><span class="s2">: Indicadores de nveis diferentes de 1 e 2 devem ter referncia de legenda. Indicadores sem referncia em </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">missing_legends_other_levels</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-354"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-354"><span class="linenos">354</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-355"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-355"><span class="linenos">355</span></a>
</span><span id="SpLegendValidator.validate_relation_indicators_in_legend-356"><a href="#SpLegendValidator.validate_relation_indicators_in_legend-356"><span class="linenos">356</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate legend-indicator relationships and level-based requirements.</p>

<p>Performs comprehensive validation including:</p>

<ul>
<li>Checking that all legend codes in description exist in legend spreadsheet</li>
<li>Validating that level 1 indicators do not have legend references</li>
<li>Ensuring indicators at levels other than 1 and 2 have legend references</li>
<li>Identifying unreferenced legend codes</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for validation failures
        - List[str]: Warning messages for unreferenced legend codes</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if legend sanity check fails</li>
<li>Level 1 indicators must not have legend references</li>
<li>Indicators at levels != 1 and != 2 must have legend references</li>
<li>Missing legend codes in legend file are errors</li>
<li>Unreferenced legend codes are warnings</li>
</ul>
</div>


                            </div>
                            <div id="SpLegendValidator.validate_range_multiple_legend" class="classattr">
                                        <input id="SpLegendValidator.validate_range_multiple_legend-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_range_multiple_legend</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpLegendValidator.validate_range_multiple_legend-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpLegendValidator.validate_range_multiple_legend"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpLegendValidator.validate_range_multiple_legend-358"><a href="#SpLegendValidator.validate_range_multiple_legend-358"><span class="linenos">358</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_range_multiple_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-359"><a href="#SpLegendValidator.validate_range_multiple_legend-359"><span class="linenos">359</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-360"><a href="#SpLegendValidator.validate_range_multiple_legend-360"><span class="linenos">360</span></a><span class="sd">        Validate that indicator values fall within their legend-defined ranges.</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-361"><a href="#SpLegendValidator.validate_range_multiple_legend-361"><span class="linenos">361</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-362"><a href="#SpLegendValidator.validate_range_multiple_legend-362"><span class="linenos">362</span></a><span class="sd">        Performs value range validation by:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-363"><a href="#SpLegendValidator.validate_range_multiple_legend-363"><span class="linenos">363</span></a><span class="sd">        - Mapping each value column to its corresponding legend</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-364"><a href="#SpLegendValidator.validate_range_multiple_legend-364"><span class="linenos">364</span></a><span class="sd">        - Extracting min/max ranges from legend definitions</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-365"><a href="#SpLegendValidator.validate_range_multiple_legend-365"><span class="linenos">365</span></a><span class="sd">        - Checking that all non-unavailable values fall within valid ranges</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-366"><a href="#SpLegendValidator.validate_range_multiple_legend-366"><span class="linenos">366</span></a><span class="sd">        - Using default ranges when no legend is specified</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-367"><a href="#SpLegendValidator.validate_range_multiple_legend-367"><span class="linenos">367</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-368"><a href="#SpLegendValidator.validate_range_multiple_legend-368"><span class="linenos">368</span></a><span class="sd">        Returns</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-369"><a href="#SpLegendValidator.validate_range_multiple_legend-369"><span class="linenos">369</span></a><span class="sd">        -------</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-370"><a href="#SpLegendValidator.validate_range_multiple_legend-370"><span class="linenos">370</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-371"><a href="#SpLegendValidator.validate_range_multiple_legend-371"><span class="linenos">371</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-372"><a href="#SpLegendValidator.validate_range_multiple_legend-372"><span class="linenos">372</span></a><span class="sd">                - List[str]: Error messages for values outside valid ranges</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-373"><a href="#SpLegendValidator.validate_range_multiple_legend-373"><span class="linenos">373</span></a><span class="sd">                - List[str]: Empty list (no warnings generated)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-374"><a href="#SpLegendValidator.validate_range_multiple_legend-374"><span class="linenos">374</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-375"><a href="#SpLegendValidator.validate_range_multiple_legend-375"><span class="linenos">375</span></a><span class="sd">        Notes</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-376"><a href="#SpLegendValidator.validate_range_multiple_legend-376"><span class="linenos">376</span></a><span class="sd">        -----</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-377"><a href="#SpLegendValidator.validate_range_multiple_legend-377"><span class="linenos">377</span></a><span class="sd">        - Validation is skipped if value dataframe is empty</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-378"><a href="#SpLegendValidator.validate_range_multiple_legend-378"><span class="linenos">378</span></a><span class="sd">        - Level 1 indicators are excluded from range validation</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-379"><a href="#SpLegendValidator.validate_range_multiple_legend-379"><span class="linenos">379</span></a><span class="sd">        - Default range is [0, 1] when no legend is specified</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-380"><a href="#SpLegendValidator.validate_range_multiple_legend-380"><span class="linenos">380</span></a><span class="sd">        - &#39;Dado indisponvel&#39; (unavailable data) values are excluded</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-381"><a href="#SpLegendValidator.validate_range_multiple_legend-381"><span class="linenos">381</span></a><span class="sd">        - Each error message includes: file, line, value, range, and column</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-382"><a href="#SpLegendValidator.validate_range_multiple_legend-382"><span class="linenos">382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-383"><a href="#SpLegendValidator.validate_range_multiple_legend-383"><span class="linenos">383</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-384"><a href="#SpLegendValidator.validate_range_multiple_legend-384"><span class="linenos">384</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-385"><a href="#SpLegendValidator.validate_range_multiple_legend-385"><span class="linenos">385</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_value</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-386"><a href="#SpLegendValidator.validate_range_multiple_legend-386"><span class="linenos">386</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-387"><a href="#SpLegendValidator.validate_range_multiple_legend-387"><span class="linenos">387</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-388"><a href="#SpLegendValidator.validate_range_multiple_legend-388"><span class="linenos">388</span></a>        <span class="n">min_lower_legend_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MIN_LOWER_LEGEND_DEFAULT</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-389"><a href="#SpLegendValidator.validate_range_multiple_legend-389"><span class="linenos">389</span></a>        <span class="n">max_upper_legend_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">CONSTANTS</span><span class="o">.</span><span class="n">MAX_UPPER_LEGEND_DEFAULT</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-390"><a href="#SpLegendValidator.validate_range_multiple_legend-390"><span class="linenos">390</span></a>        <span class="n">required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-391"><a href="#SpLegendValidator.validate_range_multiple_legend-391"><span class="linenos">391</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-392"><a href="#SpLegendValidator.validate_range_multiple_legend-392"><span class="linenos">392</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-393"><a href="#SpLegendValidator.validate_range_multiple_legend-393"><span class="linenos">393</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-394"><a href="#SpLegendValidator.validate_range_multiple_legend-394"><span class="linenos">394</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-395"><a href="#SpLegendValidator.validate_range_multiple_legend-395"><span class="linenos">395</span></a>        <span class="p">}</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-396"><a href="#SpLegendValidator.validate_range_multiple_legend-396"><span class="linenos">396</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-397"><a href="#SpLegendValidator.validate_range_multiple_legend-397"><span class="linenos">397</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">legend_read_success</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-398"><a href="#SpLegendValidator.validate_range_multiple_legend-398"><span class="linenos">398</span></a>            <span class="n">required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-399"><a href="#SpLegendValidator.validate_range_multiple_legend-399"><span class="linenos">399</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-400"><a href="#SpLegendValidator.validate_range_multiple_legend-400"><span class="linenos">400</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">required_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-401"><a href="#SpLegendValidator.validate_range_multiple_legend-401"><span class="linenos">401</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_exists</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-402"><a href="#SpLegendValidator.validate_range_multiple_legend-402"><span class="linenos">402</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-403"><a href="#SpLegendValidator.validate_range_multiple_legend-403"><span class="linenos">403</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-404"><a href="#SpLegendValidator.validate_range_multiple_legend-404"><span class="linenos">404</span></a>                <span class="n">column</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-405"><a href="#SpLegendValidator.validate_range_multiple_legend-405"><span class="linenos">405</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-406"><a href="#SpLegendValidator.validate_range_multiple_legend-406"><span class="linenos">406</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-407"><a href="#SpLegendValidator.validate_range_multiple_legend-407"><span class="linenos">407</span></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-408"><a href="#SpLegendValidator.validate_range_multiple_legend-408"><span class="linenos">408</span></a>                <span class="k">break</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-409"><a href="#SpLegendValidator.validate_range_multiple_legend-409"><span class="linenos">409</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-410"><a href="#SpLegendValidator.validate_range_multiple_legend-410"><span class="linenos">410</span></a>        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-411"><a href="#SpLegendValidator.validate_range_multiple_legend-411"><span class="linenos">411</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-412"><a href="#SpLegendValidator.validate_range_multiple_legend-412"><span class="linenos">412</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-413"><a href="#SpLegendValidator.validate_range_multiple_legend-413"><span class="linenos">413</span></a>        <span class="n">df_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-414"><a href="#SpLegendValidator.validate_range_multiple_legend-414"><span class="linenos">414</span></a>        <span class="n">df_legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_legend</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-415"><a href="#SpLegendValidator.validate_range_multiple_legend-415"><span class="linenos">415</span></a>        <span class="n">df_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dataframes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-416"><a href="#SpLegendValidator.validate_range_multiple_legend-416"><span class="linenos">416</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-417"><a href="#SpLegendValidator.validate_range_multiple_legend-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-418"><a href="#SpLegendValidator.validate_range_multiple_legend-418"><span class="linenos">418</span></a>            <span class="n">df_values</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">SpValue</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-419"><a href="#SpLegendValidator.validate_range_multiple_legend-419"><span class="linenos">419</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-420"><a href="#SpLegendValidator.validate_range_multiple_legend-420"><span class="linenos">420</span></a>        <span class="n">df_description_clean</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">DataCleaningProcessing</span><span class="o">.</span><span class="n">clean_dataframe_integers</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-421"><a href="#SpLegendValidator.validate_range_multiple_legend-421"><span class="linenos">421</span></a>            <span class="n">df_description</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-422"><a href="#SpLegendValidator.validate_range_multiple_legend-422"><span class="linenos">422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sp_name_description</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-423"><a href="#SpLegendValidator.validate_range_multiple_legend-423"><span class="linenos">423</span></a>            <span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-424"><a href="#SpLegendValidator.validate_range_multiple_legend-424"><span class="linenos">424</span></a>            <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-425"><a href="#SpLegendValidator.validate_range_multiple_legend-425"><span class="linenos">425</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-426"><a href="#SpLegendValidator.validate_range_multiple_legend-426"><span class="linenos">426</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-427"><a href="#SpLegendValidator.validate_range_multiple_legend-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_description_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-428"><a href="#SpLegendValidator.validate_range_multiple_legend-428"><span class="linenos">428</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-429"><a href="#SpLegendValidator.validate_range_multiple_legend-429"><span class="linenos">429</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-430"><a href="#SpLegendValidator.validate_range_multiple_legend-430"><span class="linenos">430</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-431"><a href="#SpLegendValidator.validate_range_multiple_legend-431"><span class="linenos">431</span></a>                <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-432"><a href="#SpLegendValidator.validate_range_multiple_legend-432"><span class="linenos">432</span></a>                <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-433"><a href="#SpLegendValidator.validate_range_multiple_legend-433"><span class="linenos">433</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-434"><a href="#SpLegendValidator.validate_range_multiple_legend-434"><span class="linenos">434</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-435"><a href="#SpLegendValidator.validate_range_multiple_legend-435"><span class="linenos">435</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-436"><a href="#SpLegendValidator.validate_range_multiple_legend-436"><span class="linenos">436</span></a>            <span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-437"><a href="#SpLegendValidator.validate_range_multiple_legend-437"><span class="linenos">437</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-438"><a href="#SpLegendValidator.validate_range_multiple_legend-438"><span class="linenos">438</span></a>        <span class="n">codes_indicators_level_one</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-439"><a href="#SpLegendValidator.validate_range_multiple_legend-439"><span class="linenos">439</span></a>            <span class="n">df_description_clean</span><span class="p">[</span><span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LEVEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">][</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-440"><a href="#SpLegendValidator.validate_range_multiple_legend-440"><span class="linenos">440</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-441"><a href="#SpLegendValidator.validate_range_multiple_legend-441"><span class="linenos">441</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-442"><a href="#SpLegendValidator.validate_range_multiple_legend-442"><span class="linenos">442</span></a>            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-443"><a href="#SpLegendValidator.validate_range_multiple_legend-443"><span class="linenos">443</span></a>            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-444"><a href="#SpLegendValidator.validate_range_multiple_legend-444"><span class="linenos">444</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-445"><a href="#SpLegendValidator.validate_range_multiple_legend-445"><span class="linenos">445</span></a>        <span class="n">valid_columns_from_values</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">CollectionsProcessing</span><span class="o">.</span><span class="n">categorize_strings_by_id_pattern_from_list</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-446"><a href="#SpLegendValidator.validate_range_multiple_legend-446"><span class="linenos">446</span></a>            <span class="n">items_to_categorize</span><span class="o">=</span><span class="n">df_values</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-447"><a href="#SpLegendValidator.validate_range_multiple_legend-447"><span class="linenos">447</span></a>            <span class="n">allowed_scenario_suffixes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scenarios_list</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-448"><a href="#SpLegendValidator.validate_range_multiple_legend-448"><span class="linenos">448</span></a>        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-449"><a href="#SpLegendValidator.validate_range_multiple_legend-449"><span class="linenos">449</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-450"><a href="#SpLegendValidator.validate_range_multiple_legend-450"><span class="linenos">450</span></a>        <span class="n">groups_legends</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="nb">str</span><span class="p">(</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="p">[]})</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-451"><a href="#SpLegendValidator.validate_range_multiple_legend-451"><span class="linenos">451</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">is_sanity_check_passed</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-452"><a href="#SpLegendValidator.validate_range_multiple_legend-452"><span class="linenos">452</span></a>            <span class="n">groups_legends</span> <span class="o">=</span> <span class="n">df_legend</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-453"><a href="#SpLegendValidator.validate_range_multiple_legend-453"><span class="linenos">453</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-454"><a href="#SpLegendValidator.validate_range_multiple_legend-454"><span class="linenos">454</span></a>        <span class="n">mapping_legends</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-455"><a href="#SpLegendValidator.validate_range_multiple_legend-455"><span class="linenos">455</span></a>        <span class="k">for</span> <span class="n">data_column_sp_value</span> <span class="ow">in</span> <span class="n">valid_columns_from_values</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-456"><a href="#SpLegendValidator.validate_range_multiple_legend-456"><span class="linenos">456</span></a>            <span class="n">aux_indicator_id</span> <span class="o">=</span> <span class="n">data_column_sp_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-457"><a href="#SpLegendValidator.validate_range_multiple_legend-457"><span class="linenos">457</span></a>            <span class="n">aux_data_mapping_legend</span> <span class="o">=</span> <span class="n">ModelMappingLegend</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-458"><a href="#SpLegendValidator.validate_range_multiple_legend-458"><span class="linenos">458</span></a>                <span class="n">column_sp_value</span><span class="o">=</span><span class="n">data_column_sp_value</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-459"><a href="#SpLegendValidator.validate_range_multiple_legend-459"><span class="linenos">459</span></a>                <span class="n">default_min_value</span><span class="o">=</span><span class="n">min_lower_legend_default</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-460"><a href="#SpLegendValidator.validate_range_multiple_legend-460"><span class="linenos">460</span></a>                <span class="n">default_max_value</span><span class="o">=</span><span class="n">max_upper_legend_default</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-461"><a href="#SpLegendValidator.validate_range_multiple_legend-461"><span class="linenos">461</span></a>            <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-462"><a href="#SpLegendValidator.validate_range_multiple_legend-462"><span class="linenos">462</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-463"><a href="#SpLegendValidator.validate_range_multiple_legend-463"><span class="linenos">463</span></a>            <span class="k">if</span> <span class="n">aux_indicator_id</span> <span class="ow">in</span> <span class="n">codes_indicators_level_one</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-464"><a href="#SpLegendValidator.validate_range_multiple_legend-464"><span class="linenos">464</span></a>                <span class="k">continue</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-465"><a href="#SpLegendValidator.validate_range_multiple_legend-465"><span class="linenos">465</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-466"><a href="#SpLegendValidator.validate_range_multiple_legend-466"><span class="linenos">466</span></a>            <span class="n">row_description</span> <span class="o">=</span> <span class="n">df_description_clean</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-467"><a href="#SpLegendValidator.validate_range_multiple_legend-467"><span class="linenos">467</span></a>                <span class="n">df_description_clean</span><span class="p">[</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">==</span> <span class="n">aux_indicator_id</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-468"><a href="#SpLegendValidator.validate_range_multiple_legend-468"><span class="linenos">468</span></a>            <span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-469"><a href="#SpLegendValidator.validate_range_multiple_legend-469"><span class="linenos">469</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">row_description</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-470"><a href="#SpLegendValidator.validate_range_multiple_legend-470"><span class="linenos">470</span></a>                <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">indicator_id</span> <span class="o">=</span> <span class="n">aux_indicator_id</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-471"><a href="#SpLegendValidator.validate_range_multiple_legend-471"><span class="linenos">471</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-472"><a href="#SpLegendValidator.validate_range_multiple_legend-472"><span class="linenos">472</span></a>                <span class="n">key_legend</span> <span class="o">=</span> <span class="n">row_description</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">SpDescription</span><span class="o">.</span><span class="n">DynamicColumn</span><span class="o">.</span><span class="n">COLUMN_LEGEND</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-473"><a href="#SpLegendValidator.validate_range_multiple_legend-473"><span class="linenos">473</span></a>                <span class="n">group_legend</span> <span class="o">=</span> <span class="n">groups_legends</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">key_legend</span><span class="p">))</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">key_legend</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups_legends</span><span class="o">.</span><span class="n">groups</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-474"><a href="#SpLegendValidator.validate_range_multiple_legend-474"><span class="linenos">474</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-475"><a href="#SpLegendValidator.validate_range_multiple_legend-475"><span class="linenos">475</span></a>                <span class="k">if</span> <span class="n">group_legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-476"><a href="#SpLegendValidator.validate_range_multiple_legend-476"><span class="linenos">476</span></a>                    <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">legend_id</span> <span class="o">=</span> <span class="n">key_legend</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-477"><a href="#SpLegendValidator.validate_range_multiple_legend-477"><span class="linenos">477</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-478"><a href="#SpLegendValidator.validate_range_multiple_legend-478"><span class="linenos">478</span></a>                    <span class="n">group_legend</span> <span class="o">=</span> <span class="n">group_legend</span><span class="p">[</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-479"><a href="#SpLegendValidator.validate_range_multiple_legend-479"><span class="linenos">479</span></a>                        <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_LABEL</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">LABEL_DATA_UNAVAILABLE</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-480"><a href="#SpLegendValidator.validate_range_multiple_legend-480"><span class="linenos">480</span></a>                    <span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-481"><a href="#SpLegendValidator.validate_range_multiple_legend-481"><span class="linenos">481</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_legend</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-482"><a href="#SpLegendValidator.validate_range_multiple_legend-482"><span class="linenos">482</span></a>                        <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MINIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-483"><a href="#SpLegendValidator.validate_range_multiple_legend-483"><span class="linenos">483</span></a>                            <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MINIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-484"><a href="#SpLegendValidator.validate_range_multiple_legend-484"><span class="linenos">484</span></a>                            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-485"><a href="#SpLegendValidator.validate_range_multiple_legend-485"><span class="linenos">485</span></a>                        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-486"><a href="#SpLegendValidator.validate_range_multiple_legend-486"><span class="linenos">486</span></a>                        <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MAXIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-487"><a href="#SpLegendValidator.validate_range_multiple_legend-487"><span class="linenos">487</span></a>                            <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MAXIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-488"><a href="#SpLegendValidator.validate_range_multiple_legend-488"><span class="linenos">488</span></a>                            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">,</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-489"><a href="#SpLegendValidator.validate_range_multiple_legend-489"><span class="linenos">489</span></a>                        <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-490"><a href="#SpLegendValidator.validate_range_multiple_legend-490"><span class="linenos">490</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-491"><a href="#SpLegendValidator.validate_range_multiple_legend-491"><span class="linenos">491</span></a>                        <span class="n">aux_min_value</span> <span class="o">=</span> <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MINIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-492"><a href="#SpLegendValidator.validate_range_multiple_legend-492"><span class="linenos">492</span></a>                        <span class="n">aux_max_value</span> <span class="o">=</span> <span class="n">group_legend</span><span class="p">[</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_MAXIMUM</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-493"><a href="#SpLegendValidator.validate_range_multiple_legend-493"><span class="linenos">493</span></a>                        <span class="n">legend_id</span> <span class="o">=</span> <span class="n">group_legend</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">SpLegend</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_CODE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-494"><a href="#SpLegendValidator.validate_range_multiple_legend-494"><span class="linenos">494</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-495"><a href="#SpLegendValidator.validate_range_multiple_legend-495"><span class="linenos">495</span></a>                        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">aux_min_value</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">aux_max_value</span><span class="p">)):</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-496"><a href="#SpLegendValidator.validate_range_multiple_legend-496"><span class="linenos">496</span></a>                            <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="n">aux_min_value</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-497"><a href="#SpLegendValidator.validate_range_multiple_legend-497"><span class="linenos">497</span></a>                            <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">aux_max_value</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-498"><a href="#SpLegendValidator.validate_range_multiple_legend-498"><span class="linenos">498</span></a>                            <span class="n">aux_data_mapping_legend</span><span class="o">.</span><span class="n">legend_id</span> <span class="o">=</span> <span class="n">legend_id</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-499"><a href="#SpLegendValidator.validate_range_multiple_legend-499"><span class="linenos">499</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-500"><a href="#SpLegendValidator.validate_range_multiple_legend-500"><span class="linenos">500</span></a>            <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux_data_mapping_legend</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-501"><a href="#SpLegendValidator.validate_range_multiple_legend-501"><span class="linenos">501</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-502"><a href="#SpLegendValidator.validate_range_multiple_legend-502"><span class="linenos">502</span></a>        <span class="n">df_values_numeric</span> <span class="o">=</span> <span class="n">df_values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-503"><a href="#SpLegendValidator.validate_range_multiple_legend-503"><span class="linenos">503</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">valid_columns_from_values</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-504"><a href="#SpLegendValidator.validate_range_multiple_legend-504"><span class="linenos">504</span></a>            <span class="n">df_values_numeric</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_values</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-505"><a href="#SpLegendValidator.validate_range_multiple_legend-505"><span class="linenos">505</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-506"><a href="#SpLegendValidator.validate_range_multiple_legend-506"><span class="linenos">506</span></a>        <span class="k">for</span> <span class="n">data_column_sp_value</span> <span class="ow">in</span> <span class="n">valid_columns_from_values</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-507"><a href="#SpLegendValidator.validate_range_multiple_legend-507"><span class="linenos">507</span></a>            <span class="n">code_column</span> <span class="o">=</span> <span class="n">data_column_sp_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-508"><a href="#SpLegendValidator.validate_range_multiple_legend-508"><span class="linenos">508</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-509"><a href="#SpLegendValidator.validate_range_multiple_legend-509"><span class="linenos">509</span></a>            <span class="k">if</span> <span class="n">code_column</span> <span class="ow">in</span> <span class="n">codes_indicators_level_one</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-510"><a href="#SpLegendValidator.validate_range_multiple_legend-510"><span class="linenos">510</span></a>                <span class="k">continue</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-511"><a href="#SpLegendValidator.validate_range_multiple_legend-511"><span class="linenos">511</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-512"><a href="#SpLegendValidator.validate_range_multiple_legend-512"><span class="linenos">512</span></a>            <span class="n">min_value</span> <span class="o">=</span> <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">min_value</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-513"><a href="#SpLegendValidator.validate_range_multiple_legend-513"><span class="linenos">513</span></a>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">max_value</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-514"><a href="#SpLegendValidator.validate_range_multiple_legend-514"><span class="linenos">514</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-515"><a href="#SpLegendValidator.validate_range_multiple_legend-515"><span class="linenos">515</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value_numeric</span> <span class="ow">in</span> <span class="n">df_values_numeric</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-516"><a href="#SpLegendValidator.validate_range_multiple_legend-516"><span class="linenos">516</span></a>                <span class="n">value_original</span> <span class="o">=</span> <span class="n">df_values</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-517"><a href="#SpLegendValidator.validate_range_multiple_legend-517"><span class="linenos">517</span></a>                <span class="k">if</span> <span class="n">value_original</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">VALUE_DATA_UNAVAILABLE</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value_numeric</span><span class="p">):</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-518"><a href="#SpLegendValidator.validate_range_multiple_legend-518"><span class="linenos">518</span></a>                    <span class="k">continue</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-519"><a href="#SpLegendValidator.validate_range_multiple_legend-519"><span class="linenos">519</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-520"><a href="#SpLegendValidator.validate_range_multiple_legend-520"><span class="linenos">520</span></a>                <span class="k">if</span> <span class="n">value_numeric</span> <span class="o">&lt;</span> <span class="n">min_value</span> <span class="ow">or</span> <span class="n">value_numeric</span> <span class="o">&gt;</span> <span class="n">max_value</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-521"><a href="#SpLegendValidator.validate_range_multiple_legend-521"><span class="linenos">521</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-522"><a href="#SpLegendValidator.validate_range_multiple_legend-522"><span class="linenos">522</span></a>                    <span class="n">text_code_legend</span> <span class="o">=</span> <span class="s2">&quot;padro&quot;</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-523"><a href="#SpLegendValidator.validate_range_multiple_legend-523"><span class="linenos">523</span></a>                    <span class="k">if</span> <span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">legend_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-524"><a href="#SpLegendValidator.validate_range_multiple_legend-524"><span class="linenos">524</span></a>                        <span class="n">text_code_legend</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;de cdigo &#39;</span><span class="si">{</span><span class="n">mapping_legends</span><span class="p">[</span><span class="n">data_column_sp_value</span><span class="p">]</span><span class="o">.</span><span class="n">legend_id</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-525"><a href="#SpLegendValidator.validate_range_multiple_legend-525"><span class="linenos">525</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-526"><a href="#SpLegendValidator.validate_range_multiple_legend-526"><span class="linenos">526</span></a>                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-527"><a href="#SpLegendValidator.validate_range_multiple_legend-527"><span class="linenos">527</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp_name_value</span><span class="si">}</span><span class="s2">, linha </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">: O valor </span><span class="si">{</span><span class="n">value_original</span><span class="si">}</span><span class="s2"> est fora do intervalo da legenda </span><span class="si">{</span><span class="n">text_code_legend</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">min_value</span><span class="si">}</span><span class="s2"> a </span><span class="si">{</span><span class="n">max_value</span><span class="si">}</span><span class="s2">) para a coluna &#39;</span><span class="si">{</span><span class="n">data_column_sp_value</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-528"><a href="#SpLegendValidator.validate_range_multiple_legend-528"><span class="linenos">528</span></a>                    <span class="p">)</span>
</span><span id="SpLegendValidator.validate_range_multiple_legend-529"><a href="#SpLegendValidator.validate_range_multiple_legend-529"><span class="linenos">529</span></a>
</span><span id="SpLegendValidator.validate_range_multiple_legend-530"><a href="#SpLegendValidator.validate_range_multiple_legend-530"><span class="linenos">530</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validate that indicator values fall within their legend-defined ranges.</p>

<p>Performs value range validation by:</p>

<ul>
<li>Mapping each value column to its corresponding legend</li>
<li>Extracting min/max ranges from legend definitions</li>
<li>Checking that all non-unavailable values fall within valid ranges</li>
<li>Using default ranges when no legend is specified</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Error messages for values outside valid ranges
        - List[str]: Empty list (no warnings generated)</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Validation is skipped if value dataframe is empty</li>
<li>Level 1 indicators are excluded from range validation</li>
<li>Default range is [0, 1] when no legend is specified</li>
<li>'Dado indisponvel' (unavailable data) values are excluded</li>
<li>Each error message includes: file, line, value, range, and column</li>
</ul>
</div>


                            </div>
                            <div id="SpLegendValidator.run" class="classattr">
                                        <input id="SpLegendValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpLegendValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpLegendValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpLegendValidator.run-532"><a href="#SpLegendValidator.run-532"><span class="linenos">532</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpLegendValidator.run-533"><a href="#SpLegendValidator.run-533"><span class="linenos">533</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.run-534"><a href="#SpLegendValidator.run-534"><span class="linenos">534</span></a><span class="sd">        Execute all legend validations.</span>
</span><span id="SpLegendValidator.run-535"><a href="#SpLegendValidator.run-535"><span class="linenos">535</span></a>
</span><span id="SpLegendValidator.run-536"><a href="#SpLegendValidator.run-536"><span class="linenos">536</span></a><span class="sd">        Orchestrates the execution of legend validators including relationship</span>
</span><span id="SpLegendValidator.run-537"><a href="#SpLegendValidator.run-537"><span class="linenos">537</span></a><span class="sd">        validation and range validation. Validations are conditionally executed</span>
</span><span id="SpLegendValidator.run-538"><a href="#SpLegendValidator.run-538"><span class="linenos">538</span></a><span class="sd">        based on data availability and sanity check status.</span>
</span><span id="SpLegendValidator.run-539"><a href="#SpLegendValidator.run-539"><span class="linenos">539</span></a>
</span><span id="SpLegendValidator.run-540"><a href="#SpLegendValidator.run-540"><span class="linenos">540</span></a><span class="sd">        Returns</span>
</span><span id="SpLegendValidator.run-541"><a href="#SpLegendValidator.run-541"><span class="linenos">541</span></a><span class="sd">        -------</span>
</span><span id="SpLegendValidator.run-542"><a href="#SpLegendValidator.run-542"><span class="linenos">542</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpLegendValidator.run-543"><a href="#SpLegendValidator.run-543"><span class="linenos">543</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpLegendValidator.run-544"><a href="#SpLegendValidator.run-544"><span class="linenos">544</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="SpLegendValidator.run-545"><a href="#SpLegendValidator.run-545"><span class="linenos">545</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="SpLegendValidator.run-546"><a href="#SpLegendValidator.run-546"><span class="linenos">546</span></a>
</span><span id="SpLegendValidator.run-547"><a href="#SpLegendValidator.run-547"><span class="linenos">547</span></a><span class="sd">        Notes</span>
</span><span id="SpLegendValidator.run-548"><a href="#SpLegendValidator.run-548"><span class="linenos">548</span></a><span class="sd">        -----</span>
</span><span id="SpLegendValidator.run-549"><a href="#SpLegendValidator.run-549"><span class="linenos">549</span></a><span class="sd">        - Relationship validation only runs if legend sanity check passes</span>
</span><span id="SpLegendValidator.run-550"><a href="#SpLegendValidator.run-550"><span class="linenos">550</span></a><span class="sd">        - All validations are skipped if description dataframe is empty</span>
</span><span id="SpLegendValidator.run-551"><a href="#SpLegendValidator.run-551"><span class="linenos">551</span></a><span class="sd">        - Results are aggregated into reports via `build_reports()`</span>
</span><span id="SpLegendValidator.run-552"><a href="#SpLegendValidator.run-552"><span class="linenos">552</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpLegendValidator.run-553"><a href="#SpLegendValidator.run-553"><span class="linenos">553</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpLegendValidator.run-554"><a href="#SpLegendValidator.run-554"><span class="linenos">554</span></a>
</span><span id="SpLegendValidator.run-555"><a href="#SpLegendValidator.run-555"><span class="linenos">555</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_legend</span><span class="o">.</span><span class="n">is_sanity_check_passed</span><span class="p">:</span>
</span><span id="SpLegendValidator.run-556"><a href="#SpLegendValidator.run-556"><span class="linenos">556</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_relation_indicators_in_legend</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEG_REL</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="SpLegendValidator.run-557"><a href="#SpLegendValidator.run-557"><span class="linenos">557</span></a>        <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_range_multiple_legend</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">LEG_RANGE</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="SpLegendValidator.run-558"><a href="#SpLegendValidator.run-558"><span class="linenos">558</span></a>
</span><span id="SpLegendValidator.run-559"><a href="#SpLegendValidator.run-559"><span class="linenos">559</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_sp_description</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpLegendValidator.run-560"><a href="#SpLegendValidator.run-560"><span class="linenos">560</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_not_executed</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpLegendValidator.run-561"><a href="#SpLegendValidator.run-561"><span class="linenos">561</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span><span id="SpLegendValidator.run-562"><a href="#SpLegendValidator.run-562"><span class="linenos">562</span></a>
</span><span id="SpLegendValidator.run-563"><a href="#SpLegendValidator.run-563"><span class="linenos">563</span></a>        <span class="c1"># BUILD REPORTS</span>
</span><span id="SpLegendValidator.run-564"><a href="#SpLegendValidator.run-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpLegendValidator.run-565"><a href="#SpLegendValidator.run-565"><span class="linenos">565</span></a>
</span><span id="SpLegendValidator.run-566"><a href="#SpLegendValidator.run-566"><span class="linenos">566</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all legend validations.</p>

<p>Orchestrates the execution of legend validators including relationship
validation and range validation. Validations are conditionally executed
based on data availability and sanity check status.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Relationship validation only runs if legend sanity check passes</li>
<li>All validations are skipped if description dataframe is empty</li>
<li>Results are aggregated into reports via <code><a href="#SpLegendValidator.build_reports">build_reports()</a></code></li>
</ul>
</div>


                            </div>
                </section>
                <section id="SpellCheckerValidator">
                            <input id="SpellCheckerValidator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpellCheckerValidator</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="SpellCheckerValidator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpellCheckerValidator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpellCheckerValidator-25"><a href="#SpellCheckerValidator-25"><span class="linenos"> 25</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpellCheckerValidator</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="SpellCheckerValidator-26"><a href="#SpellCheckerValidator-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-27"><a href="#SpellCheckerValidator-27"><span class="linenos"> 27</span></a><span class="sd">    Validates textual content using spell checking across multiple spreadsheet models.</span>
</span><span id="SpellCheckerValidator-28"><a href="#SpellCheckerValidator-28"><span class="linenos"> 28</span></a>
</span><span id="SpellCheckerValidator-29"><a href="#SpellCheckerValidator-29"><span class="linenos"> 29</span></a><span class="sd">    This validator performs spell checking on text columns in Description, Temporal Reference,</span>
</span><span id="SpellCheckerValidator-30"><a href="#SpellCheckerValidator-30"><span class="linenos"> 30</span></a><span class="sd">    and Scenario spreadsheets. It uses a custom dictionary and user-defined words to ignore</span>
</span><span id="SpellCheckerValidator-31"><a href="#SpellCheckerValidator-31"><span class="linenos"> 31</span></a><span class="sd">    during validation.</span>
</span><span id="SpellCheckerValidator-32"><a href="#SpellCheckerValidator-32"><span class="linenos"> 32</span></a>
</span><span id="SpellCheckerValidator-33"><a href="#SpellCheckerValidator-33"><span class="linenos"> 33</span></a><span class="sd">    Attributes</span>
</span><span id="SpellCheckerValidator-34"><a href="#SpellCheckerValidator-34"><span class="linenos"> 34</span></a><span class="sd">    ----------</span>
</span><span id="SpellCheckerValidator-35"><a href="#SpellCheckerValidator-35"><span class="linenos"> 35</span></a><span class="sd">    dictionary : SpDictionary | None</span>
</span><span id="SpellCheckerValidator-36"><a href="#SpellCheckerValidator-36"><span class="linenos"> 36</span></a><span class="sd">        Dictionary model instance containing words to ignore during spell checking.</span>
</span><span id="SpellCheckerValidator-37"><a href="#SpellCheckerValidator-37"><span class="linenos"> 37</span></a><span class="sd">    lang_dict_spell : str</span>
</span><span id="SpellCheckerValidator-38"><a href="#SpellCheckerValidator-38"><span class="linenos"> 38</span></a><span class="sd">        Language code for spell checking dictionary.</span>
</span><span id="SpellCheckerValidator-39"><a href="#SpellCheckerValidator-39"><span class="linenos"> 39</span></a><span class="sd">    list_words_user : List[str]</span>
</span><span id="SpellCheckerValidator-40"><a href="#SpellCheckerValidator-40"><span class="linenos"> 40</span></a><span class="sd">        User-defined words to ignore during spell checking.</span>
</span><span id="SpellCheckerValidator-41"><a href="#SpellCheckerValidator-41"><span class="linenos"> 41</span></a><span class="sd">    spellchecker : SpellChecker</span>
</span><span id="SpellCheckerValidator-42"><a href="#SpellCheckerValidator-42"><span class="linenos"> 42</span></a><span class="sd">        Spell checker instance configured with language and custom dictionary.</span>
</span><span id="SpellCheckerValidator-43"><a href="#SpellCheckerValidator-43"><span class="linenos"> 43</span></a><span class="sd">    model_columns_map : Dict[Type[Union[SpDescription, SpTemporalReference, SpScenario]], List[str]]</span>
</span><span id="SpellCheckerValidator-44"><a href="#SpellCheckerValidator-44"><span class="linenos"> 44</span></a><span class="sd">        Mapping of model types to their respective columns that require spell checking.</span>
</span><span id="SpellCheckerValidator-45"><a href="#SpellCheckerValidator-45"><span class="linenos"> 45</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-46"><a href="#SpellCheckerValidator-46"><span class="linenos"> 46</span></a>
</span><span id="SpellCheckerValidator-47"><a href="#SpellCheckerValidator-47"><span class="linenos"> 47</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpellCheckerValidator-48"><a href="#SpellCheckerValidator-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-49"><a href="#SpellCheckerValidator-49"><span class="linenos"> 49</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-50"><a href="#SpellCheckerValidator-50"><span class="linenos"> 50</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-51"><a href="#SpellCheckerValidator-51"><span class="linenos"> 51</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpellCheckerValidator-52"><a href="#SpellCheckerValidator-52"><span class="linenos"> 52</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-53"><a href="#SpellCheckerValidator-53"><span class="linenos"> 53</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-54"><a href="#SpellCheckerValidator-54"><span class="linenos"> 54</span></a><span class="sd">        Initialize the spell checker validator.</span>
</span><span id="SpellCheckerValidator-55"><a href="#SpellCheckerValidator-55"><span class="linenos"> 55</span></a>
</span><span id="SpellCheckerValidator-56"><a href="#SpellCheckerValidator-56"><span class="linenos"> 56</span></a><span class="sd">        Args</span>
</span><span id="SpellCheckerValidator-57"><a href="#SpellCheckerValidator-57"><span class="linenos"> 57</span></a><span class="sd">        ----</span>
</span><span id="SpellCheckerValidator-58"><a href="#SpellCheckerValidator-58"><span class="linenos"> 58</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpellCheckerValidator-59"><a href="#SpellCheckerValidator-59"><span class="linenos"> 59</span></a><span class="sd">            Context containing all loaded spreadsheet models.</span>
</span><span id="SpellCheckerValidator-60"><a href="#SpellCheckerValidator-60"><span class="linenos"> 60</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpellCheckerValidator-61"><a href="#SpellCheckerValidator-61"><span class="linenos"> 61</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpellCheckerValidator-62"><a href="#SpellCheckerValidator-62"><span class="linenos"> 62</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpellCheckerValidator-63"><a href="#SpellCheckerValidator-63"><span class="linenos"> 63</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpellCheckerValidator-64"><a href="#SpellCheckerValidator-64"><span class="linenos"> 64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-65"><a href="#SpellCheckerValidator-65"><span class="linenos"> 65</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpellCheckerValidator-66"><a href="#SpellCheckerValidator-66"><span class="linenos"> 66</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-67"><a href="#SpellCheckerValidator-67"><span class="linenos"> 67</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-68"><a href="#SpellCheckerValidator-68"><span class="linenos"> 68</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpDictionary</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-69"><a href="#SpellCheckerValidator-69"><span class="linenos"> 69</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-70"><a href="#SpellCheckerValidator-70"><span class="linenos"> 70</span></a>        <span class="p">)</span>
</span><span id="SpellCheckerValidator-71"><a href="#SpellCheckerValidator-71"><span class="linenos"> 71</span></a>
</span><span id="SpellCheckerValidator-72"><a href="#SpellCheckerValidator-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">:</span> <span class="n">SpDictionary</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDictionary</span><span class="p">)</span>
</span><span id="SpellCheckerValidator-73"><a href="#SpellCheckerValidator-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lang_dict_spell</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">locale</span>
</span><span id="SpellCheckerValidator-74"><a href="#SpellCheckerValidator-74"><span class="linenos"> 74</span></a>
</span><span id="SpellCheckerValidator-75"><a href="#SpellCheckerValidator-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">list_words_user</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="o">.</span><span class="n">words_to_ignore</span>
</span><span id="SpellCheckerValidator-76"><a href="#SpellCheckerValidator-76"><span class="linenos"> 76</span></a>
</span><span id="SpellCheckerValidator-77"><a href="#SpellCheckerValidator-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="p">:</span> <span class="n">SpellChecker</span> <span class="o">=</span> <span class="n">SpellChecker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lang_dict_spell</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_words_user</span><span class="p">)</span>
</span><span id="SpellCheckerValidator-78"><a href="#SpellCheckerValidator-78"><span class="linenos"> 78</span></a>
</span><span id="SpellCheckerValidator-79"><a href="#SpellCheckerValidator-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_columns_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">SpDescription</span><span class="p">,</span> <span class="n">SpTemporalReference</span><span class="p">,</span> <span class="n">SpScenario</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpellCheckerValidator-80"><a href="#SpellCheckerValidator-80"><span class="linenos"> 80</span></a>            <span class="n">SpDescription</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpellCheckerValidator-81"><a href="#SpellCheckerValidator-81"><span class="linenos"> 81</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-82"><a href="#SpellCheckerValidator-82"><span class="linenos"> 82</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-83"><a href="#SpellCheckerValidator-83"><span class="linenos"> 83</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-84"><a href="#SpellCheckerValidator-84"><span class="linenos"> 84</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-85"><a href="#SpellCheckerValidator-85"><span class="linenos"> 85</span></a>            <span class="p">],</span>
</span><span id="SpellCheckerValidator-86"><a href="#SpellCheckerValidator-86"><span class="linenos"> 86</span></a>            <span class="n">SpTemporalReference</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpellCheckerValidator-87"><a href="#SpellCheckerValidator-87"><span class="linenos"> 87</span></a>                <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-88"><a href="#SpellCheckerValidator-88"><span class="linenos"> 88</span></a>            <span class="p">],</span>
</span><span id="SpellCheckerValidator-89"><a href="#SpellCheckerValidator-89"><span class="linenos"> 89</span></a>            <span class="n">SpScenario</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpellCheckerValidator-90"><a href="#SpellCheckerValidator-90"><span class="linenos"> 90</span></a>                <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-91"><a href="#SpellCheckerValidator-91"><span class="linenos"> 91</span></a>                <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-92"><a href="#SpellCheckerValidator-92"><span class="linenos"> 92</span></a>            <span class="p">],</span>
</span><span id="SpellCheckerValidator-93"><a href="#SpellCheckerValidator-93"><span class="linenos"> 93</span></a>        <span class="p">}</span>
</span><span id="SpellCheckerValidator-94"><a href="#SpellCheckerValidator-94"><span class="linenos"> 94</span></a>
</span><span id="SpellCheckerValidator-95"><a href="#SpellCheckerValidator-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="SpellCheckerValidator-96"><a href="#SpellCheckerValidator-96"><span class="linenos"> 96</span></a>
</span><span id="SpellCheckerValidator-97"><a href="#SpellCheckerValidator-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_spellchecker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">SpDescription</span><span class="p">,</span> <span class="n">SpTemporalReference</span><span class="p">,</span> <span class="n">SpScenario</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpellCheckerValidator-98"><a href="#SpellCheckerValidator-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-99"><a href="#SpellCheckerValidator-99"><span class="linenos"> 99</span></a><span class="sd">        Perform spell checking validation on specified model class.</span>
</span><span id="SpellCheckerValidator-100"><a href="#SpellCheckerValidator-100"><span class="linenos">100</span></a>
</span><span id="SpellCheckerValidator-101"><a href="#SpellCheckerValidator-101"><span class="linenos">101</span></a><span class="sd">        Validates textual content in specified columns of the given model using the</span>
</span><span id="SpellCheckerValidator-102"><a href="#SpellCheckerValidator-102"><span class="linenos">102</span></a><span class="sd">        configured spell checker. Missing columns generate warnings, while spelling</span>
</span><span id="SpellCheckerValidator-103"><a href="#SpellCheckerValidator-103"><span class="linenos">103</span></a><span class="sd">        errors generate errors or warnings based on severity.</span>
</span><span id="SpellCheckerValidator-104"><a href="#SpellCheckerValidator-104"><span class="linenos">104</span></a>
</span><span id="SpellCheckerValidator-105"><a href="#SpellCheckerValidator-105"><span class="linenos">105</span></a><span class="sd">        Args</span>
</span><span id="SpellCheckerValidator-106"><a href="#SpellCheckerValidator-106"><span class="linenos">106</span></a><span class="sd">        ----</span>
</span><span id="SpellCheckerValidator-107"><a href="#SpellCheckerValidator-107"><span class="linenos">107</span></a><span class="sd">        model_class : Type[Union[SpDescription, SpTemporalReference, SpScenario]]</span>
</span><span id="SpellCheckerValidator-108"><a href="#SpellCheckerValidator-108"><span class="linenos">108</span></a><span class="sd">            The model class to validate (e.g., SpDescription, SpTemporalReference, SpScenario).</span>
</span><span id="SpellCheckerValidator-109"><a href="#SpellCheckerValidator-109"><span class="linenos">109</span></a>
</span><span id="SpellCheckerValidator-110"><a href="#SpellCheckerValidator-110"><span class="linenos">110</span></a><span class="sd">        Returns</span>
</span><span id="SpellCheckerValidator-111"><a href="#SpellCheckerValidator-111"><span class="linenos">111</span></a><span class="sd">        -------</span>
</span><span id="SpellCheckerValidator-112"><a href="#SpellCheckerValidator-112"><span class="linenos">112</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpellCheckerValidator-113"><a href="#SpellCheckerValidator-113"><span class="linenos">113</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpellCheckerValidator-114"><a href="#SpellCheckerValidator-114"><span class="linenos">114</span></a><span class="sd">                - List of error messages from spell checking</span>
</span><span id="SpellCheckerValidator-115"><a href="#SpellCheckerValidator-115"><span class="linenos">115</span></a><span class="sd">                - List of warning messages from spell checking</span>
</span><span id="SpellCheckerValidator-116"><a href="#SpellCheckerValidator-116"><span class="linenos">116</span></a>
</span><span id="SpellCheckerValidator-117"><a href="#SpellCheckerValidator-117"><span class="linenos">117</span></a><span class="sd">        Notes</span>
</span><span id="SpellCheckerValidator-118"><a href="#SpellCheckerValidator-118"><span class="linenos">118</span></a><span class="sd">        -----</span>
</span><span id="SpellCheckerValidator-119"><a href="#SpellCheckerValidator-119"><span class="linenos">119</span></a><span class="sd">        - Returns empty lists if the dataframe is empty</span>
</span><span id="SpellCheckerValidator-120"><a href="#SpellCheckerValidator-120"><span class="linenos">120</span></a><span class="sd">        - Returns empty lists if no columns are configured for the model</span>
</span><span id="SpellCheckerValidator-121"><a href="#SpellCheckerValidator-121"><span class="linenos">121</span></a><span class="sd">        - Warns about missing columns but continues validation for existing ones</span>
</span><span id="SpellCheckerValidator-122"><a href="#SpellCheckerValidator-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-123"><a href="#SpellCheckerValidator-123"><span class="linenos">123</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpellCheckerValidator-124"><a href="#SpellCheckerValidator-124"><span class="linenos">124</span></a>
</span><span id="SpellCheckerValidator-125"><a href="#SpellCheckerValidator-125"><span class="linenos">125</span></a>        <span class="c1"># Configure local instances</span>
</span><span id="SpellCheckerValidator-126"><a href="#SpellCheckerValidator-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="SpellCheckerValidator-127"><a href="#SpellCheckerValidator-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpellCheckerValidator-128"><a href="#SpellCheckerValidator-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpellCheckerValidator-129"><a href="#SpellCheckerValidator-129"><span class="linenos">129</span></a>
</span><span id="SpellCheckerValidator-130"><a href="#SpellCheckerValidator-130"><span class="linenos">130</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-131"><a href="#SpellCheckerValidator-131"><span class="linenos">131</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpellCheckerValidator-132"><a href="#SpellCheckerValidator-132"><span class="linenos">132</span></a>
</span><span id="SpellCheckerValidator-133"><a href="#SpellCheckerValidator-133"><span class="linenos">133</span></a>        <span class="c1"># Get columns to check for this model</span>
</span><span id="SpellCheckerValidator-134"><a href="#SpellCheckerValidator-134"><span class="linenos">134</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_columns_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_class</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="SpellCheckerValidator-135"><a href="#SpellCheckerValidator-135"><span class="linenos">135</span></a>
</span><span id="SpellCheckerValidator-136"><a href="#SpellCheckerValidator-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-137"><a href="#SpellCheckerValidator-137"><span class="linenos">137</span></a>            <span class="c1"># If no columns defined for this model, skip validation</span>
</span><span id="SpellCheckerValidator-138"><a href="#SpellCheckerValidator-138"><span class="linenos">138</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpellCheckerValidator-139"><a href="#SpellCheckerValidator-139"><span class="linenos">139</span></a>
</span><span id="SpellCheckerValidator-140"><a href="#SpellCheckerValidator-140"><span class="linenos">140</span></a>        <span class="c1"># Check if the columns exist</span>
</span><span id="SpellCheckerValidator-141"><a href="#SpellCheckerValidator-141"><span class="linenos">141</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-142"><a href="#SpellCheckerValidator-142"><span class="linenos">142</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpellCheckerValidator-143"><a href="#SpellCheckerValidator-143"><span class="linenos">143</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-144"><a href="#SpellCheckerValidator-144"><span class="linenos">144</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpellCheckerValidator-145"><a href="#SpellCheckerValidator-145"><span class="linenos">145</span></a>                <span class="k">continue</span>
</span><span id="SpellCheckerValidator-146"><a href="#SpellCheckerValidator-146"><span class="linenos">146</span></a>
</span><span id="SpellCheckerValidator-147"><a href="#SpellCheckerValidator-147"><span class="linenos">147</span></a>        <span class="c1"># Perform spellcheck</span>
</span><span id="SpellCheckerValidator-148"><a href="#SpellCheckerValidator-148"><span class="linenos">148</span></a>        <span class="n">errors_spellchecker</span><span class="p">,</span> <span class="n">warnings_spellchecker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="o">.</span><span class="n">check_spelling_text</span><span class="p">(</span>
</span><span id="SpellCheckerValidator-149"><a href="#SpellCheckerValidator-149"><span class="linenos">149</span></a>            <span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-150"><a href="#SpellCheckerValidator-150"><span class="linenos">150</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-151"><a href="#SpellCheckerValidator-151"><span class="linenos">151</span></a>            <span class="n">columns_sheets</span><span class="o">=</span><span class="n">columns_to_check</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-152"><a href="#SpellCheckerValidator-152"><span class="linenos">152</span></a>        <span class="p">)</span>
</span><span id="SpellCheckerValidator-153"><a href="#SpellCheckerValidator-153"><span class="linenos">153</span></a>
</span><span id="SpellCheckerValidator-154"><a href="#SpellCheckerValidator-154"><span class="linenos">154</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">errors_spellchecker</span><span class="p">))</span>
</span><span id="SpellCheckerValidator-155"><a href="#SpellCheckerValidator-155"><span class="linenos">155</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">warnings_spellchecker</span><span class="p">))</span>
</span><span id="SpellCheckerValidator-156"><a href="#SpellCheckerValidator-156"><span class="linenos">156</span></a>
</span><span id="SpellCheckerValidator-157"><a href="#SpellCheckerValidator-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpellCheckerValidator-158"><a href="#SpellCheckerValidator-158"><span class="linenos">158</span></a>
</span><span id="SpellCheckerValidator-159"><a href="#SpellCheckerValidator-159"><span class="linenos">159</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-160"><a href="#SpellCheckerValidator-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-161"><a href="#SpellCheckerValidator-161"><span class="linenos">161</span></a><span class="sd">        Prepare validation errors from dictionary initialization.</span>
</span><span id="SpellCheckerValidator-162"><a href="#SpellCheckerValidator-162"><span class="linenos">162</span></a>
</span><span id="SpellCheckerValidator-163"><a href="#SpellCheckerValidator-163"><span class="linenos">163</span></a><span class="sd">        Extends the internal errors list with any errors encountered during</span>
</span><span id="SpellCheckerValidator-164"><a href="#SpellCheckerValidator-164"><span class="linenos">164</span></a><span class="sd">        dictionary loading or initialization by the spell checker.</span>
</span><span id="SpellCheckerValidator-165"><a href="#SpellCheckerValidator-165"><span class="linenos">165</span></a>
</span><span id="SpellCheckerValidator-166"><a href="#SpellCheckerValidator-166"><span class="linenos">166</span></a><span class="sd">        Notes</span>
</span><span id="SpellCheckerValidator-167"><a href="#SpellCheckerValidator-167"><span class="linenos">167</span></a><span class="sd">        -----</span>
</span><span id="SpellCheckerValidator-168"><a href="#SpellCheckerValidator-168"><span class="linenos">168</span></a><span class="sd">        This method is called internally during validation preparation to collect</span>
</span><span id="SpellCheckerValidator-169"><a href="#SpellCheckerValidator-169"><span class="linenos">169</span></a><span class="sd">        any errors from the spell checker&#39;s dictionary initialization process.</span>
</span><span id="SpellCheckerValidator-170"><a href="#SpellCheckerValidator-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-171"><a href="#SpellCheckerValidator-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="o">.</span><span class="n">errors_dictionary</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-172"><a href="#SpellCheckerValidator-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="o">.</span><span class="n">errors_dictionary</span><span class="p">)</span>
</span><span id="SpellCheckerValidator-173"><a href="#SpellCheckerValidator-173"><span class="linenos">173</span></a>
</span><span id="SpellCheckerValidator-174"><a href="#SpellCheckerValidator-174"><span class="linenos">174</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpellCheckerValidator-175"><a href="#SpellCheckerValidator-175"><span class="linenos">175</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-176"><a href="#SpellCheckerValidator-176"><span class="linenos">176</span></a><span class="sd">        Execute all spell checking validations across configured models.</span>
</span><span id="SpellCheckerValidator-177"><a href="#SpellCheckerValidator-177"><span class="linenos">177</span></a>
</span><span id="SpellCheckerValidator-178"><a href="#SpellCheckerValidator-178"><span class="linenos">178</span></a><span class="sd">        Orchestrates the spell checking validation process for Description, Temporal Reference,</span>
</span><span id="SpellCheckerValidator-179"><a href="#SpellCheckerValidator-179"><span class="linenos">179</span></a><span class="sd">        and optionally Scenario models if they exist and spell checking is enabled.</span>
</span><span id="SpellCheckerValidator-180"><a href="#SpellCheckerValidator-180"><span class="linenos">180</span></a>
</span><span id="SpellCheckerValidator-181"><a href="#SpellCheckerValidator-181"><span class="linenos">181</span></a><span class="sd">        Returns</span>
</span><span id="SpellCheckerValidator-182"><a href="#SpellCheckerValidator-182"><span class="linenos">182</span></a><span class="sd">        -------</span>
</span><span id="SpellCheckerValidator-183"><a href="#SpellCheckerValidator-183"><span class="linenos">183</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpellCheckerValidator-184"><a href="#SpellCheckerValidator-184"><span class="linenos">184</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpellCheckerValidator-185"><a href="#SpellCheckerValidator-185"><span class="linenos">185</span></a><span class="sd">                - List of all error messages from validation</span>
</span><span id="SpellCheckerValidator-186"><a href="#SpellCheckerValidator-186"><span class="linenos">186</span></a><span class="sd">                - List of all warning messages from validation</span>
</span><span id="SpellCheckerValidator-187"><a href="#SpellCheckerValidator-187"><span class="linenos">187</span></a>
</span><span id="SpellCheckerValidator-188"><a href="#SpellCheckerValidator-188"><span class="linenos">188</span></a><span class="sd">        Notes</span>
</span><span id="SpellCheckerValidator-189"><a href="#SpellCheckerValidator-189"><span class="linenos">189</span></a><span class="sd">        -----</span>
</span><span id="SpellCheckerValidator-190"><a href="#SpellCheckerValidator-190"><span class="linenos">190</span></a><span class="sd">        - Spell checking can be disabled via command line flag `--no-spellchecker`</span>
</span><span id="SpellCheckerValidator-191"><a href="#SpellCheckerValidator-191"><span class="linenos">191</span></a><span class="sd">        - Scenario validation only runs if scenarios exist in the dataset</span>
</span><span id="SpellCheckerValidator-192"><a href="#SpellCheckerValidator-192"><span class="linenos">192</span></a><span class="sd">        - Temporary spell checker files are cleaned up after validation completes</span>
</span><span id="SpellCheckerValidator-193"><a href="#SpellCheckerValidator-193"><span class="linenos">193</span></a><span class="sd">        - All validation results are aggregated into reports via `build_reports()`</span>
</span><span id="SpellCheckerValidator-194"><a href="#SpellCheckerValidator-194"><span class="linenos">194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator-195"><a href="#SpellCheckerValidator-195"><span class="linenos">195</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpellCheckerValidator-196"><a href="#SpellCheckerValidator-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_action</span><span class="o">.</span><span class="n">no_spellchecker</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-197"><a href="#SpellCheckerValidator-197"><span class="linenos">197</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpellCheckerValidator-198"><a href="#SpellCheckerValidator-198"><span class="linenos">198</span></a>                <span class="p">(</span>
</span><span id="SpellCheckerValidator-199"><a href="#SpellCheckerValidator-199"><span class="linenos">199</span></a>                    <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spellchecker</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">),</span>
</span><span id="SpellCheckerValidator-200"><a href="#SpellCheckerValidator-200"><span class="linenos">200</span></a>                    <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SPELL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-201"><a href="#SpellCheckerValidator-201"><span class="linenos">201</span></a>                <span class="p">)</span>
</span><span id="SpellCheckerValidator-202"><a href="#SpellCheckerValidator-202"><span class="linenos">202</span></a>            <span class="p">)</span>
</span><span id="SpellCheckerValidator-203"><a href="#SpellCheckerValidator-203"><span class="linenos">203</span></a>
</span><span id="SpellCheckerValidator-204"><a href="#SpellCheckerValidator-204"><span class="linenos">204</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpellCheckerValidator-205"><a href="#SpellCheckerValidator-205"><span class="linenos">205</span></a>                <span class="p">(</span>
</span><span id="SpellCheckerValidator-206"><a href="#SpellCheckerValidator-206"><span class="linenos">206</span></a>                    <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spellchecker</span><span class="p">(</span><span class="n">SpTemporalReference</span><span class="p">),</span>
</span><span id="SpellCheckerValidator-207"><a href="#SpellCheckerValidator-207"><span class="linenos">207</span></a>                    <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SPELL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-208"><a href="#SpellCheckerValidator-208"><span class="linenos">208</span></a>                <span class="p">)</span>
</span><span id="SpellCheckerValidator-209"><a href="#SpellCheckerValidator-209"><span class="linenos">209</span></a>            <span class="p">)</span>
</span><span id="SpellCheckerValidator-210"><a href="#SpellCheckerValidator-210"><span class="linenos">210</span></a>
</span><span id="SpellCheckerValidator-211"><a href="#SpellCheckerValidator-211"><span class="linenos">211</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">scenarios_list</span><span class="p">:</span>
</span><span id="SpellCheckerValidator-212"><a href="#SpellCheckerValidator-212"><span class="linenos">212</span></a>                <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpellCheckerValidator-213"><a href="#SpellCheckerValidator-213"><span class="linenos">213</span></a>                    <span class="p">(</span>
</span><span id="SpellCheckerValidator-214"><a href="#SpellCheckerValidator-214"><span class="linenos">214</span></a>                        <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spellchecker</span><span class="p">(</span><span class="n">SpScenario</span><span class="p">),</span>
</span><span id="SpellCheckerValidator-215"><a href="#SpellCheckerValidator-215"><span class="linenos">215</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SPELL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpellCheckerValidator-216"><a href="#SpellCheckerValidator-216"><span class="linenos">216</span></a>                    <span class="p">)</span>
</span><span id="SpellCheckerValidator-217"><a href="#SpellCheckerValidator-217"><span class="linenos">217</span></a>                <span class="p">)</span>
</span><span id="SpellCheckerValidator-218"><a href="#SpellCheckerValidator-218"><span class="linenos">218</span></a>
</span><span id="SpellCheckerValidator-219"><a href="#SpellCheckerValidator-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpellCheckerValidator-220"><a href="#SpellCheckerValidator-220"><span class="linenos">220</span></a>
</span><span id="SpellCheckerValidator-221"><a href="#SpellCheckerValidator-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="o">.</span><span class="n">clean_files_generated</span><span class="p">()</span>
</span><span id="SpellCheckerValidator-222"><a href="#SpellCheckerValidator-222"><span class="linenos">222</span></a>
</span><span id="SpellCheckerValidator-223"><a href="#SpellCheckerValidator-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates textual content using spell checking across multiple spreadsheet models.</p>

<p>This validator performs spell checking on text columns in Description, Temporal Reference,
and Scenario spreadsheets. It uses a custom dictionary and user-defined words to ignore
during validation.</p>

<h2 id="attributes">Attributes</h2>

<p>dictionary : SpDictionary | None
    Dictionary model instance containing words to ignore during spell checking.
lang_dict_spell : str
    Language code for spell checking dictionary.
list_words_user : List[str]
    User-defined words to ignore during spell checking.
spellchecker : SpellChecker
    Spell checker instance configured with language and custom dictionary.
model_columns_map : Dict[Type[Union[SpDescription, SpTemporalReference, SpScenario]], List[str]]
    Mapping of model types to their respective columns that require spell checking.</p>
</div>


                            <div id="SpellCheckerValidator.__init__" class="classattr">
                                        <input id="SpellCheckerValidator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpellCheckerValidator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="SpellCheckerValidator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpellCheckerValidator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpellCheckerValidator.__init__-47"><a href="#SpellCheckerValidator.__init__-47"><span class="linenos">47</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpellCheckerValidator.__init__-48"><a href="#SpellCheckerValidator.__init__-48"><span class="linenos">48</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-49"><a href="#SpellCheckerValidator.__init__-49"><span class="linenos">49</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-50"><a href="#SpellCheckerValidator.__init__-50"><span class="linenos">50</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-51"><a href="#SpellCheckerValidator.__init__-51"><span class="linenos">51</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="SpellCheckerValidator.__init__-52"><a href="#SpellCheckerValidator.__init__-52"><span class="linenos">52</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpellCheckerValidator.__init__-53"><a href="#SpellCheckerValidator.__init__-53"><span class="linenos">53</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator.__init__-54"><a href="#SpellCheckerValidator.__init__-54"><span class="linenos">54</span></a><span class="sd">        Initialize the spell checker validator.</span>
</span><span id="SpellCheckerValidator.__init__-55"><a href="#SpellCheckerValidator.__init__-55"><span class="linenos">55</span></a>
</span><span id="SpellCheckerValidator.__init__-56"><a href="#SpellCheckerValidator.__init__-56"><span class="linenos">56</span></a><span class="sd">        Args</span>
</span><span id="SpellCheckerValidator.__init__-57"><a href="#SpellCheckerValidator.__init__-57"><span class="linenos">57</span></a><span class="sd">        ----</span>
</span><span id="SpellCheckerValidator.__init__-58"><a href="#SpellCheckerValidator.__init__-58"><span class="linenos">58</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="SpellCheckerValidator.__init__-59"><a href="#SpellCheckerValidator.__init__-59"><span class="linenos">59</span></a><span class="sd">            Context containing all loaded spreadsheet models.</span>
</span><span id="SpellCheckerValidator.__init__-60"><a href="#SpellCheckerValidator.__init__-60"><span class="linenos">60</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="SpellCheckerValidator.__init__-61"><a href="#SpellCheckerValidator.__init__-61"><span class="linenos">61</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="SpellCheckerValidator.__init__-62"><a href="#SpellCheckerValidator.__init__-62"><span class="linenos">62</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="SpellCheckerValidator.__init__-63"><a href="#SpellCheckerValidator.__init__-63"><span class="linenos">63</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="SpellCheckerValidator.__init__-64"><a href="#SpellCheckerValidator.__init__-64"><span class="linenos">64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator.__init__-65"><a href="#SpellCheckerValidator.__init__-65"><span class="linenos">65</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpellCheckerValidator.__init__-66"><a href="#SpellCheckerValidator.__init__-66"><span class="linenos">66</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-67"><a href="#SpellCheckerValidator.__init__-67"><span class="linenos">67</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-68"><a href="#SpellCheckerValidator.__init__-68"><span class="linenos">68</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpDictionary</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-69"><a href="#SpellCheckerValidator.__init__-69"><span class="linenos">69</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-70"><a href="#SpellCheckerValidator.__init__-70"><span class="linenos">70</span></a>        <span class="p">)</span>
</span><span id="SpellCheckerValidator.__init__-71"><a href="#SpellCheckerValidator.__init__-71"><span class="linenos">71</span></a>
</span><span id="SpellCheckerValidator.__init__-72"><a href="#SpellCheckerValidator.__init__-72"><span class="linenos">72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">:</span> <span class="n">SpDictionary</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">SpDictionary</span><span class="p">)</span>
</span><span id="SpellCheckerValidator.__init__-73"><a href="#SpellCheckerValidator.__init__-73"><span class="linenos">73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lang_dict_spell</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">locale</span>
</span><span id="SpellCheckerValidator.__init__-74"><a href="#SpellCheckerValidator.__init__-74"><span class="linenos">74</span></a>
</span><span id="SpellCheckerValidator.__init__-75"><a href="#SpellCheckerValidator.__init__-75"><span class="linenos">75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">list_words_user</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="o">.</span><span class="n">words_to_ignore</span>
</span><span id="SpellCheckerValidator.__init__-76"><a href="#SpellCheckerValidator.__init__-76"><span class="linenos">76</span></a>
</span><span id="SpellCheckerValidator.__init__-77"><a href="#SpellCheckerValidator.__init__-77"><span class="linenos">77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="p">:</span> <span class="n">SpellChecker</span> <span class="o">=</span> <span class="n">SpellChecker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lang_dict_spell</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_words_user</span><span class="p">)</span>
</span><span id="SpellCheckerValidator.__init__-78"><a href="#SpellCheckerValidator.__init__-78"><span class="linenos">78</span></a>
</span><span id="SpellCheckerValidator.__init__-79"><a href="#SpellCheckerValidator.__init__-79"><span class="linenos">79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_columns_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">SpDescription</span><span class="p">,</span> <span class="n">SpTemporalReference</span><span class="p">,</span> <span class="n">SpScenario</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SpellCheckerValidator.__init__-80"><a href="#SpellCheckerValidator.__init__-80"><span class="linenos">80</span></a>            <span class="n">SpDescription</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpellCheckerValidator.__init__-81"><a href="#SpellCheckerValidator.__init__-81"><span class="linenos">81</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-82"><a href="#SpellCheckerValidator.__init__-82"><span class="linenos">82</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-83"><a href="#SpellCheckerValidator.__init__-83"><span class="linenos">83</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_SIMPLE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-84"><a href="#SpellCheckerValidator.__init__-84"><span class="linenos">84</span></a>                <span class="n">SpDescription</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_COMPLETE_DESC</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-85"><a href="#SpellCheckerValidator.__init__-85"><span class="linenos">85</span></a>            <span class="p">],</span>
</span><span id="SpellCheckerValidator.__init__-86"><a href="#SpellCheckerValidator.__init__-86"><span class="linenos">86</span></a>            <span class="n">SpTemporalReference</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpellCheckerValidator.__init__-87"><a href="#SpellCheckerValidator.__init__-87"><span class="linenos">87</span></a>                <span class="n">SpTemporalReference</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-88"><a href="#SpellCheckerValidator.__init__-88"><span class="linenos">88</span></a>            <span class="p">],</span>
</span><span id="SpellCheckerValidator.__init__-89"><a href="#SpellCheckerValidator.__init__-89"><span class="linenos">89</span></a>            <span class="n">SpScenario</span><span class="p">:</span> <span class="p">[</span>
</span><span id="SpellCheckerValidator.__init__-90"><a href="#SpellCheckerValidator.__init__-90"><span class="linenos">90</span></a>                <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_NAME</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-91"><a href="#SpellCheckerValidator.__init__-91"><span class="linenos">91</span></a>                <span class="n">SpScenario</span><span class="o">.</span><span class="n">RequiredColumn</span><span class="o">.</span><span class="n">COLUMN_DESCRIPTION</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.__init__-92"><a href="#SpellCheckerValidator.__init__-92"><span class="linenos">92</span></a>            <span class="p">],</span>
</span><span id="SpellCheckerValidator.__init__-93"><a href="#SpellCheckerValidator.__init__-93"><span class="linenos">93</span></a>        <span class="p">}</span>
</span><span id="SpellCheckerValidator.__init__-94"><a href="#SpellCheckerValidator.__init__-94"><span class="linenos">94</span></a>
</span><span id="SpellCheckerValidator.__init__-95"><a href="#SpellCheckerValidator.__init__-95"><span class="linenos">95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the spell checker validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="SpellCheckerValidator.dictionary" class="classattr">
                                <div class="attr variable">
            <span class="name">dictionary</span><span class="annotation">: <a href="models.html#SpDictionary">data_validate.models.SpDictionary</a> | None</span>

        
    </div>
    <a class="headerlink" href="#SpellCheckerValidator.dictionary"></a>
    
    

                            </div>
                            <div id="SpellCheckerValidator.lang_dict_spell" class="classattr">
                                <div class="attr variable">
            <span class="name">lang_dict_spell</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#SpellCheckerValidator.lang_dict_spell"></a>
    
    

                            </div>
                            <div id="SpellCheckerValidator.list_words_user" class="classattr">
                                <div class="attr variable">
            <span class="name">list_words_user</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#SpellCheckerValidator.list_words_user"></a>
    
    

                            </div>
                            <div id="SpellCheckerValidator.spellchecker" class="classattr">
                                <div class="attr variable">
            <span class="name">spellchecker</span><span class="annotation">: <a href="helpers/tools.html#SpellChecker">data_validate.helpers.tools.SpellChecker</a></span>

        
    </div>
    <a class="headerlink" href="#SpellCheckerValidator.spellchecker"></a>
    
    

                            </div>
                            <div id="SpellCheckerValidator.model_columns_map" class="classattr">
                                <div class="attr variable">
            <span class="name">model_columns_map</span><span class="annotation">: Dict[Type[Union[<a href="models.html#SpDescription">data_validate.models.SpDescription</a>, <a href="models.html#SpTemporalReference">data_validate.models.SpTemporalReference</a>, <a href="models.html#SpScenario">data_validate.models.SpScenario</a>]], List[str]]</span>

        
    </div>
    <a class="headerlink" href="#SpellCheckerValidator.model_columns_map"></a>
    
    

                            </div>
                            <div id="SpellCheckerValidator.validate_spellchecker" class="classattr">
                                        <input id="SpellCheckerValidator.validate_spellchecker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_spellchecker</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="models.html#SpDescription">data_validate.models.SpDescription</a></span><span class="p">,</span> <span class="n"><a href="models.html#SpTemporalReference">data_validate.models.SpTemporalReference</a></span><span class="p">,</span> <span class="n"><a href="models.html#SpScenario">data_validate.models.SpScenario</a></span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpellCheckerValidator.validate_spellchecker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpellCheckerValidator.validate_spellchecker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpellCheckerValidator.validate_spellchecker-97"><a href="#SpellCheckerValidator.validate_spellchecker-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_spellchecker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">SpDescription</span><span class="p">,</span> <span class="n">SpTemporalReference</span><span class="p">,</span> <span class="n">SpScenario</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-98"><a href="#SpellCheckerValidator.validate_spellchecker-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-99"><a href="#SpellCheckerValidator.validate_spellchecker-99"><span class="linenos"> 99</span></a><span class="sd">        Perform spell checking validation on specified model class.</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-100"><a href="#SpellCheckerValidator.validate_spellchecker-100"><span class="linenos">100</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-101"><a href="#SpellCheckerValidator.validate_spellchecker-101"><span class="linenos">101</span></a><span class="sd">        Validates textual content in specified columns of the given model using the</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-102"><a href="#SpellCheckerValidator.validate_spellchecker-102"><span class="linenos">102</span></a><span class="sd">        configured spell checker. Missing columns generate warnings, while spelling</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-103"><a href="#SpellCheckerValidator.validate_spellchecker-103"><span class="linenos">103</span></a><span class="sd">        errors generate errors or warnings based on severity.</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-104"><a href="#SpellCheckerValidator.validate_spellchecker-104"><span class="linenos">104</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-105"><a href="#SpellCheckerValidator.validate_spellchecker-105"><span class="linenos">105</span></a><span class="sd">        Args</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-106"><a href="#SpellCheckerValidator.validate_spellchecker-106"><span class="linenos">106</span></a><span class="sd">        ----</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-107"><a href="#SpellCheckerValidator.validate_spellchecker-107"><span class="linenos">107</span></a><span class="sd">        model_class : Type[Union[SpDescription, SpTemporalReference, SpScenario]]</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-108"><a href="#SpellCheckerValidator.validate_spellchecker-108"><span class="linenos">108</span></a><span class="sd">            The model class to validate (e.g., SpDescription, SpTemporalReference, SpScenario).</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-109"><a href="#SpellCheckerValidator.validate_spellchecker-109"><span class="linenos">109</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-110"><a href="#SpellCheckerValidator.validate_spellchecker-110"><span class="linenos">110</span></a><span class="sd">        Returns</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-111"><a href="#SpellCheckerValidator.validate_spellchecker-111"><span class="linenos">111</span></a><span class="sd">        -------</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-112"><a href="#SpellCheckerValidator.validate_spellchecker-112"><span class="linenos">112</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-113"><a href="#SpellCheckerValidator.validate_spellchecker-113"><span class="linenos">113</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-114"><a href="#SpellCheckerValidator.validate_spellchecker-114"><span class="linenos">114</span></a><span class="sd">                - List of error messages from spell checking</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-115"><a href="#SpellCheckerValidator.validate_spellchecker-115"><span class="linenos">115</span></a><span class="sd">                - List of warning messages from spell checking</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-116"><a href="#SpellCheckerValidator.validate_spellchecker-116"><span class="linenos">116</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-117"><a href="#SpellCheckerValidator.validate_spellchecker-117"><span class="linenos">117</span></a><span class="sd">        Notes</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-118"><a href="#SpellCheckerValidator.validate_spellchecker-118"><span class="linenos">118</span></a><span class="sd">        -----</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-119"><a href="#SpellCheckerValidator.validate_spellchecker-119"><span class="linenos">119</span></a><span class="sd">        - Returns empty lists if the dataframe is empty</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-120"><a href="#SpellCheckerValidator.validate_spellchecker-120"><span class="linenos">120</span></a><span class="sd">        - Returns empty lists if no columns are configured for the model</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-121"><a href="#SpellCheckerValidator.validate_spellchecker-121"><span class="linenos">121</span></a><span class="sd">        - Warns about missing columns but continues validation for existing ones</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-122"><a href="#SpellCheckerValidator.validate_spellchecker-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-123"><a href="#SpellCheckerValidator.validate_spellchecker-123"><span class="linenos">123</span></a>        <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-124"><a href="#SpellCheckerValidator.validate_spellchecker-124"><span class="linenos">124</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-125"><a href="#SpellCheckerValidator.validate_spellchecker-125"><span class="linenos">125</span></a>        <span class="c1"># Configure local instances</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-126"><a href="#SpellCheckerValidator.validate_spellchecker-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">get_instance_of</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-127"><a href="#SpellCheckerValidator.validate_spellchecker-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">data_loader_model</span><span class="o">.</span><span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-128"><a href="#SpellCheckerValidator.validate_spellchecker-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">filename</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-129"><a href="#SpellCheckerValidator.validate_spellchecker-129"><span class="linenos">129</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-130"><a href="#SpellCheckerValidator.validate_spellchecker-130"><span class="linenos">130</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-131"><a href="#SpellCheckerValidator.validate_spellchecker-131"><span class="linenos">131</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-132"><a href="#SpellCheckerValidator.validate_spellchecker-132"><span class="linenos">132</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-133"><a href="#SpellCheckerValidator.validate_spellchecker-133"><span class="linenos">133</span></a>        <span class="c1"># Get columns to check for this model</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-134"><a href="#SpellCheckerValidator.validate_spellchecker-134"><span class="linenos">134</span></a>        <span class="n">columns_to_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_columns_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_class</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-135"><a href="#SpellCheckerValidator.validate_spellchecker-135"><span class="linenos">135</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-136"><a href="#SpellCheckerValidator.validate_spellchecker-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-137"><a href="#SpellCheckerValidator.validate_spellchecker-137"><span class="linenos">137</span></a>            <span class="c1"># If no columns defined for this model, skip validation</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-138"><a href="#SpellCheckerValidator.validate_spellchecker-138"><span class="linenos">138</span></a>            <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-139"><a href="#SpellCheckerValidator.validate_spellchecker-139"><span class="linenos">139</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-140"><a href="#SpellCheckerValidator.validate_spellchecker-140"><span class="linenos">140</span></a>        <span class="c1"># Check if the columns exist</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-141"><a href="#SpellCheckerValidator.validate_spellchecker-141"><span class="linenos">141</span></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_check</span><span class="p">:</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-142"><a href="#SpellCheckerValidator.validate_spellchecker-142"><span class="linenos">142</span></a>            <span class="n">exists_column</span><span class="p">,</span> <span class="n">msg_error_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_exists</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-143"><a href="#SpellCheckerValidator.validate_spellchecker-143"><span class="linenos">143</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_column</span><span class="p">:</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-144"><a href="#SpellCheckerValidator.validate_spellchecker-144"><span class="linenos">144</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_error_column</span><span class="p">)</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-145"><a href="#SpellCheckerValidator.validate_spellchecker-145"><span class="linenos">145</span></a>                <span class="k">continue</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-146"><a href="#SpellCheckerValidator.validate_spellchecker-146"><span class="linenos">146</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-147"><a href="#SpellCheckerValidator.validate_spellchecker-147"><span class="linenos">147</span></a>        <span class="c1"># Perform spellcheck</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-148"><a href="#SpellCheckerValidator.validate_spellchecker-148"><span class="linenos">148</span></a>        <span class="n">errors_spellchecker</span><span class="p">,</span> <span class="n">warnings_spellchecker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="o">.</span><span class="n">check_spelling_text</span><span class="p">(</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-149"><a href="#SpellCheckerValidator.validate_spellchecker-149"><span class="linenos">149</span></a>            <span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataframe</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-150"><a href="#SpellCheckerValidator.validate_spellchecker-150"><span class="linenos">150</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-151"><a href="#SpellCheckerValidator.validate_spellchecker-151"><span class="linenos">151</span></a>            <span class="n">columns_sheets</span><span class="o">=</span><span class="n">columns_to_check</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-152"><a href="#SpellCheckerValidator.validate_spellchecker-152"><span class="linenos">152</span></a>        <span class="p">)</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-153"><a href="#SpellCheckerValidator.validate_spellchecker-153"><span class="linenos">153</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-154"><a href="#SpellCheckerValidator.validate_spellchecker-154"><span class="linenos">154</span></a>        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">errors_spellchecker</span><span class="p">))</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-155"><a href="#SpellCheckerValidator.validate_spellchecker-155"><span class="linenos">155</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">warnings_spellchecker</span><span class="p">))</span>
</span><span id="SpellCheckerValidator.validate_spellchecker-156"><a href="#SpellCheckerValidator.validate_spellchecker-156"><span class="linenos">156</span></a>
</span><span id="SpellCheckerValidator.validate_spellchecker-157"><a href="#SpellCheckerValidator.validate_spellchecker-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span>
</span></pre></div>


            <div class="docstring"><p>Perform spell checking validation on specified model class.</p>

<p>Validates textual content in specified columns of the given model using the
configured spell checker. Missing columns generate warnings, while spelling
errors generate errors or warnings based on severity.</p>

<h2 id="args">Args</h2>

<p>model_class : Type[Union[SpDescription, SpTemporalReference, SpScenario]]
    The model class to validate (e.g., SpDescription, SpTemporalReference, SpScenario).</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List of error messages from spell checking
        - List of warning messages from spell checking</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Returns empty lists if the dataframe is empty</li>
<li>Returns empty lists if no columns are configured for the model</li>
<li>Warns about missing columns but continues validation for existing ones</li>
</ul>
</div>


                            </div>
                            <div id="SpellCheckerValidator.run" class="classattr">
                                        <input id="SpellCheckerValidator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SpellCheckerValidator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpellCheckerValidator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpellCheckerValidator.run-174"><a href="#SpellCheckerValidator.run-174"><span class="linenos">174</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="SpellCheckerValidator.run-175"><a href="#SpellCheckerValidator.run-175"><span class="linenos">175</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator.run-176"><a href="#SpellCheckerValidator.run-176"><span class="linenos">176</span></a><span class="sd">        Execute all spell checking validations across configured models.</span>
</span><span id="SpellCheckerValidator.run-177"><a href="#SpellCheckerValidator.run-177"><span class="linenos">177</span></a>
</span><span id="SpellCheckerValidator.run-178"><a href="#SpellCheckerValidator.run-178"><span class="linenos">178</span></a><span class="sd">        Orchestrates the spell checking validation process for Description, Temporal Reference,</span>
</span><span id="SpellCheckerValidator.run-179"><a href="#SpellCheckerValidator.run-179"><span class="linenos">179</span></a><span class="sd">        and optionally Scenario models if they exist and spell checking is enabled.</span>
</span><span id="SpellCheckerValidator.run-180"><a href="#SpellCheckerValidator.run-180"><span class="linenos">180</span></a>
</span><span id="SpellCheckerValidator.run-181"><a href="#SpellCheckerValidator.run-181"><span class="linenos">181</span></a><span class="sd">        Returns</span>
</span><span id="SpellCheckerValidator.run-182"><a href="#SpellCheckerValidator.run-182"><span class="linenos">182</span></a><span class="sd">        -------</span>
</span><span id="SpellCheckerValidator.run-183"><a href="#SpellCheckerValidator.run-183"><span class="linenos">183</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="SpellCheckerValidator.run-184"><a href="#SpellCheckerValidator.run-184"><span class="linenos">184</span></a><span class="sd">            A tuple containing:</span>
</span><span id="SpellCheckerValidator.run-185"><a href="#SpellCheckerValidator.run-185"><span class="linenos">185</span></a><span class="sd">                - List of all error messages from validation</span>
</span><span id="SpellCheckerValidator.run-186"><a href="#SpellCheckerValidator.run-186"><span class="linenos">186</span></a><span class="sd">                - List of all warning messages from validation</span>
</span><span id="SpellCheckerValidator.run-187"><a href="#SpellCheckerValidator.run-187"><span class="linenos">187</span></a>
</span><span id="SpellCheckerValidator.run-188"><a href="#SpellCheckerValidator.run-188"><span class="linenos">188</span></a><span class="sd">        Notes</span>
</span><span id="SpellCheckerValidator.run-189"><a href="#SpellCheckerValidator.run-189"><span class="linenos">189</span></a><span class="sd">        -----</span>
</span><span id="SpellCheckerValidator.run-190"><a href="#SpellCheckerValidator.run-190"><span class="linenos">190</span></a><span class="sd">        - Spell checking can be disabled via command line flag `--no-spellchecker`</span>
</span><span id="SpellCheckerValidator.run-191"><a href="#SpellCheckerValidator.run-191"><span class="linenos">191</span></a><span class="sd">        - Scenario validation only runs if scenarios exist in the dataset</span>
</span><span id="SpellCheckerValidator.run-192"><a href="#SpellCheckerValidator.run-192"><span class="linenos">192</span></a><span class="sd">        - Temporary spell checker files are cleaned up after validation completes</span>
</span><span id="SpellCheckerValidator.run-193"><a href="#SpellCheckerValidator.run-193"><span class="linenos">193</span></a><span class="sd">        - All validation results are aggregated into reports via `build_reports()`</span>
</span><span id="SpellCheckerValidator.run-194"><a href="#SpellCheckerValidator.run-194"><span class="linenos">194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpellCheckerValidator.run-195"><a href="#SpellCheckerValidator.run-195"><span class="linenos">195</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SpellCheckerValidator.run-196"><a href="#SpellCheckerValidator.run-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_models_context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_action</span><span class="o">.</span><span class="n">no_spellchecker</span><span class="p">:</span>
</span><span id="SpellCheckerValidator.run-197"><a href="#SpellCheckerValidator.run-197"><span class="linenos">197</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpellCheckerValidator.run-198"><a href="#SpellCheckerValidator.run-198"><span class="linenos">198</span></a>                <span class="p">(</span>
</span><span id="SpellCheckerValidator.run-199"><a href="#SpellCheckerValidator.run-199"><span class="linenos">199</span></a>                    <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spellchecker</span><span class="p">(</span><span class="n">SpDescription</span><span class="p">),</span>
</span><span id="SpellCheckerValidator.run-200"><a href="#SpellCheckerValidator.run-200"><span class="linenos">200</span></a>                    <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SPELL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.run-201"><a href="#SpellCheckerValidator.run-201"><span class="linenos">201</span></a>                <span class="p">)</span>
</span><span id="SpellCheckerValidator.run-202"><a href="#SpellCheckerValidator.run-202"><span class="linenos">202</span></a>            <span class="p">)</span>
</span><span id="SpellCheckerValidator.run-203"><a href="#SpellCheckerValidator.run-203"><span class="linenos">203</span></a>
</span><span id="SpellCheckerValidator.run-204"><a href="#SpellCheckerValidator.run-204"><span class="linenos">204</span></a>            <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpellCheckerValidator.run-205"><a href="#SpellCheckerValidator.run-205"><span class="linenos">205</span></a>                <span class="p">(</span>
</span><span id="SpellCheckerValidator.run-206"><a href="#SpellCheckerValidator.run-206"><span class="linenos">206</span></a>                    <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spellchecker</span><span class="p">(</span><span class="n">SpTemporalReference</span><span class="p">),</span>
</span><span id="SpellCheckerValidator.run-207"><a href="#SpellCheckerValidator.run-207"><span class="linenos">207</span></a>                    <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SPELL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.run-208"><a href="#SpellCheckerValidator.run-208"><span class="linenos">208</span></a>                <span class="p">)</span>
</span><span id="SpellCheckerValidator.run-209"><a href="#SpellCheckerValidator.run-209"><span class="linenos">209</span></a>            <span class="p">)</span>
</span><span id="SpellCheckerValidator.run-210"><a href="#SpellCheckerValidator.run-210"><span class="linenos">210</span></a>
</span><span id="SpellCheckerValidator.run-211"><a href="#SpellCheckerValidator.run-211"><span class="linenos">211</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_model</span><span class="o">.</span><span class="n">scenarios_list</span><span class="p">:</span>
</span><span id="SpellCheckerValidator.run-212"><a href="#SpellCheckerValidator.run-212"><span class="linenos">212</span></a>                <span class="n">validations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="SpellCheckerValidator.run-213"><a href="#SpellCheckerValidator.run-213"><span class="linenos">213</span></a>                    <span class="p">(</span>
</span><span id="SpellCheckerValidator.run-214"><a href="#SpellCheckerValidator.run-214"><span class="linenos">214</span></a>                        <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spellchecker</span><span class="p">(</span><span class="n">SpScenario</span><span class="p">),</span>
</span><span id="SpellCheckerValidator.run-215"><a href="#SpellCheckerValidator.run-215"><span class="linenos">215</span></a>                        <span class="n">NamesEnum</span><span class="o">.</span><span class="n">SPELL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="SpellCheckerValidator.run-216"><a href="#SpellCheckerValidator.run-216"><span class="linenos">216</span></a>                    <span class="p">)</span>
</span><span id="SpellCheckerValidator.run-217"><a href="#SpellCheckerValidator.run-217"><span class="linenos">217</span></a>                <span class="p">)</span>
</span><span id="SpellCheckerValidator.run-218"><a href="#SpellCheckerValidator.run-218"><span class="linenos">218</span></a>
</span><span id="SpellCheckerValidator.run-219"><a href="#SpellCheckerValidator.run-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="SpellCheckerValidator.run-220"><a href="#SpellCheckerValidator.run-220"><span class="linenos">220</span></a>
</span><span id="SpellCheckerValidator.run-221"><a href="#SpellCheckerValidator.run-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="o">.</span><span class="n">clean_files_generated</span><span class="p">()</span>
</span><span id="SpellCheckerValidator.run-222"><a href="#SpellCheckerValidator.run-222"><span class="linenos">222</span></a>
</span><span id="SpellCheckerValidator.run-223"><a href="#SpellCheckerValidator.run-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all spell checking validations across configured models.</p>

<p>Orchestrates the spell checking validation process for Description, Temporal Reference,
and optionally Scenario models if they exist and spell checking is enabled.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List of all error messages from validation
        - List of all warning messages from validation</p>

<h2 id="notes">Notes</h2>

<ul>
<li>Spell checking can be disabled via command line flag <code>--no-spellchecker</code></li>
<li>Scenario validation only runs if scenarios exist in the dataset</li>
<li>Temporary spell checker files are cleaned up after validation completes</li>
<li>All validation results are aggregated into reports via <code><a href="#SpellCheckerValidator.build_reports">build_reports()</a></code></li>
</ul>
</div>


                            </div>
                </section>
                <section id="ValidatorStructureFiles">
                            <input id="ValidatorStructureFiles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ValidatorStructureFiles</span><wbr>(<span class="base"><a href="#ValidatorModelABC">data_validate.validators.ValidatorModelABC</a></span>):

                <label class="view-source-button" for="ValidatorStructureFiles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles-21"><a href="#ValidatorStructureFiles-21"><span class="linenos"> 21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ValidatorStructureFiles</span><span class="p">(</span><span class="n">ValidatorModelABC</span><span class="p">):</span>
</span><span id="ValidatorStructureFiles-22"><a href="#ValidatorStructureFiles-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-23"><a href="#ValidatorStructureFiles-23"><span class="linenos"> 23</span></a><span class="sd">    Validates the structure of files in the input folder.</span>
</span><span id="ValidatorStructureFiles-24"><a href="#ValidatorStructureFiles-24"><span class="linenos"> 24</span></a>
</span><span id="ValidatorStructureFiles-25"><a href="#ValidatorStructureFiles-25"><span class="linenos"> 25</span></a><span class="sd">    This validator ensures that:</span>
</span><span id="ValidatorStructureFiles-26"><a href="#ValidatorStructureFiles-26"><span class="linenos"> 26</span></a><span class="sd">    - The input directory is not empty</span>
</span><span id="ValidatorStructureFiles-27"><a href="#ValidatorStructureFiles-27"><span class="linenos"> 27</span></a><span class="sd">    - All required files are present</span>
</span><span id="ValidatorStructureFiles-28"><a href="#ValidatorStructureFiles-28"><span class="linenos"> 28</span></a><span class="sd">    - No unexpected files or folders exist</span>
</span><span id="ValidatorStructureFiles-29"><a href="#ValidatorStructureFiles-29"><span class="linenos"> 29</span></a><span class="sd">    - No conflicting file formats exist (e.g., both .xlsx and .csv with same name)</span>
</span><span id="ValidatorStructureFiles-30"><a href="#ValidatorStructureFiles-30"><span class="linenos"> 30</span></a>
</span><span id="ValidatorStructureFiles-31"><a href="#ValidatorStructureFiles-31"><span class="linenos"> 31</span></a><span class="sd">    Attributes</span>
</span><span id="ValidatorStructureFiles-32"><a href="#ValidatorStructureFiles-32"><span class="linenos"> 32</span></a><span class="sd">    ----------</span>
</span><span id="ValidatorStructureFiles-33"><a href="#ValidatorStructureFiles-33"><span class="linenos"> 33</span></a><span class="sd">    context : DataModelsContext</span>
</span><span id="ValidatorStructureFiles-34"><a href="#ValidatorStructureFiles-34"><span class="linenos"> 34</span></a><span class="sd">        Context containing configuration, file system utilities, and data arguments.</span>
</span><span id="ValidatorStructureFiles-35"><a href="#ValidatorStructureFiles-35"><span class="linenos"> 35</span></a><span class="sd">    errors : List[str]</span>
</span><span id="ValidatorStructureFiles-36"><a href="#ValidatorStructureFiles-36"><span class="linenos"> 36</span></a><span class="sd">        Accumulated list of validation errors.</span>
</span><span id="ValidatorStructureFiles-37"><a href="#ValidatorStructureFiles-37"><span class="linenos"> 37</span></a><span class="sd">    warnings : List[str]</span>
</span><span id="ValidatorStructureFiles-38"><a href="#ValidatorStructureFiles-38"><span class="linenos"> 38</span></a><span class="sd">        Accumulated list of validation warnings.</span>
</span><span id="ValidatorStructureFiles-39"><a href="#ValidatorStructureFiles-39"><span class="linenos"> 39</span></a><span class="sd">    dir_files : List[str]</span>
</span><span id="ValidatorStructureFiles-40"><a href="#ValidatorStructureFiles-40"><span class="linenos"> 40</span></a><span class="sd">        List of file names in the input directory.</span>
</span><span id="ValidatorStructureFiles-41"><a href="#ValidatorStructureFiles-41"><span class="linenos"> 41</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-42"><a href="#ValidatorStructureFiles-42"><span class="linenos"> 42</span></a>
</span><span id="ValidatorStructureFiles-43"><a href="#ValidatorStructureFiles-43"><span class="linenos"> 43</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles-44"><a href="#ValidatorStructureFiles-44"><span class="linenos"> 44</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-45"><a href="#ValidatorStructureFiles-45"><span class="linenos"> 45</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-46"><a href="#ValidatorStructureFiles-46"><span class="linenos"> 46</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-47"><a href="#ValidatorStructureFiles-47"><span class="linenos"> 47</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="ValidatorStructureFiles-48"><a href="#ValidatorStructureFiles-48"><span class="linenos"> 48</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-49"><a href="#ValidatorStructureFiles-49"><span class="linenos"> 49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-50"><a href="#ValidatorStructureFiles-50"><span class="linenos"> 50</span></a><span class="sd">        Initialize the file structure validator.</span>
</span><span id="ValidatorStructureFiles-51"><a href="#ValidatorStructureFiles-51"><span class="linenos"> 51</span></a>
</span><span id="ValidatorStructureFiles-52"><a href="#ValidatorStructureFiles-52"><span class="linenos"> 52</span></a><span class="sd">        Args</span>
</span><span id="ValidatorStructureFiles-53"><a href="#ValidatorStructureFiles-53"><span class="linenos"> 53</span></a><span class="sd">        ----</span>
</span><span id="ValidatorStructureFiles-54"><a href="#ValidatorStructureFiles-54"><span class="linenos"> 54</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="ValidatorStructureFiles-55"><a href="#ValidatorStructureFiles-55"><span class="linenos"> 55</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="ValidatorStructureFiles-56"><a href="#ValidatorStructureFiles-56"><span class="linenos"> 56</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="ValidatorStructureFiles-57"><a href="#ValidatorStructureFiles-57"><span class="linenos"> 57</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="ValidatorStructureFiles-58"><a href="#ValidatorStructureFiles-58"><span class="linenos"> 58</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="ValidatorStructureFiles-59"><a href="#ValidatorStructureFiles-59"><span class="linenos"> 59</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="ValidatorStructureFiles-60"><a href="#ValidatorStructureFiles-60"><span class="linenos"> 60</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-61"><a href="#ValidatorStructureFiles-61"><span class="linenos"> 61</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles-62"><a href="#ValidatorStructureFiles-62"><span class="linenos"> 62</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-63"><a href="#ValidatorStructureFiles-63"><span class="linenos"> 63</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-64"><a href="#ValidatorStructureFiles-64"><span class="linenos"> 64</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpDescription</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-65"><a href="#ValidatorStructureFiles-65"><span class="linenos"> 65</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-66"><a href="#ValidatorStructureFiles-66"><span class="linenos"> 66</span></a>        <span class="p">)</span>
</span><span id="ValidatorStructureFiles-67"><a href="#ValidatorStructureFiles-67"><span class="linenos"> 67</span></a>
</span><span id="ValidatorStructureFiles-68"><a href="#ValidatorStructureFiles-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span> <span class="n">DataModelsContext</span> <span class="o">=</span> <span class="n">data_models_context</span>
</span><span id="ValidatorStructureFiles-69"><a href="#ValidatorStructureFiles-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-70"><a href="#ValidatorStructureFiles-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-71"><a href="#ValidatorStructureFiles-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-72"><a href="#ValidatorStructureFiles-72"><span class="linenos"> 72</span></a>
</span><span id="ValidatorStructureFiles-73"><a href="#ValidatorStructureFiles-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="ValidatorStructureFiles-74"><a href="#ValidatorStructureFiles-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="ValidatorStructureFiles-75"><a href="#ValidatorStructureFiles-75"><span class="linenos"> 75</span></a>
</span><span id="ValidatorStructureFiles-76"><a href="#ValidatorStructureFiles-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-77"><a href="#ValidatorStructureFiles-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-78"><a href="#ValidatorStructureFiles-78"><span class="linenos"> 78</span></a><span class="sd">        Prepare validation statements.</span>
</span><span id="ValidatorStructureFiles-79"><a href="#ValidatorStructureFiles-79"><span class="linenos"> 79</span></a>
</span><span id="ValidatorStructureFiles-80"><a href="#ValidatorStructureFiles-80"><span class="linenos"> 80</span></a><span class="sd">        This method is currently a placeholder for future initialization logic</span>
</span><span id="ValidatorStructureFiles-81"><a href="#ValidatorStructureFiles-81"><span class="linenos"> 81</span></a><span class="sd">        that may be needed before running validations.</span>
</span><span id="ValidatorStructureFiles-82"><a href="#ValidatorStructureFiles-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-83"><a href="#ValidatorStructureFiles-83"><span class="linenos"> 83</span></a>        <span class="k">pass</span>
</span><span id="ValidatorStructureFiles-84"><a href="#ValidatorStructureFiles-84"><span class="linenos"> 84</span></a>
</span><span id="ValidatorStructureFiles-85"><a href="#ValidatorStructureFiles-85"><span class="linenos"> 85</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_empty_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles-86"><a href="#ValidatorStructureFiles-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-87"><a href="#ValidatorStructureFiles-87"><span class="linenos"> 87</span></a><span class="sd">        Check if the input directory is empty.</span>
</span><span id="ValidatorStructureFiles-88"><a href="#ValidatorStructureFiles-88"><span class="linenos"> 88</span></a>
</span><span id="ValidatorStructureFiles-89"><a href="#ValidatorStructureFiles-89"><span class="linenos"> 89</span></a><span class="sd">        Validates that the input directory contains at least one file or folder.</span>
</span><span id="ValidatorStructureFiles-90"><a href="#ValidatorStructureFiles-90"><span class="linenos"> 90</span></a><span class="sd">        An empty directory is considered a validation error.</span>
</span><span id="ValidatorStructureFiles-91"><a href="#ValidatorStructureFiles-91"><span class="linenos"> 91</span></a>
</span><span id="ValidatorStructureFiles-92"><a href="#ValidatorStructureFiles-92"><span class="linenos"> 92</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles-93"><a href="#ValidatorStructureFiles-93"><span class="linenos"> 93</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles-94"><a href="#ValidatorStructureFiles-94"><span class="linenos"> 94</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles-95"><a href="#ValidatorStructureFiles-95"><span class="linenos"> 95</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles-96"><a href="#ValidatorStructureFiles-96"><span class="linenos"> 96</span></a><span class="sd">                - bool: True if validation passed (directory not empty), False otherwise</span>
</span><span id="ValidatorStructureFiles-97"><a href="#ValidatorStructureFiles-97"><span class="linenos"> 97</span></a><span class="sd">                - List[str]: List of error messages (empty if directory not empty)</span>
</span><span id="ValidatorStructureFiles-98"><a href="#ValidatorStructureFiles-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-99"><a href="#ValidatorStructureFiles-99"><span class="linenos"> 99</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-100"><a href="#ValidatorStructureFiles-100"><span class="linenos">100</span></a>        <span class="n">is_empty</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_directory_is_empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-101"><a href="#ValidatorStructureFiles-101"><span class="linenos">101</span></a>        <span class="k">if</span> <span class="n">is_empty</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-102"><a href="#ValidatorStructureFiles-102"><span class="linenos">102</span></a>            <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles-103"><a href="#ValidatorStructureFiles-103"><span class="linenos">103</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles-104"><a href="#ValidatorStructureFiles-104"><span class="linenos">104</span></a>                    <span class="s2">&quot;validator_structure_error_empty_directory&quot;</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-105"><a href="#ValidatorStructureFiles-105"><span class="linenos">105</span></a>                    <span class="n">dir_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles-106"><a href="#ValidatorStructureFiles-106"><span class="linenos">106</span></a>                <span class="p">)</span>
</span><span id="ValidatorStructureFiles-107"><a href="#ValidatorStructureFiles-107"><span class="linenos">107</span></a>            <span class="p">)</span>
</span><span id="ValidatorStructureFiles-108"><a href="#ValidatorStructureFiles-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span><span id="ValidatorStructureFiles-109"><a href="#ValidatorStructureFiles-109"><span class="linenos">109</span></a>
</span><span id="ValidatorStructureFiles-110"><a href="#ValidatorStructureFiles-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_not_expected_files_in_folder_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles-111"><a href="#ValidatorStructureFiles-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-112"><a href="#ValidatorStructureFiles-112"><span class="linenos">112</span></a><span class="sd">        Check for unexpected folders or files in the input directory.</span>
</span><span id="ValidatorStructureFiles-113"><a href="#ValidatorStructureFiles-113"><span class="linenos">113</span></a>
</span><span id="ValidatorStructureFiles-114"><a href="#ValidatorStructureFiles-114"><span class="linenos">114</span></a><span class="sd">        Validates that:</span>
</span><span id="ValidatorStructureFiles-115"><a href="#ValidatorStructureFiles-115"><span class="linenos">115</span></a><span class="sd">        - Files are not placed inside a single subdirectory</span>
</span><span id="ValidatorStructureFiles-116"><a href="#ValidatorStructureFiles-116"><span class="linenos">116</span></a><span class="sd">        - Only expected files exist in the root directory</span>
</span><span id="ValidatorStructureFiles-117"><a href="#ValidatorStructureFiles-117"><span class="linenos">117</span></a><span class="sd">        - No unexpected folders exist</span>
</span><span id="ValidatorStructureFiles-118"><a href="#ValidatorStructureFiles-118"><span class="linenos">118</span></a><span class="sd">        - All files match either expected or optional file patterns</span>
</span><span id="ValidatorStructureFiles-119"><a href="#ValidatorStructureFiles-119"><span class="linenos">119</span></a>
</span><span id="ValidatorStructureFiles-120"><a href="#ValidatorStructureFiles-120"><span class="linenos">120</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles-121"><a href="#ValidatorStructureFiles-121"><span class="linenos">121</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles-122"><a href="#ValidatorStructureFiles-122"><span class="linenos">122</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles-123"><a href="#ValidatorStructureFiles-123"><span class="linenos">123</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles-124"><a href="#ValidatorStructureFiles-124"><span class="linenos">124</span></a><span class="sd">                - bool: True if validation passed (no unexpected files), False otherwise</span>
</span><span id="ValidatorStructureFiles-125"><a href="#ValidatorStructureFiles-125"><span class="linenos">125</span></a><span class="sd">                - List[str]: List of error messages for each unexpected file or folder</span>
</span><span id="ValidatorStructureFiles-126"><a href="#ValidatorStructureFiles-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-127"><a href="#ValidatorStructureFiles-127"><span class="linenos">127</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-128"><a href="#ValidatorStructureFiles-128"><span class="linenos">128</span></a>        <span class="n">expected_files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">spreadsheet_info</span><span class="o">.</span><span class="n">EXPECTED_FILES</span>
</span><span id="ValidatorStructureFiles-129"><a href="#ValidatorStructureFiles-129"><span class="linenos">129</span></a>        <span class="n">optional_files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">spreadsheet_info</span><span class="o">.</span><span class="n">OPTIONAL_FILES</span>
</span><span id="ValidatorStructureFiles-130"><a href="#ValidatorStructureFiles-130"><span class="linenos">130</span></a>
</span><span id="ValidatorStructureFiles-131"><a href="#ValidatorStructureFiles-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-132"><a href="#ValidatorStructureFiles-132"><span class="linenos">132</span></a>            <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ValidatorStructureFiles-133"><a href="#ValidatorStructureFiles-133"><span class="linenos">133</span></a>            <span class="n">is_dir</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-134"><a href="#ValidatorStructureFiles-134"><span class="linenos">134</span></a>            <span class="k">if</span> <span class="n">is_dir</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-135"><a href="#ValidatorStructureFiles-135"><span class="linenos">135</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_files_not_in_folder&quot;</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles-136"><a href="#ValidatorStructureFiles-136"><span class="linenos">136</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span><span id="ValidatorStructureFiles-137"><a href="#ValidatorStructureFiles-137"><span class="linenos">137</span></a>
</span><span id="ValidatorStructureFiles-138"><a href="#ValidatorStructureFiles-138"><span class="linenos">138</span></a>        <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-139"><a href="#ValidatorStructureFiles-139"><span class="linenos">139</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-140"><a href="#ValidatorStructureFiles-140"><span class="linenos">140</span></a>            <span class="n">is_file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-141"><a href="#ValidatorStructureFiles-141"><span class="linenos">141</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_file</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-142"><a href="#ValidatorStructureFiles-142"><span class="linenos">142</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_unexpected_folder&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles-143"><a href="#ValidatorStructureFiles-143"><span class="linenos">143</span></a>                <span class="k">continue</span>
</span><span id="ValidatorStructureFiles-144"><a href="#ValidatorStructureFiles-144"><span class="linenos">144</span></a>
</span><span id="ValidatorStructureFiles-145"><a href="#ValidatorStructureFiles-145"><span class="linenos">145</span></a>            <span class="n">file_base</span><span class="p">,</span> <span class="n">file_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-146"><a href="#ValidatorStructureFiles-146"><span class="linenos">146</span></a>
</span><span id="ValidatorStructureFiles-147"><a href="#ValidatorStructureFiles-147"><span class="linenos">147</span></a>            <span class="k">if</span> <span class="n">file_base</span> <span class="ow">in</span> <span class="n">expected_files</span> <span class="ow">and</span> <span class="n">file_ext</span> <span class="ow">in</span> <span class="n">expected_files</span><span class="p">[</span><span class="n">file_base</span><span class="p">]:</span>
</span><span id="ValidatorStructureFiles-148"><a href="#ValidatorStructureFiles-148"><span class="linenos">148</span></a>                <span class="k">continue</span>
</span><span id="ValidatorStructureFiles-149"><a href="#ValidatorStructureFiles-149"><span class="linenos">149</span></a>            <span class="k">if</span> <span class="n">file_base</span> <span class="ow">in</span> <span class="n">optional_files</span> <span class="ow">and</span> <span class="n">file_ext</span> <span class="ow">in</span> <span class="n">optional_files</span><span class="p">[</span><span class="n">file_base</span><span class="p">]:</span>
</span><span id="ValidatorStructureFiles-150"><a href="#ValidatorStructureFiles-150"><span class="linenos">150</span></a>                <span class="k">continue</span>
</span><span id="ValidatorStructureFiles-151"><a href="#ValidatorStructureFiles-151"><span class="linenos">151</span></a>
</span><span id="ValidatorStructureFiles-152"><a href="#ValidatorStructureFiles-152"><span class="linenos">152</span></a>            <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_unexpected_file&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles-153"><a href="#ValidatorStructureFiles-153"><span class="linenos">153</span></a>
</span><span id="ValidatorStructureFiles-154"><a href="#ValidatorStructureFiles-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span><span id="ValidatorStructureFiles-155"><a href="#ValidatorStructureFiles-155"><span class="linenos">155</span></a>
</span><span id="ValidatorStructureFiles-156"><a href="#ValidatorStructureFiles-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_expected_files_in_folder_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles-157"><a href="#ValidatorStructureFiles-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-158"><a href="#ValidatorStructureFiles-158"><span class="linenos">158</span></a><span class="sd">        Check if all expected files are present in the input directory.</span>
</span><span id="ValidatorStructureFiles-159"><a href="#ValidatorStructureFiles-159"><span class="linenos">159</span></a>
</span><span id="ValidatorStructureFiles-160"><a href="#ValidatorStructureFiles-160"><span class="linenos">160</span></a><span class="sd">        Validates that all required files defined in the configuration are present</span>
</span><span id="ValidatorStructureFiles-161"><a href="#ValidatorStructureFiles-161"><span class="linenos">161</span></a><span class="sd">        in the root directory, accepting any of the allowed file extensions</span>
</span><span id="ValidatorStructureFiles-162"><a href="#ValidatorStructureFiles-162"><span class="linenos">162</span></a><span class="sd">        (.xlsx or .csv) for each file.</span>
</span><span id="ValidatorStructureFiles-163"><a href="#ValidatorStructureFiles-163"><span class="linenos">163</span></a>
</span><span id="ValidatorStructureFiles-164"><a href="#ValidatorStructureFiles-164"><span class="linenos">164</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles-165"><a href="#ValidatorStructureFiles-165"><span class="linenos">165</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles-166"><a href="#ValidatorStructureFiles-166"><span class="linenos">166</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles-167"><a href="#ValidatorStructureFiles-167"><span class="linenos">167</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles-168"><a href="#ValidatorStructureFiles-168"><span class="linenos">168</span></a><span class="sd">                - bool: True if validation passed (all expected files present), False otherwise</span>
</span><span id="ValidatorStructureFiles-169"><a href="#ValidatorStructureFiles-169"><span class="linenos">169</span></a><span class="sd">                - List[str]: List of error messages for each missing file</span>
</span><span id="ValidatorStructureFiles-170"><a href="#ValidatorStructureFiles-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-171"><a href="#ValidatorStructureFiles-171"><span class="linenos">171</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-172"><a href="#ValidatorStructureFiles-172"><span class="linenos">172</span></a>        <span class="n">expected_files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">spreadsheet_info</span><span class="o">.</span><span class="n">EXPECTED_FILES</span>
</span><span id="ValidatorStructureFiles-173"><a href="#ValidatorStructureFiles-173"><span class="linenos">173</span></a>
</span><span id="ValidatorStructureFiles-174"><a href="#ValidatorStructureFiles-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">file_base</span><span class="p">,</span> <span class="n">extensions</span> <span class="ow">in</span> <span class="n">expected_files</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ValidatorStructureFiles-175"><a href="#ValidatorStructureFiles-175"><span class="linenos">175</span></a>            <span class="n">file_found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ValidatorStructureFiles-176"><a href="#ValidatorStructureFiles-176"><span class="linenos">176</span></a>            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-177"><a href="#ValidatorStructureFiles-177"><span class="linenos">177</span></a>                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_base</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-178"><a href="#ValidatorStructureFiles-178"><span class="linenos">178</span></a>                <span class="n">is_file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-179"><a href="#ValidatorStructureFiles-179"><span class="linenos">179</span></a>                <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-180"><a href="#ValidatorStructureFiles-180"><span class="linenos">180</span></a>                    <span class="n">file_found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ValidatorStructureFiles-181"><a href="#ValidatorStructureFiles-181"><span class="linenos">181</span></a>                    <span class="k">break</span>
</span><span id="ValidatorStructureFiles-182"><a href="#ValidatorStructureFiles-182"><span class="linenos">182</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">file_found</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-183"><a href="#ValidatorStructureFiles-183"><span class="linenos">183</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_missing_file&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_base</span><span class="o">=</span><span class="n">file_base</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles-184"><a href="#ValidatorStructureFiles-184"><span class="linenos">184</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span><span id="ValidatorStructureFiles-185"><a href="#ValidatorStructureFiles-185"><span class="linenos">185</span></a>
</span><span id="ValidatorStructureFiles-186"><a href="#ValidatorStructureFiles-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_ignored_files_in_folder_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles-187"><a href="#ValidatorStructureFiles-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-188"><a href="#ValidatorStructureFiles-188"><span class="linenos">188</span></a><span class="sd">        Check for files that will be ignored due to format conflicts.</span>
</span><span id="ValidatorStructureFiles-189"><a href="#ValidatorStructureFiles-189"><span class="linenos">189</span></a>
</span><span id="ValidatorStructureFiles-190"><a href="#ValidatorStructureFiles-190"><span class="linenos">190</span></a><span class="sd">        Validates that there are no conflicting file formats in the root folder.</span>
</span><span id="ValidatorStructureFiles-191"><a href="#ValidatorStructureFiles-191"><span class="linenos">191</span></a><span class="sd">        When both .xlsx and .csv files exist with the same base name, this creates</span>
</span><span id="ValidatorStructureFiles-192"><a href="#ValidatorStructureFiles-192"><span class="linenos">192</span></a><span class="sd">        ambiguity in which file to use and is considered an error.</span>
</span><span id="ValidatorStructureFiles-193"><a href="#ValidatorStructureFiles-193"><span class="linenos">193</span></a>
</span><span id="ValidatorStructureFiles-194"><a href="#ValidatorStructureFiles-194"><span class="linenos">194</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles-195"><a href="#ValidatorStructureFiles-195"><span class="linenos">195</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles-196"><a href="#ValidatorStructureFiles-196"><span class="linenos">196</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles-197"><a href="#ValidatorStructureFiles-197"><span class="linenos">197</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles-198"><a href="#ValidatorStructureFiles-198"><span class="linenos">198</span></a><span class="sd">                - bool: True if validation passed (no conflicting files), False otherwise</span>
</span><span id="ValidatorStructureFiles-199"><a href="#ValidatorStructureFiles-199"><span class="linenos">199</span></a><span class="sd">                - List[str]: List of error messages for each file with conflicting formats</span>
</span><span id="ValidatorStructureFiles-200"><a href="#ValidatorStructureFiles-200"><span class="linenos">200</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-201"><a href="#ValidatorStructureFiles-201"><span class="linenos">201</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-202"><a href="#ValidatorStructureFiles-202"><span class="linenos">202</span></a>        <span class="n">file_groups</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ValidatorStructureFiles-203"><a href="#ValidatorStructureFiles-203"><span class="linenos">203</span></a>
</span><span id="ValidatorStructureFiles-204"><a href="#ValidatorStructureFiles-204"><span class="linenos">204</span></a>        <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-205"><a href="#ValidatorStructureFiles-205"><span class="linenos">205</span></a>            <span class="n">file_base</span><span class="p">,</span> <span class="n">file_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-206"><a href="#ValidatorStructureFiles-206"><span class="linenos">206</span></a>            <span class="k">if</span> <span class="n">file_ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;.csv&quot;</span><span class="p">]:</span>
</span><span id="ValidatorStructureFiles-207"><a href="#ValidatorStructureFiles-207"><span class="linenos">207</span></a>                <span class="k">if</span> <span class="n">file_base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_groups</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-208"><a href="#ValidatorStructureFiles-208"><span class="linenos">208</span></a>                    <span class="n">file_groups</span><span class="p">[</span><span class="n">file_base</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-209"><a href="#ValidatorStructureFiles-209"><span class="linenos">209</span></a>                <span class="n">file_groups</span><span class="p">[</span><span class="n">file_base</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_ext</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-210"><a href="#ValidatorStructureFiles-210"><span class="linenos">210</span></a>
</span><span id="ValidatorStructureFiles-211"><a href="#ValidatorStructureFiles-211"><span class="linenos">211</span></a>        <span class="k">for</span> <span class="n">file_base</span><span class="p">,</span> <span class="n">extensions</span> <span class="ow">in</span> <span class="n">file_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ValidatorStructureFiles-212"><a href="#ValidatorStructureFiles-212"><span class="linenos">212</span></a>            <span class="k">if</span> <span class="s2">&quot;.xlsx&quot;</span> <span class="ow">in</span> <span class="n">extensions</span> <span class="ow">and</span> <span class="s2">&quot;.csv&quot;</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-213"><a href="#ValidatorStructureFiles-213"><span class="linenos">213</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_conflicting_files&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_base</span><span class="o">=</span><span class="n">file_base</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles-214"><a href="#ValidatorStructureFiles-214"><span class="linenos">214</span></a>
</span><span id="ValidatorStructureFiles-215"><a href="#ValidatorStructureFiles-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span><span id="ValidatorStructureFiles-216"><a href="#ValidatorStructureFiles-216"><span class="linenos">216</span></a>
</span><span id="ValidatorStructureFiles-217"><a href="#ValidatorStructureFiles-217"><span class="linenos">217</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_all_general_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles-218"><a href="#ValidatorStructureFiles-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-219"><a href="#ValidatorStructureFiles-219"><span class="linenos">219</span></a><span class="sd">        Perform all validation checks on the input folder structure.</span>
</span><span id="ValidatorStructureFiles-220"><a href="#ValidatorStructureFiles-220"><span class="linenos">220</span></a>
</span><span id="ValidatorStructureFiles-221"><a href="#ValidatorStructureFiles-221"><span class="linenos">221</span></a><span class="sd">        Executes a comprehensive set of structural validations including:</span>
</span><span id="ValidatorStructureFiles-222"><a href="#ValidatorStructureFiles-222"><span class="linenos">222</span></a><span class="sd">        - Empty directory check</span>
</span><span id="ValidatorStructureFiles-223"><a href="#ValidatorStructureFiles-223"><span class="linenos">223</span></a><span class="sd">        - Unexpected files and folders check</span>
</span><span id="ValidatorStructureFiles-224"><a href="#ValidatorStructureFiles-224"><span class="linenos">224</span></a><span class="sd">        - Expected files presence check</span>
</span><span id="ValidatorStructureFiles-225"><a href="#ValidatorStructureFiles-225"><span class="linenos">225</span></a><span class="sd">        - Conflicting file formats check</span>
</span><span id="ValidatorStructureFiles-226"><a href="#ValidatorStructureFiles-226"><span class="linenos">226</span></a>
</span><span id="ValidatorStructureFiles-227"><a href="#ValidatorStructureFiles-227"><span class="linenos">227</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles-228"><a href="#ValidatorStructureFiles-228"><span class="linenos">228</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles-229"><a href="#ValidatorStructureFiles-229"><span class="linenos">229</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="ValidatorStructureFiles-230"><a href="#ValidatorStructureFiles-230"><span class="linenos">230</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles-231"><a href="#ValidatorStructureFiles-231"><span class="linenos">231</span></a><span class="sd">                - List[str]: Accumulated list of all validation errors</span>
</span><span id="ValidatorStructureFiles-232"><a href="#ValidatorStructureFiles-232"><span class="linenos">232</span></a><span class="sd">                - List[str]: Empty list (no warnings generated by this method)</span>
</span><span id="ValidatorStructureFiles-233"><a href="#ValidatorStructureFiles-233"><span class="linenos">233</span></a>
</span><span id="ValidatorStructureFiles-234"><a href="#ValidatorStructureFiles-234"><span class="linenos">234</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorStructureFiles-235"><a href="#ValidatorStructureFiles-235"><span class="linenos">235</span></a><span class="sd">        -----</span>
</span><span id="ValidatorStructureFiles-236"><a href="#ValidatorStructureFiles-236"><span class="linenos">236</span></a><span class="sd">        All errors from individual checks are aggregated into a single error list.</span>
</span><span id="ValidatorStructureFiles-237"><a href="#ValidatorStructureFiles-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-238"><a href="#ValidatorStructureFiles-238"><span class="linenos">238</span></a>        <span class="n">all_errors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ValidatorStructureFiles-239"><a href="#ValidatorStructureFiles-239"><span class="linenos">239</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_empty_directory</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles-240"><a href="#ValidatorStructureFiles-240"><span class="linenos">240</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_not_expected_files_in_folder_root</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles-241"><a href="#ValidatorStructureFiles-241"><span class="linenos">241</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_expected_files_in_folder_root</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles-242"><a href="#ValidatorStructureFiles-242"><span class="linenos">242</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_ignored_files_in_folder_root</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles-243"><a href="#ValidatorStructureFiles-243"><span class="linenos">243</span></a>        <span class="p">]</span>
</span><span id="ValidatorStructureFiles-244"><a href="#ValidatorStructureFiles-244"><span class="linenos">244</span></a>        <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">all_errors</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-245"><a href="#ValidatorStructureFiles-245"><span class="linenos">245</span></a>            <span class="n">is_valid</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">check</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ValidatorStructureFiles-246"><a href="#ValidatorStructureFiles-246"><span class="linenos">246</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles-247"><a href="#ValidatorStructureFiles-247"><span class="linenos">247</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-248"><a href="#ValidatorStructureFiles-248"><span class="linenos">248</span></a>
</span><span id="ValidatorStructureFiles-249"><a href="#ValidatorStructureFiles-249"><span class="linenos">249</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles-250"><a href="#ValidatorStructureFiles-250"><span class="linenos">250</span></a>
</span><span id="ValidatorStructureFiles-251"><a href="#ValidatorStructureFiles-251"><span class="linenos">251</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles-252"><a href="#ValidatorStructureFiles-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-253"><a href="#ValidatorStructureFiles-253"><span class="linenos">253</span></a><span class="sd">        Execute all file structure validations.</span>
</span><span id="ValidatorStructureFiles-254"><a href="#ValidatorStructureFiles-254"><span class="linenos">254</span></a>
</span><span id="ValidatorStructureFiles-255"><a href="#ValidatorStructureFiles-255"><span class="linenos">255</span></a><span class="sd">        Orchestrates the validation process by executing all structural checks</span>
</span><span id="ValidatorStructureFiles-256"><a href="#ValidatorStructureFiles-256"><span class="linenos">256</span></a><span class="sd">        and building reports based on the validation results.</span>
</span><span id="ValidatorStructureFiles-257"><a href="#ValidatorStructureFiles-257"><span class="linenos">257</span></a>
</span><span id="ValidatorStructureFiles-258"><a href="#ValidatorStructureFiles-258"><span class="linenos">258</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles-259"><a href="#ValidatorStructureFiles-259"><span class="linenos">259</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles-260"><a href="#ValidatorStructureFiles-260"><span class="linenos">260</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="ValidatorStructureFiles-261"><a href="#ValidatorStructureFiles-261"><span class="linenos">261</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles-262"><a href="#ValidatorStructureFiles-262"><span class="linenos">262</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="ValidatorStructureFiles-263"><a href="#ValidatorStructureFiles-263"><span class="linenos">263</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="ValidatorStructureFiles-264"><a href="#ValidatorStructureFiles-264"><span class="linenos">264</span></a>
</span><span id="ValidatorStructureFiles-265"><a href="#ValidatorStructureFiles-265"><span class="linenos">265</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorStructureFiles-266"><a href="#ValidatorStructureFiles-266"><span class="linenos">266</span></a><span class="sd">        -----</span>
</span><span id="ValidatorStructureFiles-267"><a href="#ValidatorStructureFiles-267"><span class="linenos">267</span></a><span class="sd">        Validation results are aggregated into reports via the `build_reports()` method</span>
</span><span id="ValidatorStructureFiles-268"><a href="#ValidatorStructureFiles-268"><span class="linenos">268</span></a><span class="sd">        and tagged with the file structure validation identifier (NamesEnum.FS).</span>
</span><span id="ValidatorStructureFiles-269"><a href="#ValidatorStructureFiles-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles-270"><a href="#ValidatorStructureFiles-270"><span class="linenos">270</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ValidatorStructureFiles-271"><a href="#ValidatorStructureFiles-271"><span class="linenos">271</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_all_general_structure</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">FS</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="ValidatorStructureFiles-272"><a href="#ValidatorStructureFiles-272"><span class="linenos">272</span></a>        <span class="p">]</span>
</span><span id="ValidatorStructureFiles-273"><a href="#ValidatorStructureFiles-273"><span class="linenos">273</span></a>
</span><span id="ValidatorStructureFiles-274"><a href="#ValidatorStructureFiles-274"><span class="linenos">274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles-275"><a href="#ValidatorStructureFiles-275"><span class="linenos">275</span></a>
</span><span id="ValidatorStructureFiles-276"><a href="#ValidatorStructureFiles-276"><span class="linenos">276</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Validates the structure of files in the input folder.</p>

<p>This validator ensures that:</p>

<ul>
<li>The input directory is not empty</li>
<li>All required files are present</li>
<li>No unexpected files or folders exist</li>
<li>No conflicting file formats exist (e.g., both .xlsx and .csv with same name)</li>
</ul>

<h2 id="attributes">Attributes</h2>

<p>context : DataModelsContext
    Context containing configuration, file system utilities, and data arguments.
errors : List[str]
    Accumulated list of validation errors.
warnings : List[str]
    Accumulated list of validation warnings.
dir_files : List[str]
    List of file names in the input directory.</p>
</div>


                            <div id="ValidatorStructureFiles.__init__" class="classattr">
                                        <input id="ValidatorStructureFiles.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ValidatorStructureFiles</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_models_context</span><span class="p">:</span> <span class="n"><a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>,</span><span class="param">	<span class="n">report_list</span><span class="p">:</span> <span class="n"><a href="controllers.html#ModelListReport">data_validate.controllers.ModelListReport</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="ValidatorStructureFiles.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles.__init__-43"><a href="#ValidatorStructureFiles.__init__-43"><span class="linenos">43</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles.__init__-44"><a href="#ValidatorStructureFiles.__init__-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.__init__-45"><a href="#ValidatorStructureFiles.__init__-45"><span class="linenos">45</span></a>        <span class="n">data_models_context</span><span class="p">:</span> <span class="n">DataModelsContext</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.__init__-46"><a href="#ValidatorStructureFiles.__init__-46"><span class="linenos">46</span></a>        <span class="n">report_list</span><span class="p">:</span> <span class="n">ModelListReport</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.__init__-47"><a href="#ValidatorStructureFiles.__init__-47"><span class="linenos">47</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="ValidatorStructureFiles.__init__-48"><a href="#ValidatorStructureFiles.__init__-48"><span class="linenos">48</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.__init__-49"><a href="#ValidatorStructureFiles.__init__-49"><span class="linenos">49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.__init__-50"><a href="#ValidatorStructureFiles.__init__-50"><span class="linenos">50</span></a><span class="sd">        Initialize the file structure validator.</span>
</span><span id="ValidatorStructureFiles.__init__-51"><a href="#ValidatorStructureFiles.__init__-51"><span class="linenos">51</span></a>
</span><span id="ValidatorStructureFiles.__init__-52"><a href="#ValidatorStructureFiles.__init__-52"><span class="linenos">52</span></a><span class="sd">        Args</span>
</span><span id="ValidatorStructureFiles.__init__-53"><a href="#ValidatorStructureFiles.__init__-53"><span class="linenos">53</span></a><span class="sd">        ----</span>
</span><span id="ValidatorStructureFiles.__init__-54"><a href="#ValidatorStructureFiles.__init__-54"><span class="linenos">54</span></a><span class="sd">        data_models_context : DataModelsContext</span>
</span><span id="ValidatorStructureFiles.__init__-55"><a href="#ValidatorStructureFiles.__init__-55"><span class="linenos">55</span></a><span class="sd">            Context containing all loaded spreadsheet models and configuration.</span>
</span><span id="ValidatorStructureFiles.__init__-56"><a href="#ValidatorStructureFiles.__init__-56"><span class="linenos">56</span></a><span class="sd">        report_list : ModelListReport</span>
</span><span id="ValidatorStructureFiles.__init__-57"><a href="#ValidatorStructureFiles.__init__-57"><span class="linenos">57</span></a><span class="sd">            Report aggregator for collecting validation results.</span>
</span><span id="ValidatorStructureFiles.__init__-58"><a href="#ValidatorStructureFiles.__init__-58"><span class="linenos">58</span></a><span class="sd">        **kwargs : Dict[str, Any]</span>
</span><span id="ValidatorStructureFiles.__init__-59"><a href="#ValidatorStructureFiles.__init__-59"><span class="linenos">59</span></a><span class="sd">            Additional keyword arguments passed to parent validator.</span>
</span><span id="ValidatorStructureFiles.__init__-60"><a href="#ValidatorStructureFiles.__init__-60"><span class="linenos">60</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.__init__-61"><a href="#ValidatorStructureFiles.__init__-61"><span class="linenos">61</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles.__init__-62"><a href="#ValidatorStructureFiles.__init__-62"><span class="linenos">62</span></a>            <span class="n">data_models_context</span><span class="o">=</span><span class="n">data_models_context</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.__init__-63"><a href="#ValidatorStructureFiles.__init__-63"><span class="linenos">63</span></a>            <span class="n">report_list</span><span class="o">=</span><span class="n">report_list</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.__init__-64"><a href="#ValidatorStructureFiles.__init__-64"><span class="linenos">64</span></a>            <span class="n">type_class</span><span class="o">=</span><span class="n">SpDescription</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.__init__-65"><a href="#ValidatorStructureFiles.__init__-65"><span class="linenos">65</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.__init__-66"><a href="#ValidatorStructureFiles.__init__-66"><span class="linenos">66</span></a>        <span class="p">)</span>
</span><span id="ValidatorStructureFiles.__init__-67"><a href="#ValidatorStructureFiles.__init__-67"><span class="linenos">67</span></a>
</span><span id="ValidatorStructureFiles.__init__-68"><a href="#ValidatorStructureFiles.__init__-68"><span class="linenos">68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span> <span class="n">DataModelsContext</span> <span class="o">=</span> <span class="n">data_models_context</span>
</span><span id="ValidatorStructureFiles.__init__-69"><a href="#ValidatorStructureFiles.__init__-69"><span class="linenos">69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles.__init__-70"><a href="#ValidatorStructureFiles.__init__-70"><span class="linenos">70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">warnings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles.__init__-71"><a href="#ValidatorStructureFiles.__init__-71"><span class="linenos">71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.__init__-72"><a href="#ValidatorStructureFiles.__init__-72"><span class="linenos">72</span></a>
</span><span id="ValidatorStructureFiles.__init__-73"><a href="#ValidatorStructureFiles.__init__-73"><span class="linenos">73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_statement</span><span class="p">()</span>
</span><span id="ValidatorStructureFiles.__init__-74"><a href="#ValidatorStructureFiles.__init__-74"><span class="linenos">74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the file structure validator.</p>

<h2 id="args">Args</h2>

<p>data_models_context : DataModelsContext
    Context containing all loaded spreadsheet models and configuration.
report_list : ModelListReport
    Report aggregator for collecting validation results.
**kwargs : Dict[str, Any]
    Additional keyword arguments passed to parent validator.</p>
</div>


                            </div>
                            <div id="ValidatorStructureFiles.context" class="classattr">
                                <div class="attr variable">
            <span class="name">context</span><span class="annotation">: <a href="controllers.html#DataModelsContext">data_validate.controllers.DataModelsContext</a></span>

        
    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.context"></a>
    
    

                            </div>
                            <div id="ValidatorStructureFiles.errors" class="classattr">
                                <div class="attr variable">
            <span class="name">errors</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.errors"></a>
    
    

                            </div>
                            <div id="ValidatorStructureFiles.warnings" class="classattr">
                                <div class="attr variable">
            <span class="name">warnings</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.warnings"></a>
    
    

                            </div>
                            <div id="ValidatorStructureFiles.dir_files" class="classattr">
                                <div class="attr variable">
            <span class="name">dir_files</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.dir_files"></a>
    
    

                            </div>
                            <div id="ValidatorStructureFiles.check_empty_directory" class="classattr">
                                        <input id="ValidatorStructureFiles.check_empty_directory-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_empty_directory</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ValidatorStructureFiles.check_empty_directory-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.check_empty_directory"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles.check_empty_directory-85"><a href="#ValidatorStructureFiles.check_empty_directory-85"><span class="linenos"> 85</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_empty_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-86"><a href="#ValidatorStructureFiles.check_empty_directory-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-87"><a href="#ValidatorStructureFiles.check_empty_directory-87"><span class="linenos"> 87</span></a><span class="sd">        Check if the input directory is empty.</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-88"><a href="#ValidatorStructureFiles.check_empty_directory-88"><span class="linenos"> 88</span></a>
</span><span id="ValidatorStructureFiles.check_empty_directory-89"><a href="#ValidatorStructureFiles.check_empty_directory-89"><span class="linenos"> 89</span></a><span class="sd">        Validates that the input directory contains at least one file or folder.</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-90"><a href="#ValidatorStructureFiles.check_empty_directory-90"><span class="linenos"> 90</span></a><span class="sd">        An empty directory is considered a validation error.</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-91"><a href="#ValidatorStructureFiles.check_empty_directory-91"><span class="linenos"> 91</span></a>
</span><span id="ValidatorStructureFiles.check_empty_directory-92"><a href="#ValidatorStructureFiles.check_empty_directory-92"><span class="linenos"> 92</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-93"><a href="#ValidatorStructureFiles.check_empty_directory-93"><span class="linenos"> 93</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-94"><a href="#ValidatorStructureFiles.check_empty_directory-94"><span class="linenos"> 94</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-95"><a href="#ValidatorStructureFiles.check_empty_directory-95"><span class="linenos"> 95</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-96"><a href="#ValidatorStructureFiles.check_empty_directory-96"><span class="linenos"> 96</span></a><span class="sd">                - bool: True if validation passed (directory not empty), False otherwise</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-97"><a href="#ValidatorStructureFiles.check_empty_directory-97"><span class="linenos"> 97</span></a><span class="sd">                - List[str]: List of error messages (empty if directory not empty)</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-98"><a href="#ValidatorStructureFiles.check_empty_directory-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-99"><a href="#ValidatorStructureFiles.check_empty_directory-99"><span class="linenos"> 99</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-100"><a href="#ValidatorStructureFiles.check_empty_directory-100"><span class="linenos">100</span></a>        <span class="n">is_empty</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_directory_is_empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-101"><a href="#ValidatorStructureFiles.check_empty_directory-101"><span class="linenos">101</span></a>        <span class="k">if</span> <span class="n">is_empty</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-102"><a href="#ValidatorStructureFiles.check_empty_directory-102"><span class="linenos">102</span></a>            <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-103"><a href="#ValidatorStructureFiles.check_empty_directory-103"><span class="linenos">103</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-104"><a href="#ValidatorStructureFiles.check_empty_directory-104"><span class="linenos">104</span></a>                    <span class="s2">&quot;validator_structure_error_empty_directory&quot;</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-105"><a href="#ValidatorStructureFiles.check_empty_directory-105"><span class="linenos">105</span></a>                    <span class="n">dir_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-106"><a href="#ValidatorStructureFiles.check_empty_directory-106"><span class="linenos">106</span></a>                <span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-107"><a href="#ValidatorStructureFiles.check_empty_directory-107"><span class="linenos">107</span></a>            <span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_empty_directory-108"><a href="#ValidatorStructureFiles.check_empty_directory-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span></pre></div>


            <div class="docstring"><p>Check if the input directory is empty.</p>

<p>Validates that the input directory contains at least one file or folder.
An empty directory is considered a validation error.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[bool, List[str]]
    A tuple containing:
        - bool: True if validation passed (directory not empty), False otherwise
        - List[str]: List of error messages (empty if directory not empty)</p>
</div>


                            </div>
                            <div id="ValidatorStructureFiles.check_not_expected_files_in_folder_root" class="classattr">
                                        <input id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_not_expected_files_in_folder_root</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ValidatorStructureFiles.check_not_expected_files_in_folder_root-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-110"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_not_expected_files_in_folder_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-111"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-112"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-112"><span class="linenos">112</span></a><span class="sd">        Check for unexpected folders or files in the input directory.</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-113"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-113"><span class="linenos">113</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-114"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-114"><span class="linenos">114</span></a><span class="sd">        Validates that:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-115"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-115"><span class="linenos">115</span></a><span class="sd">        - Files are not placed inside a single subdirectory</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-116"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-116"><span class="linenos">116</span></a><span class="sd">        - Only expected files exist in the root directory</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-117"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-117"><span class="linenos">117</span></a><span class="sd">        - No unexpected folders exist</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-118"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-118"><span class="linenos">118</span></a><span class="sd">        - All files match either expected or optional file patterns</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-119"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-119"><span class="linenos">119</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-120"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-120"><span class="linenos">120</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-121"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-121"><span class="linenos">121</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-122"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-122"><span class="linenos">122</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-123"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-123"><span class="linenos">123</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-124"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-124"><span class="linenos">124</span></a><span class="sd">                - bool: True if validation passed (no unexpected files), False otherwise</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-125"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-125"><span class="linenos">125</span></a><span class="sd">                - List[str]: List of error messages for each unexpected file or folder</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-126"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-127"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-127"><span class="linenos">127</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-128"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-128"><span class="linenos">128</span></a>        <span class="n">expected_files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">spreadsheet_info</span><span class="o">.</span><span class="n">EXPECTED_FILES</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-129"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-129"><span class="linenos">129</span></a>        <span class="n">optional_files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">spreadsheet_info</span><span class="o">.</span><span class="n">OPTIONAL_FILES</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-130"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-130"><span class="linenos">130</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-131"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-132"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-132"><span class="linenos">132</span></a>            <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-133"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-133"><span class="linenos">133</span></a>            <span class="n">is_dir</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-134"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-134"><span class="linenos">134</span></a>            <span class="k">if</span> <span class="n">is_dir</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-135"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-135"><span class="linenos">135</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_files_not_in_folder&quot;</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-136"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-136"><span class="linenos">136</span></a>                <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-137"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-137"><span class="linenos">137</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-138"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-138"><span class="linenos">138</span></a>        <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-139"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-139"><span class="linenos">139</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-140"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-140"><span class="linenos">140</span></a>            <span class="n">is_file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-141"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-141"><span class="linenos">141</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_file</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-142"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-142"><span class="linenos">142</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_unexpected_folder&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-143"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-143"><span class="linenos">143</span></a>                <span class="k">continue</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-144"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-144"><span class="linenos">144</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-145"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-145"><span class="linenos">145</span></a>            <span class="n">file_base</span><span class="p">,</span> <span class="n">file_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-146"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-146"><span class="linenos">146</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-147"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-147"><span class="linenos">147</span></a>            <span class="k">if</span> <span class="n">file_base</span> <span class="ow">in</span> <span class="n">expected_files</span> <span class="ow">and</span> <span class="n">file_ext</span> <span class="ow">in</span> <span class="n">expected_files</span><span class="p">[</span><span class="n">file_base</span><span class="p">]:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-148"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-148"><span class="linenos">148</span></a>                <span class="k">continue</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-149"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-149"><span class="linenos">149</span></a>            <span class="k">if</span> <span class="n">file_base</span> <span class="ow">in</span> <span class="n">optional_files</span> <span class="ow">and</span> <span class="n">file_ext</span> <span class="ow">in</span> <span class="n">optional_files</span><span class="p">[</span><span class="n">file_base</span><span class="p">]:</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-150"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-150"><span class="linenos">150</span></a>                <span class="k">continue</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-151"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-151"><span class="linenos">151</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-152"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-152"><span class="linenos">152</span></a>            <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_unexpected_file&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-153"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-153"><span class="linenos">153</span></a>
</span><span id="ValidatorStructureFiles.check_not_expected_files_in_folder_root-154"><a href="#ValidatorStructureFiles.check_not_expected_files_in_folder_root-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span></pre></div>


            <div class="docstring"><p>Check for unexpected folders or files in the input directory.</p>

<p>Validates that:</p>

<ul>
<li>Files are not placed inside a single subdirectory</li>
<li>Only expected files exist in the root directory</li>
<li>No unexpected folders exist</li>
<li>All files match either expected or optional file patterns</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[bool, List[str]]
    A tuple containing:
        - bool: True if validation passed (no unexpected files), False otherwise
        - List[str]: List of error messages for each unexpected file or folder</p>
</div>


                            </div>
                            <div id="ValidatorStructureFiles.check_expected_files_in_folder_root" class="classattr">
                                        <input id="ValidatorStructureFiles.check_expected_files_in_folder_root-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_expected_files_in_folder_root</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ValidatorStructureFiles.check_expected_files_in_folder_root-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.check_expected_files_in_folder_root"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-156"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_expected_files_in_folder_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-157"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-158"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-158"><span class="linenos">158</span></a><span class="sd">        Check if all expected files are present in the input directory.</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-159"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-159"><span class="linenos">159</span></a>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-160"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-160"><span class="linenos">160</span></a><span class="sd">        Validates that all required files defined in the configuration are present</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-161"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-161"><span class="linenos">161</span></a><span class="sd">        in the root directory, accepting any of the allowed file extensions</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-162"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-162"><span class="linenos">162</span></a><span class="sd">        (.xlsx or .csv) for each file.</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-163"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-163"><span class="linenos">163</span></a>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-164"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-164"><span class="linenos">164</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-165"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-165"><span class="linenos">165</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-166"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-166"><span class="linenos">166</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-167"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-167"><span class="linenos">167</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-168"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-168"><span class="linenos">168</span></a><span class="sd">                - bool: True if validation passed (all expected files present), False otherwise</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-169"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-169"><span class="linenos">169</span></a><span class="sd">                - List[str]: List of error messages for each missing file</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-170"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-171"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-171"><span class="linenos">171</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-172"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-172"><span class="linenos">172</span></a>        <span class="n">expected_files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">spreadsheet_info</span><span class="o">.</span><span class="n">EXPECTED_FILES</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-173"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-173"><span class="linenos">173</span></a>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-174"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">file_base</span><span class="p">,</span> <span class="n">extensions</span> <span class="ow">in</span> <span class="n">expected_files</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-175"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-175"><span class="linenos">175</span></a>            <span class="n">file_found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-176"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-176"><span class="linenos">176</span></a>            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-177"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-177"><span class="linenos">177</span></a>                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">data_args</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_base</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-178"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-178"><span class="linenos">178</span></a>                <span class="n">is_file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fs_utils</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-179"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-179"><span class="linenos">179</span></a>                <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-180"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-180"><span class="linenos">180</span></a>                    <span class="n">file_found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-181"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-181"><span class="linenos">181</span></a>                    <span class="k">break</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-182"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-182"><span class="linenos">182</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">file_found</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-183"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-183"><span class="linenos">183</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_missing_file&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_base</span><span class="o">=</span><span class="n">file_base</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles.check_expected_files_in_folder_root-184"><a href="#ValidatorStructureFiles.check_expected_files_in_folder_root-184"><span class="linenos">184</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span></pre></div>


            <div class="docstring"><p>Check if all expected files are present in the input directory.</p>

<p>Validates that all required files defined in the configuration are present
in the root directory, accepting any of the allowed file extensions
(.xlsx or .csv) for each file.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[bool, List[str]]
    A tuple containing:
        - bool: True if validation passed (all expected files present), False otherwise
        - List[str]: List of error messages for each missing file</p>
</div>


                            </div>
                            <div id="ValidatorStructureFiles.check_ignored_files_in_folder_root" class="classattr">
                                        <input id="ValidatorStructureFiles.check_ignored_files_in_folder_root-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_ignored_files_in_folder_root</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ValidatorStructureFiles.check_ignored_files_in_folder_root-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.check_ignored_files_in_folder_root"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-186"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_ignored_files_in_folder_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-187"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-188"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-188"><span class="linenos">188</span></a><span class="sd">        Check for files that will be ignored due to format conflicts.</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-189"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-189"><span class="linenos">189</span></a>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-190"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-190"><span class="linenos">190</span></a><span class="sd">        Validates that there are no conflicting file formats in the root folder.</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-191"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-191"><span class="linenos">191</span></a><span class="sd">        When both .xlsx and .csv files exist with the same base name, this creates</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-192"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-192"><span class="linenos">192</span></a><span class="sd">        ambiguity in which file to use and is considered an error.</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-193"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-193"><span class="linenos">193</span></a>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-194"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-194"><span class="linenos">194</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-195"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-195"><span class="linenos">195</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-196"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-196"><span class="linenos">196</span></a><span class="sd">        Tuple[bool, List[str]]</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-197"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-197"><span class="linenos">197</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-198"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-198"><span class="linenos">198</span></a><span class="sd">                - bool: True if validation passed (no conflicting files), False otherwise</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-199"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-199"><span class="linenos">199</span></a><span class="sd">                - List[str]: List of error messages for each file with conflicting formats</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-200"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-200"><span class="linenos">200</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-201"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-201"><span class="linenos">201</span></a>        <span class="n">local_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-202"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-202"><span class="linenos">202</span></a>        <span class="n">file_groups</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-203"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-203"><span class="linenos">203</span></a>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-204"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-204"><span class="linenos">204</span></a>        <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_files</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-205"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-205"><span class="linenos">205</span></a>            <span class="n">file_base</span><span class="p">,</span> <span class="n">file_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-206"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-206"><span class="linenos">206</span></a>            <span class="k">if</span> <span class="n">file_ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;.csv&quot;</span><span class="p">]:</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-207"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-207"><span class="linenos">207</span></a>                <span class="k">if</span> <span class="n">file_base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_groups</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-208"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-208"><span class="linenos">208</span></a>                    <span class="n">file_groups</span><span class="p">[</span><span class="n">file_base</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-209"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-209"><span class="linenos">209</span></a>                <span class="n">file_groups</span><span class="p">[</span><span class="n">file_base</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_ext</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-210"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-210"><span class="linenos">210</span></a>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-211"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-211"><span class="linenos">211</span></a>        <span class="k">for</span> <span class="n">file_base</span><span class="p">,</span> <span class="n">extensions</span> <span class="ow">in</span> <span class="n">file_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-212"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-212"><span class="linenos">212</span></a>            <span class="k">if</span> <span class="s2">&quot;.xlsx&quot;</span> <span class="ow">in</span> <span class="n">extensions</span> <span class="ow">and</span> <span class="s2">&quot;.csv&quot;</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-213"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-213"><span class="linenos">213</span></a>                <span class="n">local_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">lm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;validator_structure_error_conflicting_files&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_base</span><span class="o">=</span><span class="n">file_base</span><span class="p">))</span>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-214"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-214"><span class="linenos">214</span></a>
</span><span id="ValidatorStructureFiles.check_ignored_files_in_folder_root-215"><a href="#ValidatorStructureFiles.check_ignored_files_in_folder_root-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">local_errors</span><span class="p">,</span> <span class="n">local_errors</span>
</span></pre></div>


            <div class="docstring"><p>Check for files that will be ignored due to format conflicts.</p>

<p>Validates that there are no conflicting file formats in the root folder.
When both .xlsx and .csv files exist with the same base name, this creates
ambiguity in which file to use and is considered an error.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[bool, List[str]]
    A tuple containing:
        - bool: True if validation passed (no conflicting files), False otherwise
        - List[str]: List of error messages for each file with conflicting formats</p>
</div>


                            </div>
                            <div id="ValidatorStructureFiles.validate_all_general_structure" class="classattr">
                                        <input id="ValidatorStructureFiles.validate_all_general_structure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_all_general_structure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ValidatorStructureFiles.validate_all_general_structure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.validate_all_general_structure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles.validate_all_general_structure-217"><a href="#ValidatorStructureFiles.validate_all_general_structure-217"><span class="linenos">217</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_all_general_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-218"><a href="#ValidatorStructureFiles.validate_all_general_structure-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-219"><a href="#ValidatorStructureFiles.validate_all_general_structure-219"><span class="linenos">219</span></a><span class="sd">        Perform all validation checks on the input folder structure.</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-220"><a href="#ValidatorStructureFiles.validate_all_general_structure-220"><span class="linenos">220</span></a>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-221"><a href="#ValidatorStructureFiles.validate_all_general_structure-221"><span class="linenos">221</span></a><span class="sd">        Executes a comprehensive set of structural validations including:</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-222"><a href="#ValidatorStructureFiles.validate_all_general_structure-222"><span class="linenos">222</span></a><span class="sd">        - Empty directory check</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-223"><a href="#ValidatorStructureFiles.validate_all_general_structure-223"><span class="linenos">223</span></a><span class="sd">        - Unexpected files and folders check</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-224"><a href="#ValidatorStructureFiles.validate_all_general_structure-224"><span class="linenos">224</span></a><span class="sd">        - Expected files presence check</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-225"><a href="#ValidatorStructureFiles.validate_all_general_structure-225"><span class="linenos">225</span></a><span class="sd">        - Conflicting file formats check</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-226"><a href="#ValidatorStructureFiles.validate_all_general_structure-226"><span class="linenos">226</span></a>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-227"><a href="#ValidatorStructureFiles.validate_all_general_structure-227"><span class="linenos">227</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-228"><a href="#ValidatorStructureFiles.validate_all_general_structure-228"><span class="linenos">228</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-229"><a href="#ValidatorStructureFiles.validate_all_general_structure-229"><span class="linenos">229</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-230"><a href="#ValidatorStructureFiles.validate_all_general_structure-230"><span class="linenos">230</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-231"><a href="#ValidatorStructureFiles.validate_all_general_structure-231"><span class="linenos">231</span></a><span class="sd">                - List[str]: Accumulated list of all validation errors</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-232"><a href="#ValidatorStructureFiles.validate_all_general_structure-232"><span class="linenos">232</span></a><span class="sd">                - List[str]: Empty list (no warnings generated by this method)</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-233"><a href="#ValidatorStructureFiles.validate_all_general_structure-233"><span class="linenos">233</span></a>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-234"><a href="#ValidatorStructureFiles.validate_all_general_structure-234"><span class="linenos">234</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-235"><a href="#ValidatorStructureFiles.validate_all_general_structure-235"><span class="linenos">235</span></a><span class="sd">        -----</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-236"><a href="#ValidatorStructureFiles.validate_all_general_structure-236"><span class="linenos">236</span></a><span class="sd">        All errors from individual checks are aggregated into a single error list.</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-237"><a href="#ValidatorStructureFiles.validate_all_general_structure-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-238"><a href="#ValidatorStructureFiles.validate_all_general_structure-238"><span class="linenos">238</span></a>        <span class="n">all_errors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-239"><a href="#ValidatorStructureFiles.validate_all_general_structure-239"><span class="linenos">239</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_empty_directory</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-240"><a href="#ValidatorStructureFiles.validate_all_general_structure-240"><span class="linenos">240</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_not_expected_files_in_folder_root</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-241"><a href="#ValidatorStructureFiles.validate_all_general_structure-241"><span class="linenos">241</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_expected_files_in_folder_root</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-242"><a href="#ValidatorStructureFiles.validate_all_general_structure-242"><span class="linenos">242</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_ignored_files_in_folder_root</span><span class="p">()],</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-243"><a href="#ValidatorStructureFiles.validate_all_general_structure-243"><span class="linenos">243</span></a>        <span class="p">]</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-244"><a href="#ValidatorStructureFiles.validate_all_general_structure-244"><span class="linenos">244</span></a>        <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">all_errors</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-245"><a href="#ValidatorStructureFiles.validate_all_general_structure-245"><span class="linenos">245</span></a>            <span class="n">is_valid</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">check</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-246"><a href="#ValidatorStructureFiles.validate_all_general_structure-246"><span class="linenos">246</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid</span><span class="p">:</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-247"><a href="#ValidatorStructureFiles.validate_all_general_structure-247"><span class="linenos">247</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-248"><a href="#ValidatorStructureFiles.validate_all_general_structure-248"><span class="linenos">248</span></a>
</span><span id="ValidatorStructureFiles.validate_all_general_structure-249"><a href="#ValidatorStructureFiles.validate_all_general_structure-249"><span class="linenos">249</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Perform all validation checks on the input folder structure.</p>

<p>Executes a comprehensive set of structural validations including:</p>

<ul>
<li>Empty directory check</li>
<li>Unexpected files and folders check</li>
<li>Expected files presence check</li>
<li>Conflicting file formats check</li>
</ul>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: Accumulated list of all validation errors
        - List[str]: Empty list (no warnings generated by this method)</p>

<h2 id="notes">Notes</h2>

<p>All errors from individual checks are aggregated into a single error list.</p>
</div>


                            </div>
                            <div id="ValidatorStructureFiles.run" class="classattr">
                                        <input id="ValidatorStructureFiles.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ValidatorStructureFiles.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ValidatorStructureFiles.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ValidatorStructureFiles.run-251"><a href="#ValidatorStructureFiles.run-251"><span class="linenos">251</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ValidatorStructureFiles.run-252"><a href="#ValidatorStructureFiles.run-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.run-253"><a href="#ValidatorStructureFiles.run-253"><span class="linenos">253</span></a><span class="sd">        Execute all file structure validations.</span>
</span><span id="ValidatorStructureFiles.run-254"><a href="#ValidatorStructureFiles.run-254"><span class="linenos">254</span></a>
</span><span id="ValidatorStructureFiles.run-255"><a href="#ValidatorStructureFiles.run-255"><span class="linenos">255</span></a><span class="sd">        Orchestrates the validation process by executing all structural checks</span>
</span><span id="ValidatorStructureFiles.run-256"><a href="#ValidatorStructureFiles.run-256"><span class="linenos">256</span></a><span class="sd">        and building reports based on the validation results.</span>
</span><span id="ValidatorStructureFiles.run-257"><a href="#ValidatorStructureFiles.run-257"><span class="linenos">257</span></a>
</span><span id="ValidatorStructureFiles.run-258"><a href="#ValidatorStructureFiles.run-258"><span class="linenos">258</span></a><span class="sd">        Returns</span>
</span><span id="ValidatorStructureFiles.run-259"><a href="#ValidatorStructureFiles.run-259"><span class="linenos">259</span></a><span class="sd">        -------</span>
</span><span id="ValidatorStructureFiles.run-260"><a href="#ValidatorStructureFiles.run-260"><span class="linenos">260</span></a><span class="sd">        Tuple[List[str], List[str]]</span>
</span><span id="ValidatorStructureFiles.run-261"><a href="#ValidatorStructureFiles.run-261"><span class="linenos">261</span></a><span class="sd">            A tuple containing:</span>
</span><span id="ValidatorStructureFiles.run-262"><a href="#ValidatorStructureFiles.run-262"><span class="linenos">262</span></a><span class="sd">                - List[str]: All validation errors collected during execution</span>
</span><span id="ValidatorStructureFiles.run-263"><a href="#ValidatorStructureFiles.run-263"><span class="linenos">263</span></a><span class="sd">                - List[str]: All validation warnings collected during execution</span>
</span><span id="ValidatorStructureFiles.run-264"><a href="#ValidatorStructureFiles.run-264"><span class="linenos">264</span></a>
</span><span id="ValidatorStructureFiles.run-265"><a href="#ValidatorStructureFiles.run-265"><span class="linenos">265</span></a><span class="sd">        Notes</span>
</span><span id="ValidatorStructureFiles.run-266"><a href="#ValidatorStructureFiles.run-266"><span class="linenos">266</span></a><span class="sd">        -----</span>
</span><span id="ValidatorStructureFiles.run-267"><a href="#ValidatorStructureFiles.run-267"><span class="linenos">267</span></a><span class="sd">        Validation results are aggregated into reports via the `build_reports()` method</span>
</span><span id="ValidatorStructureFiles.run-268"><a href="#ValidatorStructureFiles.run-268"><span class="linenos">268</span></a><span class="sd">        and tagged with the file structure validation identifier (NamesEnum.FS).</span>
</span><span id="ValidatorStructureFiles.run-269"><a href="#ValidatorStructureFiles.run-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ValidatorStructureFiles.run-270"><a href="#ValidatorStructureFiles.run-270"><span class="linenos">270</span></a>        <span class="n">validations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ValidatorStructureFiles.run-271"><a href="#ValidatorStructureFiles.run-271"><span class="linenos">271</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate_all_general_structure</span><span class="p">,</span> <span class="n">NamesEnum</span><span class="o">.</span><span class="n">FS</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="ValidatorStructureFiles.run-272"><a href="#ValidatorStructureFiles.run-272"><span class="linenos">272</span></a>        <span class="p">]</span>
</span><span id="ValidatorStructureFiles.run-273"><a href="#ValidatorStructureFiles.run-273"><span class="linenos">273</span></a>
</span><span id="ValidatorStructureFiles.run-274"><a href="#ValidatorStructureFiles.run-274"><span class="linenos">274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_reports</span><span class="p">(</span><span class="n">validations</span><span class="p">)</span>
</span><span id="ValidatorStructureFiles.run-275"><a href="#ValidatorStructureFiles.run-275"><span class="linenos">275</span></a>
</span><span id="ValidatorStructureFiles.run-276"><a href="#ValidatorStructureFiles.run-276"><span class="linenos">276</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnings</span>
</span></pre></div>


            <div class="docstring"><p>Execute all file structure validations.</p>

<p>Orchestrates the validation process by executing all structural checks
and building reports based on the validation results.</p>

<h2 id="returns">Returns</h2>

<p>Tuple[List[str], List[str]]
    A tuple containing:
        - List[str]: All validation errors collected during execution
        - List[str]: All validation warnings collected during execution</p>

<h2 id="notes">Notes</h2>

<p>Validation results are aggregated into reports via the <code><a href="#ValidatorStructureFiles.build_reports">build_reports()</a></code> method
and tagged with the file structure validation identifier (NamesEnum.FS).</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>